[TulaAnti&ViralClub] PRESENTS ...
MooN_BuG, Issue 7, Sep 1998                                           file 014

                       Тысяча и одна ночь криптографии
                                                        by Генрих ШАНКИН

     После  гибели  Римской  империи Европа погрузилась во мрак средневековья.
Почти   исчезли   грамотность,  наука  и  искусство.  Не  стала  исключением и
криптография.
     Применявшиеся  в  это  время  шифры были предельно просты. Фразы писались
либо  по  вертикали,  либо  в  обратном  порядке,  гласные заменялись точками,
использовались  иностранные  алфавиты (греческий, древнееврейский, армянский и
т.д.  -  вместо  латинского). В шифрах простой замены использовался упрощенный
шифр  Цезаря, где каждая буква заменялась на последующую в алфавитном порядке,
а в более сложных системах буквы заменялись на специально придуманные знаки.
     Из  этого  времени в истории сохранилось лишь несколько имен, связанных с
европейской криптографией.
     Согласно преданию, миссионер Св. Бонифаций (Германия) в XVIII веке привез
в  Западную  Европу  "Сборник  криптозагадок",  где  гласные  буквы заменялись
точками.  Монах  Герберт  (X  век),  правящий католической церковью под именем
Сильвестра  II,  вел  записи по так н азываемой силлабической системе, которая
была изобретена вольноотпущенным Цицерона Туллием Тироном.
     Английский   монах-францисканец,   профессор  в  Оксфорде,  универсальный
ученый,  математик,  оптик, астроном Роджер Бэкон в середине XIII века написал
книгу  "Тайные  опыты  и  недействительность магии". В предисловии он заметил:
"Дурак тот, кто пишет о тайне каким -либо способом, но не так, чтобы скрыть ее
от  простонародья".  Здесь же Бэкон приводит несколько методов сокрытия тайны:
пропуск  гласных  букв,  использование метафор, букв из иностранных алфавитов,
стенографии, то есть скорописи.
     За  свои научные работы Роджер Бэкон был осужден церковным судом и провел
14  лет  в  заточении.  Его  обвинили в черной магии. Особенно много суеверных
толков связано с его лабораторией. Говорили, будто в ней Бэкон вместе со своим
учеником  монахом  Бунгеем  изг  отовил  бронзовую  голову,  которую с помощью
дьявола  пытался  оживить  и  заставить  говорить.  В конце жизни Роджер Бэкон
покаялся  и  стал  отшельником.  В XVI веке, после появления легенды о докторе
Фаусте, его стали считать прообразом этого героя.
     Одним  из  ведущих  европейских  криптографов  был  известный  английский
писатель,  астроном-любитепь,  таможенный  чиновник  Джеффри Чосер. Сама жизнь
заставила  автора  знаменитых  "Кентерберийских рассказов" овладеть искусством
криптографии.  Еще  мальчиком  он  был  о  пределен  пажом  при дворе, а затем
рыцарским  оруженосцем  в  окружении  английского  короля.  Во время похода на
Францию  он  попал  в  плен,  но  вместе  с  двумя чистокровными скакунами был
выкуплен  своим  монархом, который заплатил 120 ливров за лошадей и всего 16-з
а  своего  подданного.  В  70-х  годах  в  звании  эсквайра Чосер, как человек
надежный  и  сведущий,  выполнял  секретные  дипломатические  поручения своего
короля  в Италии и Франции. Всю тайную переписку он вел используя шифр простой
замены.  Даже  в свои стихи он вкл ючал зашифрованные строфы. Преуспев в делах
дипломатических,   он   оставался   в  тени,  получив  за  многолетнюю  службу
"высочайшую" милость - всего-то должность таможенного надсмотрщика лондонского
порта  по  шерсти,  коже  и мехам. Но величайшим делом его жизни бы ли поэзия,
астрономия  и криптография. Однако ни то, ни другое, ни третье не принесло ему
ни  славы,  ни  денег. Он кончил жизнь смотрителем стен, валов, канав, сточных
труб,  прудов,  дорог  и  мостов вдоль Темзы и был похоронен в Вестминстерском
аббатстве.
     Во  времена средневековья европейская криптография приобрела сомнительную
славу,   отголоски   которой   слышатся  и  в  наши  дни.  Криптографию  стали
отождествлять  с  черной  магией, с некоторой формой оккультизма, астрологией,
алхимией, еврейской каббалой. К шифров анию информации призывались мистические
силы. Так, например, рекомендовалось использовать "магические квадраты".
     В  квадрат  размером  4  на  4  вписывались  числа  от 1 до 16. Его магия
состояла  в  том,  что  сумма  чисел  по строкам, столбцам и полным диагоналям
равнялась одному и тому же числу - 34. Впервые эти квадраты появились в Китае,
где им и была приписана некоторая "м агическая сипа".

                      16   3   2   13
                      5   10  11    8
                      9    6   7   12
                      4   15  14    1

     Шифрование  по  магическому  квадрату  производилось  следующим  образом.
Например,  требуется  зашифровать  фразу: "Приезжаю сегодня". Буквы этой фразы
вписываются  последовательно  в  квадрат согласно записанным в них числам, а в
пустые клетки ставится точка.

                      16.   3 И   2 Р   13 Д
                      5 З  10 Е  11 Г    8 Ю
                      9 С   6 Ж   7 А   12 О
                      4 Е  15 Я  14 Н    1 П

     После этого шифрованный текст записывается в строку:

                              (.)ИРДЗЕГЮСЖАОЕЯНП

     При расшифровывании текст вписывается в квадрат и открытый текст читается
в последовательности чисел "магического квадрата".
     Данный  шифр  -  обычный  шифр  перестановки,  но  считалось,  что особую
стойкость ему придает волшебство "магического квадрата".
     Иначе  обстояло дело на Востоке. В арабском мире в это время была создана
одна  из  самых  развитых  цивилизаций.  Процветала наука, арабская медицина и
математика  стали  ведущими  в  мире. Естественно, что и наилучшие условия для
развития  криптографии  появились  именно  здесь.  Одно  из  основных  понятий
криптографии - шифр - имеет корни в арабском слове "цифра". Некоторые историки
даже  считают, что криптография как наука зародилась в арабском мире. Именно в
арабских  книгах  впервые  были  описаны  содержательные  методы криптоанализа
(дешифрования).  Тайнопись  и ее значение упоминается в сказках "Тысяча и одна
ночь".  Одна  из  первых  крупных  книг,  в  которой содержательно описывается
криптография,  -  это  труд,  созданный  Абу  Бакр  Ахмед  бен  Али бен Вахшия
ан-Набати,  -  "Книга  о большом стремлении человека разгадать загадки древней
письменности". В ней описано несколько систем шифров.
     В  1412  году  Шехаб  аль Каш-канди написал 14-томную энциклопедию "Шауба
аль-Аша". В этой работе имеется раздел о криптографии "Относительно сокрытия в
буквах тайных сообщений". В нем дано систематическое описание различных шифров
замены  и  перестановки.  Зде  сь  же приводится и криптоанализ этих шифров на
основе   подсчета   частотности  букв  в  арабском  языке  по  тексту  Корана:
развиваются  методы  дешифрования,  базирующиеся  на  разночастотности букв. В
работе    Кашканди    предлагается   семь   систем   шифрования   (повторяющих
неопубликованные идеи его предшественника Ибн ад-Дурахийма):
     одна буква может заменять другую;
     можно  писать  слово  в  обратном порядке, например, слово "Мухаммед" (в
арабском алфавите, состоящем из согласных) примет вид ДМХМ:
     можно переставлять в обратном порядке чередующиеся буквы слов;
     заменять в соответствии с принятой заменой арабских букв на числа. Тогда
слово   "Мухаммед"  превращается  в  40+8+40+4  (М=40,  Х=8,  Д=4).  При  этом
криптограмма выглядит как перечень каких-то цифр;
     можно  заменять  каждую букву открытого текста на две арабские буквы, ко
торые  используются и в качестве чисел и сумма которых равна цифровой величине
шифруемой буквы открытого текста;
     можно заменять каждую букву именем какого-либо человека;
     при  шифровании  можно  использовать  положения  Луны, названия стран (в
определенном по рядке), перечисление названий фруктов, деревьев и т.д.
     Арабы  первыми обратили внимание на возможность использования стандартных
слов  и выражений для дешифрования. Так, первый широко известный филолог среди
арабов  Абу  аль-Ахмади, дешифровав криптограмму на греческом языке, посланную
ему  византийским  императо  ром,  заявил:  "Я  сказал себе, что письмо должно
начинаться  со слов "Во имя Бога" или как-нибудь в этом роде. Итак, я составил
на основе этого первые буквы, и все оказалось правильным". На основе открытого
им  метода  дешифрования  он написал книгу "Китаб аль -Маумма" ("Книга тайного
языка").
     Однако в последующем столетии криптография у арабов деградировала. В 1600
году   марокканский  султан  Ахмед  аль-Мансур  направил  английской  королеве
Елизавете  посольство  в целях заключения союза против Испании. Посол отправил
султану зашифрованную депешу, ко торая попала в руки к арабам. Ее дешифрование
длилось  15  лет  и  в связи с успешным завершением работы арабы воздали хвалу
Аллаху. Ибн ад-ДурахиЙм решил бы эту загадку за несколько часов.
     Но  впереди,  вместе  с  эпохой  Возрождения, приближался и новый расцвет
криптографии.
