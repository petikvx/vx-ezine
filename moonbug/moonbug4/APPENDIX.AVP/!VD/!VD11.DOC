                                Хороший вирус - намертво
                                залеченый вирус.

                Virus Detector version 1.1

                      Что есть VD ?

  VD, как это следует из названия, отностися к антивирусным
  программам. Однако, он обладает некоторыми ( причем очень
  важными ) особенностями :
     - НИЧЕГО не лечит
     - не ориентирован ни на один конкретный вирус
  Такая отстраненность  от  конкретных вирусов  объясняется
  несколькими причинами. В первую очередь,это желание иметь
  программу, которая с одинаковой  легкостью будет находить
  как старые, так и новые вирусы;  при этом время ее работы
  должно быть минимальным. Широко распространенные антивиру-
  сы (DrWeb, AVP, TBAV), к сожалению,  не удовлетворяют вре-
  менному критерию. Это (плюс подозрение о неполноте тестов,
  проводимых вышеперечисленными программами) и привело к на-
  писанию Virus Detector'a.
  VD проверяет множество параметров -- наличие обработчиков
  прерываний в  зарезервированных областях,  подозрительные
  MCB, входные значения регистров, соответствие DOS-перемен-
  ных реальным значениям и т.д. VD осбенно чувствителен к
  резидентным вирусам, в то время как  на  Search-вирус  он
  среагирует в двух случаях :
      - заражен файл !VD.EXE
      - вирус оставил в памяти компьютера какой-то
        резидентный код (отвечающий, например, за видеоэффек-
        ты).
  "Крутой" стелс-вирус найден не будет, хотя не очень наворо-
  ченные (скрывающие только изменение длины, не обрабатывающие
  FCB-функции MS-DOS или обрабатывающие только их) будут выяв-
  лены. Причем найдены будут и .COM, и .EXE вирусы, независимо
  от метода заражения -- при создании исполняемого файла, при
  его открытии, закрытии или запуске.

  Не упаковывайте !VD.EXE  различными программами типа PKLITE,
  DIET, LZEXE, ExePack,... Этим вы понизите качество его рабо-
  ты. Дело в том, что существуют вирусы, заражающие  файл при
  наличии в нем достаточно большого участка повторяющихся дан-
  ных. VD содержит 3х килобайтный буфер, который исполбзуется
  двояко -- и как ловушка для таких вирусов, и по прямому наз-
  начению (в качестве буфера  при  создании  временных файлов
  #TEMPEXE.EXE и #TEMPCOM.COM). После упаковки этих трех кило-
  байт, естественно,  не останется.  Кроме того, VD проверяет
  свой файл на целостность (размер+CRC32). После  упаковки Вы
  неизменно будете получать сообщение
   Virus Detector file is corrupt !
   You have a virus !
  и, вероятно,
   Registers are broken !
   Stealth virus detected !
  Аналогичные сообщения будут выдаваться и при заражении упако-
  ванного файла. В случае отсутствия каких-либо иных проявлений
  вируса Вы можете не заметить разницы.

                        Работа с VD v1.1

  Никаких особых требований VD не предъявляет. Его можно запус-
  кать без параметров, при этом будет напечатан только оконча-
  тельный результат проверки. Если было выдано сообщение о воз-
  можном наличии в системе вируса -- вот тут-то и пришло время
  "нормальных" антивирусов. Если их запуск ничего не дал, запус-
  тите VD с ключем /R и попытайтесь понять, в чем дело. Обрати-
  те особое внимание на наличие в зарезервированных областях
  обработчиков прерываний (8,9,10h,11h,12h,17h,28h,2Ah,70h,13h,
  16h,1Ch,21h,40h) и сообщения о несоответствии размера памяти
  значению переменной DOS. Если единственным сообщением было
    Registers are broken,
  то либо Вы запустили VD из-под отладчика, либо работаете в
  не совсем совместимой с MS-DOS 6.20 OS.
  Если во время работы VD Вам показалось, что экран покраснел,
  а затем восстановил свой прежний вид -- не трите уставшие
  глаза. Вы наблюдали тест видеопамяти.

  Ключи командной строки :
        /? - краткая справка
        /R - полный отчет о работе
        /A - не тестировать систему на наличие вирусов, обра-
             тывающих функцию 13h прерывания 2Fh. Таким прие-
             мом некоторые BOOT-вирусы пытаются спрятаться от
             не очень дотошных антивирусов (как правило, от
             ADINF'a, за что и получили свое название).
        /F - отключает создание и последующий запуск "наживок"
             -- файлов #TEMPCOM.COM и #TEMPEXE.EXE. Не стоит
             отключать эту проверку.

  Коды завершения (ErrorLevel) :
    0 - вирусов не обнаружено
    1 - возможно наличие вируса в системе
    2 - обнаружен вирус
    3 - найдено много вирусов или что-то большое и навороченное

  Два совета :
   - Не стоит запускать !VD.EXE из-под Windows. Конфликтов с
     системой не будет, но могут быть ложные срабатывания.
   - Проверяйте систему даже при единственном сообщении
     Registers are broken. Береженого бог бережет.

                  Список возможных сообщений

   BIOS Memory Size report : XXXK
   DOS  Memory Size report : YYYK
   Diagnose : It''s may be virus !
   Diagnose : You have a virus !!
   Diagnose : You have a total %#&%@& !!! : One_cool or many simple viruses !
   Diagnose : Viruses are not detected.
   AntiAdinf style virus detected !
   Possibly boot virus (int 13h handler in RAM).
   TSR.EXE. virus detected !
   TSR.COM. virus detected !
   TSR.EXE.Stealth virus detected !
   TSR.COM.Stealth virus detected !
   Warning : strange Memory Control Block at XXXXh:0 (X bytes long).
   Testing MCB ...
   Testing last MCB ...
   Testing end of conventional memory ...
   Testing TSR.COM.EXE viruses ...
   Not enough memory !
   Warning : Int XXh handler in reserved area (XXXXh:XXXXh) !
   ChipAwayVirus Enable
   Registers are broken !
   Virus Detector file is corrupt !
   MS Windows 2.0 (win386) detected.
   MS Windows 3.0 (Enhanced mode) detected.
   MS Windows 3.1 (Enhanced mode) detected.
   MS Windows 3.0 (Real mode) detected.
   MS Windows 3.x (Standart mode) detected.

                        История.

            Прообразом для Virus Detector'а послужил
              VirusTest (c) by Chebotarev Alexander.
     Несмотря на успешную борьбу с V-1441 и ChDir-783 это была
     черезвычайно глюкавая программа.

     ═════════════╤════════════════════════════════════════════
       Версия     │        Комментарий
     ═════════════╪════════════════════════════════════════════
        1.0       │   Проверка зарезервированных областей,
                  │   MCB, контроль за целостностью файла,
                  │   TSR.Virus-тест.
     ─────────────┼────────────────────────────────────────────
        1.1       │   Bug fixed. Проверка AntiAdinf-вирусов.
     ═════════════╪════════════════════════════════════════════
        2.0?      │   Эвристический анализ обработчиков пре-
                  │   рываний.
     ═════════════╧════════════════════════════════════════════

                        Реквизиты автора.

     Пожелания, вопросы и пиво шлите по адресу
                     Vladimir S. Lokhov 2:5022/18.14@fidonet

     PS: файл-бомбы будут заключены в вирусную оболочку для
     увеличения мощности и отправленны обратно :)
     PPS: будут вирусы - шлите, всегда рады.
                                              Владимир Лохов.
