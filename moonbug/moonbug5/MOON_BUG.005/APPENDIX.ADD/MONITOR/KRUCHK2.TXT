Ю. Крючков

"Вскрытие"  парольной защиты в операционных системах DR DOS

- Скажи пароль!
- Пароль!
- Проходи!


Ключи и замки - это лишь для честных людей, а вот от ... защиты
нет. Однако бывают случаи, когда Вы сами потеряли ключ и не можете
попасть в свою же собственную квартиру. Как быть в этом случае?
Ломать дверь - жалко, бить окно (а если на дворе зима?) - еще хуже.

Так же бывает и при работе с компьютером: поставлен пароль, а
потом забыт. Что же делать? Переформатировать "винчестер" или
подбирать ключ для снятия пароля? Лично я выбираю второе.

Со мной произошел такой случай: после отработки архиватора lha
версии 2.12 с командой m и ключами -r1x1 образовался архив объемом
более 2 Мбайтов, к которому не было доступа. Работа компьютера
проходила под управлением операционной системы DR DOS 5.0.
Складывалось впечатление, что после упаковки архива и
переименования его из временного в итоговый система сама установила
атрибуты: hidden и пароль. Сложилась такая ситуация, что архив
есть, а воспользоваться им невозможно, так как пароль неизвестен. В
операционных системах DR DOS 3.41 и 5.0 файлы и каталоги
паролируются с помощью утилиты Password или из оболочки ViewMAX.
Здесь же ни первой, ни второй в системе не было, а пароль появился.
В чем дело?..

Выяснилось, что дело в операционной системе и программе lha.
Паролирование архива происходит в том случае, если в переменной
окружения указан каталог, в действительности отсутствующий в
системе, например:

SET TMP=C:\TEMP ,

а на диске С отсутствует или стерт каталог TEMP. Для исключения
таких случаев я рекомендую добавить в autoexec.bat следующую строку:

IF NOT "%TEMP%"=="" MD %TEMP% >NUL.

Теперь о снятии защиты в DR DOS. Для этого необходимо
воспользоваться утилитой DiskEdit из набора Norton Integrator или
аналогичной из PCTools. Необходимо найти на диске место, где в
таблице размещения файлов записана информация по интересующему Вас
файлу. В следующем за названием файла байте (смещение 0Bh) записаны
атрибуты этого файла (для каталога - аналогично файлу), затем
следуют четыре байта, два из которых (смещение 0h) используются
для установки пароля (рисунок). Следует заменить эти два байта
на 00Н, снять атрибут hidden (установить значение 20h), записать
внесенные изменения на диск, и проблема решена.

 0  1  2  3  4  5  6  7     8  9  A  B  C  D  E  F

48 49 44 4F 53 20 20 20  - 53 59 53 20 00 00 00 00   HIDOS   SYS ....
00 00 00 00 00 00 00 30  - 17 17 51 00 82 48 00 00   .......0..Q..H..
4B 45 59 42 20 20 20 20  - 43 4F 4D 22 00 00 0F 9C   KEYB    COM"....
00 00 00 00 55 05 00 30  - 17 17 0F 00 1F 87 00 00   ....U..0.......
4D 45 4D 20 20 20 20 20  - 45 58 45 20 00 00 00 00   MEM     EXE ....
00 00 00 00 00 00 00 30  - 17 17 49 00 2D 2C 00 00   .......0..I.-,..
4D 45 4D 4D 41 58 20 20  - 45 58 45 20 00 00 00 00   MEMMAX  EXE ....
00 00 00 00 00 00 00 30  - 17 17 4C 00 A6 08 00 00   .......0..L.....

Рис. Фрагмент таблицы размещения файлов
