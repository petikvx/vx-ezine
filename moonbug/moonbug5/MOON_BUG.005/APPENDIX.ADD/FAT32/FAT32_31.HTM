<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<TITLE>SetDPB_ForceMediaChng (FAT32)</TITLE>
<META NAME="MS-HKWD" CONTENT="SetDPB_ForceMediaChng (FAT32)">
<META NAME="MS-HAID" CONTENT="funcs_0000000101001e00">
</HEAD>
<BODY BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF">
<FORM name=x>
<OBJECT name=iv classid="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016">
</OBJECT>
</FORM>
<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="funcs_0000000101001e00"></A>SetDPB_ForceMediaChng (FAT32) </H2>
<P>
[Windows 95 only.]
<P>
Forces a media change. 
<P>
This sub-function is called when the SetDPB_Function field of the <A HREF="fat32_43.htm">SDPDFormatStruc
(FAT32)</A> structure is set to 2. 
<H4>Return Values</H4>
<P>
Sets a flag which causes the next MS-DOS access to the drive to call the
BUILD_DPD routine in the drive&#39;s device driver. 
<H4>Remarks</H4>
<P>
This is similar to the <A HREF="fat32_30.htm">SetDPB_SetDPBFrmBPB
(FAT32)</A> call, except that the BPB is obtained from the device driver instead
of a passed-in parameter. 
<P>
The function does not take effect on this call. Rather, it takes effect upon
the next access to the drive. Therefore, it is recommended to immediately
follow this with some other Int 21h call to the drive (for example <A HREF="fat32_27.htm">Int
21h Function 7303h Get_ExtFreeSpace (FAT32)</A>). 
<P>
As a side effect of this call, the next access to the drive also causes
dpb_next_free (or extdpb_next_free) to be reset to 2, and the dpb_free_cnt to
be reset to 0xFFFFFFFF. 
<P>
The assembler calling sequence for all Int 21h 7304h sub-functions is almost
identical. See the main listing for a sample. (<A HREF="fat32_28.htm">Int
21h Function 7304h Set_DPBForFormat (FAT32)</A>) 
<P></FONT>
</BODY>
</HTML>
