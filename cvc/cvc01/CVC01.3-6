
 ã•îe–e Õ©ü°°°œ¢ µEª• àwπ¡                                      CVC #01  97/06

-------------------------------------------------------------------> kiminwoo


                              Õ©ü°°°œ¢ µEª•∑Å äÅ¨˜
                            ~~~~~~~~~~~~~~~~~~~~~~~


 ª©¢Ö:  Õ©ü° °°œ¢∑° ¢≥ì°åa??
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 îs•e:  µÅ,Õ©ü° °°œ¢∑°úe †Å∂Å îa¥∑–e —w»Åù° π•∏Å–aâA –aìe à·
        ∫a.
        §aé° †i–a∏a°e êÅ∂w∑e à{∑aêa —w»Åàa îaüeàÛì°îa.

 ª©¢Ö:  ∏i°°üaâVìeïA..Õ©ü°°°œ¢µEª•∑e ≠°Øa œaù°ãaúëµA ¥·òÂ
        —w»Å∑Å ∏b¥Û∑i –sì°åa?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
îs•e:  †Å∂Å πΩ∑e ª©¢Ö∑≥ì°îa..îÅâA∑Å ¥q—°—¡ìe ¥q—°—¡àa ñAî·úa
       ï° ãaàı∑i ŒÅìe¶Å¶Ö
       -decryptûÅÀ•-∑° ∑©∏˜–aã° òÅ¢ÖµA §ÇØ• œaù°ãaúëµAâA
       ÆÛâA ¡A«a ñSì°îa.
       ¢Ö∏a ß°äaüi –aìe §ÇØ•∑© âw∂ÅµAìe †i∑°∫a.ãeïA Õ©ü°°°
       œ¢∑e ãa ¥q—°üi ŒÅìe¶Å¶ÖµA îa¥∑–e •e—¡üi ∫ÅìeàÛì°îa.
       µÅüi ói°e


               MOV      SI,enc_begin
               MOV      CX,10
main_loop:     XOR      BYTE PTR [SI],55
               INC      SI
               LOOP     main_loop

∑°ú·–e ûÅÀ•∑i •°°e enc_begin¶Å»· 10àÅ∑Å hexüi 55h∑Å àt∑aù°
¥q—°—¡ –aìeàı∑i ¥iÆÅ∑∂Øsì°îa.ãaúÂïA Õ©ü°°°œ¢∑Å §w§Û∑i ¬·–e
îa°e °wùw¥·ói∑Å ∂·√°üi ¨·ù° äa—≈–aìe§Û∑° ∑∂à·óe∂a..ãaàÈ –a
°e..

               MOV      CX,10
               MOV      SI,enc_begin
main_loop:     XOR      BYTE PTR [SI],55
               INC      SI
               LOOP     main_loop

∑°ú˝âA ñAìe àÛì°îa.∑°ú·–e Õ©ü°°°œ¢∑e 3àaª°∑° Õ©ü°°°œ¢ §wØ¢
∫óµA ¨˜ìw∑e ∫ó∑•ïA ¥e»aåsâAï° §a∑°ú·ØaµA êaµ°ìe °wùw¥·µA îÅ
–Å ïA∑°»a •A∑°Øa—¡ ñA¥·¥° –a£aù° ∂wú∑∑° ¥Ò¿˜êaâA ƒ·ª≥ì°îa.
ãaúÅ¨· ∂•π° Õ©ü°°°œ¢∑i •°°e

               MOV      CX,10
               NOP
               NOP
               MOV      SI,enc_begin
               NOP
main_loop:     NOP
               NOP
               XOR      BYTE PTR [SI],55
               NOP
               INC      SI
               NOP
               NOP
               NOP
               NOP
               LOOP     main_loop


∑°úÂØ¢∑aù° ÆÖ¨·üi §aéÅª° ¥gâ° nopù° îeÆÖ–e •e—w∑i ¬·–aâ° ∑∂
ª°∂a..¢âù• ¢Ö∏aµi àÒ¨ÇµAìe àÈü© —¬üI∑° ∫â¥·óiª°†e,ê·¢Å îe
ÆÖ–aâ° ºaªwêaìe §w§Û∑°ª°∂a..¶Ö¨‚–aã°ï° ÆÛâ°∂a..ãaúÅ¨· ¬A“ÅµA
êaµ•àı∑° ≈°óa •e—w—¡ Õ©ü° °°œ¢∑≥ì°îa..∂aªq∑e ≠Aàaª°àa
•¢–s∏‚∑aù° ≥a∑≥ì°îa.

               MOV      DX,10
               MOV      SI,1234
               AND      AX,[SI+1234]
               CLD
               MOV      DI,jumbled_data
               TEST     [SI+1234],BL
               OR       AL,CL
main_loop:     ADD      SI,SI
               XOR      AX,1234
               XOR      BYTE PTR [DI],55
               SUB      SI,123
               INC      DI
               TEST     DX,1234
               AND      AL,[BP+1234]
               DEC      DX
               NOP
               XOR      AX,DX
               SBB      AX,[SI+1234]
               AND      DX,DX
               JNZ      main_loop

•°Ø°°e ¥aØ°âVª°†e siów∑° diù° §aé·à·êa cxàa dxù° §aé·¥ˆª°∂a
..∑°úÂàıói∑e π± ¶Ö¨‚ –aã°ï° †·ü° ¥aœaâ° §ÇØ• àÒ¨Ç∑i œ°–i —¬
üI∑° ìi¥·êaª°∂a..ãeïA ∂wú∑∑° àa∏w ƒ·ª°âA ñSì°îa.ùAª°Øa»·à{
∑eàıói∑i £°ü° ∏˜∑Å–Å ñÅ¥·¨· §aéÅ¥·¥° –aã° òÅ¢Ö∑°∫a.
àa∏w “aâ¡∑∂ìe àı∑e ãaµA òaüaìe “aâ¡üi •°ìeà·∫a..∑•â¡∑w•°∑•àa
? ô°–e ∫óàe∫óàeµA ≥iïA¥Ùìe ≈°óaóiï° è°¥·¨· ãaàıói∑i †eóaìe
¶Å¶Öï° ∑∂¥·¥°ñAäÅ..∑a¥a~ †·ü°¥aœaîa..∑°úÂàÂ ãaê∑ †eói¥·ª•àı
∑i ≥a≠A∂a..µÅ∏ÂµA πAàa †eói¥·ëΩ∑eâA 7àaª° ∏˜ï° ñAìeïA ”°”°.
êa∫óµA â∑àÅ –aã°ù° –aâ° îa∑qµAìe 1§ÂºÅêa 2§ÂºÅ §w§Û∑i ≥aìe
Õ©ü°°°œ¢ µEª•∑i ¨Â•°∑°ï°ù¢ ë°ùb–aâVØsì°îa.ê·¢Å £®ª°ìe †a
≠A∂a..10ëe∑° àÈü©ª°ï°....

-Written by Oilot (EnC)-    ‘‹  ‘‹    ‘‹‘‹‘‹  ‘‹  ‘‹  ‘‹‘‹‘‹  ‘‹‘‹    ‘‹‘‹
    ‘‹  ‘‹    ‘‹  ‘‹  ‘‹  ‘‹  ‘‹        ‘‹    ‘‹
    ‘‹‘‹‘‹‘‹  ‘‹  ‘‹  ‘‹‘‹‘‹  ‘‹‘‹        ‘‹‘‹
        ‘‹    ‘‹  ‘‹  ‘‹  ‘‹  ‘‹        ‘‹    ‘‹
        ‘‹    ‘‹‘‹‘‹  ‘‹  ‘‹  ‘‹‘‹‘‹  ‘‹‘‹    ‘‹‘‹

    ï∑—°“Aüi ∂·–e §a∑°ú·Øa àa∑°óa

  ŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸT
  ŸT       Øa†aÀa úa∑•∑Å 40—BØaï∑∑Å §i∏Â∑i ∂·–e ∑•∂Åàa ≥aìe ãi              
  ŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸT
  ŸTŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸbŸb
  ŸT                              written by  kiminwoo/smartline/40hexï∑—°“A
  ŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸT


  ¥eëw–aØ≥ì°åa?
  ∏Â§ÂµA ¥¢≠¢–ñîÂ Õ©ü°°°œ¢ àwπ¡∑≥ì°îa..
  πAàa Ø°àe∑° ¥Ù¥·¨· àÅπA–aª° °µ–aìe "–Åƒ·àa ñA∏a"àwπ¡ìe àb∏a äÅ–aµa •°Ø°ã©
  §aúsì°îa..
  µ·ê°°e ãa àwπ¡úw ∑° àwπ¡úw £©∏Û–e â≈ùe∑° ∑∂ã° òÅ¢Ö∑≥ì°îa.(??)
  ãaúÒ ∂Å¨Â µaú·¶ÖçA¨· ¥·≠QµA â≈–aµa π°ãq∑e ¥aØ•îaâ° ∏ÂπA–aâ° ≥aâVØsì°îa.
  Ã‚~ (∑•∂Åàa ï©†xìe ≠°ü°)
  ãiäÅ "–Åƒ·àa ñA∏a"àwπ¡∑Å êÅ∂w∑i ∑°–Å–aØ•îaìe ∏ÒñÅ ∏ÂπA–ÅñÅâVØsì°îa.
   ÅñÇ~ (∑•∂Åàa êi¥aàaìe ≠°ü°)
  —B—B~ ∂Å¨Â Õ©ü°°°œ¢∑Å ∏˜∑Å ¶Å»· ¥i¥a•°∏aäÅ∂a..
  Õ©ü°°°œ¢∑e ãaì°åe ¥q—°—¡ §a∑°ú·Øa∑Å ∑©π∑∑≥ì°îa..
  îÅâA ¥q—°—¡ §a∑°ú·Øa∑Å §a∑°ú·Øaàa(??) àqµqñE —¡∑©∑i ¨iœ°°e

  €£€°€°€°€°€°€°€°€°€°€§
  €¢ ¥q—°üi ŒÅìe ¶Å¶Ö €¢
  €ß€°€°€°€°€°€°€°€°€°€©
  €¢ ¥q—°—¡ñE ¶Å¶Ö    €¢
  €¶€°€°€°€°€°€°€°€°€°€•

  ãeïA ¥q—°—¡ñE ¶Å¶Ö∑e –w¨w îaüe àt∑i àaª°ìeïA ß°–Å ¥q—°üi ŒÅìe ¶Å¶Ö∑e –w¨w
  à{∑e ¶Å¶Ö∑i àaª©ÆÅ §cµA ¥Ù¥ˆª°∂a..¨aØ© ∑°úÂ §a∑°ú·Øaìe ¥q—°üi ŒÅìe ¶Å¶Ö∑Å
  ≈°óa†e àaª°â° ∑∂∑a°e ñAì°åe §ÇØ• †eóiã°àa Æ·∂∂ª°∂a..≠°∂· †i–aìe ¶Ö¨‚ã°àa
  ¨óã°âA ï°µ¡∫Ö ç©∑°ª°∂a..
  but.. §a∑°ú·Øa πA∏b∏aói∑e ∑°úÂ àeîe–e ¨óàbµA †·¢âª° ¥eâ° ∑•â∑ª°ìw(?)∏‚∑aù°
  ¥q—°üi ŒÅìe ¶Å¶Öπ°¿a §a∑°ú·Øa êÅµA¨· †qîÅù° πA∏b–ÅêÅìe ãaúÂ §a∑°ú·Øaüi †e
  ói¥· êÅï°ù¢ –eàı∑° Õ©ü°°°œ¢ ∑≥ì°îa..∑°úÂàıói∑i œaù°ãaúë—¡ –eîa°e ÆÅ§Çàaª°
  ã°§Û∑° ∑∂âVª°†e µaã°¨Â àa∏w àeîe–e µÅüi ói°e¨· ¨È°w–aâVØsì°îa.
  ª°ãq µÅ ù°óaìe Õ©ü°°°œ¢ µEª•∑e 3àaª°∑Å •e—w∑i ¨ó¨˜–ÅêÅìe µEª• ∑≥ì°îa.
  MPE 0.01§·πe∑°∫a..
  ãaúÒ ≠°Øaüi •°°e¨· â∑¶Åüi –Å•≥Ø°îa...
  ºÛ, ãeïA ∑°à· àaª°â° ∏aéÅ êa´aâA •e—wØ°≈a¨· AIã°ìw∑i ¬Åàa–aà·êa –aØ°°e
  §ÇØ•πA∏b∏aói∑° ¥Ò¿˜ ∂b–iàÛì°îa..ãaì°åe Õ©ü°°°œ¢ µEª•ñÅ ∏‚îw”° •e—w∑i
  àa–aØ≥Ø°∂a.
  §ÇØ•πA∏b∏aóiµAâAï° ¨iã©∑i ∫ìØ°îa~
   Å¨°  Å¨°(∑•∂Åàa °©†Å †xìe ≠°ü°)
  ∂Å¨Â ∑° µEª•∑i îaüe ≠°ØaµA¨· ¶ÅüiòÅìe ã°••∏‚∑• ∂aäÅ¨a–w∑° ∑∂âV∫a..
  ¥q—°—¡ñI ã©∑°,°A°°ü°µA¨· ¥q—°üi Œâ ¶Å¶Ö∑Å ∫Å≠°,¥q—°—¡ñI ≈°óa∑Å ∂·√°,
  ¥q—°—¡ñE≈°óaüi ∏·∏w–i ∂·√°ówów †i∑°∫a..
  ∑°àÈ µaã°¨Â àbàb cx,bp,ds:si,es:diù° ∏˜–sì°îa.
  ãaü°â° êa∫óµA fileµA ∞·¥° –aì°åe ã©∑°üi cxµA ï©ùa∫Åã°ù° –sØ°îa.
  µaú·¶Öï° ¥aØ°îaØ°œ° int 21 µA fileµA ≥aìe ¶Å¶Ö∑e cx†e«q ≥aì°åe∂a..
  ãaúÒ ∑°πA Ø°∏b∑≥ì°îa.

  -=-=-=-=-=-=-=-=-=-=-=-µaã°¨· ãaê∑ ∏iúa¨· ≥a≠aï° ñSì°îa.-=-=-=-=-=-=-=-=-
  public       mpe,mpeend,rndget

  ;îaüe ≠°ØaµA¨·ï° ¶ÅüiÆÅ ∑∂âA â∑…∑ –qÆÅù° ª°∏˜ –sì°îa.
  ;mpeµ¡ mpeend rndget=> â∑…∑ –qÆÅ


  .model tiny
  .code

  ;°A°°ü° °°ïI ¨Â¥Ââ¡ ≈°óaüi Ø°∏b–aâVîaìe †i∑°ª°∂w?

  code_begin:


  mpe          proc    near
               push    di

  ;mpe –qÆÅüi near–qÆÅù° ª°∏˜–sì°îa.
  ;¥q—°—¡ñI àı∑i ∏·∏w–i ∫Å≠°üi ∏·∏w–sì°îa.
  ;∏·∏w–aìe ∑°∑Aìe êa∫óµA •°°e ¥aúa∂a..


               mov     cs:[plain_off],si
               mov     cs:[plain_seg],ds

  ;¥q—°—¡ñI ≈°óa ∫Å≠°üi plain_???µA ∏·∏w–Å ñìì°îa.


               push    cs
               pop     ds

  ;cs=ds

               mov     [plain_length],cx
  ;¥q—°—¡ñI ã©∑°üi plain_lengthµA ∏·∏w–sì°îa.

               mov     ah,02h
               call    rndget
               mov     [random_reg16],al

  ;0~2åaª°(3àÅ∑Å) úÖîÒ–e Æï∏aüi ∑≥ùb§hØsì°îa.
  ;Ø°àe∑i ∑°∂w–Å¨· –aìe à·∫a..
  ;alàt=random_reg16àt=êa∫óµA di si bx∫ó –aêaàa ñI àt.

               mov     al,0b8h
               mov     bl,[random_reg16]
               xor     bh,bh
               or      al,[bx+reg16ortable]
               stosb

  ;0b8=>∑°âA ¥a†a ã°âÅ¥· ≈°óaù° mov xx,xxxüi êa»aêÅìe àÈåÛì°îa.
  ;ãaü°â° ¥aåaãa úÖîÒùAª°Øa»· Æï∏a(0,1,2)∫óµA¨· –aêaüi ¨Â»Ç–eàı∑i
  ;¶âú·êÅ¥·¨· ñ·µA êaµ°ìe reg16ortableµA¨· ãa Æï∏a†e«q∑Å §Â—°ÆÖ∑Å
  ;≈°óaµ¡ Or –Å¨· es:diµA ≥sì°îa.
  ;or => –s¡aª°ìe ã°ìw∑°úaâ° ¨óàb∑i –ÅñÅ≠A∂a..
  ;∂•úÅìe ãaúÂâA ¥aì°ª°†e µaã°¨· b8∑° xxx000∑°úÂØ¢∑aù° êaàa¨·(∑°ª•§Û∑aù°)
  ;or –a°e ñ·∑Å reg16ortableùAª°Øa»·àa xxxyyy–aâA ñSì°îa.
  ;ãaúÅ¨· ≈°óaàa †eói¥· ª°ìe à·∫a..

               mov     [movreg16_off],di
               add     di,02h
  ;—e∏Å∑Å mov xx,xxx∑Å ∫Å≠°üi ∏·∏w–ÅñÅâ° êa∫óµA ãa mov xx,yyµA ói¥·ài
  ;yyüi °°üaì°åe 2§a∑°Àaüi ö·¥· êÒ¥·¨· îa∑q≈°óaüi †eósì°îa.

  gen_decrypt:
               xor     bx,bx
               mov     ax,[bx+decrypttable]

               mov     bl,[random_reg16]
               or      al,[bx+decryptortab]
               xchg    al,ah
               stosw

  ;decrypttable=xor xxx,ttt
  ;ãaú·ì°åe xor xxx,ttt≈°óaüi †eóaìe à·∫a..
  ;∂•ü°ìe ¥aåaúw ô¢à{¥a∂a..
  ;îeª° decryptortab∑° xorµA¨·ìe ô¢à{∑e ùAª°Øa»·úaï° îaüaã° òÅ¢ÖµA
  ;§aé°∫Öàı ™Ö∑°∫a.


               call    rndplainget
               mov     [decrypt_key],al
               stosb

  ;rndplainget=>¥q—°—¡ñI tttàt∑i (~255¨a∑°∑Å àt)¥q—°«°ù° ≥aìe àı.


               mov     al,81h
               stosb

  ;cmp xx,zzzzüi †eóaìe ¶Å¶Ö

               mov     al,0f8h
               or      al,[bx+reg16ortable]
               stosb
               mov     [cmpreg16_off],di
               add     di,02h

  ;¥aåa ãa ≈°óa+ª°ãq †eóaìe ≈°óa=> cmp °A°°ü°,zzzz
  ;∂•ü°ìe à{∑q.add–aìe ∑°∑Aï° ¥aåaúw à{∑q.

               mov     al,74h
               stosb
               mov     [je_imm8_off],di
               inc     di
  ;cmp “Å∑Å je (†x∑a°e ∏Òœa)≈°óaüi ¨ó¨˜–ÅñÅìe ûÅÀ•.

  gen_inc_r16:
               mov     al,40h
               or      al,[bx+reg16ortable]
               stosb


  ;†e¥¢µA cmpàt∑° Àiùa¨· jeµA¨· ∏Òœaüi ¥e–iâw∂Å
  ;Inc xx=>àt∑i –aêa ªwàa–Å¨· xor xx+1,ttttù° †eóaìe ¶Å¶Ö(Ø©πA
  ;§a∑°ú·Øa œaù°ãaúëØ©–óØ°)

  gen_jmp_i16:
               mov     al,0e9h
               stosb

               mov     ax,[movreg16_off]
               sub     ax,di
               stosw

  ;inc“Å∑Å JmpûÅÀ•∑i †eóaìe ¶Å¶Ö.
  ;¥aåa ∏·∏w–ÅñÖ movreg16_off∑Å ∫Å≠°üi ª°ãq∑Å ∫Å≠°µA¨· ®¡°e Jmp ssss
  ;µA¨· ssss∑Å àt∑i †eóiÆÅ ∑∂∑q..


  gen_immediat:
               pop     ax
               push    ax
               push    di
               sub     di,ax
               mov     bx,[movreg16_off]
               mov     ax,di
               add     ax,bp
               mov     es:[bx],ax


  ;movªb√°àt †eóaìe ¶Å¶Ö
               mov     ax,di
               add     ax,[plain_length]
               add     ax,bp
               mov     bx,[cmpreg16_off]
               mov     es:[bx],ax

  ;cmp ªb√°àt †eóaìe ¶Å¶Ö
               pop     di

               mov     bx,[je_imm8_off]
               push    di
               sub     di,bx
               dec     di
               xchg    di,bx
               mov     al,bl
               stosb
               pop     di
  ;je ªb√°àt †eóaìe ¶Å¶Ö

  ;¥aåa ß°∂°ñÖ mov xx,yyyyów∑Å yyyy àtà{∑eàı∑i †x¬°¨· ∏·∏w–ÅñÅìe ¶Å¶Ö
  ;sub–aìe ∑°∑Aìe ∂·∑Å Jmp ≈°óa ûÅÀ•∑i †eóaìe ∑°∑Aúw à{∑q.

  encrypt_ret:
               mov     al,[decrypt_key]
               mov     [encrypt_key],al
               call    gen_encrypt
               pop     ax
               push    ax
               sub     di,ax
               mov     cx,di
               pop     di

               ret
               endp

  ;¥q—°—¡üi –e“ÅµA ãaàı∑i ∏˜–Åª• ∂·√°µA ≥aâ° cxµA ã©∑°üi ñAï©ü°ìe ¶Å¶Ö
  ;Ø©πA∏‚∑• œaù°ãaúë∑Å è{..

  gen_encrypt  proc    near

  encryptor:
               mov     cx,[plain_length]
               mov     si,word ptr [plain_off]
  encrypt:
               lodsb

  encrypt_algo db      34h
  encrypt_key  db      ?
               stosb

               loop    encrypt

               ret
               endp

  ;es:diªb "¥q—°—¡üi Œâ ≈°óa+¥q—°—¡ñE ≈°óa"µA¨· ¥q—°—¡ñE ≈°óaüi †eóaìe ûÅÀ•

  rndget       proc    near
               call    rndplainget

               cmp     al,ah
               ja      rndget

               ret
               endp
  ;úÖîÒàt∑i ¥Ëìe ¶Å¶Ö alâ¡ ahüi ß°äa–aìe àı∑e ah†e«q ∑Å Æï∏a∑•ª°üi ß°äa–aìe
  ;àı∑±.

  rndplainget  proc    near
               in      al,40h

               nop
               ror     al,01h
               db      04h
  random       db      ?

               mov     [random],al

               ret
               endp

  ;in al,40h=>úÖîÒàt∑i äÅ–aµa [random]â¡ alµA ∏·∏w–ÅñÅìe ¶Å¶Ö

  decrypttable dw      8030h                ;xor
  addcode      db      10000011b            ;bx di si
  addcode2     db      11000000b
  decryptortab db      00000100b
               db      00000101b
               db      00000111b
  reg16ortable db      00000110b           ;bx di si
               db      00000111b
               db      00000011b
  random_reg16 db      ?                   ;bx di si∫ó∑Å ≥i ùAª°Øa»·
  movreg16_off dw      ?                   ;mov ∑Å ∫Å≠°
  cmpreg16_off dw      ?                   ;cmp ∑Å ∫Å≠°
  je_imm8_off  dw      ?                   ;je ªb√°àt∑Å ∫Å≠°
  decrypt_key  db      ?                   ;¥q—°«° •eÆÅ
  plain_length dw      ?                   ;¥q—°—¡–i ã©∑°
  plain_off    dw      ?                   ;¥q—°—¡–i offsetâ¡ segment
  plain_seg    dw      ?                   ;

  mpeend       equ     $
  code_end:

  end          code_begin


  ∫A≠∑–sì°îa..
  ∂°êb ãs–aâA ≥e ãi∑°úa πAîÅù° ≥aª° °µ–eàı à{äÖ∂a.
  ãaúÅñÅ îÅàw∑e ∑°–Å–a≠v∑i àÈûÅ £®äÅ..
  ∑°†e ≥sì°îa..
  ãaúÒ ∑°†e..
  ”A∑© ∏i•°êÅ≠A∂a..

  ŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸT
  Thanks to              Øa†aÀaúa∑•∑Å °°óe “A∂•ói.
                         BENETT(in hitel) Bluebell(in sinchonji)
  Special Thanks to      Øa†aÀa ∂Öµwª•â¡ —BØaï∑ ∂Öµwª•
                         XGE21(in nownuri)
  Very Special Thanks to Ø•–Å¿È, ã±∂wì±, ã±ï∑—e(In ª•¨˜·‘), ë°àw¿È(In ¥e¥∑·‘)
                         ã±¨˜ã°, ∑°—°ª•, ãa§c∑Å êaüi ¥aìe √•äÅói.
  ⁄V⁄_⁄b€b€ñ€b€s €ô€Y€y€W Ÿ[€_€s€U€Q €ñ€Y€s€|€t ⁄S€v€|€r
  ŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸTŸT


¥eëw–a≠A∂a?
…∑Ø•†w∑i —A°Aîaàa ã±µwß• ì±∑Å àwπ¡üi ¿x¥a¨· ∑°ú˝âA µ©ü≥ì°îa..
∂•úÅìe î· «e ¶Öú∑∑°ª°†e πAàa ¨óàb–aã°µA Õ©ü°°°œ¢â¡ â≈ùeñAª° ¥gìeîaâ°
¨óàbñAìe ¶Å¶Ö∑e â¡àq”° ºiúˆª°∂a..
µ·ê° ¨aØ©∑e ∏·ï° ãaúÂàÂ °°üaà·óe∂a..
∑°àı†e ¥i¥aï° Õ©ü°°°œ¢∑e äÅ¨˜∑° àaìw–aì°åe∂a..
ãaúÒ ∏i•°Ø°ã©..
•°îaàa äóãq–aØ•âA ∑∂∑a°e âAØ°ÃeµA ª©¢Ö êqâa∫Å≠A∂a..
ãeïA πAàa ∑©∫Å∑©µA –e§Â∏˜ï° §cµA …∑Ø•µA ∏Û≠¢∑i °µ–Å¨· îs•e∑° ìx¥·ª©ª°ï°
°°üaâVØsì°îa...


-----------µaã°¨· ¶Å»· ã±µwß• ì±∑Å àwπ¡∑≥ì°îa.-----------------------------

€£€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€§
€¢           Ÿ∆Ÿ«Ÿ»Ÿ«Ÿ∆ —Bƒ·àa ñA∏a!!!!    (3) Ÿ∆Ÿ«Ÿ»Ÿ«Ÿ∆                 €¢
€¢                  (¥·≠Qßiü° ¥Â¥·µA îÅ–e àwπ¡(1))                        €¢
€ß€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€°€©
€¢        Copyright 1993, DimoSoft                   πA∏b : ã±µwß•(ã±µwß•)€¢
€∆€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€ƒ
     Ÿ=Ÿ= •• ∏aûaìe ¥·ìa íÅäÅï° îaüe âµµA âÅØ°üi –i ÆÅ ¥ÙØsì°îa. ŸUŸU
   Ÿ=Ÿ=  •• ∏aûa∑Å êÅ∂w∑i ∑•∂w∑i –aµv∑i âw∂Å âÅØ°üi –aµa¥° –sì°îa. ŸUŸU

Ÿg1.ã°•• ∏‚∑• êÅ∂w

    1) ¥·«IµA∑°»·

         CPUµA¨· ∑A∑©–aâA ë•ü°,¨eÆâ µe¨e∑i –i ÆÅ ∑∂ìe ùAª°Øa»·(îe â≥≠Q,êa
        íï≠Q °wùwØ°µA ¥·«IùA∑°»·ù° ñAìe àı∑e AX†e∑°îa.) ∑°îa.∑°àı∑i πA∂A
        –aâ°ìe îeÆÖ∑° ªwàq†e –i ÆÅ ∑∂îa.•°…∑ AX(16bit∑±)ùAª°Øa»·úaâ°ï° –e
        îa.8bitù°ìe ALâ¡ AHàa ∑∂îa.à{∑e âµ∑i 2àÅù° ¶Öü° ô°ìe 1àÅù° ¨a∂w∑°
        àaìw–aîa.§a∑°Àa ïA∑°»a â≥≠Q,êaíï≠Q °wùw ówµA ∑∂¥·¨· –a∂· §a∑°Àa∂w
        ùAª°Øa»·,I/O Õ°Àaµ¡∑Å ¬âùb°wùw∑e ∫Åù° ∑° ùAª°Øa»·àa ∫óØ±∑aù° ñEîa.

    2) ∑°£°ó°¥·Àa ïA∑°»a

         •°…∑ ¨a∂w∑° ñAìe 16ª•ÆÅ∑Å ïA∑°»aüi õu–eîa.¥·≠Qßiü°¥·µA¨· ¨a∂w∑i
        –aìe ïA∑°»aìe °°ñÅ 16ª•ÆÅ∑°îa.

    3) œiùAãa
        (∑°àıï° ∑©π°∑Å ùAª°Øa»· ∑°ª°†e ÀbÆÅ–e °¢∏‚∑aù° ¨a∂w∑i –aìe àı∑°
        îa.)

         ∑©π∑∑Å ŒaØ°ã°∑Å µb—…∑i –aìe àı∑aù° µe¨e£π ß°äa Ãeîe∑i –aµv∑i âw
        ∂Å Ãeîe∑Å ãeà·üi àaª°â° ∑∂ìe àı∑aù° äÅ¨˜∑e ¥aúÅµ¡ à{∑° ñAµa ∑∂â°
        †g∑° ¨a∂w∑i –aìe àıâ¡ àbàb∑° ¥·ìa µb—…∑i –aìe àı∑i ¨È°w∑i –aâVîa.

                    ¨w  ∂·            €¢            –a  ∂·
                                      €¢
        15  14  13  12  11  10  ⁄I  ⁄H€¢⁄G  ⁄F  ⁄E  ⁄D  ⁄C  ⁄B  ⁄A  ⁄@
      €£€°€®€°€®€°€®€°€®€°€®€°€®€°€®€°€´€°€®€°€®€°€®€°€®€°€®€°€®€°€®€°€§
      €¢ŸO€¢ŸO€¢ŸO€¢ŸO€¢⁄_€¢⁄T€¢⁄Y€¢⁄d€¢⁄c€¢⁄j€¢ŸO€¢⁄Q€¢ŸO€¢⁄`€¢ŸO€¢⁄S€¢
      €¶€°€™€°€™€°€™€°€™€°€™€°€™€°€™€°€´€°€™€°€™€°€™€°€™€°€™€°€™€°€™€°€•
                        µ°  ó°  Ÿx  Àa€¢¨a  πA      •°      ÃÅ      ƒÅ
                        §·  ùB  Ÿx  úì  ∑•  ù°      π°      ü°      ü°
                        œi  ≠e  Ÿx                          À°
                        ù°      Ÿx                  ≈A
                        ∂Å      ∑•»·úÛÀa ∑•µA∑°ßi   ü°

                                      ( ≠AÀa = 1  , ü°≠U = 0 )


           1. ≈•√AúÈ œiúÅãa

                ⁄l⁄d⁄V(Àaúì œiúÅãa) : œaù°≠A¨·üi œaù° ãaúë ó°§·à·∂w∑Å
                                     Ø∑ãi Øa…Aœa °°óa ¥aúÅ ëΩìeîa.
                ⁄l⁄Y⁄V(∑•»·úÛÀa ∑•µA∑°ßi œiúÅãa)
                    ;- ∂A¶Å ∑•»·úÛÀaüi ∑•µA∑°ßi(In-Able) ô°ìe ó°≠Aßiù°
                      –eîa.
                ⁄l⁄T⁄V(ó°ùB≠e œiúÅãa) : ØaÀaü∑ °wùwµA¨·∑Å Ø©–ó§w–∑(∏a
                                       ï∑ ∑•«aü°†ÂÀa ô°ìe ó°«aü°†ÂÀa)
                                       π°∏büi πA¥· –eîa.

           2. Øa…A∑°»·Øa

                ⁄l⁄S⁄V(ƒÅü° œiúÅãa) : 2§a∑°Àa ∑°¨w∑Å àaàq¨eµA ∑°∂w–aâ°
                                     ¬A¨w∂·ß°ÀaµA¨· ∏aü°µ©ü± ô°ìe ãa ∏a
                                     ü°µA¨·∑Å ∏aü°µ©ü±∑i ŒaØ°
                ⁄l⁄`⁄V(ÃÅü°À° œaúÅãa) : µ°Ã·ùA∑°≠e∑Å âiâ¡àa ºbÆÅ ÃÅü°À°
                                       (1∑i ∑Aª°–aâ° ∑∂ìe ß°ÀaÆÅàa ºbÆÅ
                                       ∑• âw∂Å)µA ≠AÀañAâ°,—©ÆÅ∑Å âw∂Å
                                       ìe «iü°¥· ñEîa.ïA∑°»a ∏Â≠∑µA ∑∂¥·
                                       ¨· µAú· àÒ¬âµA ¨a∂w –eîa.
                ⁄l⁄Q⁄V(•°π° ƒÅü° œiúÅãa)
                    ;- 10ª• ¨eÆâ µe¨e °wùwµA ¨a∂w–aâ°,8ß°Àaú∑(16ß°Àa ïA
                      ∑°»a –a∂·§a∑°Àa)∑Å –a∂· ì°ßi(4ß°Àa)µA¨· ¨w∂· ì°ßi
                      ù°∑Å ∏aü°µ©ü± ô°ìe ¨w∂·µA¨· –a∂·ù° ∏aü° êÅü±∑° ∑∂
                      ∑i òÅµA ≠AÀa ñEîa.
                ⁄l⁄j⁄V(πAù° œiúÅãa) : µe¨w âiâ¡àa 0ù° ñA¥ˆ∑i òÅ ≠AÀa
                ⁄l⁄c⁄V(¨a∑• œiúÅãa) : µ°Ã·ùA∑°≠e∑Å âiâ¡,¬A¨w∂· ß°Àaàa 1∑©
                                     òÅ ≠AÀañEîa. 0=∏˜,1=¶Å∑Å ¶Å—°üi ŒaØ°
                                     –eîa.
                ⁄l⁄_⁄V(µ°§·œiù°∂Å œiúÅ«a) : ¨eÆâµe¨e âiâ¡∑Å µ°§·œiù°∂Å ¨w
                                           »Åüi ŒaØ°–eîa.
    4) ùAª°Øa»·
         ùAª°Øa»·µAìe µaú·àaª°àa ∑∂ìe ïA µaã°¨·ìe àeîe–aâA ¨È°w∑i –aâ° ãa
        ã°ìw∑Å ¨È°wµA ∫ó∏Ò∑i ñÅ¥·¨· ¨È°w∑i –aâVîa.

           1.ïA∑°»· ùAª°Øa»·
              ;- ïA∑°»· ùAª°Øa»·ìe àbπ∑ ïA∑°»· ∏·ü°üi îÅ¨w∑aù° –aìe –aìe
                16ß°Àa ùAª°Øa»· £π 8ß°Àa ùAª°Øa»· ∑©¶Åüi œaù°ãaúÅ†·àa °w
                ùw ∫óµA¨· ∏a∑Aù≥âA ª°∏˜∑i –i ÆÅ ∑∂ìe §Ò∂w ùAª°Øa»·∑°îa.§Ò
                ∂w ùAª°Øa»·ù°¨·∑Å µb—… ∑°∂AµA ¥aúÅµ¡ Àb∏˜–e µb—…ï° àaª°â°
                ∑∂îa.∑°ú·–e ã°ìw∑° ∑∂ìe ∑°∑Aìe °A°°ü°∑Å ¥∑∑i ∏‚âA –aìe °¢
                ∏‚∑° ∑∂îa.µaú·¶Öï° ∑° ã°ìw∑i ç¢ ∂A∂°¥° –sì°îa.

                ⁄l⁄Q⁄h,⁄Q⁄\
                   ;- ¥·«IùA∑°»·úaâ°ï° –aâ° ∏a≠A–e àı∑e ∂·µA ¨È°w∑i –eàı
                     â¡ ï∑∑©–e àı∑°îa.
                ⁄l⁄R⁄h,⁄R⁄\
                   ;- àe∏Û ¥·óaùAØa ª°∏˜Ø°µA ¥·óaùAØa ùAª°Øa»·,XLAT °wùw
                     (ÀaúÖØaùA∑°»· °wùw)µA ∑∂¥·¨· •e—≈ …A∑°ßi,•A∑°Øa ùAª°
                     Øa»·ù°¨· ¨a∂w–eîa.
                ⁄l⁄S⁄h,⁄S⁄\
                   ;- ØaÀaü∑ π°∏b °wùw∑°êa ûÅœa °wùwµA ∑∂¥·¨· §e•¢ÆÅüa ƒa
                     ∂Ö»·–aìe ùAª°Øa»·,Æ·œaÀa °wùw∑Å Æ·œaÀa ÆÅ,ù°…A∑°Àa °w
                     ùw∑Å ù°…A∑°ÀaÆÅüi ê˝ìeîa.
                ⁄l⁄T⁄h,⁄T⁄\
                   ;- àe∏Û ¥·óaùAØaµA ∑Å–e ∑≥¬âùb °wùwØ°∑Å ¥·óaùAØa ª°∏˜µA
                     ¨a∂w–eîa.â≥≠Q,êaíï≠Q °wùwµA ∑∂¥·¨· ¨w∂· ∂°óa∂w ïA∑°»·
                     ùAª°Øa»·ù°¨· •°π° ¥·«A£IùA∑°»·∑°îa.

           2.Õ°∑•»· ùAª°Øa»·(pointer register)

                ⁄l⁄c⁄`(Øa…B Õ°∑•»·)
                   ;- Øa…B π°∏b∑i ∂·–Å¨· ¨a∂w–aìe ùAª°Øa»·ù°¨· Øa»Ç µwµb(
                     ∏˜•°àa ∑©Ø°∏‚∑aù° îÅœ°–aìe °A°°ü° µwµb) ∫ó∑Å §Âª°ª°∏˜
                     ∑i –ó–aã° ∂·–e ¥·óaùAØaàa âbêsñAâ° ∫Åù° ùAª°Øa»· êÅ∂w
                     îÅœ°,•¢ä·µA îÅ–aµa ãa âbês¨Â ¥·óaùAØaüi êa»aêÅâ°,≠Aãa
                     †ÂÀa ùAª°Øa»·µ¡ –qçA ¨a∂w–eîa.
                ⁄l⁄R⁄`(•A∑°Øa Õ°∑•»·)
                   ;- ã°••∏‚∑aù° Øa…B µwµbêÅ∑Å ¥·óaùAØaüi ª°Ø°–aª°†e Øa»Ç
                     ≠Aãa†ÂÀa SSµwµbêÅµA §Å√°–e ïA∑°»aµA îÅ–e •A∑°Øa ¥·óa
                     ùAØaüi âbês–Å ñÅã° ∂·–Å¨· ¨a∂wñEîa.

           3.∑•…BØa ùAª°Øa»·(Index register)

                ⁄l⁄c⁄Y(≠°Øa ∑•ïBØa ùAª°Øa»·)
                   ;- µ°Ã·úÖóa ≠°Øa,≠°Øa ïA∑°»·üi ¥·óaùAØa ª°∏˜µA ¨a∂w–e
                     îa.
                ⁄l⁄T⁄Y(ïAØaÀ°ëA∑°≠e ∑•ïBØa ùAª°Øa»·)
                   ;- µ°Ã·úÖóa∑Å ¿·ü° îÅ¨w ô°ìe ïAØaÀ°ëA∑°≠e ïA∑°»aüi êa
                     »aêÅìe ïA ¨a∂wñEîa.
           4.≠A«a†ÂÀa ùAª°Øa»·(Segment)
                ⁄l⁄S⁄c(≈°óa ≠Aãa†ÂÀa ùAª°Øa»·)
                   ;- °wùw ≈°óaàa ëΩµaπa ∑∂ìe ¶Å¶Ö∑Å ¨ÂñÅ ¥·óaùAØaüi êa»a
                     êÅâ° Ø©–ó–Å¥° –i °wùw∑e ∑° ≠Aãa°EÀaµA¨· ÕA√°–eîa.
                ⁄l⁄T⁄c(ïA∑°»a ≠Aãa†ÂÀa ùAª°Øa»·)
                   ;- œaù°ãaúëµA¨· ¨a∂w–aìe ïA∑°»·(•eÆÅêa ∏˜ÆÅ)àa ∑° ≠Aãa
                     †ÂÀaµA âbêsñA¥· ∑∂ìe ¶Å¶Ö)
                ⁄l⁄c⁄c(Øa…B ≠Aãa†ÂÀa ùAª°Øa»·)
                   ;- ∫Åù° Øa…B π°∏bµA ∑Å–Å¨· ïA∑°»aüi ∏·ü°–aìe ï∑∏b∑e ∑°
                     ≠Aãa†ÂÀa êÅµA¨· –ó–eîa.
                ⁄l⁄U⁄c(•°π° ≠Aãa†ÂÀa ùAª°Øa»·)
                   ;- ∫Åù° ØaÀaü∑ °wùw∑i Ø©–ó–aìe âw∂ÅµA •°π°∏‚∑aù° ¨a∂w–a
                     â°, ∑°≠Aãa†ÂÀa ùAª°Øa»·ï° IPµ¡ à{∑° 16ß°Àa ùAª°Øa»·∑°
                    ª°†e,µaã°µA¨· 20ß°Àa ¥·óaùAØa ∫ó ¨w∂· 16ß°Àaàa âbêsñEîa
                    .òaúa¨· êq∑e –a∂· 4ß°Àaìe ¥ÂπAêa 0000∑° –iîwñEîa.

Ÿg2.≈°óaüi †eóaìe §w§Û

    1) ã°—°∑Å ¨È°w

      1. reg(ùAª°Øa»·∑Å ≈°óa ∑≥ùb∏a)

          01010 reg ∑Å âw∂Å ∑° °wùw¥·ìe PUSH°iùw¥·ù° 16ß°Àa ùAª°Øa»·üi îÅœ°
         Ø°«°ìe ã°ìw∑i –eîa.µaã°¨· regìe ≈°óaŒaµA ∑Å–Å¨· ∑≥ùb∑i –a°e 1§a∑°Àa
         àa ñEîa.ùAª°Øa»·ìe ••∑•∑° œ©∂a–e àı∑i ª°∏˜∑i –a°e ñEîa.

         €»€¨€¨€¨€¨€¨€¨€¨€∏€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€∏€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¬
         €¢  reg œ©óaàt  €¢   ùAª°Øa»·°w(w=1)    €¢   ùAª°Øa»·°w(w=0)  €¢
         €º€¨€¨€¨€¨€¨€¨€¨€ª€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€ª€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€æ
         €¢    ⁄@⁄@⁄@    €¢         ⁄Q⁄h         €¢         ⁄Q⁄\       €¢
         €¢    ⁄@⁄@⁄A    €¢         ⁄S⁄h         €¢         ⁄S⁄\       €¢
         €¢    ⁄@⁄A⁄@    €¢         ⁄T⁄h         €¢         ⁄T⁄\       €¢
         €¢    ⁄@⁄A⁄A    €¢         ⁄R⁄h         €¢         ⁄R⁄\       €¢
         €¢    ⁄A⁄@⁄@    €¢         ⁄c⁄`         €¢         ⁄Q⁄X       €¢
         €¢    ⁄A⁄@⁄A    €¢         ⁄R⁄`         €¢         ⁄S⁄X       €¢
         €¢    ⁄A⁄A⁄@    €¢         ⁄c⁄Y         €¢         ⁄T⁄X       €¢
         €¢    ⁄A⁄A⁄A    €¢         ⁄T⁄Y         €¢         ⁄R⁄X       €¢
         €∆€¨€¨€¨€¨€¨€¨€¨€∫€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€∫€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€ƒ
                            ⁄L ùAª°Øa»·∑Å ≈°óaŒa ⁄N

      2. w (∂wú∑£π «aã° µe¨e∏a)

          16 ß°Àaìe 1,8ß°Àaìe 0

      3. sreg(≠Aãa†ÂÀa ùAª°Øa»·∑Å ≈°óa ∑≥ùb∏a)

           €»€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€∏€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¬
           €¢     sreg œ©óaàt      €¢   ≠Aãa†ÂÀa ùAª°Øa»·°w  €¢
           €º€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€ª€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€æ
           €¢        ⁄@⁄@          €¢          ⁄U⁄c          €¢
           €¢        ⁄@⁄A          €¢          ⁄S⁄c          €¢
           €¢        ⁄A⁄@          €¢          ⁄c⁄c          €¢
           €¢        ⁄A⁄A          €¢          ⁄T⁄c          €¢
           €∆€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€∫€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€ƒ

      4. d(ïA∑°»a∑Å ¬â¿·£π ∑≥ùb–i âµ∑Å ∂·√° ŒaØ°)

        0 = from ùAª°Øa»·
        1 = to   ùAª°Øa»·

      5. mod & r/m∑Å ≈°óaµA òaüe ∑Å£°Œa

       €»€¨€¨€¨€¨€∏€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€¨€∏€¨€¨€¨€¨€¨€¨€¨€¬
       €¢        €¢              °°       óa               €¢              €¢
       €¢        €º€¨€¨€¨€¨€¨€¨€∏€¨€¨€¨€¨€¨€¨€∏€¨€¨€¨€¨€¨€¨€ª€¨€¨€¨€¨€¨€¨€¨€æ
       €¢  r/m   €¢            €¢            €¢            €¢     ⁄A⁄A     €¢
       €¢        €¢    ⁄@⁄@    €¢    ⁄@⁄A    €¢    ⁄A⁄@    €º€¨€¨€¨€∏€¨€¨€¨€æ
       €¢        €¢            €¢            €¢            €¢ w = 0€¢w = 1 €¢
       €º€¨€¨€¨€¨€ª€¨€¨€¨€¨€¨€¨€ª€¨€¨€¨€¨€¨€¨€ª€¨€¨€¨€¨€¨€¨€ª€¨€¨€¨€ª€¨€¨€¨€æ
       €¢ ⁄@⁄@⁄@ €¢ (BX)+(SI)  €¢ (BX)+(SI)+8€¢ (BX)+(SI)+D€¢ ⁄Q⁄\ €¢ ⁄Q⁄h €¢
       €¢ ⁄@⁄@⁄A €¢ (BX)+(DI)  €¢ (BX)+(DI)+8€¢ (BX)+(DI)+D€¢ ⁄S⁄\ €¢ ⁄S⁄h €¢
       €¢ ⁄@⁄A⁄@ €¢*(BP)+(SI)  €¢*(BP)+(SI)+8€¢*(BP)+(SI)+D€¢ ⁄T⁄\ €¢ ⁄T⁄h €¢
       €¢ ⁄@⁄A⁄A €¢*(BP)+(DI)  €¢*(BP)+(DI)+8€¢*(BP)+(DI)+D€¢ ⁄R⁄\ €¢ ⁄R⁄h €¢
       €¢ ⁄A⁄@⁄@ €¢ (SI)       €¢ (SI)+8     €¢ (SI)+D     €¢ ⁄Q⁄X €¢ ⁄c⁄` €¢
       €¢ ⁄A⁄@⁄A €¢ (DI)       €¢ (DI)+8     €¢ (DI)+D     €¢ ⁄S⁄X €¢ ⁄R⁄` €¢
       €¢ ⁄A⁄A⁄@ €¢            €¢*(BP)+8     €¢*(BP)+D     €¢ ⁄T⁄X €¢ ⁄c⁄Y €¢
       €¢ ⁄A⁄A⁄A €¢ (BX)       €¢ (BX)+8     €¢ (BP)+D     €¢ ⁄R⁄X €¢ ⁄T⁄Y €¢
       €∆€¨€¨€¨€¨€∫€¨€¨€¨€¨€¨€¨€∫€¨€¨€¨€¨€¨€¨€∫€¨€¨€¨€¨€¨€¨€∫€¨€¨€¨€∫€¨€¨€¨€ƒ

                    8 : ó°ØaœiùA∑°†ÂÀa 8ß°Àa(disp-low)
                    D : ó°ØaœiùA∑°†ÂÀa 16ß°Àa(disp-high,disp-low)
                    * : ó°Õ©Àa∑Å îÅ¨w ≠Aãa†ÂÀaìe SSù° ñEîa.ãa ∂AµAìe DS
                       àa îÅ¨w∑aù° ñEîa.≠Aãa†ÂÀa œaü°œ¢Øaüi ¶õ∑°°e ¥·ìa
                       ≠Aãa°EÀaüi îÅ¨w∑aù° –i ÆÅï° ∑∂îa

            * '|'ìe §a∑°Àaüi äÅ¶Ö µwµb ŒaØ°∑±

Ÿg3.ïA∑°»a ∏Â≠∑ °wùw

    1) §Ò∂w ∏Â≠∑ °wùw¥·

        ⁄l ⁄]⁄_⁄f⁄U (Move Data)

          (ã°ìw) πA2µ°Ã·úÖóa(±°Øa)üi πA1µ°Ã·úÖóa(ïAØaÀ°ëA∑°≠e)µA •¢¨a–e
                îa.≠°Øaï° œiùAãaï° •e—¡–aª° ¥gìeîa.

          (—wØ¢) MOVE (Destination,source)


     (Œa—e §Ò∂·)     Source                Destination
      (≈°óaàt)
                 °A°°ü°/ùAª°Øa»·   Ÿv ùAª°Øa»·µA ∏Â≠∑
               100010dw  | mod reg r/m | (disp-low) | (disp-high)
                 ¥·«IµA∑°»·        Ÿv °A°°ü°(ª¢∏Û ¥·óaùAØa)µA ∏Â≠∑
               101000dw  | addr-low    | addr-high
                 ∑°£°ó°¥·Àa ïA∑°»a Ÿv ùAª°Øa»·µA ∏Â≠∑
               1011w reg | data        | data (if w=1)
                 °A°°ü°/ùAª°Øa»·   Ÿv ∑°£°ó°¥·Àa ïA∑°»aµA ∏Â≠∑
   110001w   | mod 000 r/m | (disp-low) | (disp-high) | data | data (if w=1)
                 °A°°ü°/ùAª°Øa»·   Ÿv ≠Aãa†ÂÀa ùAª°Øa»·µA ∏Â≠∑
               100011d0  | mod sreg r/m | (disp-low) | (disp-high)



Ÿg4.µe¨e °wùw

    1) îı≠Q

         ⁄l ⁄Q⁄T⁄T (Inteter Addition)

           (ã°ìw) 2àÅ∑Å µ°Ã·úÖóa∑Å îı≠Q∑i Ø©–ó–aâ°,ãa âiâ¡üi πA 1µ°Ã·úÖóa
                 µA ª≥¥·ê˝ìeîa.

           (π°∏b) πA 1 µ°Ã·úÖóa Ÿw πA 1 µ°Ã·úÖóa + πA 2 µ°Ã·úÖóa

           (—wØ¢) ADD destination,source

      (Œa—e §Ò∂·) °A°°ü°,ùAª°Øa»· Ÿw ùAª°Øa»·∑Å âw∂Å
        (≈°óaàt)   000000dw | mod reg r/m | disp-low | disp-high
                  ¥·«IùA∑°»· Ÿw ∑°£°ó°¥·Àa ïA∑°»·∑Å âw∂Å
                   000001dw | data | (data if w = 1)
                  °A°°ü°,ùAª°Øa»· Ÿw ∑°£°ó°¥·Àa ïA∑°»·∑Å âw∂Å
                   100000sw | mod 000 r/m | disp-low | disp-high | data
                         | (data if sw = 01)

         ⁄l ⁄Q⁄T⁄S (Inteter Add with Carry)

           (ã°ìw) 2àÅ∑Å µ°Ã·úÖóa∑Å îı≠Q∑i Ø©–ó–aâ°, ãaâiâ¡üi

           (π°∏b) πA1µ°Ã·úÖóa Ÿw CF + πA1µ°Ã·úÖóa + πA2µ°Ã·úÖóa

           (—wØ¢) ADC destination,source

      (Œa—e §Ò∂·) °A°°ü°,ùAª°Øa»· Ÿw ùAª°Øa»· âw∂Å
        (≈°óaàt)   000100dw | mod reg r/m | (disp-low) | (disp-high)
                  ¥·«A£IùA∑°»· Ÿw ∑°£°ó°¥·Àa ïA∑°»a âw∂Å
                   0001010w | data | (data if w=1)
                  °A°°ü°,ùAª°Øa»· Ÿw ∑°£°ó°¥·Àa ïA∑°»a∑Å âw∂Å
                   100000sw | mod 010 r/m | (disp-low) | (disp-high) |
                         data | (data if sw = 01)

         ⁄l ⁄Y⁄^⁄S (Increment By 1)

           (ã°ìw) µ°Ã·úÖóaüi –aêa ∑•«aü°†ÂÀa(ªwàa) –eîa.

           (π°∏b) µ°Ã·úÖóa Ÿw µ°Ã·úÖóa + 1

           (—wØ¢) INC destination

      (Œa—e §Ò∂·) ∂°óa ùAª°Øa»·
        (≈°óaàt)    01000reg
                  °A°°ü°,ùAª°Øa»·
                    1111111w | mod 000 r/m | (disp-low) | (disp-high)

         ⁄l ⁄Q⁄Q⁄Q (ASCII Adjust for Addition)

           (ã°ìw) 2àÅ∑Å ASCII —wØ¢∑Å ƒÅúÇ»· 10ª• ïA∑°»·(BCD)∑Å îı≠QµA ∑Å
                 –aµa ALùAª°Øa»·µA ¥Ë¥·ª• âiâ¡∑Å •°∏˜(•°¬ó–aµa §aù°∏s∑q)
                 ∑i Ø©–ó–eîa.
                  ASCII —wØ¢∑Å 0Ÿ=9åaª° ïA∑°»aìe 30HŸ=39Håaª°∑Å ≈°óaù° Ø©
                 —eñEîa.îı≠Qâiâ¡ ALüi 00HŸ=09H∑Å àtµA •°∏˜∑i –aâ°,∏aü°µ©ü±
                 ∑° ∑∂ìe âw∂Å (AF = 1 ∑© òÅ)ìe AHàtµA 1∑i îı≠Q–aâ° CFüi ≠A
                 Àa–eîa. ®â≠Q∑Å •°∏˜∑e AAS °wùw

           (π°∏b) AL Ÿw AL & 0FH (–a∂· 4ß°Àaàa îÅ¨w)
                   (AL & 0FH) > 9 ô°ìe AF = 1∑Å âw∂Å
                    AL Ÿw AL + 6
                    AH Ÿw AH + 1
                    CF Ÿw AF Ÿw 1
           (—wØ¢) AAA no operands

      (Œa—e §Ò∂·)      AAA
        (≈°óaàt)        37

         ⁄l ⁄T⁄Q⁄Q (Decimal Adjust for Addition)

           (ã°ìw) 10ª• îı≠Q∑aù° §aéë.2àÅ∑Å ÃÇ —wØ¢∑Å 10ª• µ°Ã·úÖóaüi îı≠Q
                 –aµa ¥Ë∑i ÆÅ ∑∂ìe ALêÅ∑Å âiâ¡üi ÃÇ —wØ¢∑Å 10ª•ÆÅù° §aéÖ
                 îa.®â≠Q∑i –i òÅ∑Å §aéë∑e DAS °wùw

           (π°∏b) (AL & 0FH) > 9 ô°ìe AF (•°π°ƒÅü° œiúÅãa) = 1∑©òÅ
                    AL Ÿw AL + 6
                    AF Ÿw 1
                  AL > 9FH ô°ìe CF = 1∑©òÅ
                    AL Ÿw AL + 60H
                    CF Ÿw 1
                (∫Å) ÃÇ —wØ¢∑°úe §a∑°Àa∑Å ¨w∂· 4§a∑°Àaµ¡ –a∂· 4§a∑°ÀaµA¨·
                    2∏aü°∑Å BCDüi êa»aêÖ àı

           (—wØ¢) DAA (no operands)

      (Œa—e §Ò∂·)       DAA
        (≈°óaàt)         27

    2) ®â≠Q

         ⁄l⁄c⁄e⁄R (Integer Subtraction)

           (ã°ìw) πA1µ°Ã·úÖóa(ïAØaÀ°ëA∑°≠e µ°Ã·úÖóa)µA¨· πA2µ°Ã·úÖóa(≠°Øa
                 µ°Ã·úÖóa)üi ®Åâ°,ãa âiâ¡üi πA 1µ°Ã·úÖóaµA ê˝ìeîa.

           (π°∏b) πA1µ°Ã·úÖóa Ÿw πA1µ°Ã·úÖóa - πA2µ°Ã·úÖóa

           (—wØ¢) SUB destination,source

      (Œa—e §Ò∂·) ùAª°Øa»·µ¡ ùAª°Øa»·,°A°°ü°∑Å âw∂Å
        (≈°óaàt)    001010dw | mod reg r/m | (disp-low) | (disp-high)
                  AX,ALâ¡ ∑°£°ó°¥·Àa ïA∑°îa∑Å âw∂Å
                    0010110w | data | (data if w=1)
                  ùAª°Øa»·,°A°°ü°µ¡ ∑°£°ó°¥·Àa ïA∑°»a∑Å âw∂Å
                    100000sw | mod 101 r/m | (disp-low) | (disp-high)
                        | data | (data if sw = 01)

         ⁄l⁄c⁄R⁄R (Integer Subtraction with Borrow)

           (ã°ìw) πA1µ°Ã·úÖóa(ïAØaÀ°ëA∑°≠e µ°Ã·úÖóa)µA¨· πA2µ°Ã·úÖóa(≠°Øa
                 µ°Ã·úÖóa)µ¡ CF∑Å ••úÅ àt∑i ®Åâ°¨· πA1µ°Ã·úÖóaµA ê˝ìeîa.

           (π°∏b) πA1µ°Ã·úÖóa Ÿw πA1µ°Ã·úÖóa - πA2µ°Ã·úÖóa - CF

           (—wØ¢) SBB destination,source

      (Œa—e §Ò∂·) ùAª°Øa»· Ÿw ùAª°Øa»· / °A°°ü°∑Å âw∂Å
        (≈°óaàt)    000110dw | mod reg r/m | (disp-low) | (disp-high)
                  ¥·«A£IùA∑°»· Ÿw ∑°£°ó°¥·Àa ïA∑°»·∑Å âw∂Å
                    0001110w | data | (data if w=1)
                  ùAª°Øa»·/°A°°ü° Ÿw ∑°£°ó°¥·Àa ïA∑°»a∑Å âw∂Å
                    100000sw | mod 011 r/m | (disp-low) | (disp-high)
                        | data | (data if sw = 01)

         ⁄l⁄T⁄U⁄S (Decrement by 1)

           (ã°ìw) ª°∏˜ñE µ°Ã·úÖóaµA¨· 1†e àq≠°–aâ°,ãa âiâ¡üi ãa µ°Ã·úÖóaµA
                 âbês–eîa.

           (π°∏b) µ°Ã·úÖóa Ÿw µ°Ã·úÖóa - 1

           (—wØ¢) DEC destination

      (Œa—e §Ò∂·) ∂°óa ùAª°Øa»·∑Å âw∂Å
        (≈°óaàt)    01001reg
                  °A°°ü°/ùAª°Øa»·∑Å âw∂Å
                    1111111w | mod 001 r/m | (disp-low) | (disp-high)

         ⁄l⁄^⁄U⁄W (Negate an Integer)

           (ã°ìw) ùAª°Øa»· ô°ìe °A°°ü° µ°Ã·úÖóa∑Å 2•°ÆÅüi ¬·–aµa,∂•úÅ∑Å
                 µ°Ã·úÖóa∑Å àtâ¡ √°—≈–i ÆÅ ∑∂îa.

           (π°∏b) µ°Ã·úÖóa Ÿw µ°Ã·úÖóa∑Å 2∑Å •°ÆÅ

           (—wØ¢) NEG destination

      (Œa—e §Ò∂·) îe∑© —w»Å∑±
        (≈°óaàt)    1111011w | mod 011 r/m | (disp-low) | (disp-high)

         ⁄l⁄S⁄]⁄` (Compare Two operands)

           (ã°ìw) µ°Ã·úÖóa∑Å ß°äaüi Ø©–ó–eîa.πA1µ°Ã·úÖóaµA¨· πA2µ°Ã·úÖóa
                 üi ®Ö âiâ¡µA òaúa¨· Øa…A∑°»·Øa œiúÅãaàa ≠AÀañEîa.µ°Ã·úÖ
                 óaìe °°ñÅ •e—¡–aª° ¥gìeîa.

           (π°∏b) FLAG Ÿw πA1µ°Ã·úÖóa - πA2µ°Ã·úÖóa

           (—wØ¢) CMP destination,source

      (Œa—e §Ò∂·) °A°°ü°/ùAª°Øa»·µ¡ ùAª°Øa»·∑Å âw∂Å
        (≈°óaàt)    001110dw | mod reg r/m | (disp-low) | (disp-high)
                  ¥·«A£IùA∑°»·µ¡ ∑°£°ó°¥·Àa ïA∑°»·∑Å âw∂Å
                    0011110w | data | (data if w=1)
                  °A°°ü°/ùAª°Øa»·µ¡ ∑°£°ó°¥·Àa ïA∑°»·∑Å âw∂Å
                    100000sw | mod 111 r/m | (disp-low) | (disp-high)
                        | data | (data if sw=01)

         ⁄l⁄Q⁄Q⁄c (ASCII Adjust for Subtraction)

           (ã°ìw) 2àÅ∑Å ASCII —wØ¢∑Å ƒÅúÇ»· 10ª• ïA∑°»·(BCD)∑Å ®â≠QµA ∑Å
                 –aµa ALùAª°Øa»·µA ¥Ë¥·ª• âiâ¡∑Å •°∏˜(•°¬ó–aµa §aù°∏s∑q)
                 ∑i Ø©–ó–eîa.
                  ASCII —wØ¢∑Å 0Ÿ=9åaª° ïA∑°»aìe 30HŸ=39Håaª°∑Å ≈°óaù° Ø©
                 —eñEîa.®â≠Qâiâ¡ ALüi 00HŸ=09H∑Å àtµA •°∏˜∑i –aâ°,∏aü°êÅü±
                 ∑° ∑∂ìe âw∂Å (AF = 1 ∑© òÅ)ìe AHàtµA 1∑i ®Åâ°–aâ° CFüi ≠A
                 Àa–eîa. îı≠Q∑Å •°∏˜∑e AAA °wùw

           (π°∏b) AL Ÿw AL & 0FH (–a∂· 4ß°Àaàa îÅ¨w)
                   (AL & 0FH) > 9 ô°ìe AF = 1∑Å âw∂Å
                    AL Ÿw AL - 6
                    AH Ÿw AH - 1
                    CF Ÿw AF Ÿw 1
           (—wØ¢) AAS no operands

      (Œa—e §Ò∂·)      AAS
        (≈°óaàt)        3F

         ⁄l⁄T⁄Q⁄c (Decimal Adjust for Subtraction)

           (ã°ìw) 10ª• ®â≠Q∑aù° §aéë.2àÅ∑Å ÃÇ —wØ¢∑Å 10ª• µ°Ã·úÖóaüi ®â≠Q
                 –aµa ¥Ë∑i ÆÅ ∑∂ìe ALêÅ∑Å âiâ¡üi ÃÇ —wØ¢∑Å 10ª•ÆÅù° §aéÖ
                 îa.îı≠Q∑i –i òÅ∑Å §aéë∑e DAA °wùw

           (π°∏b) (AL & 0FH) > 9 ô°ìe AF (•°π°ƒÅü° œiúÅãa) = 1∑©òÅ
                    AL Ÿw AL - 6
                    AF Ÿw 1
                  AL > 9FH ô°ìe CF = 1∑©òÅ
                    AL Ÿw AL - 60H
                    CF Ÿw 1
                (∫Å) ÃÇ —wØ¢∑°úe §a∑°Àa∑Å ¨w∂· 4§a∑°Àaµ¡ –a∂· 4§a∑°ÀaµA¨·
                    2∏aü°∑Å BCDüi êa»aêÖ àı

           (—wØ¢) DAS (no operands)

      (Œa—e §Ò∂·)       DAA
        (≈°óaàt)         2F


