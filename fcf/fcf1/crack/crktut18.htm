<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
<head>
<base target="detail">
<title>HPA Crack Tutorial - 18</title>
<meta name="author" content="Formater [FCF]">
<meta name="generator" content="Namo WebEditor v3.0">
</head>

<body background="bg2.gif"
 bgcolor="white" text="black" link="blue" vlink="purple" alink="red">

<h2 align="center"><font face="Comic Sans MS">Package for the WEB gyors t&ouml;r&eacute;se<br>
avagy<br>
hogyan csin&aacute;ljunk Time-LOCK generic t&ouml;r&eacute;st</font></h2>
<p><font face="Comic Sans MS">K&eacute;sz&iacute;tette: Lukundoo [HPA]<br>
e-mail: </font><a href="mailto:lukundoo@beer.com"><font face="Comic Sans MS">lukundoo@beer.com</font></a><font
 face="Comic Sans MS"><br>
web: </font><a href="http://hpa.virtualave.net"><font face="Comic Sans MS">http://hpa.virtualave.net</font></a></p>
<p><font face="Comic Sans MS"><u>Tartalomjegyz&eacute;k:</u></font><font face="Comic Sans MS"><br>
1. Hozz&aacute;val&oacute;k<br>
2. Minden kezdet k&ouml;nny&ucirc;<br>
3. Egy kis Win32 assembly<br>
4. V&eacute;gsz&oacute;</font></p>
<p><font face="Comic Sans MS"><u>1. Hozz&aacute;val&oacute;k</u></font><font
 face="Comic Sans MS"><br>
Sz&uuml;ks&eacute;geltetik hozz&aacute; a k&ouml;vetkez&otilde; programok:<br>
Package for the WEB ami let&ouml;lthet&otilde; a </font><a href="http://www.instalshield.com"><font
 face="Comic Sans MS">http://www.instalshield.com</font></a><font face="Comic Sans MS">-r&oacute;l,<br>
SoftIce v4.0 &eacute;s HIEW ami let&ouml;lthet&otilde; a </font><a href="http://w3.swi.hu/toc"><font
 face="Comic Sans MS">http://w3.swi.hu/toc</font></a><font face="Comic Sans MS">
c&iacute;mr&otilde;l.</font></p>
<p><font face="Comic Sans MS"><u>2. Minden kezdet k&ouml;nny&ucirc;</u></font><font
 face="Comic Sans MS"><br>
Csapjunk &nbsp;a &nbsp;s&ucirc;r&ucirc;j&eacute;be. &nbsp;Ind&iacute;tsuk el
a programot, majd megjelenik egy &nbsp;ablak, ami &eacute;rtes&iacute;t minket
arr&oacute;l, hogy mennyi id&otilde;nk van m&eacute;g h&aacute;tra. Ezen az
ablakon&nbsp;van&nbsp;egy olyan gomb hogy &quot;Purchase&quot; azaz v&aacute;s&aacute;rl&aacute;s.
Ezut&aacute;n bej&ouml;n &nbsp;m&eacute;gegy &nbsp;ablak, &nbsp;ahol &nbsp;meg
&nbsp;lehet &nbsp;v&aacute;s&aacute;rolni a programot. Mit is l&aacute;thatunk
az ablakban:</font></p>
<p><font face="Courier" size="2">Registration number: 0000000000000000<br>
Unlock Code:<br>
User Name:<br>
Company Name:</font></p>
<p><font face="Comic Sans MS">A &nbsp;regisztr&aacute;ci&oacute;s k&oacute;dot&nbsp;a
program gener&aacute;lja nek&uuml;nk, a felold&oacute; kulcsot (Unlock Code)
a c&eacute;gk&uuml;ldi nek&uuml;nk, a felhaszn&aacute;l&oacute; nevet &eacute;s
c&eacute;gnevet pedig nek&uuml;nk kell megadni!&nbsp;T&ouml;lts&uuml;k&nbsp;ki
a&nbsp;mez&otilde;ket, a felold&oacute; k&oacute;dhoz csak sz&aacute;mokat &iacute;rjunk.
Miut&aacute;n megvagyunk vele, akkor nyomjuk meg a &quot;CTRL-D&quot; gomb &nbsp;kombin&aacute;ci&oacute;t,&nbsp;&eacute;s
bej&ouml;n&nbsp;a&nbsp;SoftIce ablak. &Iacute;rjuk be hogy &quot;BPX HMEMCPY&quot;.
&nbsp;A Hmemcpy parancs&nbsp;akkor hajt&oacute;dik v&eacute;gre, amikor b&aacute;rmilyen
mem&oacute;ria m&aacute;sol&aacute;s t&ouml;rt&eacute;nik. Ilyen p&eacute;ld&aacute;ul
az az eset, amikor az ablakb&oacute;l beolvassuk a sz&ouml;veget. &nbsp;Miut&aacute;n
be&iacute;rtuk,&nbsp;akkor &nbsp;nyomjunk F5-&ouml;t, &eacute;s visszat&eacute;r&uuml;nk
a&nbsp;SoftIce-ba. Nyomjunk r&aacute;&nbsp;az OK gombra.&nbsp;Miut&aacute;n
r&aacute;kattintottunk&nbsp;a&nbsp;regisztr&aacute;ci&oacute;s&nbsp;ablak OK&nbsp;gombj&aacute;ra,&nbsp;r&ouml;gt&ouml;n
visszat&eacute;r&uuml;nk a&nbsp;SoftIce-hez.&nbsp;Az&nbsp;ablak&nbsp;alj&aacute;n
l&aacute;thatjuk, hogy a KERNEL egyik&nbsp;utas&iacute;t&aacute;sa a HMEMCPY.
Nyomjuk meg az F12 gombot 8-szor, &eacute;s &nbsp;oda&eacute;r&uuml;nk, &nbsp;ahol
a program megh&iacute;vta ezt az utas&aacute;t&aacute;st. Az utas&iacute;t&aacute;st
&eacute;rdekes m&oacute;don nem a PFW h&iacute;vta meg, hanem egy titokzatos
&quot;TL32V20&quot; nev&uuml; program! &nbsp;Ha &nbsp;megn&eacute;zz&uuml;k,
akkor l&aacute;thatjuk, hogy ez egy DLL, &nbsp;azaz &nbsp;egy Dinamikusan&nbsp;szerkesztett
k&ouml;nyvt&aacute;r. Ezekben a DLL-ekben t&aacute;rolnak&nbsp;el olyan&nbsp;j&oacute;l&nbsp;haszn&aacute;lhat&oacute;&nbsp;procedur&aacute;kat,&nbsp;amit
t&ouml;bb program is haszn&aacute;l. Ezeket fut&aacute;s&nbsp;k&ouml;zben bet&ouml;lt&nbsp;aprogram
a mem&oacute;ri&aacute;ba, majd miut&aacute;n haszn&aacute;lta,&nbsp;kit&ouml;rli&nbsp;onnan.
&nbsp;Ha&nbsp;belen&eacute;z&uuml;nk a file-ba, akkor egy kis keresg&eacute;l&eacute;s
ut&aacute;n&nbsp;tal&aacute;lunk egy olyan bejegyz&eacute;st, hogy Time-LOCK.
Sz&oacute;val ez az&nbsp;omin&oacute;zus Time-LOCK v&eacute;delem, amit igen&nbsp;sok
program haszn&aacute;l! &nbsp;Legal&aacute;bb&nbsp;m&aacute;r ezzel is tal&aacute;lkoztam!
Ha tov&aacute;bb megy&uuml;nk az F10 gomb &nbsp;seg&iacute;ts&eacute;g&eacute;vel,
akkor&nbsp;l&aacute;thatjuk,&nbsp;hogy r&ouml;gt&ouml;n a kiolvas&aacute;s&nbsp;ut&aacute;n
ellen&otilde;riz valamit!</font></p>
<p><font face="Courier" size="2">* Reference To: USER32.GetDlgItem, Ord:00EBh<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br>
:10004AC2 FF15B0050210 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call
dword ptr [100205B0]<br>
:10004AC8 50 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
eax<br>
:10004AC9 8BD8 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov
ebx, eax</font></p>
<p><font face="Comic Sans MS">Kiolvassa a program a be&iacute;rt nevet.</font></p>
<p><font face="Courier" size="2">* Reference To: USER32.GetWindowTextLengthA,
Ord:0136h<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br>
:10004ACB FF15C8050210 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call
dword ptr [100205C8]<br>
:10004AD1 83F802 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmp
eax, 00000002<br>
:10004AD4 7F1C &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jg
10004AF2</font></p>
<p><font face="Comic Sans MS">Ellen&otilde;rzi a hossz&aacute;t, &eacute;s ha
nagyobb mint 2 akkor tov&aacute;bb ugrik.</font></p>
<p><font face="Courier" size="2">:10004AD6 6800200000 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
00002000<br>
:10004ADB 6839D50110 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
1001D539<br>
:10004AE0 6849DA0110 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
1001DA49<br>
:10004AE5 6A00 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
00000000</font></p>
<p><font face="Courier" size="2">* Reference To: USER32.MessageBoxA, Ord:0188h<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br>
:10004AE7 FF1594050210 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call
dword ptr [10020594]<br>
:10004AED E935010000 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jmp
10004C27</font></p>
<p><font face="Comic Sans MS">Ha kisebb, akkor hiba&uuml;zenet!</font></p>
<p><font face="Comic Sans MS">Ezut&aacute;n &nbsp;tov&aacute;bb &nbsp;megy&uuml;nk,
&nbsp;&eacute;s el&eacute;r&uuml;nk od&aacute;ig, hogy kiolvassuk az &quot;Unlock
Code&quot;-ot.</font></p>
<p><font face="Courier" size="2">* Reference To: USER32.GetDlgItem, Ord:00EBh<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br>
:10004B01 FF15B0050210 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call
dword ptr [100205B0]<br>
:10004B07 6A31 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
00000031<br>
:10004B09 6890E30110 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
1001E390<br>
:10004B11 8D45D8 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea
eax, dword ptr [ebp-28]<br>
:10004B14 50 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
eax<br>
:10004B15 E8F5C4FFFF &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call
1000100F</font></p>
<p><font face="Comic Sans MS">A &nbsp;program &nbsp;ezut&aacute;n nagyon buta
m&oacute;don, kisz&aacute;molja, hogy mi a j&oacute; &quot;Unlock Code&quot;!</font></p>
<p><font face="Courier" size="2">:10004B1A 83C404 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add
esp, 00000004<br>
:10004B1D 8D45EC &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea
eax, dword ptr [ebp-14]<br>
:10004B20 8D4DD8 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea
ecx, dword ptr [ebp-28]</font></p>
<p><font face="Comic Sans MS">Ezut&aacute;n &nbsp;ha &nbsp;el&eacute;rt&uuml;nk
&nbsp;a&nbsp;10004B23 c&iacute;mig, akkor &iacute;rjuk be, hogy &quot;D EAX&quot;.
R&ouml;gt&ouml;n &nbsp;l&aacute;tjuk, &nbsp;hogy a saj&aacute;t k&oacute;dunk
van a megadott helyen! Ha be&iacute;rjuk hogy &nbsp;&quot;D &nbsp;ECX&quot;,
&nbsp;akkor &nbsp;pedig &nbsp;l&aacute;thatjuk, hogy a j&oacute; k&oacute;d
jelent meg a k&eacute;perny&otilde;n! Ezt&nbsp;a c&iacute;met j&oacute;l jegyezz&uuml;k
meg, mert m&eacute;g sz&uuml;ks&eacute;g&uuml;nk lehet r&aacute;! &nbsp;Itt&nbsp;m&aacute;r&nbsp;meg
is old&oacute;dhatna a probl&eacute;m&aacute;nk, de ez a k&oacute;d csak a mig&eacute;p&uuml;nk&ouml;n
&nbsp;&nbsp;m&ucirc;k&ouml;dik. &nbsp;&Iacute;rjuk be a k&oacute;dot az &quot;Unlock
Code&quot;-ba, &eacute;s csoda t&ouml;rt&eacute;nt! A program elfogadta! De
ez a k&oacute;d m&aacute;r nem m&uuml;k&ouml;dik m&aacute;s g&eacute;p&eacute;n...
Menj&uuml;nk egy kicsit tov&aacute;bb...</font></p>
<p><font face="Courier" size="2">:10004B23 50 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
eax<br>
:10004B24 51 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
ecx<br>
:10004B25 E8161C0000 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call
10006740<br>
:10004B2A 83C408 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add
esp, 00000008<br>
:10004B2D 85C0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test
eax, eax<br>
:10004B2F 7553 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jne
10004B84</font></p>
<p><font face="Comic Sans MS">Az 10004B25 c&iacute;men ellen&otilde;rzi a k&oacute;dot,
&eacute;s ha rossz, akkor tov&aacute;bb ugrik a 10004B84 c&iacute;mre. L&aacute;ssuk
mi t&ouml;rt&eacute;nik ott!</font></p>
<p><font face="Courier" size="2">* Referenced by a (U)nconditional or (C)onditional
Jump at Address:<br>
|:10004B2F(C)<br>
|<br>
:10004B84 8D45D8 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea
eax, dword ptr [ebp-28]<br>
:10004B87 50 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
eax<br>
:10004B88 E88CC4FFFF &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call
10001019</font></p>
<p><font face="Comic Sans MS">Id&aacute;ig semmi k&uuml;l&ouml;n&ouml;s...</font></p>
<p><font face="Courier" size="2">:10004B8D 83C404 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add
esp, 00000004<br>
:10004B90 8D45EC &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea
eax, dword ptr [ebp-14]<br>
:10004B93 8D4DD8 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea
ecx, dword ptr [ebp-28]<br>
:10004B96 50 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
eax<br>
:10004B97 51 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
ecx<br>
:10004B98 E8A31B0000 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call
10006740</font></p>
<p><font face="Comic Sans MS">Az &nbsp;EAX-be &nbsp;megint &nbsp;beleteszi &nbsp;a
&nbsp;mi &nbsp;k&oacute;dunkat, &nbsp;&eacute;s az ECX -be pedig beleteszi a
TRIAL peri&oacute;dust meghosszab&iacute;t&oacute; k&oacute;dot.</font></p>
<p><font face="Courier" size="2">:10004B9D 83C408 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add
esp, 00000008<br>
:10004BA0 85C0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test
eax, eax<br>
:10004BA2 753E &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jne
10004BE2</font></p>
<p><font face="Comic Sans MS">Ellen&otilde;rzi, hogy a Trial peri&oacute;dus
k&oacute;dj&aacute;t &uuml;t&ouml;tt&uuml;k-e be. Ha nem, akkor tov&aacute;bb
megy a 10004BE2 c&iacute;mre. L&aacute;ssuk csak! Mi t&ouml;rt&eacute;nik itt???
Csak nem egy &nbsp;&uuml;zenetablak??? Juh&eacute;&eacute;&eacute;!! &nbsp;Ez
kell nek&uuml;nk. Tudni kell, hogy hogyan kell a MessageBoxA-nev&ucirc; procedur&aacute;t
param&eacute;terezni:</font></p>
<p><font face="Courier" size="2">int MessageBox(<br>
&nbsp;&nbsp;&nbsp;&nbsp;HWND &nbsp;hwndOwner, &nbsp;&nbsp;&nbsp;// A tulajdonos
ablak kezelõje<br>
&nbsp;&nbsp;&nbsp;&nbsp;LPCTSTR &nbsp;lpszText, &nbsp;// Az ablak &uuml;zenet&eacute;re
mutat&oacute; pointer<br>
&nbsp;&nbsp;&nbsp;&nbsp;LPCTSTR &nbsp;lpszTitle, // Az ablak felirat&aacute;ra
mutat&oacute; pointer &nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;UINT &nbsp;fuStyle &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//
Az ablak st&iacute;lusa<br>
&nbsp;&nbsp;&nbsp;);</font></p>
<p><font face="Comic Sans MS">Tov&aacute;bb&aacute; tudnunk kell, hogy az assembler
a vermet haszn&aacute;lja erre, az&eacute;rt<br>
ford&iacute;tott sorrendben kell belerakni a param&eacute;tereket.</font></p>
<p><font face="Courier" size="2">:10004BB2 6800200000 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
00002000 //st&iacute;lus<br>
:10004BB7 6839D50110 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
1001D539 //ablak felirata<br>
:10004BBC 6875DB0110 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
1001DB75 // ablak &uuml;zenete<br>
:10004BC1 56 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
esi //tulajdonos ablak kezelõje</font></p>
<p><font face="Courier" size="2">* Reference To: USER32.MessageBoxA, Ord:0188h<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br>
:10004BC2 FF1594050210 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call
dword ptr [10020594]<br>
:10004BC8 C70534AA011001000000 &nbsp;&nbsp;&nbsp;mov dword ptr [1001AA34], 00000001</font></p>
<p><font face="Comic Sans MS">Mostm&aacute;r &nbsp;l&aacute;tjuk, &nbsp;hogy
&nbsp;ez egy hiba&uuml;zenet, ami t&aacute;j&eacute;koztat minket, hogy hib&aacute;s
a k&oacute;dunk. De eml&eacute;ksz&uuml;nk m&eacute;g, hogy valahol m&aacute;r
l&aacute;ttuk a mi helyes k&oacute;dunkat! &nbsp;Mi lenne, hogyha azt a k&oacute;dot
tudn&aacute;nk ki&iacute;ratni? Elvben nincs semmi akad&aacute;lya.</font></p>
<p><font face="Comic Sans MS"><u>3. Egy kis Win32 assembly</u></font></p>
<p><font face="Comic Sans MS">Ahogy &nbsp;l&aacute;ttuk, valahogy bele kell
tenni az ablak &uuml;zenetbe a k&oacute;dunkkat. Tudjuk, hogy a 10004B20 c&iacute;men
lev&otilde; utas&iacute;t&aacute;s t&aacute;rolta el a j&oacute; c&iacute;met!
Itt kell tenn&uuml;nk teh&aacute;t valamit. A dolog nagyon egyszer&ucirc;. El
kell ugranunk oda, ahol a ki&iacute;rat&aacute;s volt!</font></p>
<p><font face="Courier" size="2">:10004B1D 8D45EC &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea
eax, dword ptr [ebp-14]<br>
:10004B20 8D4DD8 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea
ecx, dword ptr [ebp-28]<br>
:10004B23 50 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
eax<br>
:10004B24 51 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
ecx<br>
:10004B25 E8161C0000 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call
10006740</font></p>
<p><font face="Comic Sans MS">A &nbsp;10004B23 c&iacute;men lev&otilde; utas&iacute;t&aacute;st
kell &aacute;t&iacute;rnunk. Teh&aacute;t ind&iacute;tsuk &uacute;jra az eg&eacute;szet,
&eacute;s amikor erre a c&iacute;mre &eacute;r&uuml;nk, akkor nyomjuk meg az
&quot;A&quot; bet&uuml;t. Ha siker&uuml;lt, akkor be&iacute;rhatjuk az &uacute;j
utas&iacute;t&aacute;st. &Iacute;rjuk be hogy:</font></p>
<p><font face="Courier" size="2">:10004B23 JMP 10004BB2</font></p>
<p><font face="Comic Sans MS">Ha &nbsp;be&iacute;rtuk, &nbsp;akkor &nbsp;l&aacute;thatjuk,
&nbsp;hogy megv&aacute;ltozott a k&oacute;dok, mert a JMP utas&iacute;t&aacute;s
opk&oacute;dja 5 byte, ez&eacute;rt m&eacute;g be kell &iacute;rnunk k&eacute;tszer
hogy &nbsp;&quot;NOP&quot;. Ha minden siker&uuml;lt, akkor ezt fogjuk l&aacute;tni.</font></p>
<p><font face="Courier" size="2">:10004B23 E9BA000000 JMP 10004BB2<br>
:10004B28 90 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOP<br>
:10004B29 90 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOP</font></p>
<p><font face="Comic Sans MS">Ha &nbsp;&uuml;t&uuml;nk m&eacute;g egy ENTER-t,
akkor befejezz&uuml;k a szerkeszt&eacute;st. Ezut&aacute;n ha tov&aacute;bb
&nbsp;megy&uuml;nk, &nbsp;akkor r&ouml;gt&ouml;n oda ugrunk, ahol a hiba&uuml;zenet
ki&iacute;rat&aacute;sa t&ouml;rt&eacute;nik.</font></p>
<p><font face="Courier" size="2">:10004BB2 6800200000 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
00002000 //st&iacute;lus<br>
:10004BB7 6839D50110 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
1001D539 //ablak felirata<br>
:10004BBC 6875DB0110 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
1001DB75 // ablak &uuml;zenete<br>
:10004BC1 56 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push
esi //tulajdonos ablak kezelõje</font></p>
<p><font face="Courier" size="2">* Reference To: USER32.MessageBoxA, Ord:0188h<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br>
:10004BC2 FF1594050210 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call
dword ptr [10020594]<br>
:10004BC8 C70534AA011001000000 &nbsp;&nbsp;&nbsp;mov dword ptr [1001AA34], 00000001</font></p>
<p><font face="Comic Sans MS">Ha &nbsp;most &nbsp;be&iacute;rjuk &nbsp;hogy
&quot;DECX&quot;, akkor l&aacute;thatjuk, hogy az ECX regiszter<br>
r&aacute;mutat &nbsp;a &nbsp;helyes &nbsp;k&oacute;dra! &nbsp;Nincs &nbsp;m&aacute;s
&nbsp;teend&otilde;nk, mint ezt az &eacute;rt&eacute;ket lementen&uuml;nk &nbsp;a
&nbsp;verembe. &nbsp;Ha oda &eacute;rt&uuml;nk a 10004BBC c&iacute;mre, akkor
megint &iacute;rjuk be hogy &quot;A&quot; &eacute;s ENTER! Ut&aacute;na &iacute;rjuk
be hogy &quot;PUSH ECX&quot;, ami annyit csin&aacute;l, hogy&nbsp;lementi&nbsp;a
verembe az ECX tartalm&aacute;t. De l&aacute;thatjuk, hogy ennek &nbsp;azopk&oacute;dja
&nbsp;csak &nbsp;egy byte, ez&eacute;rt m&eacute;g n&eacute;gyszer be kell &iacute;rni
hogy &quot;NOP&quot;. Ha ez siker&uuml;lt, akkor a k&ouml;vetkez&otilde;t fogjuk
l&aacute;tni:</font></p>
<p><font face="Courier" size="2">:10004BB2 push 00002000 //st&iacute;lus<br>
:10004BB7 push 1001D539 //ablak felirata<br>
:10004BBC push ecx<br>
:10004BBD nop<br>
:10004BBE nop<br>
:10004BBF nop<br>
:10004BC0 nop<br>
:10004BC1 push esi //tulajdonos ablak kezelõje</font></p>
<p><font face="Courier" size="2">* Reference To: USER32.MessageBoxA, Ord:0188h<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br>
:10004BC2 FF1594050210 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call
dword ptr [10020594]<br>
:10004BC8 C70534AA011001000000 &nbsp;&nbsp;&nbsp;mov dword ptr [1001AA34], 00000001</font></p>
<p><font face="Comic Sans MS">Ezut&aacute;n &nbsp;ha &nbsp;elind&iacute;tjuk
&nbsp;m&eacute;gegyszer, &nbsp;akkor&nbsp;a hiba&uuml;zenet helyett m&aacute;r
a saj&aacute;t &nbsp;k&oacute;dunkat&nbsp;fogjuk &nbsp;visszontl&aacute;tni
&nbsp;a &nbsp;hiba&uuml;zenet helyett. Mostm&aacute;r nincs &nbsp;m&aacute;s
&nbsp;dolgunk, &nbsp;mint &iacute;rni &nbsp;egy&nbsp;crack &nbsp;programot,
ami &nbsp;el&otilde;sz&ouml;r m&oacute;dos&iacute;tja a DLL-t, majd vissza&aacute;ll&iacute;tja
az eredeti &aacute;llapot&aacute;t!</font></p>
<p><font face="Comic Sans MS">4. V&eacute;gsz&oacute;<br>
Tudom, hogy ez egya kicsit neh&eacute;zkes anyag volt, de aki megcsin&aacute;lja,
az egy kicsit&nbsp;k&ouml;zelebb&nbsp;ker&uuml;l a Windows bels&otilde; m&ucirc;k&ouml;d&eacute;s&eacute;hez!
&Uuml;dv&ouml;zletemet k&uuml;ld&ouml;m Moln&aacute;r&nbsp;L&aacute;szl&oacute;nak,&nbsp;aki&nbsp;az&nbsp;UPX-et
ingyen &eacute;s b&eacute;rmentve fejleszti!!!</font></p>
<p align="right"><font face="Comic Sans MS"><br>
Lukundoo [HPA]<br>
1999. dec. 28.</font></p>
<p align="center"><font face="Comic Sans MS" color="black"><img src="../../../../../PROGRA~1/NAMO/WEBEDI~1/WORK/ISSUE1~1/hr.gif"
 width="457" height="15" border="0"></font></p>
</body>

</html>