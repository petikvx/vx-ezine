<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=windows-1251">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
<title>Top Device</title>
</head>

<body bgcolor="#B1B1B1" text="#000000" topmargin="0"
leftmargin="3">

<p><STYLE> </p>

<p>INPUT { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt
}</p>

<p>SELECT { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE:
8pt } </p>

<p>OPTION { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE:
8pt } </p>

<p>TEXTAREA { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE:
8pt } </p>

<p>FORM { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt
} <br>
BODY { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt } <br>
P { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt }
TABLE { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt
}TR { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt } TD
{ FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 10pt
}TEXTAREA { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE:
8pt } A { COLOR: #005500; TEXT-DECORATION: none }A:hover {
TEXT-DECORATION: underline } A:link { TEXT-DECORATION: none
}A:visited { }text:unknown { FONT-SIZE: 8pt } } </STYLE> </p>

<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><div align="center"><center><table
        border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
                <td width="100%" bgcolor="#000000"><img
                src="../-.gif" width="1" height="1"></td>
            </tr>
            <tr>
                <td width="100%" bgcolor="#808080"><strong>03.03.2000</strong>
                Игры с сигнатурами <strong>[Deviator]</strong></td>
            </tr>
            <tr>
                <td bgcolor="#000000"><img src="../-.gif"
                width="1" height="1"></td>
            </tr>
            <tr>
                <td><pre>

 Привет.
  В общем подал Януш Миловски очень неплохую идею - обламывать DrWeb'a,
 путем подсовывания ему сигнатур. Все его успехи булы опубликованны в 
 IV#15,но он был платным,да еще и печатным :). Вобщем Януш сказал,что он
 такое сделал,но как признаваться не хотел..Вот и пришлось убить день на
 расковыривание DrWeb'a.
 Будем надеятся,что я его (c) не подпорчу :)
  И так...

	1. Как работает DrWeb
  DrWeb себе спокойно грузится,загружает базы данных и начинает проверять
 файлы (бут-сектора и тп). Проверка делится на три этапа - эмуляция кода,
 проверка эвристикой и сигнатурный поиск. 
		a) Эмуляция кода. Ну...это уже и так всем извеcтно.
	Достаточно много в этом направлении сделал SSR и Януш,а я только
	немного довел до ума саму идею (см. WebBugger+). Сделано для 
	расшифровки шифрованных вирусов
		b) Эвристика. Ну...это тоже всем известно.. Читайте доки.
		c) А вот на сигнатурном поиске я хочу остановится
	И так,DrWeb имеет некоторые базы данных. В них находятся записи
	о вирусах. Вообще сама сигнатура занимает 16 байт,но остальные
	байты оной заполнены различной информацией - как лечить файл и
 	тп. 
( cтруктура в Сишном формате )

	struct	sig
	{
	byte	sig1_byte;    // Байт сигнатуры
	word	sig1_ofs;     // Смещ. от текущ. позиции до данного байта
	byte	sig1_len;     // Длина CRC кода начиная с позиции sig1_ofs
	word	sig1_CRCL;    // Собственно сам CRC код
	word	sig2_CRCH;

	byte	sig2_byte;    // Аналогично sig1_xx,но если sig2_len = 0,
	byte	sig2_ofs;     // то данная часть отсутствует
	byte	sig2_len;
	word	sig2_CRCL;
	word	sig2_CRCH;
	
	...	some	useless	shit	;)
	};
	
	Так вот,DrWeb открывает файл,в зависимости от формата указывает
	на начало программы и проходит все сигнатуры. Если совпало , 
	осведомляет user'a. Если нет,то DrWeb пропускает одну комманду 
	и проверяет снова.
	Так несколько раз (сколько - я не определял)

	2. Что же со всем этим делать ?
	Да все что угодно - от прикалывания над начинающими трейдерами
	:),до скрывания под чем угодно. 

	3. <a href="../files/dev_sigs.zip" target="main"><strong>Приложение</strong></a>
	Да,я написал пару утилит,которые помогут немного облегчить жизнь
	И так,это:

		a) Откомментированные куски кода отвечающие за сравнение 
		сигнатур DrWeb'a (директория CODE)

		b) Программа &quot;Радость коллекционера&quot;,которая просто
		создает файл с сигнатурой. Но (!) данная программа не 
		заполняет оный мусором - файл на выходе состоит из 
		одних нулей и с некоторыми вкраплениями сигнатуры. 
		(директория LAME) 

		c) Небольшая выдиралка сигнатур. (директория sniff)
			1) Распаковаете DrWeb для DOS (CUP386'ым напр.)
			2) Запускаете patcher.com
			3) если все успешно - запускаете sniffer.com,
			запускаете DrWeb и тестируете один (!) файл.

		  ВНИМАНИЕ:	Так как один файл тестируется на 
			сигнатуры многократно,то прийдется взять то число,
			которое DrWeb пишет внизу (кол-во вирусов),
			умножить на 16 и в hiew'e (или написать прогу)
			урезать размер до данного числа. Иначе у вас 
			будут многократные вхождения одной и той-же 
			сигнатуры . 

		d) Пример вирусов (директория Vir)

Deviator/HAZARD.
</pre>
                </td>
            </tr>
            <tr>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;</td>
            </tr>
        </table>
        </center></div></td>
        <td>&nbsp;</td>
    </tr>
</table>

<p>&nbsp;</p>
</body>
</html>
