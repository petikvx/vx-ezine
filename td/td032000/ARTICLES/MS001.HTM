<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=windows-1251">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
<title>Top Device</title>
</head>

<body bgcolor="#B1B1B1" text="#000000" topmargin="0"
leftmargin="3">

<p><STYLE> </p>

<p>INPUT { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt
}</p>

<p>SELECT { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE:
8pt } </p>

<p>OPTION { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE:
8pt } </p>

<p>TEXTAREA { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE:
8pt } </p>

<p>FORM { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt
} <br>
BODY { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt } <br>
P { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt }
TABLE { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt
}TR { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt } TD
{ FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 10pt
}TEXTAREA { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE:
8pt } A { COLOR: #005500; TEXT-DECORATION: none }A:hover {
TEXT-DECORATION: underline } A:link { TEXT-DECORATION: none
}A:visited { }text:unknown { FONT-SIZE: 8pt } } </STYLE> </p>

<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><div align="center"><center><table
        border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
                <td width="100%" bgcolor="#000000"><img
                src="../-.gif" width="1" height="1"></td>
            </tr>
            <tr>
                <td width="100%" bgcolor="#808080"><strong>10.03.2000</strong>
                Win32CPP - PE infector in C++ <strong>[meza &amp;
                SMT]</strong></td>
            </tr>
            <tr>
                <td bgcolor="#000000"><img src="../-.gif"
                width="1" height="1"></td>
            </tr>
            <tr>
                <td><pre>

вашему вниманию предлагается пример вируса на с++ (к статье SMT
&quot;Использование microsoft visual C++ 6.0 для создания
перемещаемого програмного кода.&quot;)

вирус учебный , поэтому многие вещи в нем упущены , т.к.
их реализация не представляет особого труда

итак , win32cpp - это РЕ инфектор , заражающий любые РЕ файлы
(с некоторыми уточнениями , см ниже). метод заражения самый 
простой - создание собственной секции , что не проходит мимо
нормальной эвристики , конечно :)

в проекте для msvc++ есть только release build , т.к. debug
build просто не будет работать (за подробностями к SMT:))
первое поколение заражает файл из командной строки
следующие - файл с именем goat.exe в текущей директории

тестировался на exe, dll, scr - успешно
по идее , должен работать и с ocx , просто не проверялось
для работы с cpl надо немного изменить firstfunc , т.к
cpl вызывается не совсем так , как обычная dll
из-за нехватки времени тестировался только под win98 , хотя
очевидно , что должен работать под любой win32 осью

чего не хватает для того , чтоб его можно было бы пустить в
природу?

1 конечно , надо применить более приличный метод заражения
2 работа с аттрибутами файла
3 создание рабочего потока - поиск и заражение файлов
4 заражение залоченных файлов , через setupapi

все это остается для следующей версии

выводы - смотрите сами , насколько легко читается исходник,
насколько легко вносить в него свои изменения. и где проигрыш
по сравнению с асмом?

PS небольшой прикол напоследок
AVP считает , что секции в файле расположены в том же порядке ,
что и их заголовки - какая трогательная наивность!:) Короче , 
достаточно поменять местами 1-й и последний ЗАГОЛОВКИ секции ,
т.е. сделать заголовок секции виря первым , чтоб AVP перстал
его видеть! И это проверенный факт. Это называется хевристика...
ДрВеба , конечно , так просто не провести.</pre>
                <pre><a href="../files/win32cpp.zip"
target="main">исходник</a></pre>
                </td>
            </tr>
            <tr>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;</td>
            </tr>
        </table>
        </center></div></td>
        <td>&nbsp;</td>
    </tr>
</table>

<p>&nbsp;</p>
</body>
</html>
