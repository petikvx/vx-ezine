<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=windows-1251">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
<title>Top Device</title>
</head>

<body bgcolor="#B1B1B1" text="#000000" topmargin="0"
leftmargin="3">

<p><STYLE> </p>

<p>INPUT { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt
}</p>

<p>SELECT { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE:
8pt } </p>

<p>OPTION { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE:
8pt } </p>

<p>TEXTAREA { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE:
8pt } </p>

<p>FORM { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt
} <br>
BODY { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt } <br>
P { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt }
TABLE { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt
}TR { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt } TD
{ FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 10pt
}TEXTAREA { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE:
8pt } A { COLOR: #005500; TEXT-DECORATION: none }A:hover {
TEXT-DECORATION: underline } A:link { TEXT-DECORATION: none
}A:visited { }text:unknown { FONT-SIZE: 8pt } } </STYLE> </p>

<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td>&nbsp;</td>
        <td valign="top"><div align="center"><center><table
        border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
                <td width="100%" bgcolor="#000000"><img
                src="../-.gif" width="1" height="1"></td>
            </tr>
            <tr>
                <td width="100%" bgcolor="#808080"><strong>22.03.2000</strong>
                Stack polimorphic engine <strong>[Voodoo]</strong></td>
            </tr>
            <tr>
                <td bgcolor="#000000"><img src="../-.gif"
                width="1" height="1"></td>
            </tr>
            <tr>
                <td><pre>

 Приветствую тебя уважаемый  читатель. Речь в этой статье пойдет о 
полиморфизме.
Люди имевшие дело с полиморфизмом знают, что традиционным методом 
является создание  полиморфного расшифровщика. При этом  основной код 
шифруется. Существует еще один метод создания полиморфного кода, 
менее традиционный. 
Суть данного метода заключается в следующем:
генерируется  код результатом работы которого является появление
в стеке исходного кода. Далее передается управление в стек на 
исходную программу. Код который  дописывается к жертве выглядит 
примерно так:
<font color="#0000A0">
мусор
push 0xXXXXXXXX ; Последнее двойное слово исходного кода
мусор
push 0xXXXXXXXX
мусор
:
:
push 0xXXXXXXXX ; Первое двойное слово исходного кода
мусор
jmp esp
мусор</font>

Данный метод имеет свой плюсы и свои минусы.
К минусам можно отнести большой коэффициент увеличения кода. Так при
коэффициенте увеличения кода 4, исходный код в 1к преобразуется в 4к 
кода. И это не предел (Этот коэфициент можно менять в файле dinav2.inc).
К плюсам следует отнести высокую степень полиморфности. Она обусловлена
 тем что при данном подходе ограничения на &quot;мусор&quot; минимальны.К плюсам 
также следует отнести тот факт, что кодовая секция (в PE файле) в 
которую будет дописываться наш код может быть и ReadOnly. При этом 
многие антивирусы ничего не заподозрят.
Этот метод был реализован мной в виде процедуры  MakePolyImg в dinav2.inc файле.</pre>
                <pre>Параметрами этой процедуры является :
Esi=Смещение на исходный код
Edi=Смещение на буфер в котором генерируется полиморфный код
Ecx= Размер исходного кода.
Результатом работы является: 
edi=сгенерированный полиморфный код, 
eax=размер генерированного полиморфного кода. 
Пример использования DINA v2.0 находится в файле dinav2.asm
(c) Voodoo/SMF
<a href="http://smf.chat.ru">http://smf.chat.ru</a> 
</pre>
                </td>
            </tr>
            <tr>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;</td>
            </tr>
        </table>
        </center></div></td>
        <td>&nbsp;</td>
    </tr>
</table>

<p>&nbsp;</p>
</body>
</html>
