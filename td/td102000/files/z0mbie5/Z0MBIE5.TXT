
  
  Z0MBiE-5  --  and come what may!     (x) march-october 2000
  

  Я долго не хотел публиковать этот вирус, но,
  не пропадать же говну, в конце концов!

  Вирус представляет из себя незаконченно-неудавшуюся поделку.

  Изначальная маза была написать охуительно навороченный
  полиморфно-пермутирующий трепак, но, вышел облом:
  получилось слишком много кода,
  что в комбинации с многоуровневым стэковым полиморфиком
  дало глюки на многих исполнябельных файлах.

  Поэтому полиморфик пришлось убрать...
  а без него это просто RPME-пермутирующий вирус.
  Пермутация НАМНОГО лучше представлена в версиях 6a, 6b и 7.

  Теперь о собственно фичах этого трепака:

  - параллельная нить в текущем процессе ЛИБО перехват ExitProcess
  - рекурсивный скан дисков
  - explorer.exe через wininit
  - pe файл в последнюю секцию, ну и рандомно ее переименовать
  - старая точка входа в файл вставляется ВНУТРЬ пермутирующего кода
    (т.е. ее придется поискать ;-)
  - пересчет контрольной суммы через IMAGEHLP.DLL
  - code pervertor (немного произвращать оригинальные команды файла)
  - RAR/ZIP архивы
  - win9X: перейти в ноль, охуячить AV VxD & s-ice,
    переход через threadcontext либо cкан ldt
  - полное отсутствие в трепаке данных (генерация их кодом),
    а также всяких надписей в "чистом" виде
  - захеривание некоторых файлов надписью, расшифровываемой при помощи RSA
    (да откуда я знаю нахуй это надо!? так уж вышло... ;-)

  И, НАКОНЕЦ, ДВЕ НАИБОЛЕЕ ИНТЕРЕСНЫЕ ФИШКИ:

  - большинство частей вируса исполняются с рандомной вероятностью.
    в результате чего можно нехило наебнуться при трассировке, да и вообще
    это добавляет счастья при изучении "в живой природе".

  - "downgrade"
    многие части вируса выбрасываются из него, опять же по рандому.
    За счет RPME выброшенные куски затем начисто удаляются из кода.
    В результате для привязки сигнатур к инструкциям и прочего анализа
    придется еще чуть-чуть поебаться.


  - к вирусу прилагается дроппер (инсталлер), консольный отладчик,
    и прочее говно

  - ну и, кроме всего здесь описанного еще дохрена мелочей,
    о которых и писать-то лениво.
    И вообще, это описалово пишется спустя четыре месяца после
    скончания работы над трепаком. Копайте сорцы.

  - представленный PBRUSH.EX$ суть только первое поколение, без основных
    наворотов. Полученные из него экземпляры будут несколько хуже.

