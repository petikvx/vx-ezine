Вирусные тайфуны тоже получают женские имена

В Интернет зафиксирована очередная эпидемия
компьютерного вируса, однако клиенты "Лаборатории
Касперского" могут не беспокоиться 

В конце прошлой недели "Лаборатория Касперского" получила
тревожные сигналы об обнаружении нового макро-вируса,
получившего название Macro.Word97.Melissa. Первыми
пострадавшими от очередного компьютерного монстра
оказались читатели электронных конференций USENET, куда
злоумышленниками и был послан вирус. 

Являясь по своей сути очередным макро-вирусом, Melissa
отличается от своих "собратьев" необычно высокой скоростью
своего распространения, причем для рассылки своих копий
вирус использует возможности глобальной сети Интернет. Как
только вирус попадает на компьютер, он, пользуясь
возможностями встроенного в MS Office языка
программирования Visual Basic, открывает электронную почту
MS Outlook и тайно рассылает свои копии по адресам,
хранящимся в адресной книге. Это происходит посредством
создания сообщения под заголовком "Important Message From
[Имя Пользователя]". В теле письма содержатся строки: " Here
is that document you asked for ... don't show anyoneelse ;-)". В
нем также содержится зараженный вложенный файл,
представляющий собой документ Word, редактируемый на
зараженном компьютере в момент отсылки этого сообщения.
Нет необходимости объяснять, что таким образом с
компьютера неосторожного пользователя может произойти
утечка важной конфиденциальной информации. 

Таким образом, каждый зараженный компьютер "веером"
рассылает десятки вирусных копий другим пользователям
Интернет, что существенно ускоряет распространения вируса
и увеличивает опасность заражения. 

Вирус отличается также тем, что в нем предусмотрена
возможность размножения не только в популярном Microsoft
Word 8 (Office 97), но и его будущей версии - Microsoft Word 9
(Office 2000). 

"Лаборатория Касперского" сообщает пользователям AVP, что
причины для беспокойства нет: процедуры обнаружения и
удаления вируса уже добавлены в очередное обновление
антивирусной базы AVP. Воспользоваться им можно на
веб-сайте компании
http://www.kasperskylab.ru/bases/up990328.zip 


ТЕХНИЧЕСКИЕ ДЕТАЛИ 

Macro.Word97.Melissa 

Заражает файлы документов и шаблонов MS Word и
рассылает свои копии в сообщениях электронной почты при
помощи MS Outlook. Вирус распространяется чрезвычайно
быстро: процедура рассылки зараженных писем отсылает
большое количество вирусных копий по адресам из всех
списков адресной книги MS Outlook. Вирус также изменяет
системный реестр, выключает антивирусную защиту MS Word. 

Для рассылки своих копий через электронную почту вирус
использует возможность Visual Basic активизировать другие
приложения MS Windows и использовать их процедуры. Вирус
вызывает MS Outlook, считывает из базы адресов Outlook
адреса электронной почты и посылает по этим адресам
сообщение. Это сообщение содержит: 

Тема:
"Important Message From [UserName]" (UserName берется из
базы адресов) 

Тело письма:
"Here is that document you asked for ... don't show anyone else
;-)" 

К сообщению также присоединен документ (естественно
зараженный), причем вирус присоединяет тот документ,
который в данный момент редактируется (активный документ).
Как побочный эффект подобного распространения передаются
файлы пользователя, которые могут содержать
конфиденциальные данные. 

Количество рассылаемых писем зависит от конфигурации
адресной книги Outlook (базы адресов e-mail) на конкретном
компьютере. Вирус открывает каждый список в адресной книге
и отылает зараженное сообщение по 50 первым адресам из
каждого списка. Если в списке меньше 50 адресов, вирус
отсылает сообщение на все из них. Для каждого списка
создается одно зараженное письмо, поле адресата которого
содержит первые 50 адресов из списка. 

Вирус использует электронную почту для своего
распространения только один раз - для этого проверяется
специальная "метка" в системном реестре: 

 HKEY_CURRENT_USER\Software\Microsoft\Office\
 "Melissa?" = "... by Kwyjibo" 

 (строка "Kwyjibo", судя по всему, является
 зашифрованым (XOR 2Bh) текстом "`\RABID"). 

Если этот ключ не найден, то вирус посылает сообщения
электронной почты с приложенными зараженными
документами и создает этот ключ в реестре. 

Вирус способен распространяться не только в версии Word97,
но и в Word2000. Эта особенность вируса связана с
возможность Word2000 преобразовывать файлы старого
формата в новый при их открытии. При этом в новый формат
конвертируются все необходимые секции файла, включая
макро-программы (включая код вируса). Как результат, вирус
получает возможность распространяться в среде Word2000. 

При запуске вируса в Word 2000 он производит
дополнительные действия: выключает (устанавливает в
минимум) установки безопасности (антивирусную защиту). 

Код вируса хранится в одном макро модуле "Melissa" и состоит
из одной авто-процедуры: в зараженных документах это
"Document_Open", в NORMAL.DOT (область глобальных
макросов) - "Document_Close". Вирус заражает NORMAL.DOT
при открытии зараженного документа и записывается в другие
документы при их закрытии. При заражении вирус копирует
свой код построчно из зараженного объекта в файл-жертву. В
случае заражения области глобальных макросов вирус
переименовывает свою процедуру в "Document_Close", когда
же происходит заражение документов, то вирусная процедура
переименовывается в "Document_Open". В результе вирус
заражает Word при открытии зараженного документа, а при
закрытии других документов они, в свою очередь,
оказываются зараженными. 

Вирус также содержит процедуру-эффект, которая
срабатывает в случае если день равен минутам в момент
активации вирусного кода. Эта процедура вставляет
следующий текст в редактируемый документ: 

 Twenty-two points, plus triple-word-score, plus fifty points
 for using all my letters. Game's over. I'm outta here. 

Вмрус также содержит комментарии в своем коде: 

 WORD/Melissa written by Kwyjibo
 Works in both Word 2000 and Word 97
 Worm? Macro Virus? Word 97 Virus? Word 2000 Virus?
 You Decide!
 Word -> Email | Word 97 <--> Word 2000 ... it's a new
 age! 
