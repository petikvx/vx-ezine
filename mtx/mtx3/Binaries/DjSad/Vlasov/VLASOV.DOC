 ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ
                             MZ-EXE HEADER
 ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

    ÉÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»
    º ‘¬¥é¥­¨¥ º „«¨­  º                    Ž¯¨á ­¨¥                       º
    ÌÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
    º  +00h    º   2b  º à¨§­ ª EXE-ä ©«  (MZ).                           º
    º  +02h    º   2b  º „«¨­  ¯®á«¥¤­¥£® ¡«®ª  ä ©« .                     º
    º  +04h    º   2b  º „«¨­  ä ©«  ¢ 512-¡ ©â­ëå ¡«®ª å                  º
    º  +06h    º   2b  º —¨á«® í«¥¬¥­â®¢ ¢ â ¡«¨æ¥ ­ áâà®©ª¨  ¤à¥á®¢       º
    º  +08h    º   2b  º „«¨­  § £®«®¢ª  ¢ 16-¡ ©â­ëå ¯ à £à ä å.          º
    º  +0Ah    º   2b  º Œ¨­¨¬ «ì­ë© ®¡ê¥¬ ¯ ¬ïâ¨, ª®â®àãî ­ã¦­® ¢ë¤¥«¨âì  º
    º          º       º ¯®á«¥ ª®­æ  ¯à®£à ¬¬ë (¢ 16-¡ ©â­ëå ¯ à £à ä å).  º
    º  +0Ch    º   2b  º Œ ªá¨¬ «ì­ë© ®¡ê¥¬ ¯ ¬ïâ¨, ª®â®àãî ­ã¦­® ¢ë¤¥«¨âì º
    º          º       º ¯®á«¥ ª®­æ  ¯à®£à ¬¬ë (¢ 16-¡ ©â­ëå ¯ à £à ä å).  º
    º  +0Eh    º   2b  º ‘¥£¬¥­â áâ¥ª  (§­ ç¥­¨¥ SS).                      º
    º  +10h    º   2b  º ‘¬¥é¥­¨¥ áâ¥ª  (§­ ç¥­¨¥ SP).                     º
    º  +12h    º   2b  º Š®­âà®«ì­ ï áã¬¬ .                                º
    º  +14h    º   2b  º ‘¬¥é¥­¨¥ â®çª¨ ¢å®¤  (§­ ç¥­¨¥ IP).               º
    º  +16h    º   2b  º ‘¥£¬¥­â â®çª¨ ¢å®¤  (§­ ç¥­¨¥ CS).                º
    º  +18h    º   2b  º ‘¬¥é¥­¨¥ â ¡«¨æë ­ áâà®©ª¨  «à¥á®¢.               º
    º  +1Ah    º   2b  º ®¬¥à ®¢¥à«¥ï (0 - ¤«ï ª®à­¥¢®£® ¬®¤ã«ï).         º
    º  ....    º   ..  º ................................................. º
    º  +3Ch    º   4b  º ‘¬¥é¥­¨¥ § £®«®¢ª  NewEXE (®â ­ ç «  ä ©« ).      º
    ÈÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼









 ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ
             ”ŽŒ€’› …ŠŽ’Ž›• ŠŽŒ€„ (ˆ‘Ž‹œ‡“…’‘Ÿ ‚ Ž‹ˆŒŽ”ˆŠ…)
 ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

ÚÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ COM ³ ª®¬ ­¤          ³
³ REG ³ à¥£¨áâà         ³
³ R/M ³ à¥£¨áâà/¯ ¬ïâì  ³
³ D8  ³ 8-¡¨â­®¥ ç¨á«®  ³
³ D16 ³ 16-¡¨â­®¥ ç¨á«® ³
ÀÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

ÚÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄ¿
³     ³            ³               ³                ³   MOD=11  ³
³ R/M ³   MOD=00   ³    MOD=01     ³     MOD=10     ÃÄÄÄÄÄÂÄÄÄÄÄ´
³     ³            ³               ³                ³ W=0 ³ W=1 ³
ÃÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÅÄÄÄÄÄ´
³ 000 ³ DS:[BX+SI] ³ DS:[BX+SI+D8] ³ DS:[BX+SI+D16] ³ AL  ³  AX ³
³ 001 ³ DS:[BX+DI] ³ DS:[BX+DI+D8] ³ DS:[BX+DI+D16] ³ CL  ³  CX ³
³ 010 ³ SS:[BP+SI] ³ SS:[BP+SI+D8] ³ SS:[BP+SI+D16] ³ DL  ³  DX ³
³ 011 ³ SS:[BP+DI] ³ SS:[BP+DI+D8] ³ SS:[BP+DI+D16] ³ BL  ³  BX ³
³ 100 ³ DS:[SI]    ³ DS:[SI+D8]    ³ DS:[SI+D16]    ³ AH  ³  SP ³
³ 101 ³ DS:[DI]    ³ DS:[DI+D8]    ³ DS:[DI+D16]    ³ CH  ³  BP ³
³ 110 ³ DS:[D16]   ³ SS:[BP+D8]    ³ SS:[BP+D16]    ³ DH  ³  SI ³
³ 111 ³ DS:[BX]    ³ DS:[BX+D8]    ³ DS:[BX+D16]    ³ BH  ³  DI ³
ÀÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÙ

ÚÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄ¿   ÚÄÄÄÄÄÂÄÄÄÄÄ¿
³ REG ³ W=0 ³ W=1 ³   ³ COM ³     ³
ÃÄÄÄÄÄÅÄÄÄÄÄÅÄÄÄÄÄ´   ÃÄÄÄÄÄÅÄÄÄÄÄ´
³ 000 ³ AL  ³  AX ³   ³ 000 ³ ADD ³
³ 001 ³ CL  ³  CX ³   ³ 001 ³  OR ³
³ 010 ³ DL  ³  DX ³   ³ 010 ³ ADC ³
³ 011 ³ BL  ³  BX ³   ³ 011 ³ SBB ³
³ 100 ³ AH  ³  SP ³   ³ 100 ³ AND ³
³ 101 ³ CH  ³  BP ³   ³ 101 ³ SUB ³
³ 110 ³ DH  ³  SI ³   ³ 110 ³ XOR ³
³ 111 ³ BH  ³  DI ³   ³ 111 ³ CMP ³
ÀÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÙ   ÀÄÄÄÄÄÁÄÄÄÄÄÙ

ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ COMMAND R/M, REG ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

 0 0  COM  0 S W   MOD  REG   R/M
ÉÍÑÍËÍÑÍÑÍËÍËÍËÍ» ÉÍÑÍËÍÑÍÑÍËÍÑÍÑÍ»
ÈÍÏÍÊÍÏÍÏÍÊÍÊÍÊÍ¼ ÈÍÏÍÊÍÏÍÏÍÊÍÏÍÏÍ¼
 7 6 5 4 3 2 1 0   7 6 5 4 3 2 1 0


S=0 => COMMAND R/M, REG
S=1 => COMMAND REG, R/M

ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ COMMAND R/M, D ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

 1 0 0 0 0 0 S W   MOD  COM   REG
ÉÍÑÍÑÍÑÍÑÍÑÍËÍËÍ» ÉÍÑÍËÍÑÍÑÍËÍÑÍÑÍ»
ÈÍÏÍÏÍÏÍÏÍÏÍÊÍÊÍ¼ ÈÍÏÍÊÍÏÍÏÍÊÍÏÍÏÍ¼
 7 6 5 4 3 2 1 0   7 6 5 4 3 2 1 0

S=0 => D16 § ­¨¬ ¥â 2 ¡ ©â  (7F<D16<FF80)
S=1 => D16 § ­¨¬ ¥â 1 ¡ ©â  (0<=D16<=7F ¨«¨ FF80<=D16<=FFFF)
