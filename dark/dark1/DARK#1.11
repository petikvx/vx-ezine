
                   PLUGIN
                   ~~~~~~

Существует  множество вирусов реализующих идею  plugin.
Но остается  какой-то осадок. Необходимо стандартиризо-
вать структуру дополнений. Пусть любые два вируса несут
разный  код, но к ним можно будет подключать одни  и те 
же дополнения.

в дополнениях должно быть:
    - импорт функций
    - экспорт
    - контрольная сумма
    - флаги, указывающие на свойство дополнения
    - указатель на функцию дополнения
    - версия дополнения

Дополнение может быть как в виде exe модуля, так и в виде
кода.

Я составил такую структуру:  

type
    update=record
           signature: dword;  идентификатор
           length   : dword;  длина в байтах
           entry    : dword;  точка входа
           tentry   : dword;  точка в хода в нить
           flag     : dword;  флаги
           crc32    : dword;  контрольная сумма
           ver_1    : word;   функция дополнения
           ver_2    : word;   версия
end;

Надо   решить  будет   код   иметь атрибут для  записи.
Если код только для чтения, то это  ставит  проблему  с 
исправлением кода в памяти антивирусом.

Допустим,  на  входе    имеем 0 и генерируем уникальное
имя  12ABCF3. Заходим на  rambler.ru  и скачиваем   имя 
сайта, где находятся дополнения. Вместе  с дополнениями
идет RSA ключ для расшифровки. T.e.  для каждого набора 
дополнений имеется свой ключ. Выложить дополнения может 
любой желающий. Ведь никто не додумается закрыть 
rambler.ru ;)




