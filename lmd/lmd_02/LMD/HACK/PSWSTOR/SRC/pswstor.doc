┌──┌─┐┌──
──┘├─┘──┘ Presents
┐  ┌┐┐┌─┤ VMag, Issue 2, 1 June 1998
└─┘┘ ┘└─┘ ──────────────────────────

               WELCOME 2 PasswordStorer 4 Novell Network.
                    -- * -- * -- * -- * -- * -- * --
                             version 2.02
                [C] 1997 by Psychomancer aka Nice, SPS.
                           fido:2:454/5.9



0. Маскировка.

Для маскировки и затруднения обнаружения программ PswStor и PswView данные
программы при   каждом  запуске с вероятностью 1/2 производят ПЕРЕШИФРОВКУ
своего кода.  Поэтому не пугайтесь, если после запуска у них несколько из-
менится размер. Вы можете также переименовать указанные файлы, чтобы ваш
сетевой администратор не обнаружил их у вас поиском по имени (поиск по сиг-
натуре в виду непостоянного кода НЕВОЗМОЖЕН!).


1. Что это?

Данная программный пакет предназначен для сбора сетевых паролей пользова-
телей в локальных сетях Novell 3.xx/4.xx. В состав пакета входят:

PswStor.Com - программа, производящая "довешивание" подпрограммы сохранения
              пользовательских паролей на указанный COM или EXE файл.
PswView.Com - программа-декодировщик файла с сохраненными паролями, создавае-
              мого подпрограммой-сборщиком.
PswStor.Doc - настоящая документация.


2. Использование.

Формат вызова программы PswStor:

PswStor.Com philename pswlist
где:

philename    - имя программы в формате COM или EXE файла, к которой будет "до-
               вешена" подпрограмма сборки сетевых паролей пользователей.
pswlist      - полное имя+путь к файлу, в котором подпрограммой сборки будут
               сохраняться пользовательские пароли.
               ВНИМАНИЕ! Существование пути проверяется при инсталляции. Если
               путь задан неверно, то инсталляция прервется.

Пример: PswStor.Com ts.com D:\UTIL\USER\NEW\list.usr 

В данном случае к файлу Ts.Com будет приписана подпрограмма-сборщик паролей,
которая при запуске будет находить файл D:\UTIL\USER\NEW\list.usr, а при его
отсутствии, создавать его заново, и сохранять в нем в закодированном виде
имена пользователей и их пароли, входящих в сеть.

Формат вызова программы PswView:

PswView.Com pswlist
где:

pswlist      - имя файла, в котором подпрограммом-сборщиком были сохранены
               пароли и имена пользователей.

Пример: PswView.Com list.usr

В данном случае файл list.usr, в котором хранятся пароли и сетевые имена поль-
зователей будет дешифрован. Рекомендую переписать дешифрованный файл к себе на
диск и удалить его. Он будет затем повторно создан при инсталляции подпрограм-
мы-сборщика.


3. Принцип работы.

К указанному  пользователем файлу в формате COM или EXE дописывается закоди-
рованная подпрограмма-сборщик паролей. Причем к EXE файлам, имеющим внутренние
оверлеи подпрограмма-сборщик НЕ ДОПИСЫВАЕТСЯ в виду возможной потери файлом
работоспособности. Подпрограмма шифруется полиморфным генератором SMEG
(Simulated Metamorphic Encryption Generator by Black Baron v0.3), поэтому
контекстный поиск подпрограммы в файле НЕВОЗМОЖЕН. В теле подпрограммы сохраня-
ется путь к файлу, в котором будет производится сохранение паролей и имен
пользователей, входящих в сеть. При запуске такого COM или EXE файла происходит
инсталляция продпрограммы-сборщика в память компьютера (по возможности, в
область UMB). Причем резидентный блок НЕ ВИДЕН в меню просмотра карты памяти
Volkov Commander или Dos Navigator. Производится поиск файла, в котором будут
сохраняться пароли, а при его отсутсвии, он создается заново. После инсталляции
в памяти, подпрограмма-сборщик производит перехват пользовательских имен и
паролей и сохранение их в закодированном виде в указанном файле. Причем момент
входа в сеть определяется не по запуску программы LOGIN.EXE, а по вызову внут-
ренней системной функции, поэтому имя файла login может быть любым. Пароль
сохраняется только в том случае, если вход в сеть был осуществлен успешно.
Данный файл можно будет затем прочитать, дешифровав его программой PswView.Com.


4. Исправления.

В версию 2.02 внесены следующие изменения:

- повышена надежность работы для EXE - файлов.
- улучшены алгоритмы шифрования.
- улучшен алгоритм распределения UMB-памяти для подпрограммы-сборщика.
- введены антиэвристические приемы в раскодировке подрограммы-сборщика,
  поэтому сейчас Dr.Web не обнаруживает сборщик как COM.TSR.CRYPT.Virus.
- генератор TPE заменен на SMEG.

Благодарности:

Black Baron                 [UK]         - за генератор SMEG.
Alex Morshchakin aka Scout  2:454/2.15   - за моральную поддержку.


Пожелания и рекомендации по поводу улучшения работы программы и информацию
об обнаруженных ошибках ждем по адресу 2:454/5.9@FidoNet.

Успешной эксплуатации, Psychomancer aka Nice // SPS.
