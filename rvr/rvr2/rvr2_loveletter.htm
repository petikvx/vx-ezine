<HTML>
<HEAD>
  <TITLE>Russian Viral Review #2 : description of known versions I-Worm.LoveLetter</TITLE>
  <META content=Duke/SMF name=Author>
  <META content=smf2000@mail.ru name=Reply-to>
  <META content="SMF, Duke, Duke's Virus Labs, links, virii, virus" name=Keywords>
  <META content="text/html; charset=windows-1251" http-equiv=Content-Type>
</HEAD>
<BODY aLink=#b0ffff bgColor=#000000 link=#00c0ff text=#ffffff vLink=#0060ff>
<p>
<FONT color="cian" size=+1><U>Описание вируса VBS.LoveLetter</u></font>
<p>
Интернет/IRC/файловый вирус-червь, представляющий собой VBS-скрипт. 
Известно несколько модификаций вируса, которые обладают общими функциональными свойствами.
Вирус распространяется по IRC-каналам и по e-mail используя адресную книгу программы Outlook.
Subject и тело письма у отсылаемых писем статичны у каждой из модификаций.
Содержит в заголовке закомментированный текст.
<p>
<FONT color="cian" size=+1><U>Базовая (английская) версия (variant A [1,2]):</u></font><br>
<U>Закомментированный текст в заголовке:</u><br>
<pre>
barok -loveletter(vbe) < hate go to school> 
	by: spyder  /  ispyder@mail.com  /  @GRAMMERSoft Group  /  Manila,Philippines
</pre>
<U>Длина вируса в чистом виде:</u> 10307/10309 и 10583.
Вирусы различаются по длине из-за различия в способе задания перевода строки (ODh OAh и 0Dh 0Dh 0Ah соответственно); 
различия эти возникли естественным путем из-за попадания вируса на компьютеры с различными OS.
<br>
<U>Имя файла:</u> LOVE-LETTER-FOR-YOU.TXT.vbs <br>
<U>Subject:</u> "ILOVEYOU" <br>
<U>Тело письма:</u> "kindly check the attached LOVELETTER coming from me." <br>
<U>Описание работы:</u> 
После запуска вирус копируется в папки Windows под именами:<br>
%windir%\system\MSKernel32.vbs<br>
%windir%\Win32DLL.vbs<br>
%windir%\LOVE-LETTER-FOR-YOU.TXT.vbs<br>
Так же создает файл с именем LOVE-LETTER-FOR-YOU.HTM, который рассылает по IRC (для этого создается файл script.ini в директории mIRC).
Из интернета с одного из 4 сайтов выкачивается файл WIN-BUGSFIX.exe, содержащий программу-backdoor, который впоследствии инсталлируется на пораженном компьютере.
<br>
Создает в реестре ключи<br>
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\MSKernel32",dirsystem&"\MSKernel32.vbs<br>
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices\Win32DLL",dirwin&"\Win32DLL.vbs<br>
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\WIN-BUGSFIX",downread&"\WIN-BUGSFIX.exe<br>
которые отвечают за запуск вируса и троянского дополнения при включении компьютера.
<br>
Вирус копирует себя в *.VBS, *.VBE, *.js, *.jse, *.css, *.wsh, *.sct, *.hta, *.jpg, *.jpeg файлы,
для *.mp3, *.mp2 создает одноименные VBS-файлы. 
<br>
<U>Реакция антивирусов:</u> c 05-May-2000 детектируется AVP под именем I-Worm.LoveLetter
<p>
<hr>
<p>
<FONT color="cian" size=+1><U>Модифицированная (литовская) версия (variant B [3]):</u></font><br>
<U>Закомментированный текст в заголовке:</u><br>
<pre>
barok -loveletter(vbe) < hate go to school> 
	by: spyder  /  ispyder@mail.com  /  @GRAMMERSoft Group  /  Manila,Philippines
 Modified Lameris Tamoshius / Lithuania (Tovi systems)
</pre>
<U>Длина вируса в чистом виде:</u> 10399 <br>
<U>Имя файла:</u> LOVE-LETTER-FOR-YOU_TXT.vbs <br>
<U>Subject:</u> "Susitikim shi vakara kavos puodukui..." <br>
<U>Тело письма:</u> "kindly check the attached LOVELETTER coming from me." (не изменено)<br>
<U>Реакция антивирусов:</u> c 12-May-2000 детектируется AVP под именем I-Worm.LoveLetter
<p>
<hr>
<p>
<FONT color="cian" size=+1><U>Модифицированная (литовская) версия (variant B2 [4,5]):</u></font><br>
<U>Закомментированный текст в заголовке:</u><br>
<pre>
barok -loveletter(vbe) < hate go to school> 
	by: spyder  /  ispyder@mail.com  /  @GRAMMERSoft Group  /  Manila,Philippines
Modified Lameris Tamoshius / Lithuania (Tovi systems)
</pre>
<U>Длина вируса в чистом виде:</u> 7983/10365 (в конце вируса содержится массив пробелов, и у некоторых экземпляров вируса он "откушен").<br>
<U>Имя файла:</u> LOVE-LETTER-FOR-YOU_TXT.vbs <br>
<U>Subject:</u> "Susitikim shi vakara kavos puodukui..." <br>
<U>Тело письма:</u> "kindly check the attached LOVELETTER coming from me." (не изменено)<br>
<U>Комментарии:</u> Является переделанным "variant B [3]". Файл LOVE-LETTER-FOR-YOU.HTM не создается (на этом месте в вирусе находится массив пробелов).<br>
<U>Реакция антивирусов:</u> c 12-May-2000 детектируется AVP под именем I-Worm.LoveLetter
<p>
<hr>
<p>
<FONT color="cian" size=+1><U>Модифицированная версия (variant C [6]):</u></font><br>
<U>Закомментированный текст в заголовке:</u><br>
<pre>
 barok -loveletter(vbe) < hate go to school>
      by: spyder  /  ispyder@mail.com  /  @GRAMMERSoft Group  /  Manila,Philippines
</pre>
<U>Длина вируса в чистом виде:</u> 10194 <br>
<U>Имя файла:</u> LOVE-LETTER-FOR-YOU.TXT.vbs (на диске) & Very Funny.vbs (в аттаче)<br>
<U>Subject:</u> "fwd: Joke" <br>
<U>Тело письма:</u> отсутствует <br>
<U>Комментарии:</u> Является переделанным "variant A [1]". Рассылает по IRC файл с именем Very Funny.HTM <br>
<U>Реакция антивирусов:</u> c 06-May-2000 детектируется AVP под именем I-Worm.LoveLetter
<p>
<hr>
<p>
<FONT color="cian" size=+1><U>Модифицированная версия (variant D [7]):</u></font><br>
<U>Закомментированный текст в заголовке:</u> отсутствует<br>
<U>Длина вируса в чистом виде:</u> 10170/10172 <br>
<U>Имя файла:</u> LOVE-LETTER-FOR-YOU.TXT.vbs <br>
<U>Subject:</u> "ILOVEYOU" <br>
<U>Тело письма:</u> "kindly check the attached LOVELETTER coming from me." <br>
<U>Комментарии:</u> из вируса только удален комментарий, все остальное - без изменений. <br>
<U>Реакция антивирусов:</u> c 05-May-2000 детектируется AVP под именем I-Worm.LoveLetter
<p>
<hr>
<p>
<FONT color="cian" size=+1><U>Модифицированная версия (variant E [8]):</u></font><br>
<U>Закомментированный текст в заголовке:</u>
<pre>
hackers.com
by: hackers.com
</pre>
<U>Длина вируса в чистом виде:</u> 10004/10007 <br>
<U>Имя файла:</u> mothersday.vbs <br>
<U>Subject:</u> "Mothers Day Order Confirmation" <br>
<U>Тело письма:</u> " We have proceeded to charge your credit card for the amount of $326.92 for the mothers day diamond special. We have attached a detailed invoice to this email. Please print out the attachment and keep it in a safe place.Thanks Again and Have a Happy Mothers Day! mothersday@subdimension.com " <br>
<U>Комментарии:</u> ссылки переделаны на сайты http://www.hackers.com, http://www.l0pht.com, http://www.2600.com, http://www.hackers.com . 
Расылает по IRC файл mothersday.HTM <br>
<U>Реакция антивирусов:</u> c 06-May-2000 детектируется AVP под именем I-Worm.LoveLetter
<p>
<hr>
<p>
<FONT color="cian" size=+1><U>Модифицированная версия (variant F [9]):</u></font><br>
<U>Закомментированный текст в заголовке:</u>
<pre>
 barok -loveletter(vbe) < hate go to school>
			by: spyder  /  ispyder@mail.com  /  @GRAMMERSoft Group  /  Manila,Philippines
</pre>
<U>Длина вируса в чистом виде:</u> 10358 <br>
<U>Имя файла:</u> virus_warning.jpg.vbs <br>
<U>Subject:</u> "Dangerous Virus Warning" <br>
<U>Тело письма:</u> "There is a dangerous virus circulating.  Please click attached picture to view it and learn to avoid it." <br>
<U>Комментарии:</u> модификация вируса "variant A [1]" . Рассылает по IRC файл virus_warning.jpg.HTM <br>
<U>Реакция антивирусов:</u> c 06-May-2000 детектируется AVP под именем I-Worm.LoveLetter
<p>
<hr>
<p>
<FONT color="cian" size=+1><U>Модифицированная (немецкая) версия (variant [10]):</u></font><br>
<U>Закомментированный текст в заголовке :</u><br>
<pre>
Und noch so ein hдЯliches Ding
Construction with The Orginal Letter.A Vir
by Lucky2000

Hello all,,,Yes our PC are Infected...
</pre>
<U>Длина вируса в чистом виде:</u> 8814 <br>
<U>Имя файла:</u> Vir-Killer.vbs (Vir-Killer.TXT.vbs) <br>
<U>Subject:</u> "Yeah, Yeah another time to DEATH..." <br>
<U>Тело письма:</u> "This is the Killer for VBS.LOVE-LETTER.WORM." <br>
<U>Комментарии:</u> Вирус создан путем модификации литовской версии вируса длины 10365 "variant B2 [4]" (все строки "WIN-BUGSFIX" заменены на "Vir-Killer" и добавлена куча ошибок).
Модификацию делал идиот, который в вирусах ничерта не соображает :
<li> вирус пытается скачать файлы http://www.yahoo.com/Vir-Killer.exe, http://www.msn.com/Vir-Killer.exe, http://www.Hotmail.com/Vir-Killer.exe, http://www.Aol.com/Vir-Killer.exe, которых там нет и небыло, вместо того чтобы выкачивать бакдор
<li> вирус регистрирует в реестре вызов файлов MSKernel32.vbs и Win32DLL.vbs, забыв предварительно создать их (см. базовую версию)
<li> файл VIR-KILLER.HTM не создается по причине уничтоженного кода (см. модифицированную литовскую версию)
<br>
В отличие от базовой версии "variant A [1]" :
<li> портит файлы *.vbs, *.vbe, *.zip, *.rar, *.asm, *.pas
<li> не рассылает файлы по IRC
<br>
<U>Реакция антивирусов:</u> с 10-May-2000 детектируется AVP под именем I-Worm.LoveLetter.q
<p>
