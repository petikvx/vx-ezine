- [Duke's Virus Labs #9] - [Page 13] -

PMP Mutation Engine
(c) by Deviator/HAZARD

Duke/SMF написал довольно интерестный пермутатор на паскале - TPPE. Он по
структуре сложный и в исходниках большинство его кода просто дублируется.
Пермутация получалась относительно неплохой, однако для написания чего-то
сложного с использованием TPPE было не тривиальной задачей. Структура TPPE
базировалась на следующих принципах:
 - Trans (Take Random Switch) что в простонародии означает что мутатор
 модифицировал флаги компилятора (выравнивание данных на слово...etc)
 Весь код мутатора/вируса был напичкан подобными инструкциями:
 {$IFDEF ...}...{$ELSE}....{$ENDIF} благодаря чему собственно и проводилась
 пермутация. В результате получаем очень громоздкую конструкцию...
 - Pinc  (Permutation With Include)
 Модули TPPE находятся в виде включаемых файлов которые перемешиваются между
 собой.

 Я решил написать что-то свое подобное. Я взял два Duke'иных ноухау ;) но
в немного видоизмененном виде.
 - Trans используется только для директив компилятора (т.е. конструкции
   мутатора ее вообще не используют)
 - Pinc вроде использована в полной мере
 - Мусор добавляется по типу полиморфного генератора (сорца сделаны так,что
   после всех строк начинающихся с пробела можно вставлять мусор)

Вот так. Смотрите примеры (например HLLP PMP вируса)...


Deviator/HAZARD.

