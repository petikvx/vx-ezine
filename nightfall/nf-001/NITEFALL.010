 а мы вас сапогом part 2 "antisniff - и их мы поимеем..."            by seltorn

 группа lopht heavy industries выпустила очередную поделку в области security -
 antisniff. как обычно, много помпы и мало реальной пользы. из их заявлений as
 сможет определять все типы снифферов, сидящих в сети и читающих траффик. х$#@%
 ;) конечно, это творение остановить netxray или buttsniff, однако обойти мето-
 ды поиска снифающих хостов примитивно, об этом и статья. я провел 4 часа в ло-
 кальной сети, развлекаясь с antisniff и снифферами. методики обхода оказались
 достаточно просты.

 как же antisniff обнаруживает сниффинг? тремя методиками:

 1. всякие особенности ip стека операционок обычно проявляются в ethernet fra-
 me. если hwaddr отличается от hwaddr сниффающей машины, то пакеты не выкиды-
 ваются ядром при проходе, тем самым говоря "а я сниффер" :)

 2. достаточно продвинутые (по сравнению с детским уровнем) снифферы ответят на
 dns lookup о тех хостах, которые они сниффают. так что достаточно кинуть пару
 фэковых пакетов и voila! мы видим, как сниффер ищет фэйковые адреса.

 3. задержки. при обработке не своих пакетов снифферу приходиться обрабатывать
 их вручную, т.к. карта в promiscious mode. достаточно вылить в сеть кучу мусо-
 ра, затем попингать машины и будет видно, какая тормозит. этот пункт действи-
 тельно достаточно эффективен.

 как же можно избавиться от назойливых антиснифферов? можно добавить к снифферу
 утилиту по определению загрузки сети. если сеть загружена - сниффим спокойно,
 нас не заметят. если активность в сети падает - перестаем заниматься логгингом
 и засыпаем. если активность совсем падает - отключаем promiscious mode и сти-
 раем себя. это из простых методов. дальше сложнее.

 мы можем сделать машину стабильно пассивной, поменять ip-адрес и запустить if-
 config -arp и сидеть, тихо слушая траффик. так мы избавимся от 2-го и 3-го ме-
 тодов антисниффинга. теперь. оказывается братья наши lopht-овые гонят, причем
 очень сильно. ядро linux 2.2.10 прекрасно выкинет пакеты:/net/ipv4/ip_input.c.
 с другими системами - не знаю.

 вот и все мысли - вперед! да здраствует anti-anti-sniffing!!! ;)
