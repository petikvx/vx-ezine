 о междусеточном стелсинге                                         by napalmed

 недавно на #phrack в течении более 3-х дней горел флэйм о реальности/нереаль-
 ности полного междусеточного стелсирования, т.е. прятания себя злого. вернем-
 ся же еще раз к высказанным там умным мыслям, как за, так и против.

 dezibel: при переходах пакетов черех гейты x25-сеток параметры пакетов транс-
 ферного протокола меняются, пакеты дробятся, что часто приводит к порче "хит-
 рых" пакетов.

 хм. вот и первая мысль. действительно, при переходе например между sprintnet,
 консервой и инетом по цепочке достаточно часто энкапсулированые icmp-пакеты и
 калечатся, и даже иногда умирают. а это уже автоматом отсекает ряд DoS-атак.

 однако эта проблема легко решаема - достаточно найти вход в intranet какой-то
 крупной фирмы, осесть там, расколупать механизмы работы клиенсткого софта при
 не-прямой работе (т.е. через графический интерфейс, как например в виндовом и
 досовом клиентах фирмы Dialog, нынче уже Knight Ridder) и искать пути из этой
 сетки, по которым можно было бы посылать капсулы аля клиентский софт, которые
 бы на гейте разбивались, под ними обнаруживался следующий слой уже для следу-
 ющей сетки, и так пока мы не попадаем в нужную сеть.

 mona: это только кажеться, что отследить лоха сложно. по правде говоря, в на-
 шей фирме мы спокойно отслеживали человека из росии, ходящего через rosnet <>
 bt tymnet <> MCI <> Compuserve <> iNET. по колличеству сетей парень был пара-
 ноиком, но по качеству - хиляком. отслеживание проходило от гейта до близкого
 рутера, там уже ждали нового пакета и отслеживали его до следующего гейта. мы
 успели поймать его, пока он ковырялся у нас в системе в течении трех часов.

 нууу =) тут конечно сложнее. однако все равно это не сложно. достаточно иметь
 местный рутер, через который идет трафик от твоего хоста и похакать его. кис-
 ки всегда славились слабостью к любовным касаниям психически нездоровых инди-
 видуумов. поэтому мы просто у себя на рутере прописываем, что для нас рутинг-
 схема кастомная, после чего с чистыми руками меняем ее во время сессии сколь-
 ко угодно раз, при этом НЕ меняя гейта.

 есть другой вариант. мы можем фрагментировать у себя пакеты, пускать их через
 разные сети, а на входе в inet они бы собирались гейтом в один и шли куда на-
 до. при этом полной информации получить нельзя, т.к. после прохода гейта _из_
 inet-а мы уже не получим полного пакета, а неполный - недостаточное подтверж-
 дение работы хакера именно через этот гейт. но при малом колличестве фрагмен-
 тов все равно можно отследить все пути, при этом собрав полные пакеты. поэто-
 му вполне резонно будет во-первых рэндомно менять номера фрагментов, посылае-
 мых по данному пути, во-вторых иногда посылать тут 2 фрагмента в ряд, а там -
 фэйк с левым оффсетом, большим, чем контрольная сумма пакета. или, для особых
 ленивцев, мы можем просто сделать схемы прохода такими длинными, а колличест-
 во фрагментов таким большим, что люди просто обломаются все искать.

 sonyck: а что же делать, если мы хотим гнать оттуда/туда файл трансфер?

 UU+ROT13 спасет отца русской демократии и украинского хакерства =) пофрагмен-
 тировали и послали, это будет выглядеть как невинное общение клиентской проги
 и сервера.

 seltorn: НЕРЕАЛЬНО. ЗАЕБЕМСЯ :)

 реально. проверено. упаковано. продано. =)

 так все-таки о разработанном механизме работы с полной конфиденциальностью. в
 целях окончательного диверсионного извращения мы можем по дороге раздеть хост
 под unix-ом, пропихать ему pipe с дивайса на шелл, при этом расшифровывая за-
 шиврованные у нас пакеты. после хост ретранслирует их дальше. гейтим мы между
 сетками с разными протоколами, что часто уродует служебную информацию с прош-
 лой сетки. поэтому многослойность пакета должна быть мягко говоря непроницае-
 мой. при фрагментации стоит делать пару ложных фрагментов с одинаковым оффсе-
 том, и только потом с правильным. а затем можно посылать как бы "поверх" сот-
 ню неправильных фрагментов, при этом меняя контрольную сумму на единичку. че-
 ловеку это не сразу будет заметно, а вот место, где фрагменты собираются пош-
 лет "левые" фрагменты к черту. так что работайте господа и получайте удоволь-
 ствие от своей неотслеживаемости.
