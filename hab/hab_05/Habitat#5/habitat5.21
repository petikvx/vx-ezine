
▐█ █▐▀█▄▐▀█ ▀▐▀▀▌▀█▄▐▀▀▌    ▄▄▄█▀█
 █ █▐  █▐▄█▌█▐  ▄  █▐       █▄▄▄▄    ▄     Взлом щаровар
 █▄█▐▄▄█▐  █▐▐  █▄▄█▐       ▀   ▀█  
▐█ █▐▄ █▐▄██▐▐▄ █▄ █▐▄      ▀█▄▄█▀   ▀     (c) NeKr0!
==============================================================================


   Имеется ли на вашей машине какой-либо коварный шароварный софт? Или не 
шароварный, но все равно требующий регистрации? Да полюбому есть и надоедает
вам своими Nag-screen'ами или надписями типа "UNREGISTERED". Так вот будем 
бороться с этим. Представьте как будет рулезно, когда на компе все проги 
будут зареганы не на каких-то там мифических CORE, RiSC, Phrozen Crew и проч.
а на ваш коронный ник. Нет,я не собираюсь рассказывать где искать keygen'ы :)
Будем делать кейген сами.
   В качестве пациента выбрана найденная недавно мной утилита SuitForFile2.
В стародавние времена, когда Винды еще небыло, была утилита на подобие этой.
Она позволяет разбивать файл/файлы на куски заданного размера, работать с
группами файлов: переименовать, изменить аттрибуты и проч. В общем, довольно
полезная тулза для тех, у кого нет WinCommander'a (Total Commander'a) ;)

   Осмотр: после запуска мы видим в заголовке окна жалобную надпись, что
"ПРОГРАММА НЕ ЗАРЕГИСТРИРОВАННА", нас так и подгоняют убрать эту надпись ;)
На вкладке "Помощь" узнаем, что для регистрации нам надо раастаться с одним
у.ё. по системе WebMonkey ;) . Жуткое расточительство не украшает список на-
ших жутких достоинств, поэтому будем работать руками при помощи головы.
   Запускаем Soft-Ice. (Те, кто не знает что это такое и как его запускать -
уйдите куда нибудь подальше). Переходим на закладку регистрации. Так, нас
просят ввести Имя и Рег.номер. Вводим что-либо (например Имя: [NeKr0!] и но-
мер: 666-666-666). Ставим бряк на hmemcpy. Почему не на GetWindowTextA или
GetDlgItemTextA? Да потому что они работают через hmemcpy ;) . Нажимаем на
"Регистрацию" и попадаем в Soft-ice. Отключаем бряк (bd 0) и жмем F12 пока
не окажемся в теле программы, где-то в адресах 0042F972 где видим ret, т.е.
возврат из процедуры. По F8 трассируем пока не выйдем в саму программу гдето
в 00477853. Видим участок кода примерно такой:

   call xxxxx
   mov eax, [ebp-08] загрузка в eax указателя на первую группу введенных чисел
   call xxxx         после вызова этой процедуры мы получаем в eax число 29A
                     что как известно равно 29A=666
   mov edx,[ebp-04]  
   mov [edx+04C4],eax   сохраняем в памяти это число

   Далее идет обработка введенных групп чисел таким же образом, пока не дойдем
до такого участка кода:
  
            mov eax,[ebp-14] опять указатель на первую группу чисел
   04778BC  call xxx         ф-ция возвращает кол-во цифер в группе
            cmp eax,3        3 цифры в числе? Если да то продолжаем

Но вот облом:
   
   04778DA  call xxx
            cmp eax,4        Второе число должно быть из 4х(!) цифер :(

Снимаем бряки и выходим из проги. Начинам заново. Только теперь вводим код
666-6666-666. Ставим бряки, трассируем все то, что трассировали ранее. Теперь
введенный нами код соответствует шаблону. Идем, пока не попадаем вот в такое
место:

   047790F  mov eax, [ebp-4]         Указатель на шестнадцатиричное число
                                     равное 1й введенной тройке цифер
   0477912  fild dword ptr [eax+4C4h] высшая математика :)
   0477918  fdiv real4 ptr [477DA0]
   047791E  call xxx                  преобразование

После этого мы получаем в eax число 6. Ничего не напоминает ;) ? Точно, это
первая введенная нами цифра.

   0477923  mov ebx, eax
   0477925  mov eax, [ebp-4]
   0477928  mov [eax+4D0h], ebx    сохраняем число в памяти 
  
Дальше заполняем остальные ячейки числами. Но тут коварный автор решил видимо
заподлить нам и сохранять ячейки не по порядку, а в своем собственном порядке.
Типа так:    
               порядковый номер цифры      
                a        b        c      - 3 группы чисел
              1 2 3   4 5 6 7   8 9 10   - то что мы ввели

              1 5 8   2 6 9 3   7 10 4   - во что это превратилось

Типа замутил. Аж руки опускаются :) . Т.е. сейчас у нас есть таблица из чисел
которые мы ввели, но перемешанная вот таким образом. ...Идем дальше.
(Я буду называть числа так: a1 - первое число из первой группы, b1 - первое
число из 2й группы и т.д., я говорю про уже перемешанные числа). Видим:

   0477AAD  mov eax, [eax+4D0h]  берем число a1
   0477AB3  mov edx, [ebp-4]
   0477AB6  add eax, [edx+4DCh]  прибавляем к нему b1
   0477ABC  mov edx, [ebp-4]
   0477ABF  sub eax, [edx+4E8h]  вычитаем из их суммы b4
   0477AC5  cmp eax, 7           должно быть равно 7
   0477AC8  jnz xxx              если не равно - гневно ругаемся

Гениальная математика ;) a1+b1-b4=7 Далее:

   0477ACA  mov eax, [ebp-4]
   0477ACD  mov eax, [eax+4F4h]  c3
   0477AD3  mov edx, [ebp-4]
   0477AD6  sub eax, [edx+4D4h]  - a2
   0477ADC  mov edx, [ebp-4]
   0477ADF  mov edx, [edx+4E0h]  b2
   0477AE5  mov ecx, [ebp-4]
   0477AE8  sub edx, [ecx+4ECh]  - c1
   0477AEE  add eax, edx
   0477AF0  cmp eax, 7           =7

Типа такое равенство c3-a2+(b2-c1)=7 . Чувак в школе не зря учился ;))
Далее:

   0477AF8  mov eax, [eax+4D8h]  a3
   0477AFE  mov edx, [ebp-4]
   0477B01  sub eax, [edx+4E4h]  - b3
   0477B07  mov edx, [ebp-4]
   0477B0A  add eax, [edx+4F0h]  + c2
   0477B10  cmp eax, 7           =7

Угу. a3-b3+c2=7. Вот блин фанат семерок нашелся :)

   Вот собственно мы и получили алгоритм проверки ключа. Теперь осталось только
подобрать числа, чтоб равенства были правильными, размешать эти числа обратно.
И у нас будет ключ :) Обратно соответственно они перемешиваются так:

                a        b        c      - 3 группы чисел
              1 2 3   4 5 6 7   8 9 10   - типа наши подобранные числа

              1 4 7  10 2 5 8   3 6 9    - а так они должны стоять
            
Теперь должен получиться ключ. Я пораскинул мозгами и подставил такие числа:

8 3 5  2 6 2 3  4 4 3

8+2-3=7  8-3+(6-4)=7  5-2+4=7

Расставил числа по местам и полуил ключ:

 823-8364-524

Уф, аж считать устал :) . Все, теперь можно оформлять релиз, писать nfo'шку и
архивировать это все вместе. Nfo-файл можно оформить так:

======================[cut here]====================
    _       ____   _   _   _____   ____    _
   / \ /\  /  __\ / \_/ \ /   _ \ /    \  / \ 
  /   \  \/  _\  /     _//     _//   /  \/  /
 /       /   \__/      \/      \/   /   /\_/
 \___/\_/\_____/\___/\_/\___/\_/\______/ (_) 
 ============================================
 :................:Presents:................:      
 :......[Program: SuitForFile2       ]......:
 :.[Registration:                         ].:
 :.[ Name: [NEKR0!]                       ].:
 :.[  Key: 823-8364-524                   ].:
 :..........................................:
 ::.(x).2003.::::::::::::::::::::::.NeKr0!.::
======================[cut here]====================
(скромность - моё второе имя ;)

Или написать к нему кейген. Но я такая тварь ленивая, что писать его мне в 
падлу. Алгоритм я вам дал, так что дерзайте ;)

P.S: Вы сейчас увидели Reverse Engineering в действии. Мы без наличия исходного
     кода сумели восстановить алгоритм работы программы (ну пусть не всей прог-
     раммы, а одного куска, но очччень полезного куска ;) )

P.P.S: Если вы не поняли как я переставлял цифры - я вам сочувствую... :р







            Быстрый кряк.

   Вот недавно качнул еще прогу. "Патрульный ресурсов 4.00" называется. Прога 
прикольная, даже полезная, тока не зарегистрированная ;) 
   Запускаемм ее и видим главный экран и типа закладок на нем. При переходе с
закладки на закладку выскакивает MessageBox с текстом о бренности нашего бытия
и о том что следует в слезах и печали оплакать свою никчемную жизнь, т.к. не
родились мы с дебаггером в руках :) Придется и это исправить. Лезем в докумен-
тацию, чтоб узнать про регистрацию (типа каламбур :) ). Вощем после регистра-
ции нам типа пришлют рабочую версию проги. Но так ли это? Проверим ;). В самой
проге нет никаких менюшек с регистрацией..... хмм.. что делать? Чует мое боль-
шое сердце что дело касается реестра. Так-с, надо это проверить. Запускаем
APIspy и следим за работой проги. Закрываем прогу, сохраняем лог. Читаем лог.
Видим: прога пытается прочесть из реестра такой ключ:

  HKEY_CURRENT_USER\SOFTWARE\Zenith Technosoft\PR 4.00\Registration
   
   Лезем в реестр и ненаходим его там. Значит надо его создать ;)
Создаем. Опять запускаем APIspy. Смотрим лог. Ага!. Пытается прочесть из этого
ключа вот такие переменные: UserName и Key . Но ничего у проги не выходит, т.к.
нету их там. Но мы ей поможем ;) Создаем переменные и присваиваем им значения:

"UserName"="NeKr0!"
"Key"="HAHA-HAHA-HAHA"    (а что? очень хороший код, типа мы оценили чувство
                           юмора автора проги насчет регистрации)
 
   Пришло время Soft-ice'а. Запускаем, ставим бряк на RegQueryValueExA и пыта-
емся запустить прогу. Но так как эту API юзают все, кому не лень (и даже те,
кому лень ее юзают), то надо как-то узнать когда апишка  прочитает наши данные.
Поэтому после каждого останова делаем: s 0 L ffffff 'HAHA-HAHA-HAHA'
что обозначает поиск строки "HAHA-HAHA-HAHA" во всей памяти.(Я так чувствую что
вы заипётесь это от руки набирать каждый раз, поэтому вот вам хинт: введите это
один раз, потом просто набирайте букву s и жмите кнопку со стрелочкой вверх)
   После какого-то останова строчка найдена. Теперь самое время остановиться и
подумать. По идее сначала читается переменная UserName. Потом на ее основе дол-
жен генериться правильный ключ. Потом должна считаться переменная Key и срав-
ниваться с правильным ключом. Проверим:
 Включим окно дампа памяти (если оно не вкючено, наберите wd в soft-ice)
 Повторим s 0 L ffffff 'HAHA-HAHA-HAHA'
 Прокрутим окошко вверх/вниз для поиска ключа (alt+стрелка вверх/вниз)
 Где-то выше нашего неправильного ключа мы увидим строчку: 0001DB80-0003E4A4

   Похоже на ключ? Я тоже так думаю ;) Пробуем записать этот ключ в реестр.
Запускаем прогу. О чудо! Надоедливые MessageBox'ы при переключении закладок
исчезли! Аллилуйя!
   Все, можно оформлять еще один варезный релиз. Но чтоб глупый юзер не парился
пытаясь записать нужные строчки в реестр (все равно он где-то ошибется), мы
сделаем .reg файл, кликнув на котором мы заставим винду саму добавить информацию
в реестр. Вот он наш crack.reg :

======================[cut here]====================
REGEDIT4

[HKEY_CURRENT_USER\SOFTWARE\Zenith Technosoft\PR 4.00\Registration]
"UserName"="NeKr0!"
"Key"="0001DB80-0003E4A4"
======================[cut here]====================

   Усё, пакуем прогу, добавляем в архив nfo'шку и crack.reg . 




                Еще один быстрый кряк :)

   Есть у меня WinRAR 3.00 beta 4 . Так вот какой-то он странный :) . Мож он
уже был подломан? Т.к. во всех окнах написано что програма не зарегистрирована
и осталось типа 30 дней ее спокойно юзать. Но (!) количество оставшихся дней
почему-то не уменьшается изо дня в день... странно? :) Ага...
   Вобщем как-то достала она меня и решил я ее регнуть. По более ранним версиям
я знал что для регистрации у меня должен быть файл-ключ. Я запустил FileMon,
чтоб посмотреть к каким файлам обращается WinRAR. И было мне откровение, что
нужен ему rarreg.key . Okey, надо - так сделаем. И создал я текстовое файло из
нескольких строк. Типа вот так:
NeKr0!
NeKr0!
NeKr0!
   И стал я запускать сиё творение мысли человеческой, дабы взглянуть, как оно
ругаться будет на то, что ключ не верный......................................
.........................(тут идет мое охуевание....минуты две)...............
..............................................................................
WinRAR СТАЛ ЗАРЕГАННЫМ НА МЕНЯ!!!! .....Я в ауте.....



P.S.: Даже как то стыдно как-то :)






             Б. Гейтс "Бизнес со скоростью мысли"  
        Э-э-э. NeKr0! "Кряк с не меньшей скоростью"

    Последняя на сегодня прога... Была скачана с http://microlab.boom.ru
Типа настройщик системы. (надо было мне стрелочки с ярлыков поубирать, да вот
забыл я как это делается :) Прога, как вы догадались требует регистрации.....
А теперь внимание :) Кряк без дебаггеров и дизассемблеров! (типа смертельный
номер). Открываю я прогу на просмотр, дабы знать что перехватывать и тексты
посмотреть. Вижу что прога даже не запакована. Радуюсь. Делаю поиск строки про
регистрацию, типа "Regist"... Нахожу ее... Смотрю рядом... 8() ... Два ключа
лежат открытым текстом. Проверяю... Оба рабочие ключи :) Все!

HJ2U-VFS3-92YQ-XEPH
HJ68-X8F6-998O-OB66

   Даааа господа программеры, ну у вас и приходы... Да и чего еще можно ожидать
от программера, который даже по русски с ошибками пишет :) Интересно откуда он
эти ключи придумал? .... долго наверное думал :)))


P.S.: благодарю сайт www.download.ru за любезно предоставленные проги для 
      моего саморазвлечения, самообучения и самоуспокоения. (..Кстати это
      очень хороший способ занять время, когда нет никаких идей и ничего
      не хочется делать. Лезешь на этот сайт и качаешь проги, благо там
      сразу написанно требует прога регистрации или нет... Угадайте, какие
      проги я качал? ;) ...)


Greetz in random order:

        TranSpect      - хехе, задолбал топик менять ;)
        intuit         - заходи почаще :)
        $t0rm          - СПАСИБО!, хотя это плохо помогает ;).
        Gxp            - вы куда все поисчезали?

        и ещё привет тем особым людям с кем я чатился и которые 
        не любят светиться ;) . Кому надо, те поймут.


Все, утомился чепятать.... Буй вам всем.

(c) NeKr0! 2003
