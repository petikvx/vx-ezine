

        OvelOvelOvelOvelOvelOvelOvelOvelOvelOvelOvelOvelOvelOvelOvelOvel
        v                                                              v
        e       »OÆW«Â¤O¯f¬r¬ã¨s²ÕÂ´ ²Ä ‘D ´Á Âø»x      P.003          e
        l       [¯f¬r]                                                 l
        O                                                              O
        v       ¯f¬r±Ð¾Ç«ü«n (¶}¾÷¡BDTA)                Min Jean       v
        e       E-Mail: ovel.bbs@ntu.edu.tw                            e
        l                                                              l
        OvelOvelOvelOvelOvelOvelOvelOvelOvelOvelOvelOvelOvelOvelOvelOvel

    ±q¨S¼g¹L±Ð¾Ç¤å³¹ªº§Ú, ³o¦¸¤£ª¾¬°¦ó¦³³oºØ¿³­P, ©Ò¥H´N¼g¤F³o¨Ç°ò¥»ªº
±`ÃÑ, ¼H¼H....§Æ±æ³o½g¤å³¹¤£·|¹ï§A¤ÓÃø¤~¦n, §Ú¤w¸g¼g±o«D±`«D±`ªºÂ²³æ¤F
, ­Y§A¦A¤£¯à²z¸Ñªº¸Ü, §Ú´N¨S¦³¿ìªk¹Æ...:)


¡½  ¥H¤U¬O¹q¸£¾ã­Ó¨t²Îªº¶}¾÷¬yµ{¹Ï:
Á`¦@¦³¤T­Óµ{§ÇBIOS & partition/boot & DOS
¨ä¤¤ partition/boot µ{§Ç¬°§Ú¨S¼Ð¥Üªº¨º¤@¬q, ¦]¬°¨S¦³¦a¤è¼Ð¥Ü..
§Æ±æ¹ï¤j®a¦³©ÒÀ°§U, ­YµL¥ô¦ó§U¯q, ´N·í§@¬O¦bÁA¸Ñ§A±`±`§@ªºreboot µ{§Ç:)


   ---+---            ¢z¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢{
      |               ¢x        reboot          ¢x
      |               ¢|¢w¢w¢w¢w¢w¢s¢w¢w¢w¢w¢w¢w¢}
      |               ¢z¢w¢w¢w¢w¢w¢r¢w¢w¢w¢w¢w¢w¢{
      |               ¢x  ¶i¦æ¨t²Îªì©l¤Æ»P´ú¸Õ  ¢x
      |               ¢|¢w¢w¢w¢w¢w¢s¢w¢w¢w¢w¢w¢w¢}
  BOIS µ{§Ç           ¢z¢w¢w¢w¢w¢w¢r¢w¢w¢w¢w¢w¢w¢{
      |               ¢x´M§ä¨Ã°õ¦æªþ¥[ ROM µ{¦¡ ¢x
      |               ¢|¢w¢w¢w¢w¢w¢s¢w¢w¢w¢w¢w¢w¢}
      |               ¢z¢w¢w¢w¢w¢w¢r¢w¢w¢w¢w¢w¢w¢{
      |               ¢x bios post °õ¦æ int 19h ¢x
      |               ¢|¢w¢w¢w¢w¢w¢s¢w¢w¢w¢w¢w¢w¢}
   ---+---            ¢z¢w¢w¢w¢w¢w¢r¢w¢w¢w¢w¢w¢w¢{
              ¢z¢w¢w¢w¢t   int 19h load boot    ¢u¢w¢w¢w¢{
              ¢x      ¢|¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢}      ¢x
  ¢z¢w¢w¢w¢w¢w¢r¢w¢w¢w¢w¢w¢w¢{ have  H.D -> ¢z¢w¢w¢w¢w¢w¢r¢w¢w¢w¢w¢w¢w¢{
  ¢x        Floopy          ¢u¢w¢w¢w¢w¢w¢w¢w¢t       Hard Disk        ¢x
  ¢x    load & run boot     ¢u¢w¢w¢w¢w¢w¢w¢w¢t    load & run boot     ¢x
  ¢|¢w¢w¢s¢w¢w¢w¢w¢w¢w¢s¢w¢w¢}<- None H.D   ¢|¢w¢s¢w¢w¢w¢w¢w¢w¢w¢w¢w¢s¢}
¢z¢w¢w¢w¢r¢w¢w¢w¢{    ¢x              ¢z¢w¢w¢w¢w¢r¢w¢w¢w¢{  ¢z¢w¢w¢w¢r¢w¢w¢w¢{
¢x Run int 18h  ¢x    ¢|¢w¢w¢w¢w¢w¢s¢w¢tload & run boot ¢x  ¢x Run int 18h  ¢x
¢|¢w¢w¢w¢w¢w¢w¢w¢}                ¢x  ¢|¢w¢w¢w¢w¢w¢w¢w¢w¢}  ¢|¢w¢w¢w¢w¢w¢w¢w¢}
   ---+---            ¢z¢w¢w¢w¢w¢w¢r¢w¢w¢w¢w¢w¢w¢{
      |               ¢x boot load & run io.sys ¢x
      |               ¢|¢w¢w¢w¢w¢w¢s¢w¢w¢w¢w¢w¢w¢}
      |             ¢z¢w¢w¢w¢w¢w¢w¢r¢w¢w¢w¢w¢w¢w¢w¢{
      |             ¢xio.sys load & rnu msdos.sys ¢x
      |             ¢|¢w¢w¢w¢w¢w¢w¢s¢w¢w¢w¢w¢w¢w¢w¢}
      |           ¢z¢w¢w¢w¢w¢w¢w¢w¢r¢w¢w¢w¢w¢w¢w¢w¢w¢{
      |           ¢xmsdos.sys load & run config.sys ¢x
   DOS µ{§Ç       ¢|¢w¢w¢w¢w¢w¢w¢w¢s¢w¢w¢w¢w¢w¢w¢w¢w¢}
      |               ¢z¢w¢w¢w¢w¢w¢r¢w¢w¢w¢w¢w¢w¢{
      |               ¢x load & run command.com ¢x
      |               ¢|¢w¢w¢w¢w¢w¢s¢w¢w¢w¢w¢w¢w¢}
      |               ¢z¢w¢w¢w¢w¢w¢r¢w¢w¢w¢w¢w¢w¢{
      |               ¢x load & run autoexec.bat¢x
      |               ¢|¢w¢w¢w¢w¢w¢s¢w¢w¢w¢w¢w¢w¢}
      |               ¢z¢w¢w¢w¢w¢w¢r¢w¢w¢w¢w¢w¢w¢{
      |               ¢xok. §¹¦¨¶}¾÷µ{§Ç¤F....:)¢x
   ---+---            ¢|¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢}

¬Ý§¹¤F¬yµ{¹Ï, ¬O§_¦³§ó²`¤JªºÁA¸Ñ reboot ©Ò§@ªº°Ê§@¤F©O??


¡½  ¦n¤F, ²{¦bÅý§Ú­Ì¨Ó¬Ý¬Ýpartition & boot ºÏ°Ï:
    bios ¤¤ªº¤¤Â_ªA°Èµ{¦¡int 19h Åª¨ú²Ä¤@³¡³nºÐªº²Ä0ºÏ­y²Ä0ºÏ­±²Ä1ºÏ°Ï,
©ÎÅª¨ú²Ä¤@³¡µwºÐªº²Ä0ºÏ¬W,²Ä0ºÏ­±,²Ä1ºÏ°Ï, ¨Ã±N±±¨îÅv¥æ¨ìºÏ°Ï¤Wªºµ{¦¡¡C
²{¦b¦A¨ÓªÈ¥¿¤j®a¤@¨Ç°ò¥»Æ[©À, ³nºÐ¤Wªº²Ä¤@­Ó¹ê»ÚºÏ°Ïªº¦s©ñµÛboot µ{¦¡,
©Ò¥HÅª¶iªº´N¬Oboot µ{¦¡, ¦ý¬OµwºÐ©O? ¨þ¨þ..´N¤£¬O³o¼Ë¹Æ,µwºÐªº²Ä¤@­Ó
¹ê»ÚºÏ°Ï¨Ã«D¬O¦s©ñµÛboot µ{¦¡, ¦Ó¬Opartition ºÏ°Ï, ¤º§tload_boot µ{¦¡
¤Î1¡ã4Äæªºpartition table, ©Ò¥H·í¦³µwºÐ¦s¦b®É int 19h ©ÒÅª¨ìªº¨Ã¤£¬O
boot µ{¦¡, ¦Ó¬O¤@­Óload_boot µ{¦¡, ¸g¥Ñlood_boot °Ñ·Ó¦P¤@ºÏ°Ïªºparti-
tion table ¤ºªº¸ê®Æ, §ä¨ìµwºÐªºboot ºÏ°Ï, ¦A¨úÅªboot ºÏ°Ï,¨Ã±N±±¨îÅv
Âà¥æµ¹boot µ{¦¡, ¤~§¹¦¨load boot¡C

    ¬Ý§¹¤Fpartition & boot °ò¥»Æ[©À«á, ¬O§_ªÈ¥¿¤F§A¤@¨Ç¿ù»~ªºÆ[©À©O??
­Y¨S¦³, ¨º´N¥Nªí§AªºÆ[©À«D±`ªº¥¿½T, ½ÐÄ~Äò«O«ù..:)

    ¥H«á­Y¦³¤H°Ý§Afdisk /mbr ¬O§@¤°»òªº, §A¯à¥¿½T¦^µª¤F¶Ü??
ok, ´N¥ý¬°°ò¥»ªº¤¶²Ð¨ì¦¹§i¤@­Ó¬q¸¨, ¦Ü©ópartition & boot µ²ºc, ½Ð°Ñ¦Ò
«e´X´ÁÂø»x¡C

¡½  ³Ì«á¦A¨Ó§i¶D¤j®aint n ¦b¦V¶qªí¤¤ªº°_©l¦ì§}©Mcs:ip ¦ì§}:
§A¥i¥H§@¤@­Ó¹êÅç..

debug
-a
xxxx:xxxx int 21
-d
-q

Åã¥Üªºµ²ªG¤¤§A·|µo²{int 21 ÅÜ¬°cd21
¶â, ¦A¨Ó§@¤@¦¸

debug
-a
xxxx:xxxx int 13
-d
-q

®@, ³o¦¸ªºint 13 ÅÜ¬°cd13 !
§A¬O§_¦³µoÄ±¦³¤°»ò¦@¦PÂI¶Ü??
¨S¿ù, int ³£ÅÜ¬°cd ¦Ó¤¤Â_n ÁÙ¬O¨SÅÜ...¦ý³o¤£¬O³Ì­«­nªº, ¥D­nªº¬O¥L­Ì³£
¦U¦û¥|­Ó¦ì¤¸²Õ, ³o¼Ë§A´N¯à¨Ì·Ó³o­Ó±À¥X¤@®M¤½¦¡:
int n ¦s©ñ¦ì§} = 4 * n ³o¼Ë§AÀ´¤F§a?? §Ú·Q§A·|À´ªº..:)
¦n¤F, ¦b§AÁA¸Ñint nªº¤¤Â_¦V¶qªí°_©l¦ì§}, ¤]ª¾¹Dint n ¥L­Ì¦U¦û¥|­Ó¦ì¤¸²Õ
, ¨º§A¦³¨S¦³·Q¹L³o¥|­Ó¦ì¤¸²Õ¥Nªí¤°»ò??
²{¦b´N¨Ó§i¶D¤j®a³o¥|­Ó¦ì¤¸²Õªº·N¸q, ¨ä¹ê¥L´N¥Nªí¤¤Â_µ{¦¡©Ò¦bªº°O¾ÐÅé¦ì§}
[offset low byte] [offset high byte] [segment low byte] [segment high byte]
¥Ñ¤W­±§Ú­Ì¤S¥i¥H¦A±À¥X¦U­Ó¦ì¤¸²Õªº¤½¦¡:

int n [offset low byte] = ip low byte = (4 * n)
int n [offset high byte] = ip high byte = (4 * n + 1)
int n [segment low byte] = cs low byte = (4 * n + 2)
int n [segment high byte] = cs high byte = (4 * n + 3)

¦]¦¹§Ú­Ì¥i¥H¥Ñ¤W­±±oÃÒ

int n ªº cs:ip = (4*n+3 4*n+2 : 4*n+1 4*n)

³o¼Ë,§A´N¾å±o­n«ç»òºâ¤F§a...:)
®@..¹ï¤F, §Ñ¤F§i¶D¤j®a¡u¥ýoffset ¦Ó«á segment ¥B¥ý°ª¦ì¤¸ ¦Ó«á §C¦ì¤¸¡v®@ !

¡½ DTA (Disk Transfer Area) information ¡½

    ±`±`¬Ý¨ì¯f¬r¨Ï¥ÎDTA ¦Ó¤£ª¾¹DDTA ¨ì©³¬O¤°»ò?
²{¦bDTA ªº¸ê®Æ´N¦b²´«e, ¤£¥Î§Ú§i¶D§A«ç»ò¥Î§a??
¨þ¨þ...DTA ¥i¦n¥Îªº«Ü©O, °Ê°Ê¸£¤l§a..:)

====================================================
Offset       Size        Contents
====================================================
  00         Byte        Drive letter
 01-0B       Bytes       Search template
 0C-14       Bytes       Reserved
  15         Byte        File attribute
 16-17       Word        File time
 18-19       Word        File date
 1A-1D       DWord       File size
 1E-3A       Bytes       ASCIIZ filename + extension
====================================================


¡½ µ²§ô ¡½
    ¬Ý§¹¤F¥»½gªº°ò¥»¤¶²Ð, ¦³±o¨ì¨Ç¤°»ò¶Ü??
    ¨þ¨þ....¦n¦nªº¾Ç²ß§a..:)
