@echo off
REM ษออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
REM บ This batch file is intended to run McAfee's SCAN v2.x and echo any บ
REM บ error messages back to the users screen for diagnostic purposes    บ
REM บ         Written by: DJ TECH @ McAfee PSET June 1995                บ
REM ศออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
CLS
echo ษออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ                        **  ATTENTION  **                           บ
echo บ         Scanning your local drives before allowing login!          บ
echo บ            Written by: DJ TECH @ McAfee PSET June 1995             บ
echo ศออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo .
REM SCAN C:\ WILL JUST SCAN MBR AND ROOT DIRECTORY FOR VIRUSES
REM SCAN /ADL /NOBREAK WILL SCAN MBR AND WHOLE HARD DRIVE FOR VIRUSES
REM SCAN /ADL /NOBREAK
REM SCAN C:\ /ALL /PAUSE /REPORT k:lastscan.rpt /frequency 4 
O:\SCAN C: /NOBREAK /PAUSE /report k:lastscan.rpt 
if errorlevel 21 goto error21
if errorlevel 20 goto error20
if errorlevel 18 goto error18
if errorlevel 17 goto error17
if errorlevel 16 goto error16
if errorlevel 15 goto error15
if errorlevel 14 goto error14
if errorlevel 13 goto error13
if errorlevel 12 goto error12
if errorlevel 11 goto error11
if errorlevel 10 goto error10
if errorlevel 9 goto error9
if errorlevel 8 goto error8
if errorlevel 7 goto error7
if errorlevel 6 goto error6
if errorlevel 5 goto error5
if errorlevel 4 goto error4
if errorlevel 3 goto error3
if errorlevel 2 goto error2
if errorlevel 1 goto error1
if errorlevel 0 goto error0
goto end

:error21
echo.
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  WARNING  ***                        ***  NON-CRITICAL ERROR  ***  บ
echo บ A "system" error has occured while SCANNING your local drives for viruses.บ
echo บ Please refer to your documentation or contact Trimble's Help Desk.        บ
echo ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
echo บ ErrorLevel=21+                                                            บ
echo บ                                                                           บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
pause
echo ---------------------------------------------------------------------      >>K:SCAN.LOG
z:\SYSTIME                                                                      >>K:SCAN.LOG
echo A "system" error has occured while SCANNING your local drives for viruses. >>K:SCAN.LOG 
echo ErrorLevel 21 occured at above date / time                                 >>K:SCAN.LOG
echo ----------------------------------------------------------------------     >>o:\viruslog\allscan.log
z:\SYSTIME                                                                      >>o:\viruslog\allscan.log
echo A "system" error has occured while SCANNING your local drives for viruses. >>o:\viruslog\allscan.log
echo ErrorLevel 21 occured at above date / time on User %log_name%              >>o:\viruslog\allscan.log
echo %log_name% is located at station number %station%                          >>o:\viruslog\allscan.log 
echo.
goto END

:error20
echo.
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  WARNING  ***                        ***  NON-CRITICAL ERROR  ***  บ
echo บ The SCANNING /FREQUENCY is set to ON and your last SCAN falls within an   บ
echo บ acceptable time frame.                                                    บ
echo ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
echo บ ErrorLevel=20                                                             บ
echo บ                                                                           บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
rem pause
goto AFTEREND

:error18
echo.
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  WARNING  ***                                  ***  ERROR  ***     บ
echo บ An error has occured while SCANNING your local drives for viruses.        บ
echo บ Please refer to your documentation or contact Trimble's Help Desk.        บ
echo ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
echo บ A validation file has been modified (/CF or /CV options).                 บ
echo บ ErrorLevel=18                                                             บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo.
pause
echo ----------------------------------------------------------------------     >>K:SCAN.LOG
z:\SYSTIME                                                                      >>K:SCAN.LOG
echo A validation file has been modified (/CF or /CV options).                  >>K:SCAN.LOG
echo ErrorLevel 18 occured at above date / time                                 >>K:SCAN.LOG
echo ----------------------------------------------------------------------     >>o:\viruslog\allscan.log
z:\SYSTIME                                                                      >>o:\viruslog\allscan.log
echo A validation file has been modified (/CF or /CV options).                  >>o:\viruslog\allscan.log
echo ErrorLevel 18 occured at above date / time on User %log_name%              >>o:\viruslog\allscan.log
echo %log_name% is located at station number %station%                          >>o:\viruslog\allscan.log 
echo.
goto END

:error17
echo.
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  WARNING  ***                                  ***  ERROR  ***     บ
echo บ An error has occured while SCANNING your local drives for viruses.        บ
echo บ Please refer to your documentation or contact Trimble's Help Desk.        บ
echo ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
echo บ No drive, directory or file was specified; nothing to scan.               บ
echo บ ErrorLevel=17                                                             บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo.
pause
echo ----------------------------------------------------------------------     >>K:SCAN.LOG
z:\SYSTIME                                                                      >>K:SCAN.LOG  
echo No drive, directory or file was specified; nothing to scan.                >>K:SCAN.LOG  
echo ErrorLevel 17 occured at above date / time                                 >>K:SCAN.LOG
echo ----------------------------------------------------------------------     >>o:\viruslog\allscan.log
z:\SYSTIME                                                                      >>o:\viruslog\allscan.log
echo No drive, directory or file was specified; nothing to scan.                >>o:\viruslog\allscan.log  
echo ErrorLevel 17 occured at above date / time on User %log_name%              >>o:\viruslog\allscan.log
echo %log_name% is located at station number %station%                          >>o:\viruslog\allscan.log 
echo.
goto END
        
:error16
echo.
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  WARNING  ***                                  ***  ERROR  ***     บ
echo บ An error has occured while SCANNING your local drives for viruses.        บ
echo บ Please refer to your documentation or contact Trimble's Help Desk.        บ
echo ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
echo บ An error occured while accessing a specified drive or file.               บ
echo บ ErrorLevel=16                                                             บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo.
pause
echo ----------------------------------------------------------------------     >>K:SCAN.LOG
z:\SYSTIME                                                                      >>K:SCAN.LOG
echo An error occured while accessing a specified drive or file.                >>K:SCAN.LOG
echo ErrorLevel 16 occured at above date / time                                 >>K:SCAN.LOG
echo ----------------------------------------------------------------------     >>o:\viruslog\allscan.log
z:\SYSTIME                                                                      >>o:\viruslog\allscan.log
echo An error occured while accessing a specified drive or file.                >>o:\viruslog\allscan.log
echo ErrorLevel 16 occured at above date / time on User %log_name%              >>o:\viruslog\allscan.log
echo %log_name% is located at station number %station%                          >>o:\viruslog\allscan.log 
echo.
goto end

:error15
echo.
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  WARNING  ***                                  ***  ERROR  ***     บ
echo บ An error has occured while SCANNING your local drives for viruses.        บ
echo บ Please refer to your documentation or contact Trimble's Help Desk.        บ
echo ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
echo บ VirusScan self-check failed. It may be infected or damaged.               บ
echo บ ErrorLevel=15                                                             บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo.
pause
echo ----------------------------------------------------------------------     >>K:SCAN.LOG
z:\SYSTIME                                                                      >>K:SCAN.LOG
echo VirusScan self-check failed. It may be infected or damaged.                >>K:SCAN.LOG
echo ErrorLevel 15 occured at above date / time                                 >>K:SCAN.LOG
echo ----------------------------------------------------------------------     >>o:\viruslog\allscan.log
z:\SYSTIME                                                                      >>o:\viruslog\allscan.log
echo VirusScan self-check failed. It may be infected or damaged.                >>o:\viruslog\allscan.log
echo ErrorLevel 15 occured at above date / time on User %log_name%              >>o:\viruslog\allscan.log
echo %log_name% is located at station number %station%                          >>o:\viruslog\allscan.log 
echo.                                                                           
goto end

:error14
echo.
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  WARNING  ***                                  ***  ERROR  ***     บ
echo บ An error has occured while SCANNING your local drives for viruses.        บ
echo บ Please refer to your documentation or contact Trimble's Help Desk.        บ
echo ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
echo บ The SCAN.DAT file is out of date; upgrade VirusScan data files.           บ
echo บ ErrorLevel=14                                                             บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo.
pause
echo ----------------------------------------------------------------------     >>K:SCAN.LOG
z:\SYSTIME                                                                      >>K:SCAN.LOG
echo The SCAN.DAT file is out of date; upgrade VirusScan data files.            >>K:SCAN.LOG
echo ErrorLevel 14 occured at above date / time                                 >>K:SCAN.LOG
echo ----------------------------------------------------------------------     >>o:\viruslog\allscan.log
z:\SYSTIME                                                                      >>o:\viruslog\allscan.log
echo The SCAN.DAT file is out of date; upgrade VirusScan data files.            >>o:\viruslog\allscan.log
echo ErrorLevel 14 occured at above date / time on User %log_name%              >>o:\viruslog\allscan.log
echo %log_name% is located at station number %station%                          >>o:\viruslog\allscan.log 
echo.
goto end

:error13
echo.
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  WARNING  ***                                  ***  VIRUS  ***     บ
echo บ An error has occured while SCANNING your local drives for viruses         บ
echo บ Please refer to your documentation or contact Trimble's Help Desk.        บ
echo ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
echo บ One or more viruses were found in the master boot record, or boot sector, บ
echo บ or a virus(s) were found in the files listed.                             บ
echo บ ErrorLevel=13                                                             บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo.
pause
echo ----------------------------------------------------------------------     >>K:SCAN.LOG
z:\SYSTIME                                                                      >>K:SCAN.LOG
echo Virus(s) were found in the MBR or LBS, or were found in the files listed.  >>K:SCAN.LOG
echo ErrorLevel 13 occured at above date / time                                 >>K:SCAN.LOG
echo ----------------------------------------------------------------------     >>o:\viruslog\allscan.log
z:\SYSTIME                                                                      >>o:\viruslog\allscan.log
echo Virus(s) were found in the MBR or LBS, or were found in the files listed.  >>o:\viruslog\allscan.log
echo ErrorLevel 13 occured at above date / time on User %log_name%              >>o:\viruslog\allscan.log
echo %log_name% is located at station number %station%                          >>o:\viruslog\allscan.log 
echo.
goto NOTINMEM
                  
:error12
echo.
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  WARNING  ***                                  ***  ERROR  ***     บ
echo บ An error has occured while SCANNING your local drives for viruses.        บ
echo บ Please refer to your documentation or contact Trimble's Help Desk.        บ
echo ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
echo บ An error occured while attempting to remove a virus, such as no           บ
echo บ CLEAN.DAT file found, or VirusScan was unable to remove the virus.        บ
echo บ ErrorLevel=12                                                             บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo.
pause
echo ----------------------------------------------------------------------     >>K:SCAN.LOG
z:\SYSTIME                                                                      >>K:SCAN.LOG
echo Error removing a virus, such as no CLEAN.DAT, unable to remove the virus.  >>K:SCAN.LOG       
echo ErrorLevel 12 occured at above date / time                                 >>K:SCAN.LOG
echo ----------------------------------------------------------------------     >>o:\viruslog\allscan.log
z:\SYSTIME                                                                      >>o:\viruslog\allscan.log
echo Error removing a virus, such as no CLEAN.DAT, unable to remove the virus.  >>o:\viruslog\allscan.log       
echo ErrorLevel 12 occured at above date / time on User %log_name%              >>o:\viruslog\allscan.log
echo %log_name% is located at station number %station%                          >>o:\viruslog\allscan.log 
echo.
goto end
                  
:error11
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  WARNING  ***                                  ***  ERROR  ***     บ
echo บ An error has occured while SCANNING your local drives for viruses.        บ
echo บ Please refer to your documentation or contact Trimble's Help Desk.        บ
echo ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
echo บ An internal program error occurred.                                       บ
echo บ ErrorLevel=11                                                             บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo.
pause
echo ----------------------------------------------------------------------     >>K:SCAN.LOG
z:\SYSTIME                                                                      >>K:SCAN.LOG
echo An internal program error occurred.                                        >>K:SCAN.LOG
echo ErrorLevel 11 occured at above date / time                                 >>K:SCAN.LOG
echo ----------------------------------------------------------------------     >>o:\viruslog\allscan.log
z:\SYSTIME                                                                      >>o:\viruslog\allscan.log
echo An internal program error occurred.                                        >>o:\viruslog\allscan.log
echo ErrorLevel 11 occured at above date / time on User %log_name%              >>o:\viruslog\allscan.log
echo %log_name% is located at station number %station%                          >>o:\viruslog\allscan.log 
echo.
goto end

:error10
echo.
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  WARNING  ***                                  ***  VIRUS  ***     บ
echo บ A virus found in memory this could be an actual virus or traces left from บ
echo บ a prior operation. Possibly a false alarm generated by a conflict or TSR. บ
echo บ Please refer to your documentation or contact Trimble's Help Desk.        บ
echo ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
echo บ A virus was found in memory.                                              บ
echo บ ErrorLevel=10                                                             บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo.
pause
echo ----------------------------------------------------------------------     >>K:SCAN.LOG
z:\SYSTIME                                                                      >>K:SCAN.LOG
echo A virus was found in memory.                                               >>K:SCAN.LOG 
echo ErrorLevel 10 occured at above date / time                                 >>K:SCAN.LOG
echo ----------------------------------------------------------------------     >>o:\viruslog\allscan.log
z:\SYSTIME                                                                      >>o:\viruslog\allscan.log
echo A virus was found in memory.                                               >>o:\viruslog\allscan.log 
echo ErrorLevel 10 occured at above date / time on User %log_name%              >>o:\viruslog\allscan.log
echo %log_name% is located at station number %station%                          >>o:\viruslog\allscan.log 
echo.
goto critical

:error9
echo.
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  WARNING  ***                                  ***  ERROR  ***     บ
echo บ An error has occured while SCANNING your local drives for viruses.        บ
echo บ Please refer to your documentation or contact Trimble's Help Desk.        บ
echo ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
echo บ Incompatible or unrecognized option(s) or arguements were specified       บ
echo บ ErrorLevel=9                                                              บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo.
pause
echo ----------------------------------------------------------------------     >>K:SCAN.LOG
z:\SYSTIME                                                                      >>K:SCAN.LOG
echo Incompatible or unrecognized option(s) or arguements were specified        >>K:SCAN.LOG
echo ErrorLevel 9 occured at above date / time                                  >>K:SCAN.LOG
echo ----------------------------------------------------------------------     >>o:\viruslog\allscan.log
z:\SYSTIME                                                                      >>o:\viruslog\allscan.log
echo Incompatible or unrecognized option(s) or arguements were specified        >>o:\viruslog\allscan.log
echo ErrorLevel 9 occured at above date / time on User %log_name%               >>o:\viruslog\allscan.log
echo %log_name% is located at station number %station%                          >>o:\viruslog\allscan.log 
echo.
goto end

:error8
echo.
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  WARNING  ***                                  ***  ERROR  ***     บ
echo บ An error has occured while SCANNING your local drives for viruses.        บ
echo บ Please refer to your documentation or contact Trimble's Help Desk.        บ
echo ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
echo บ A file required to run VirusScan, such as SCAN.DAT, is missing.           บ
echo บ ErrorLevel=8                                                              บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo.
pause
echo ----------------------------------------------------------------------     >>K:SCAN.LOG
z:\SYSTIME                                                                      >>K:SCAN.LOG
echo A file required to run VirusScan, such as SCAN.DAT, is missing.            >>K:SCAN.LOG
echo ErrorLevel 8 occured at above date / time                                  >>K:SCAN.LOG
echo ----------------------------------------------------------------------     >>o:\viruslog\allscan.log
z:\SYSTIME                                                                      >>o:\viruslog\allscan.log
echo A file required to run VirusScan, such as SCAN.DAT, is missing.            >>o:\viruslog\allscan.log
echo ErrorLevel 8 occured at above date / time on User %log_name%               >>o:\viruslog\allscan.log
echo %log_name% is located at station number %station%                          >>o:\viruslog\allscan.log 
echo.
goto end

:error7
echo.
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  WARNING  ***                                  ***  ERROR  ***     บ
echo บ An error has occured while SCANNING your local drives for viruses.        บ
echo บ Please refer to your documentation or contact Trimble's Help Desk.        บ
echo ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
echo บ An error in accessing an international message file (MCAFEE.MSG)          บ
echo บ ErrorLevel=7                                                              บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo.
pause
echo ----------------------------------------------------------------------     >>K:SCAN.LOG
z:\SYSTIME                                                                      >>K:SCAN.LOG
echo An error in accessing an international message file (MCAFEE.MSG)           >>K:SCAN.LOG
echo ErrorLevel 7 occured at above date / time                                  >>K:SCAN.LOG
echo ----------------------------------------------------------------------     >>o:\viruslog\allscan.log
z:\SYSTIME                                                                      >>o:\viruslog\allscan.log
echo An error in accessing an international message file (MCAFEE.MSG)           >>o:\viruslog\allscan.log
echo ErrorLevel 7 occured at above date / time on User %log_name%               >>o:\viruslog\allscan.log
echo %log_name% is located at station number %station%                          >>o:\viruslog\allscan.log 
echo.
goto end

:error6
echo.
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  WARNING  ***                                  ***  ERROR  ***     บ
echo บ An error has occured while SCANNING your local drives for viruses.        บ
echo บ Please refer to your documentation or contact Trimble's Help Desk.        บ
echo ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
echo บ An internal program error occurred.                                       บ
echo บ ErrorLevel=6                                                              บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo.
pause
echo ----------------------------------------------------------------------     >>K:SCAN.LOG
z:\SYSTIME                                                                      >>K:SCAN.LOG
echo An internal program error occurred.                                        >>K:SCAN.LOG
echo ErrorLevel 6 occured at above date / time                                  >>K:SCAN.LOG
echo ----------------------------------------------------------------------     >>o:\viruslog\allscan.log
z:\SYSTIME                                                                      >>o:\viruslog\allscan.log
echo An internal program error occurred.                                        >>o:\viruslog\allscan.log
echo ErrorLevel 6 occured at above date / time on User %log_name%               >>o:\viruslog\allscan.log
echo %log_name% is located at station number %station%                          >>o:\viruslog\allscan.log 
echo.
goto end

:error5
echo.
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  WARNING  ***                                  ***  MEMORY ***     บ
echo บ An error has occured while SCANNING your local drives for viruses.        บ
echo บ Please refer to your documentation or contact Trimble's Help Desk.        บ
echo ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
echo บ Insufficient memory to load program or complete operation.                บ
echo บ ErrorLevel=5                                                              บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo.
pause
echo ----------------------------------------------------------------------     >>K:SCAN.LOG
z:\SYSTIME                                                                      >>K:SCAN.LOG
echo Insufficient memory to load program or complete operation.                 >>K:SCAN.LOG
echo ErrorLevel 5 occured at above date / time                                  >>K:SCAN.LOG
echo ----------------------------------------------------------------------     >>o:\viruslog\allscan.log
z:\SYSTIME                                                                      >>o:\viruslog\allscan.log
echo Insufficient memory to load program or complete operation.                 >>o:\viruslog\allscan.log
echo ErrorLevel 5 occured at above date / time on User %log_name%               >>o:\viruslog\allscan.log
echo %log_name% is located at station number %station%                          >>o:\viruslog\allscan.log 
echo.
goto end

:error4
echo.
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  WARNING  ***                                  ***  ERROR  ***     บ
echo บ An error has occured while SCANNING your local drives for viruses.        บ
echo บ Please refer to your documentation or contact Trimble's Help Desk.        บ
echo ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
echo บ An error occured while accessing the file created with the /AF option.    บ
echo บ ErrorLevel=4                                                              บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo.
pause
echo ----------------------------------------------------------------------     >>K:SCAN.LOG
z:\SYSTIME                                                                      >>K:SCAN.LOG
echo An error occured while accessing the file created with the /AF option.     >>K:SCAN.LOG
echo ErrorLevel 4 occured at above date / time                                  >>K:SCAN.LOG
echo ----------------------------------------------------------------------     >>o:\viruslog\allscan.log
z:\SYSTIME                                                                      >>o:\viruslog\allscan.log
echo An error occured while accessing the file created with the /AF option.     >>o:\viruslog\allscan.log
echo ErrorLevel 4 occured at above date / time on User %log_name%               >>o:\viruslog\allscan.log
echo %log_name% is located at station number %station%                          >>o:\viruslog\allscan.log 
echo.
goto end

:error3
echo.
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  WARNING  ***                                  ***  ERROR  ***     บ
echo บ An error has occured while SCANNING your local drives for viruses.        บ
echo บ Please refer to your documentation or contact Trimble's Help Desk.        บ
echo ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
echo บ An error occured while accessing a disk (reading or writing).             บ
echo บ ErrorLevel=3                                                              บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo.
pause
echo ----------------------------------------------------------------------     >>K:SCAN.LOG
z:\SYSTIME                                                                      >>K:SCAN.LOG
echo An error occured while accessing a disk (reading or writing).              >>K:SCAN.LOG
echo ErrorLevel 3 occured at above date / time                                  >>K:SCAN.LOG
echo ----------------------------------------------------------------------     >>o:\viruslog\allscan.log
z:\SYSTIME                                                                      >>o:\viruslog\allscan.log
echo An error occured while accessing a disk (reading or writing).              >>o:\viruslog\allscan.log
echo ErrorLevel 3 occured at above date / time on User %log_name%               >>o:\viruslog\allscan.log
echo %log_name% is located at station number %station%                          >>o:\viruslog\allscan.log 
echo.
goto end

:error2
echo.
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  WARNING  ***                                  ***  ERROR  ***     บ
echo บ An error has occured while SCANNING your local drives for viruses.        บ
echo บ Please refer to your documentation or contact Trimble's Help Desk.        บ
echo ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
echo บ A VirusScan database (*.DAT) file is corrupted.                           บ
echo บ ErrorLevel=2                                                              บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo.
pause
echo ----------------------------------------------------------------------     >>K:SCAN.LOG
z:\SYSTIME                                                                      >>K:SCAN.LOG
echo A VirusScan database (*.DAT) file is corrupted.                            >>K:SCAN.LOG
echo ErrorLevel 2 occured at above date / time                                  >>K:SCAN.LOG
echo ----------------------------------------------------------------------     >>o:\viruslog\allscan.log
z:\SYSTIME                                                                      >>o:\viruslog\allscan.log
echo A VirusScan database (*.DAT) file is corrupted.                            >>o:\viruslog\allscan.log
echo ErrorLevel 2 occured at above date / time on User %log_name%               >>o:\viruslog\allscan.log
echo %log_name% is located at station number %station%                          >>o:\viruslog\allscan.log 
echo.
goto end

:error1
echo.
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  WARNING  ***                                  ***  VIRUS  ***     บ
echo บ A virus has been detected by VirusScan.                                   บ
echo บ Please refer to your documentation or contact Trimble's Help Desk.        บ
echo ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
echo บ Error occured while accessing a file (reading or writing).                บ
echo บ                                                                           บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo.                                 
pause
echo ----------------------------------------------------------------------     >>K:SCAN.LOG
z:\SYSTIME                                                                      >>K:SCAN.LOG
echo Error occured while accessing a file (reading or writing).                 >>K:SCAN.LOG
echo ErrorLevel 1 occured at above date / time                                  >>K:SCAN.LOG
echo ----------------------------------------------------------------------     >>o:\viruslog\allscan.log
z:\SYSTIME                                                                      >>o:\viruslog\allscan.log
echo Error occured while accessing a file (reading or writing).                 >>o:\viruslog\allscan.log
echo ErrorLevel 1 occured at above date / time on User %log_name%               >>o:\viruslog\allscan.log
echo %log_name% is located at station number %station%                          >>o:\viruslog\allscan.log 
echo.
goto end

:error0
echo.
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ    ***  ALL GOOD  ***                            *** NO PROBLEMS  ***     บ
echo บ              Everything ran fine.  There is no problem!                   บ
echo บ                                                                           บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo.
rem pause not needed when everything is ok
echo.
goto afterend

:end
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ       A NON-CRITICAL ERROR HAS OCCURED, PLEASE MAKE A NOTE OF IT          บ
echo บ            YOU WILL TEMPORARILY BE ALLOWED ONTO THE NETWORK               บ
echo บ                PLEASE CONTACT YOUR SYSTEM ADMINISTRATOR                   บ
echo บ                                                                           บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
pause
echo off
goto afterend

:notinmem
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ                   *** VIRUS ALERT ERROR ***                               บ
echo บ A VIRUS WAS FOUND, HOWEVER YOU WILL BE ALLOWED TO CONTINUE AT THIS TIME   บ
echo บ IF THE VIRUS CONTINUES YOU MAY NOT BE ALLOWED ONTO THE NETWORK NEXT TIME  บ
echo บ                                                                           บ
echo บ             PLEASE CONTACT THE TRIMBLE HELP DESK AT # 7902                บ
echo บ                                                                           บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo off
rem goto skipmhs1

rem next section for MHS-MAIL notification
copy o:mhs-temp.txt k:mail_log.txt
echo ----------------------------------------------------------------------     >>k:mail_log.txt
z:\SYSTIME                                                                      >>k:mail_log.txt
echo A virus was found in memory at station number %station%                    >>k:mail_log.txt
echo ErrorLevel 10 occured at above date / time on User %log_name%              >>k:mail_log.txt
type k:lastscan.rpt                                                             >>k:mail_log.txt
copy k:mail_log.txt m:\mhs\mail\snd
rem end of section for MHS-MAIL notification

:skipmhs1
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ  WOULD YOU LIKE TO ATTEMPT TO CLEAN THE VIRUS NOW? (y/n)                  บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
choice /c:yn /t:y,10
if errorlevel 2 goto afterend
if errorlevel 1 goto clean
goto afterend

:CRITICAL
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ                   *** CRITICAL VIRUS ERROR ***                            บ
echo บ    SINCE A CRITICAL ERROR HAS OCCURED YOU ARE NOW BEING LOGGED OFF        บ
echo บ             PLEASE CONTACT THE TRIMBLE HELP DESK AT # 7902                บ
echo บ                                                                           บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
echo off
rem goto skipmhs2

rem next section for MHS-MAIL notification
copy o:mhs-temp.txt k:mail_log.
echo ----------------------------------------------------------------------     >>k:mail_log.txt
z:\SYSTIME                                                                      >>k:mail_log.txt
echo A virus was found in memory at station number %station%                    >>k:mail_log.txt
echo ErrorLevel 10 occured at above date / time on User %log_name%              >>k:mail_log.txt
k:type lastscan.rpt                                                             >>k:mail_log.txt
copy k:mail_log. m:\mhs\mail\snd\%user_id%.
rem end of section for MHS-MAIL notification

:skipmhs2
echo.
z:\LOGOUT.EXE
goto offnet

:afterend
rem the syntax of the following line is critical; if there is a space after = it will not work!
set SCAN=YES
echo off
echo ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
echo บ Virus Scanning has completed successfully                                 บ
echo บ You will now be prompted for your password...                             บ
echo ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
login %log_name%
goto offnet

:clean
rem next line for users that found a virus ERRORLEVEL 13, not in memory just on hard drive
O:\SCAN C: /NOBREAK /report k:lastscan.rpt /frequency 96 /clean
goto afterend

:offnet
rem very end!
