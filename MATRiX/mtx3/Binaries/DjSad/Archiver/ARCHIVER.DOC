‚Ž‡ŒŽ†›… ‚€ˆ€’› —’…ˆŸ „€›• ˆ‡ ”€‰‹€:

   ÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
    EXE Header ³ ®áâ «ì­®© ä ©« ³ ¢¨àãá ³ ®¡« áâì §  ¯à¥¤¥« ¬¨ ä ©« 
   ÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

0) ÍÍÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ
                                          ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ^

1) ÍÍÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ
                                    ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ^

2) ÍÍÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ
                                  ÀÄÄÄ^

3) ÍÍÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ
                        ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ^

4) ÍÍÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ
                     ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄ^

5) ÍÍÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ
                  ÀÄÄÄÄÄÄÄÄÄÄ^

6) ÍÍÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ
         ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ^

7) ÍÍÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ
        ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ^

8) ÍÍÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ
       ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ^

9) ÍÍÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÎÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ
      ÀÄÄÄÄ^

ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

ŽŸ‘…ˆŸ:

   CURPOS         - â¥ªãé ï ¯®§¨æ¨ï ¢ ä ©«¥
   FSIZE          - ¤«¨­  ä ©« 
   CODESIZE       - ¤«¨­  ¢¨àãá 
   offset HEADER  - á¬¥é¥­¨¥ ¨§¬¥­¥­­®£® ¢¨àãá®¬ MZ-EXE § £®«®¢ª 
   CX             - áª®«ìª® ¡ ©â ç¨â ¥âáï ¨§ ä ©« 
   DX = SI        - á¬¥é¥­¨¥ ¡ãää¥à , ¢ ª®â®àë© ç¨â ¥âáï ¨­ä®à¬ æ¨ï

à¥¤¯®« £ ¥âáï, çâ® ª®¤ ¢¨àãá  à á¯®«®¦¥­ á á ¬®£® ­ ç «  á¥£¬¥­â .
‡ ¬¥ç ­¨¥: ãª § â¥«ì ¬®¦­® ãáâ ­ ¢«¨¢ âì §  ¯à¥¤¥«ë ä ©« ,   â ª¦¥
¯¨á âì ¨ ç¨â âì §  ¯à¥¤¥« ¬¨ ä ©« 

ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

€‹ƒŽˆ’Œ ‚ Ž‹“‘‹Ž‚…‘Ž‰ ”ŽŒ…:


if CURPOS > FSIZE+CODESIZE -> goto Exit

if CURPOS > FSIZE
   SI = DX
   DI = CURPOS-FSIZE

   if CURPOS+CX > FSIZE+CODESIZE -> goto L1
   else -> goto L2
end

if CURPOS > 18h
   SI = DX+(FSIZE-CURPOS)
   DI = 0

   if CURPOS+CX > FSIZE+CODESIZE -> goto L3
   if CURPOS+CX > FSIZE -> goto L4
   else -> goto Exit
end

else
   N  = 18h-CURPOS
   SI = DX
   DI = (offset HEADER)+CURPOS

   if CURPOS+CX > FSIZE+CODESIZE -> goto L5
   if CURPOS+CX > FSIZE -> goto L6
   if CURPOS+CX > 18h -> goto L8
   else -> goto L9
end

ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

L1:	N = (FSIZE-CURPOS)+CODESIZE
	goto L8

L2:	N = CX
	goto L8

L3:	N = CODESIZE
	goto L8

L4:	N = CX-(FSIZE-CURPOS)
	goto L8

L5:	call STORE
	N = CODESIZE
	goto L7

L6:	call STORE
	N = CX-(FSIZE-CURPOS)
L7:	SI = DX+(FSIZE-CURPOS)
	DI = 0
	goto L8

L8:	call STORE
	goto Exit

L9:	N = CX
	goto L8

ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

STORE:	if N = 0 -> goto L11
	CX = N
L10:	DS:[SI] = CS:[DI]
	SI = SI + 1
	DI = DI + 1
	CX = CX - 1
	if CX <> 0 -> goto L10
L11:	Return
