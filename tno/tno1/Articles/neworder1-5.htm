<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=windows-1251">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
<title>ThE NeW OrDeR #1</title>
</head>

<body bgcolor="#000000" link="#0000FF" vlink="#000080"
bgproperties="fixed" topmargin="15" leftmargin="20" "
vlink="#000080">

<p align="center"><font color="#FF0000" size="4"><strong>Common
Gateway Interface - средство расширения
возможностей World Wide Web технологии</strong></font></p>

<p align="center"><font color="#FF0000" size="5"><strong><img
src="../images/Rs.jpg" width="640" height="12"></strong></font></p>

<p><font color="#FFFFFF" size="3"><strong>Главное
назначение Common Gateway Interface -
обеспечение единообразного потока
данных между сервером и прикладной
программой, которая запускается
из-под сервера <br>
CGI-скрипт - программа написанная в
соответствии со спецификацией Common
Gateway Interface. CGI-скрипты могут быть
написаны на любом языке
программирования (C, C++, PASCAL, FORTRAN и т.
п.) или командном языке (shell, cshell,
командный язык MS-DOS, Perl и т. п.).
Скрипт может быть написан даже на
языке редактора EMAC в системах Unix <br>
Шлюз - это CGI-скрипт, который
используется для обмена данными с
другими информационными ресурсами
Internet или приложениями-демонами.
Обычная CGI- программа запускается
сервером HTTP для выполнения
некоторой работы, возвращает
результаты серверу и завершает
свое выполнение <br>
Механизмы обмена данными<br>
· переменные окружения <br>
· формат командной строки <br>
· формат стандартного ввода <br>
· формат стандартного вывода <br>
<br>
</strong></font><font color="#00FF40" size="3"><strong>Список
переменных окружения<br>
</strong></font><font color="#FFFFFF" size="3"><strong>К
общим переменным окружения
относятся: <br>
· SERVER_SOFTWARE - определяет имя и версию
сервера <br>
· SERVER_NAME - определяет доменное имя
сервера <br>
· GATEWAY_INTERFACE - определяет версию
интерфейса </strong></font></p>

<p><font color="#FFFFFF" size="3"><strong><br>
</strong></font><font color="#00FFFF" size="3"><strong>К
запрос-ориентированным относятся: <br>
</strong></font><font color="#FFFFFF" size="3"><strong>·
SERVER_PROTOCOL - протокол сервера <br>
· SERVER_PORT - определяет порт TCP, по
которому осуществляется
взаимодействие (80 порт) <br>
· REQUEST_METHOD - определяет метод
доступа к информационному ресурсу <br>
· PATH_INFO - передает программе путь
(адрес скрипта) в виде, указанном в
HTML-документе <br>
· PATH_TRANSLATED - то же, что и PATH_INFO, но
только после подстановки сервером
определенных в его конфигурации
вставок <br>
· SCRIPT_NAME - определяет адрес скрипта
так, как он указан клиентом <br>
· QUERY_STRING - определяет содержание
запроса к скрипту </strong></font></p>

<p><font color="#FFFFFF" size="3"><strong><br>
</strong></font><font color="#00FFFF" size="3"><strong>Идентификация
пользователя и его машины: <br>
</strong></font><font color="#FFFFFF" size="3"><strong>·
REMOTE_HOST - доменный адрес машины, с
которой осуществляется запрос <br>
· REMOTE_ADDR - IP-адрес запрашивающей
машины <br>
· AUTH_TYPE - тип идентификации
пользователя <br>
· REMOTE_USER - идентификация
пользователя <br>
· REMOTE_IDENT - устанавливается
сервером; предназначена для
первоначального использования
скрипта <br>
· CONTENT_TYPE - определяет MIME-тип данных,
передаваемых скрипту <br>
· CONTENT_LENGTH - определяет размер
данных в байтах, которые передаются
скрипту </strong></font></p>

<p><font color="#FFFFFF" size="3"><strong><br>
</strong></font><font color="#00FFFF" size="3"><strong>Стандартный
ввод CGI-скрипта <br>
</strong></font><font color="#FFFFFF" size="3"><strong>·
Методы GET или Post <br>
· CONTENT-LENGHT <br>
· CONTENT-TYPE <br>
· QUERY-STRING <br>
</strong></font><font color="#00FFFF" size="3"><strong>Стандартный
вывод CGI-скрипта </strong></font></p>

<p><font color="#00FFFF" size="3"><strong><br>
</strong></font><font color="#FFFFFF" size="3"><strong>·
Заголовок <br>
· CONTENT-TYPE <br>
· Location <br>
· Status <br>
· Тело ответа (обычно текст) </strong></font></p>

<p><font color="#FFFFFF" size="3"><strong><br>
</strong></font><font color="#00FFFF" size="3"><strong>Применение
CGI-скриптов<br>
</strong></font><font color="#FFFFFF" size="3"><strong>·
Простейшие SHELL-скрипты <br>
· Вызов внешней программы через SHELL <br>
· Вызов модуля &quot;С&quot; <br>
· Доступ к базам данных <br>
· Imagemap </strong></font></p>

<p><font color="#FFFFFF" size="3"><strong><br>
</strong></font><font color="#00FFFF" size="3"><strong>Примеры
SHELL-скриптов<br>
</strong></font><font color="#FFFFFF" size="3"><em>#!/bin/sh<br>
echo Content-type: text/plain<br>
echo<br>
echo This is the result of script execution.<br>
#The end of script<br>
#!/bin/sh<br>
echo Content-type: text/plain<br>
echo<br>
echo $REQUEST_METHOD<br>
echo $QUERY_STRING<br>
echo $CONTENT_TYPE<br>
echo $CONTENT_LENGTH<br>
#The end of script.<br>
#!/bin/sh<br>
echo Content-type: text/plain<br>
echo<br>
finger paul@polyn.kiae.su<br>
#The end of script.</em></font></p>

<p><font color="#FFFFFF" size="3"><em><br>
</em></font><font color="#00FFFF" size="3"><strong>Пример
С-программы<br>
</strong></font><font color="#FFFFFF" size="3"><em>#include
&lt;stdlib.h&gt;;<br>
#include &lt;sys/types.h&gt;;<br>
main()<br>
{<br>
long i,n,uid;<br>
char input_ch[1024];<br>
char *env;<br>
env = getenv(&quot;CONTENT_LENGTH&quot;);<br>
/* Here we recieve a length */<br>
sscanf(env,&quot;%d&quot;,&amp;n);<br>
/* of input stream and form */<br>
for(i=0;i&lt;;n;i++)<br>
/* command line */<br>
{ input_ch[i]<br>
= getchar(); }<br>
input_ch[i] = '\000';<br>
printf(&quot;Content-type:<br>
text/html\n\n&quot;); /* First message of a CGI Programme */<br>
/* This message must be a first one */<br>
/* in output sream. */<br>
printf(&quot;&lt;TITLE&gt;<br>
C-cgi script.(example#1)&lt;/TITLE&gt;\n&quot;);<br>
printf(&quot;&lt;H3&gt;&lt;I&gt;<br>
Russian Research Center \&quot;Kurchatov
Institute\&quot;&lt;I&gt;&lt;/H3&gt;\n&quot;);<br>
c_uid = -1;<br>
sscanf(input_ch,&quot;uid=%ld&quot;,&amp;uid);<br>
/* Transform input data */<br>
printf(&quot;Input<br>
Nuber:%ld.&lt;BR&gt;&lt;HR&gt;&quot;,uid);<br>
exit(0);<br>
}<br>
</em><strong><br>
</strong></font><font color="#00FFFF" size="3"><strong>Доступ
к базе данных под управлением Ingres<br>
</strong></font><font color="#FFFFFF" size="3"><strong>·
Простой вызов постоянного запроса <br>
· Форматирование вывода <br>
· Запрос через Query-String <br>
· Фильтрация </strong></font></p>

<p><font color="#FFFFFF" size="3"><strong><br>
</strong></font><font color="#00FFFF" size="3"><strong>Примеры
скриптов<br>
</strong></font><font color="#FFFFFF" size="3"><strong><br>
</strong><em>#!/bin/sh<br>
echo Content-type: text/plain<br>
echo<br>
ingres polyn &lt; query<br>
#The end of script<br>
#!/bin/sh<br>
echo Content-type: text/plain<br>
echo<br>
helpr polyn<br>
#The end of script<br>
#!/bin/sh<br>
echo Content-type: text/html<br>
echo<br>
echo '&lt; PRE&gt; '<br>
helpr polyn situat<br>
echo '&lt; /PRE&gt; '<br>
#The end of script<br>
#!/bin/sh<br>
echo Content-type: text/html<br>
echo<br>
echo '&lt; PRE&gt; '<br>
echo $QUERY_STRING | tr &quot;+&quot; &quot; &quot; | ingres
polyn<br>
echo '&lt; /PRE&gt; '<br>
#The end of script<br>
#!/bin/sh<br>
echo Content-type: text/html<br>
echo<br>
echo '&lt; PRE&gt; '<br>
echo $QUERY_STRING | sed -f symbols | ingres polyn | tr
&quot;\007&quot; &quot;*&quot; | head 100<br>
echo '&lt; /PRE&gt; '<br>
#The end of script</em></font></p>

<p><font color="#FFFFFF" size="3"><em><br>
</em></font><font color="#00FFFF" size="3"><strong>Организация
стека графических ссылок<br>
</strong></font><font color="#FFFFFF" size="3"><em><strong>Скрипт
imagemap <br>
</strong></em><em>&lt;A
href=&quot;http://polyn.net.kiae.su/cgi-bin/imagemap/russia&quot;&gt;<br>
&lt;img SRC=&quot;http://demin.polyn.kiae.su/dss/russia.gif&quot;
ISMAP&gt;<br>
&lt;/A&gt;<br>
# метка : адрес файла описания
картинки <br>
russia : /usr/local/etc/httpd/cgi-bin/maps/russia.map<br>
brussia : /usr/local/etc/httpd/cgi-bin/maps/brussia.map<br>
#описание прямоугольника <br>
rect 10 20 100 200<br>
circle 50 50 60 60<br>
poly 10 10 20 20 20 10</em></font></p>

<p align="center"><a href="../TNO#1_start.htm"><img
src="../images/14ic3.gif" border="0" width="60" height="65"></a></p>

<p align="center"><a href="mailto:nrgteam@mail.ru"><img
src="../images/coollogo_com_7565375.jpg" border="0" width="206"
height="53"></a></p>

<p align="center"><a href="mailto:nrgteam@mail.ru"><img
src="../images/Lurker2.jpg" border="0" width="212" height="119"></a></p>
</body>
</html>
