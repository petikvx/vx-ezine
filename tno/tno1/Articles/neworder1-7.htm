<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=windows-1251">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
<title>ThE NeW OrDeR #1</title>
</head>

<body bgcolor="#000000" link="#0000FF" vlink="#000080"
bgproperties="fixed" topmargin="15" leftmargin="20" "
vlink="#000080">

<p align="center"><font color="#FF0000" size="4"><strong>Как
стать рабовладельцем в Сети.</strong></font></p>

<p align="center"><font color="#FF0000" size="5"><strong><img
src="../images/Rs.jpg" width="640" height="12"></strong></font></p>

<p><font color="#FFFFFF" size="3"><strong>Ну о
Троянцах наверное все слышали.
Хорошие это штучки для хакера.
Впариваешь глупому юзеру прогу, он
её запускает и сразу становится
твоим рабом. Отдаёт тебе свой
Интернет-акаунт, почтовые пароли,
аську и всю другую конфидециальную
инфу. Часто он ещё дарит тебе доступ
к своему винчестеру, позволяет
управлять своей мышкой, смотреть на
свой экран и т.д. Вообщем если
рабовладельчество тебе по душе, то
Троянцы – это то, что тебе нужно.</strong></font></p>

<p align="center"><font size="4"><strong><img
src="../images/screen1.gif" width="602" height="295"></strong></font></p>

<p align="center"><a
href="http://www.xakep.ru/soft/trojans/stlthcfg.exe"><font
size="4"><strong>Скачать этот чудо
Stealth-Конфигуратор можно прям тут !</strong></font></a></p>

<p><font color="#FF0000" size="3"><strong>Step 1. &quot;Как
получить раба&quot;.</strong></font></p>

<p><font color="#FFFFFF" size="3"><strong>Для начала
скачиваешь себе файл &quot;StlthCfg.exе&quot;
- эта программа сгенерирует Трояна
и сконфигурирует его под тебя.
Чтобы произвести настройку, ты
должен ввести свой Email (на него
будут приходить спертые Пароли) и
свой идентификатор для опозвания
тебя самой программой.</strong></font></p>

<p><font color="#FFFFFF" size="3"><strong>Затем
наступает самая ответственная
часть – впаривание Троянца юзеру
ушастому. Впаривание лучше всего
производить под видом некой очень
полезной программы, якобы
ускоряющей работу в Интернете в 5
раз . Ну, или что-нибуть подобное в
этом духе. Если юзер действительно
ЮЗЕР, то он на это клюнет и с
радостью возьмет у тебя прогу, и,
конечно же, сразу после получения
её запустит. Ура!!! Вот ты и
рабовладелец!</strong></font></p>

<p><font color="#FFFFFF" size="3"><strong>Как и
большиство подобных программ, наша,
после первого запуска копирует
себя в директорию, где живут винды,
под каким-нибудь неприметным
именем. В то же время она добавляет
себя в один из разделов регистра,
который обеспечивает ей загрузку
при каждом старте виндов. Для о</strong></font><img
src="../images/screen2.gif" alt="screen2.gif (34326 bytes)"
align="right" hspace="0" width="279" height="233"><font
color="#FFFFFF" size="3"><strong>беспечения
прикрытия свой легенды (т.е. чем её
представили жертве) она может
выдать какое-нибудь сообщение для
отвода глаз типа &quot;Required DLL MFC50.DLL not
found. The program will now terminate&quot;, что в
переводе с буржуйского значит
&quot;Требуемая библиотечка MFC50.DLL не
найдена. Программа завершит свою
работу.&quot;</strong></font></p>

<p><font color="#FFFFFF" size="3"><strong>На сайте ты
сможешь выбрать нужную легенду или
заказать новую. Под этим предлогом
наш Троянец избежит выполнения
обещаных функций (типа апгрейда ICQ
до самой неслыханой версии). Для
случая, когда Троян запущен не
самим пользователем, а например,
закачан на машину через NETBUS (как
ломать через NetBus ты можешь
прочитать в этом же номере) или
BackOrfice или что-то в этом роде,
имеется версия, которая не выдает
при запуске никаких сообщений.</strong></font></p>

<p><font color="#FFFFFF" size="3"><strong>Под конец
будет запущена та самая
неприметная копия программы из
директории виндов, чтобы троян мог
сразу приступить к выполнению
своих неосредственных шпионских
обязанностей.</strong></font></p>

<p><font color="#FF0000" size="3"><strong>Step 2 &quot;Куда
это меня скачали?&quot;</strong></font></p>

<p><font color="#FFFFFF" size="3"><strong>Наш Троян
нацелен на нахождение логинов и
паролей доступа в Интернет и WWW
серверам. Каждую секунду программа
проверяет, есть ли связь с
Интернетом. Как только коннект
установлен, начинается сбор данных.
Для начала составляется список
имеющихся соединениний и их
параметров (телефоны, DNS, имя
скрипта и т.д) с помощью API функции
&quot;RasEnumEntries&quot; и &quot;RasGetEntryProperties&quot;
соответственно.</strong></font></p>

<p><font color="#FFFFFF" size="3"><strong>Если
обрнаруживается, что для входа в
Интернет используется стандартный
виндовcкий скрипт, то не составляет
проблемы взяв путь к нему из
свойств соединения считать файл. Но
такая халява встречется нечасто.
Если пользователю в лом каждый раз
набирать логин и пароль и он
поставил галочку &quot;Сохранить
пароль&quot; (&quot;Save password&quot;), то 95-е/98-е
винды сохранят его в файле
кешированных паролей с расширением
PWL и с именем текущего пользователя.
Наш Троян не упускает возможности
поискать файлы с подобным
расширением в виндовой директории.
Алгоритм получения списка
паролей/логинов из подобного файла
при наличиии имени пользоветеля и
его пароля на вход в винды, давно
известен. Этот алгоритм реализован
в программе PWLHACK. Но есть способ и
получше. Дело в том, что одна всеми
любимая фирма (назовем её условно
Мелкософт, чтобы не порочить
&quot;доброе&quot; имя ) оставила в
виндах функцию, с помощью которой
можно получить список кешированых
паролей для текущего пользователя
вне зависимости есть ли у
пользователя пароль на вход в винды
или нет. Естественно данная функция
нигде не упоминается, она
недокументирована. Находится она в
неприметном файле mpr.dll и называется
“WnetEnumCachedPasswords”. С её помощью наш
троян получает список
логинов/паролей текущего
пользователя.</strong></font></p>

<p><font color="#FF0000" size="3"><strong>Step 3 &quot;А
теперь я всё о тебе расскажу
хозяину&quot;.</strong></font></p>

<p><font color="#FFFFFF" size="3"><strong>Cобранные
развед-данные отправляются
владельцу не просто, а очень просто
- по почте. Чтобы отправить письмо
необходимо связаться с почтовым
сервером по протоколу STMP. Подобных
серверов множество. У каждого
уважающего себя провайдера есть
свой сервер. Но связываться с
такими серверами не стоит. Они
весьма капризны и могут отказать в
посылке письма, если текущий IP
адрес принадлежит другому
провайдеру. Надежнее использовать
нейтральный сервер. Не стоит
связываться с некоммерческими типа
тех, что стоят в штатовских
университетах. Они имеют тенденцию
закрываться без предупреждений,
т.к. никому ничего не обязаны. Лучше
всего использовать STMP сервера
больших почтовых сайтов типа HotMail
или USAnet. Они могу потребовать
только, чтобы обратный адрес
принадлежал данному серверу.
Поэтому, когда будешь конфигурить
Троянца под себя, вводи адрес SMTP
сервера – “pop.netaddress.com” ,
предварительно создав себе
почтовый ящик на Usa.net. После того,
как данные собраны, наш троян
проверит, отсылались ли данные.
Если нет - то данные отсылаются и
сохраняются в регистри. Если уже
отсылались, то из регистри
извлекается предыдущее письмо и
происходит сравнение с текущим.
Если произошли какие-либо
изменения (например у юзера новый
акаунт в Интернет появился), то
письмо отсылается и в регистри
записываются свежие данные о
паролях.</strong></font></p>

<p><font color="#FFFFFF" size="3"><strong>Письмо
включет в себя описаные выше
данные. Скрипты и PWL-файлы
добавляются как вложения в письмо.</strong></font></p>

<p><font color="#FF0000" size="3"><strong>“Апгрейди
меня!”.</strong></font></p>

<p><font color="#FFFFFF" size="3"><strong>В последнее
время появился новый признак
хорошего тона - программа должна
сама проверять, не выпустила ли
фирма-производитель новую версию
своего программного продукта, и
если сие чудо произошло, то
предлагать скачать свежую версию.
Наш Троян не исключение. Только он
скачивает апгрейд и запускет его не
спрашивая на то разрешения .
Апргрейд в данном случае
скачивается не с сайта, а с обычного
бесплатного почтового сервера. Т.е
программа &quot;проверяет почту&quot; на
определенном сервере и, если
обнаруживает письмо с определенным
заголовком, скачивает его,
распаковывает вложеный в письмо
апгрейд и запускает его. Апгрейд
де-инсталлирует текущю версию
программы (завершает работу
текущей копии, чистит регистри и
убивает программу из виндовой
директории) и после инсталлирует
себя.</strong></font></p>

<p><font color="#FFFFFF" size="3"><strong>“Всё. Ухожу,
ухожу…”Как я уже упоминал, в
программу включена функция
де-инсталляции. Помимо случая с
апгрейдом можно де-инсталлировать
Трояна, запустив его с параметром
&quot;pizdets&quot; в командной строке.
Например: “Stealth2.exe pizdets”. После
выполнения данной команды система
будет полностью очищенна от Трояна
и все твои рабы сбегут на волю.</strong></font></p>

<p><font color="#FFFFFF" size="3"><strong>Ну я надеюсь,
что до де-инсталяции у тебя дело не
дойдёт. Но всё-таки предупреждаю:
рабовладение подобно наркотику,
как только у тебя появится первый
раб, ты уже не сможешь себе
представить, как же это ты раньше
жил обходясь только своими силами.
Как же это ты раньше платил за
Интернет? Почему ты раньше не читал
чужую почту и не перехватывал чужие
любовные письма? Да и вообще, как
это ты обходился только своей
“подставкой под чашечку кофе”?
Счастливого хакинга !!! </strong></font></p>

<p align="center"><a href="../TNO#1_start.htm"><img
src="../images/14ic3.gif" border="0" width="60" height="65"></a></p>

<p align="center"><font color="#FFFF00" size="2" face="Arial">Авторы:
KurT (ICQ: 2950197) Email: </font><a href="mailto:Kurt@xakep.ru"><font
size="2" face="Arial">Kurt@xakep.ru</font></a><font
color="#FFFF00" size="2" face="Arial">  and DoC (E-mail: </font><a
href="mailto:DoC@xakep.ru"><font size="2" face="Arial"><u>DoC@xakep.ru</u></font></a><font
color="#FFFF00" size="2" face="Arial"> )</font></p>
</body>
</html>
