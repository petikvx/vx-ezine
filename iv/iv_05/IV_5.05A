          ▄▄                  █
         ▀▀▀ Monthly Magazine █ For VirMakers.                  FEB '95
 	 ▀██ ▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀ █ ▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀ ▀ ▀▀▀▀▐▀▀▀  ██▀▀▀██  
	  ▐█ █▀▄ █▀▀ ▄▀▀ ▄▀▀ ▄█▄ ▄▀▀ █▀█    ▌ █ ▄▀█ █ ▄▀▀ █▄▄   ██ ▀▀██
	   █ █ █ █▀  █▀  █    █  █▀  █ █    █ █ █ █ █ █   █     ████ ██
	   █ ▐ ▐ ▐   ▐▄▄ ▐▄▄  ▐  ▐▄▄ ▐▄▀     ▀█ ▀▄█ ▐ ▐▄▄ ▐▄▄▄  ██▄▄▄██
	   ▐ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄ 
	     Copyright , (C),1994-95, by STEALTH group, unLtd.
	     (M)ail: BOX 10, KIEV 148, The CUNTry of fUcKRAINE

■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■
Dr. Web , version 2.00 (1995 Jan 18)
Copyright (c) by Igor Daniloff 1992-95
Scanning Report dated 1995 Feb 11  03:32:00
Command line:  c:/A/F/D/S2/V/P/O/L
No viruses found in memory
Searching for viruses and infected programs in disk C:

	Написал я как-то одну прикладную программку (понимайте, как хотите)
и решил ее WEB'ом прогнать. Версия 1.06 орет, что COM.EXE.TSR.VIRUS. Сделал
 я кое-какие исправления, у себя, разумеется, и WEB замолк.
  2.02 тоже молчит, я было возрадовался, да не тут-то было, смотрю, а у него
3 уровня эротического (позвольте называть его так - мне удобней и по смыслу
схоже) анализа, - 0 = минимальный, 1 = оптимальный ( по умолчанию ): он-то и
молчал, и... "параноический" = 2, который возьми да и ляпни: CRYPT.VIRUS. 
Вот тут-то и пришлось задуматься... И додумался! Конечно же, все очень просто,
также, как и в WEB.YOU из IV_4. 

	По сему поводу была устроена проWEBка всего диска,-такой вот Парад
Победы, где строй докторов, в паутине и  полосатых робах, волочили через 
площадь свои ободранные CRC, и кое-как кидали палки кто в костер у Главного
Дисковода, а кто просто ронял непосильную ношу, и его тут же подхватывали 
жужжащие по поверхностям головки. 

	 На 3DX40 ушло минут 10, было прорвано 1350 файлов, с вышеуказанными
опциями, в частности, "/O" - расписка в собственной  беспомощности, - ставить
OK, где не надо. Так он,собак бэшэный, стал на бедных ДОКов кидаться, и даже 
обидел Novell DOS Antivirus - все у него CRYPT'ы. В таких случаях я ставлю 
себя на место Юзера_запуганного и пытаюсь представить ситуацию, аж жалко 
становится... Ведь если в .DOC файле ВИРУС!, да еще и шифрованный - теперь он
не только будет DEL *.EXE/COM/OVL/SYS делать, а еще и уничтожать все текстовые
файлы!!! Попробуй такому потом докажи, что он не прав. 
	
	Автора WEB'а попрошу принять это за конструктивную критику, если хо-
чет, может обижаться, у него на это All rights reserved. 
Подобные штучки способны задавить лишь начинающего программиста, которому не 
под силу сразу слепить полиморфик-стелз. Я понимаю, это конечно прикольно, 
когда твое изделие прогремит в вирлИсте, еще и со всеми текстами, но вирусо-
писание уже давно бы вымерло, будь это самоцелью; вирусописание-это не так же
тривиально, как graffiti (исписывание стен). Я не знаю автора WEB'а лично, и 
поэтому, к сожалению, не могу понять, что движет его деятельностью. 
Финансовая сторона или душа в "сером мундире"... SPIDERMAN - спасатель 
человечества от коварных вирусов ?  ???

	Довелось одному из наших ребят юзать WEB 1.06 для лечения OneHalf.
И полетело пол-стекерного диска. Опасный вирус OneHalf ? Нет, благодаря
WEB'у, который, убивая сей вир еще, если не вру, с версии 1.01, заодно
убивал-недолечивал еще и диски ничего не подозревающим юзерам. И нам заодно -
спасибо,доктор! Мы привыкшие, нам не страшно. Что, о шифровании диска spIDer 
догадался только с версии 1.09 ? И конечно, все обхаяли OneHalf - обидно за 
этот БЕЗОБИДНЫЙ вирус!!!

	Итак, метод борьбы с параноидально-шизофреническим бредом.
	Читайте, анализируйте и придумывайте новые алгоритмы - с интересом
их изучим! А SPIDER'MAN - ДЕРЖИСЬ, раз обьявил нам войну, решил, что имеешь
право без суда и следствия и без спроса сажать и убивать плоды нашего твор-
чества - наша швабра против Твоей паутины. БАНЗАЙ !!!

 -----------------------------------------------------------------------------
	
	Эвристический аналиатор, или, в более широком понимании -
 символический исполнитель кода, - это программа, которая эмулирует действия
 процессора. 

	Идеальный символический исполнитель кода должен обладать такими 
	свойствами:

	  1. Эмуляция RAM в отдельном файле.
	  2. Знание всех портов, учет ReadOnly и WriteOnly портов.
	  3. Эмуляция работы прерываний, в особенности таймерных.
	  4. Эмуляция работы с диском при небольших обьемах записи.
	  5. Учет конвейера в зависимости от типа процессора.

	Из приведенных выше пунктов Dr.WEB не соблюдает ни один,
	что сразу же дает повод для его обхода по всем 5 пунктам.
	Не беда, если враг попытается работать в каком-либо направ-
	лении - идеальный символический исполнитель создать 
	невозможно - обязательно найдутся способы его обойти. 

	Для того, чтобы WEB не находил расшифровщик, необходимо 
	успокоить его в самом начале:  
	
	а) проверить, не символически ли нас исполняют?
	   Предлагаю сделать это с помощью таблицы векторов - WEB
	   не посмеет менять вектор на свой страх и риск.
	   Возможный обход: эмуляция памяти, действенен, но практически
			    врядли может быть используем - громоздко, 
			    да и мы сразу же придумаем что-нибудь другое.
           		xor ax,ax
			mov es,ax
			push es:[ANYVECTOR]	; сохраним старое значение
			mov es:[ANYVECTOR],dx	; записываем в таблицу векторов
						; расшифровщик
			cmp es:[ANYVECTOR],dx	; сравниваем 
			je  Decrypt		; реальное исполнение

	б) послать его далеко от расшифровщика 

			int 20h			; действует на WEB, но не 
						; на FPROT		
			
	Но если это вставить до расшифровщиков,тогда не будет phantom-вирусов!
	Нет, для этого только прийдется поменять полиморфную часть.
	Теперь она должна содержать и вышеуказанный участок кода.
	Хорошо, завтра Данилов извратится в своем WEB'е и каждый раз
	прийдется писать новый Mutation Engine ? Да, пожалуй так.
	Если не написать один, но хороший, и сразу. 

					LovinGOD.

