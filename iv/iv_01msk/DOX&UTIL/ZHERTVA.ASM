┌────────────────┬──┬────────┬─────────────────────────────┬─────────────────┐
│INFECTED MOSCOW │#1│ JAN'97 │(C)STEALTH Group MoscoW & Co │ one@redline.ru  │
└────────────────┴──┴────────┴─────────────────────────────┴─────────────────┘
┌──────────────────────────────────────────────────┬────────────────────────┐
│ Жертва для вируса                                │ (C) Beast/SGBishkek    │
└──────────────────────────────────────────────────┴────────────────────────┘

; Я конечно извиняюсь за небольшое количество комментариев, но по-моему
; в этой проге и комментировать нечего. 
;  Короче, все наверняка запарились с файлами-жертвами, каждый раз их 
; откуда-то переписывать после очередной проверки вирия. 
;  Просто укажите в коммандной строке: 
; zhertva.com R

; И та самая многострадальная жертва будет востановленна.

;  P.S. В командной строке R указывать большой. Не то OneHalf подцепите >:-)

		.MODEL SMALL
		.CODE
		ORG	100H
START:
		MOV	AL,DS:[82H]	; Чаго там в командной строке ?
		CMP	AL,'R'		; неужто нас восстановится просят
		JNE	NO_RESTORE
					; просят. Да еще как
        mov ax,Ds:[2ch]		; От find'им откуда грузанулись
        mov Ds,ax
        xor bx,bx
next:
        mov al,Ds:[bx]
        or al,0
        je con
        inc bx
        jmp next
con:
        inc bx
        mov al,Ds:[bx]
        or al,al
        jne next
	add bx,3

		MOV	AH,3CH	; И зарисуемся
		MOV	CX,0	; в CX и так при загрузке ZERO торчит
		MOV	DX,BX
		INT	21H
		JC	NO_RESTORE
		MOV	BH,40H
		XCHG	BX,AX
		PUSH	CS
		POP	DS
		MOV	CX,PRL
		CWD	
		INC	DH
;		MOV	DX,100H
		INT	21H
		MOV	AH,3CH
		INT	21H
NO_RESTORE:
		RET
PL		EQU	$-START
		DB	2000-PL DUP (90H)
PRL		EQU	$-START
		END	START