
                                                                     P.009

         TpVOtPVoTpvOTpVOtpVoTPvOTPVOtpVOTPvOtPVOtPVOtPvOTPvOTpVoTPVO
         PT                                                        OT
         VP     ¥x ÆW «Â ¤O ¯f ¬r ²Õ Â´   ¯f¬rÂø»x   ²Ä ‘B ´Á      TP
         oV                                                        PV
         TO                  Ææ  PTAV  µù¥U¾¹  Ææ                  Vo
         pT                                                        OT
         VP                      by Zhuge Jin                      VP
         OV                                                        OV
         OVTPVoTpvOtPvoTPVOtPvoTpVotpvoTpVotpvOtPvoTpVOtpvOTPvOTpvOTP


   Hi¡T¤j®a¦n¡T§Ú¬O½Þ­ô¡T²{¦b§Ú­n±À¥X¤@­Ó·sª±·N¡T³o­Ó´N¬O PTAV µù¥U¾¹¡S¬Û«H
   ¤j®aÁÙ°O±o±q«e¦³­Ó¤H·Q±N PV ªº«Â¤O®i²{µ¹¤j®a§a¡T¥i¬O¬°¤°»ò¤£¥á©O¡S­ì¦]¥á
   ¤F¤§«á´N¤£¯à¼´¤@µ§¤F¡T¦Ó¥B¤]¹ï¤£°_¥Lªº·R¥Î¤á¡T¦ý... ¦pªG¥Ñ§Ú¨Ó·Fªº¸Ü¡A¦Ü
   ¤Ö²Ä¤G¶µÀ³¸Ó¤£·|¦³°ÝÃD§a¡T³Ü¡T;_)

   ¦b PTAV ªº´ú¸Õª©»Pµù¥Uª©¤§¶¡¨Ã¨S¦³«Ü¤jªº®t²§¡A¥u¬O¦b .COD ªº«e E0h ªº³¡¥÷
   ½s½X¤£¦P©Ò­P¡T¦]¦¹±N´ú¸Õª©ªº½s½X­È§ï±¼´N¥i¥H¥Î¤F¡T¦Ó¥B¥u­n±N PVSCAN.COM
   §ï¦¨ PVCLEAN.COM ©Î PVTSR.COM ´N¯à¨É¥Î¥Lªº¸Ñ¬r¥\¯à«¨¡T¼H¡T¯u¤è«K¡TPF °Ú¡T
   ¯uÁÂÁÂ¡y±z¡z¡TÁÂÁÂ±z¼g¤@­Ó¨º»ò¦nªºªFªF¨º§Ú­Ì¥Î¡T¥H«á¸Ñ¬r´N¤£¥Î§Ú·Ð¤ßÅo¡T

   ¨ä¹ê¼g³o¨ÇªF¦è¸ò¥»´N¸ò·d¯}¸Ñ¤@¯ë¡A©Ò¥H§Ú¥Î¤£µÛ¯d±¡¡T¨ì¬O§AªºªFªF¦³¦p¶Ç¨¥
   ¤¤ªº¨º»ò¦n¨º»ò´Î¶Ü¡S¼H¡T¯dµ¹¤j®a¥hµû½×§a¡T

   ¥Ñ©ó§Ú¼gªº«Ü¥^«P¡A¦³¨Ç¥\¯à¨Ã¤£¬O«Ü¦n¡T¦]¦¹¤j®a¨£½ÌÅo¡T;_)
   ½Ð±N´ú¸Õª©ªº PVSCAN.COM «þ¨ì²{¦æ¥Ø¿ýªº PVSCAN.ORG¡T
   µM«á°õ¦æ PV-KEY.COM¡T[TAB] §@¤Á´«¡T[ESC] ¦sÀÉ¡T¨ä¥¦²Ó¸`¥h¬ã¨s­ì©lµ{¦¡§a
   ¡T³á¡T§Ú«ÜÅÜºA¶Ü¡S

   ½Ð¥Î MASM pv-key;
        LINK pv-key;
        EXE2BIN pv-key pv-key.com

   ª`·N¡T¨Ï¥Îªº¥~±¾¼Ò²Õ³Ì¦n¬O¦b PVCOD v2.1 ¤§«e...

;
;  PV-KEY v1.0  Written by Zhuge Jin at TPVO, 1995.
;  (C) Copyright TPVO, 1995.
;

        .MODEL SMALL
        .CODE

        org 0100h

begin:
        mov ax,0600h
        mov bx,0700h
        xor cx,cx
        mov dx,184fh
        int 10h

        call print_scr

        mov ah,02h
        xor bx,bx
        mov dx,091fh
        int 10h

        mov si,OFFSET eng_buf

key_loop:
        mov bp,OFFSET eng_buf+03h
        mov ax,1300h
        mov bx,0070h
        xor cx,cx
        mov cl,cs:eng_buf
        mov dx,091fh
        int 10h

        mov bp,OFFSET chi_buf+03h
        mov ax,1300h
        mov bx,0070h
        xor cx,cx
        mov cl,cs:chi_buf
        mov dx,0b1fh
        int 10h

        call get_key

        cmp ah,01h
        jz exit

        call key_proc

        jmp key_loop

exit:
        mov ax,3d00h
        mov dx,OFFSET file_name
        int 21h

        xchg ax,bx

        mov ah,3fh
        mov cx,1663
        mov dx,OFFSET buffer
        int 21h

        push bx

        mov si,OFFSET buffer+0621h
        mov word ptr ds:[si],0d4e1h

        mov cx,24/2
        mov si,OFFSET eng_buf+03h
        mov di,OFFSET buffer+01d8h
xor_a1:
        lodsw
        xor ax,1c3ch
        stosw
        loop xor_a1

        mov cx,20/2
        mov si,OFFSET chi_buf+03h
        mov di,OFFSET buffer+0330h
xor_a2:
        lodsw
        xor ax,169fh
        stosw
        loop xor_a2

        mov ah,3ch
        mov cx,0020h
        mov dx,OFFSET pvscan
        int 21h

        xchg ax,bx

        mov ah,40h
        mov cx,1663
        mov dx,OFFSET buffer
        int 21h

        mov ah,3eh
        int 21h

        pop bx

        mov ah,3eh
        int 21h

        mov ax,0600h
        mov bx,0700h
        xor cx,cx
        mov dx,184fh
        int 10h

        mov ah,02h
        xor dx,dx
        int 10h

        mov ax,4c00h
        int 21h

print_scr:
        mov dx,050dh
        mov bp,OFFSET version
ps_a:
        mov ax,1300h
        mov bx,0007h
        mov cx,0032h
        int 10h
        add bp,cx
        inc dh
        cmp dh,0bh+05h
        jb ps_a
        ret

get_key:
        xor ax,ax
        int 16h
        ret

key_proc:
        push ax

        mov ah,03h
        xor bx,bx
        int 10h

        pop ax

        cmp ah,0fh
        jnz kp_a1

        cmp si,OFFSET eng_buf
        jnz kp_ab

        mov si,OFFSET chi_buf
        mov dh,0bh
        jmp kp_a1

kp_ab:
        mov si,OFFSET eng_buf
        mov dh,09h

kp_a1:
        mov bx,ds:[si+01h]

        cmp al,20h
        jae kp_a2

        cmp ah,4bh
        jnz kp_a1b1
        dec bx
        jmp kp_ext
kp_a1b1:
        cmp ah,4dh
        jnz kp_ext
        inc bx
        jmp kp_ext

kp_a2:
        call chk_range
        mov ds:[bx+si+03h],al
        inc bx
kp_ext:
        call chk_range
        mov ds:[si+01h],bx

        mov ah,02h
        xor bx,bx
        mov dl,cs:[si+01h]
        add dl,1fh
        int 10h

        ret

chk_range:
        cmp bl,0ffh
        jnz cr_a
        mov bl,ds:[si]
        dec bx
        jmp cr_ext
cr_a:
        cmp bl,ds:[si]
        jb cr_ext
        xor bx,bx
cr_ext:
        mov bh,00h
        ret

eng_buf db 17h,00h,00h,'Register : Zhuge Jin    '
chi_buf db 14h,00h,00h,'µù¥UªÌ¡G½Ñ¸¯¿[ ¤j­ô!'

file_name db 'PVSCAN.ORG',00h
pvscan db 'PVSCAN.COM',00h

version db '¢z¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢{'
        db '¢x      PV Key v1.0  By Zhuge Jin at TPVO.      ¢x'
        db '¢x----------------------------------------------¢x'
        db '¢x                                              ¢x'
        db '¢x English Name : _______________________       ¢x'
        db '¢x                                              ¢x'
        db '¢x Chinese Name : ____________________          ¢x'
        db '¢x                                              ¢x'
        db '¢x----------------------------------------------¢x'
        db '¢x(C) Copyright TPVO, 1995. All rights reserved.¢x'
        db '¢|¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢w¢}'

buffer db 1000h dup(?)

        END begin

