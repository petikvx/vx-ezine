                              Пивет !!!
     Кем бы ты ни был, уважаемый читатель, вирусологом, вирусописателем или
просто заблудшим пользователем...
                     Салям(и :) тебе, о мой друг.

     То что ты сейчас читаешь, это файл-описание к вирусу ViKing.Genius.59,
написанный за несколько дней (не считая время  на  обдумывание).

     Написание вирусов ,  для меня, не желание напакостить ближнему своему,
а скорее спорт, как например охота.

     Соревнование по написанию самого короткого вируса длится довольно дав-
но. Абсолютным рекордсменом был,  есть и будет вирус  Little-25  (Trivial),
который был написан еще раньше 91?  (увы не знаю точную дату написания) го-
да.  Но это скорее не вирус, а троянская программа, которая уничтожает свою
программу-хозяина.
     Война на вирусном фронте разразилась после выхода  в  свет  Болгарских
Tiny  и Московских AT(Small) вирусов:  рекорды падали,  как листья осенью в
лесу - 198, 160, 154, 133, 122, 118, 114. Но это было в 90-91? годах. Потом
прямо что-то случилось и каждый мало-мальский смыслящий в ассемблере брался
за написание крошек.  Но как правило это получались либо клоны существующих
либо далекие от рекорда.  В 92 рекорд был 112 байт,  но его почему-то нет в
-V (или как сейчас AVP).  В то время я тоже участвовал в этой гонке:  в  93
моими  рекордами  были  102 и 96 байт.  Но как только я очухался чтоб куда-
нибудь их послать,  вышел питерский 92-й. После этого я 1.5-2 года не зани-
мался малютками. Но вот наступило лето 94, а с ним у Диалога появился новый
WEB (как любят у нас говорить в рекламах).  После этого вплоть до сегодняш-
него утра появились новые рекордсмены:  семейство Dinky. Их автор Игорь Да-
нилов (он же автор Dr.Web) (см.  Aidstest.me & Web.me соответственно),  по-
трудился на славу и заслуживает наивысших похвал:
Micro-66 -> Dinky.66 по классификации Aidstest'а
     Заражает только COM,  резидентный.  Это,  конечно,  невозможно,  но
     Игорь Данилов сумел его сделать!  Есть еще и  86,  80,  76,  но  на
     свободе  им  не гулять,  поэтому в Aidstest вставлен только текущий
     рекорд. Мне кажется, что его побить невозможно, но...
Игорь пишет Dinky.64...

Но рекордсменами Dinky продержались не долго...
     Я ,те  ViKing,  за  пару  дней   написал   семейство   вирусов Genius:
80,76,64,60,59 байт.  Все вирусы резидентны, свое тело располагают в Inter-
rupt Table.  Записываются в начало заражаемого файла. Перехватывают 21 пре-
рывание. Так как идей было много, то и версий было достаточно.

     А теперь более подробно об рекордсмене:
     1) Содержит в себе инструкции 286 процессора PUSHA & POPA.
     2) Перехватывая 21h прерывание, он проверяет запись блока данных начи-
нающихся с символа 0E9h,  те JMP NEAR. Предполагая что такое обычно бывает у
COM файлов,  да и то когда их копируют;  вирус пишет свое тело,  а уж после
этого передает управление в DOS. Причем после этого (как правило) получает-
ся такая ситуация:
                                   ┌─────────────────────┐
                                   │              <────┐ │
┌─────────────────────┐            │                   │ │
│             <─────┐ │            │   Тело копируемой │ │
│                   │ │            │      программы    │ │
│  Тело копируемой  │ │    ==>     │                   │ │
│     программы     │ │            │                   │ │
│                   │ │            │       JMP NEAR────┘ │
│                   │ │            ├─────────────────────┤
│      JMP NEAR─────┘ │            │     Тело Вируса     │
└─────────────────────┘            └─────────────────────┘
     Но увы  возможны  случаи когда вирус может безвозвратно испортить файл
хозяин. Такое может произойти, например, при лечении аналогичной зараженной
программы  антивирусом.  Такие случаи довольно редки и при обычных условиях
вирус не должен портить файлы (день как у меня 59 сидит на  машине  и  пока
тьфу-тьфу-тьфу  ничего не испортил;). Условие конечно притянуто за уши,  но
это дает очень большой выигрыш в размере.  Конечно и в 59-м  можно  кое-что
подчистить, но я  не хочу этого делать (это не значит, что я не знаю как),
т.к.  сильно уменьшится живучесть вируса.
     3) Может  подвиснуть  при  нестандартных  ДОСках,  когда SI<>IP DI<>SP
AH<>0 BH<>0 CH<>0: при MS-DOS <=6.22 такого еще не  происходило. Или  когда
файл  будет  заражен еще раз вирусом который не восстанавливает прежние ре-
гистры.  Аналогично: когда заражаемая программа сама критична к входным ре-
гистрам.
     4) В 59 (в отличии от 60) в обработчике используется  вызов  int  21h,
из-за   этого   в  стэке  оказываются  все  регистры  общего  назначения  +
FLAGS,CS,IP два раза (в 60 только один раз :).
     А это мой вариант таблицы к -V или Web:
╔═══════════════╤════╤════╤════╤═════╤═══════════╤═════╤══════════════════╗
║      Name     │Inf.│TSR │Eff │ Len │ Infected  │Inf. │File's len growing║
║               │way │    │ects│( L )│   files   │place│                  ║
╠═══════════════╪════╪════╪════╪═════╪═══════════╪═════╪══════════════════╣
║Genius.59      │INT │INTB│ -  │ 59  │    C *    │  s  │ L                ║
╚═══════════════╧════╧════╧════╧═════╧═══════════╧═════╧══════════════════╝
    Мог бы еще приложит лечащую базу к -V, но лень уже писать, думаю что он
не принесет больших потерь, пока не выйдут новые версии Aidstest, -V и Web.

Ну вот и все ребята.
Желаю Genius'ам продержатся рекордсменами хотя бы пол-года.

                ViKing, The Greatest King of OutStanding Kingdom.

PS:
Пользуюсь случаем я хочу передать привет всем моим друзьям:
Dr.EuGGiE, Black Jack, Professor Nimnul, Cyrix NightMareff и всем, Всем, ВСЕМ.
                Yours ViKing. =8*)+

PPS:
Дяде Жене: А все-равно Жигулевское лучше Праздничного...
Дмитрию Николаевичу: Слабо... Мне слабо придумать и не написать вирус.

                С превеликим уважением ViKing.

BBS: (а что бы это могло значить? :)
Ну а это уж стабильное местечко в подобных трудах: Доска благодарностей.
Сергею:         за то, влияние которое оказал на меня его 114-й
Женям (1-2-3):  за повышение знаний ассемблера.
Шурам (двум+1): за протирку моих плат и контактов спиртосодержащими растворами.
За моральную поддержку:
        FrontLine Assembly
        Nine inch nails
        Qntal
        Dead Can Dance
        Pink Dots (& Pink Floyd too)
        Swans
        Skinny Puppy
        Einsturzende Neubauten
        The Mortal Coil (not Mortal Combat 1-2)
        ну и еще куче всяких там разных чуваков, кто время от времени издает
всякие там непотребные звуки...
        Кстати не надо сразу бросаться на меня с кулаками, если вам не нравит-
ся то, что я слушаю.


                Гудбаюшки усем, с этим разрешите откланяться ваш ВиКинг.

==> End of Genius59.doc

